%% The following is a directive for TeXShop to indicate the main file
%%!TEX root = HarmonicAnalysis.tex

\part{Distributional Methods}

\chapter{The Theory of Distributions}

Distribution theory is a tool which enables us to justify formal manipulations in harmonic analysis without having to worry about technical analytical issues. For instance, the theory allows us to take the formal derivative of a much more general class of functions than those differentiable pointwise by methods of the classical differential calculus. That such a consistant formal definition of the derivative is possible is hinted at by equations in Fourier analysis such as
%
\[ D^i f = \mathcal{F}^{-1} \left\{ M^i \mathcal{F} \{ f \} \right\}, \]
%
where $M^i f(x) = (2 \pi i x_i) f(x)$, and $D^i f$ is differentiation in the variable $x_i$. The quantity $D^i f$ can only be classically interpreted if $f$ is pointwise differentiable in the variable $x_i$, whereas the right hand side, interpreted in terms of Lebesgue integrals, is defined for a much less regular class, namely the family of integrable functions $f$ such that $M^i \widehat{F} \{ f \}$ is also integrable. We will find a much larger domain, a class of generalized functions called tempered distributions, such that both sides of the equation have the same domain, and can be correctly interpreted.

If we consider solutions $u \in \loc{C^2}(\RR^d)$ to elliptic partial differential equations like the Laplace equation $\Delta u = 0$, then the regularity theory of such solutions shows the family of such functions is closed under locally uniform convergence, i.e. in the space $\loc{C}(\RR^d)$. This is no longer true for solutions to certain non-elliptic partial differential equations, such as solutions to the wave equation $\partial_t u = \Delta_x u$ in $\loc{C^2}(\RR \times \RR^d)$. For instance, the closure of such a class under uniform convergence would have to contain all functions of the form
%
\[ f(x+t) + g(x-t) \]
%
for any $f,g \in \loc{C}(\RR \times \RR^d)$. To fix this problem, in PDE it is often of interest to enlarge the class of solutions to consider \emph{weak solutions}, i.e. functions $u \in \loc{L^1}(\RR^d)$ such that for any $\phi \in C_c^\infty(\RR \times \RR^d)$,
%
\[ \int u(t,x) (\Delta \phi - \partial_t \phi)(t,x)\; dt\; dx = 0, \]
%
an equation true for any classical solution, as verified by integration by parts. This class is then clearly closed under uniform convergence, i.e. in $\loc{L^\infty}(\RR^d)$. The step to distributional solutions to partial differential equations from classical solutions is then not far off, since the theory of generalized functions allows us to apply differentiable operators to $u \in \loc{L^1}$, and we find that $u$ will be a weak solution to the wave equation if and only if $\partial_t u = \Delta_x u$. We will also find that the family of \emph{distributional} solutions to the wave equation is closed under a very general topology. These properties are one reason why distributions are a core tool to the formulation of many problems in partial differential equations and modern harmonic analysis.

\section{Distributions}

The path of modern analysis has extended analysis from the study of continuous and differentiable functions to the much larger class of measurable functions. The power of this approach is that we can study a very general class of functions. On the other hand, the more general the class of functions we work with, the more restricted the analytical operations we can perform, e.g. one cannot differentiate elements of $L^1(\RR^d)$ in a classical sense. Nonetheless, in pretty much all function spaces we consider on $\RR^d$, the space $C^\infty_c(\RR^d)$ forms a dense subclass, and in this subclass we can perform pretty much all possible analytical operations. One approach to studying the general class of measurable functions is to prove results for elements of $C^\infty_c(\RR^d)$, in which one can apply all necessary analytical operations, and then apply an approximation result to obtain the result for a wider class of measurable functions. The theory of distributions provides a complimentary approach, using \emph{duality} to formally extend analytical operations on $C^\infty_c(\RR^d)$ to a larger family of \emph{generalized functions}.

From the perspective of set theory, a function $f: X \to Y$ is a rule for assigning a value in $Y$ to each point in $X$. However, in analysis this perspective is often not the most useful. This is most clear in measure theory, where we are very used to treating a function as defined `up to a set of measure zero'. This has the peculiar feature that a function often cannot be interpreted pointwise at any particular point. Distribution theory continues this philosophy, taking the point of view that functions are `integrands', whose properties are understood by integration against a family of `test functions'.

As an example of this phenomenon, since the dual space of $L^1(\RR^d)$ is $L^\infty(\RR^d)$, we can think of elements $f \in L^\infty(\RR^d)$ as `integrands', which can be completely understood by `testing' $f$ against an element $\phi \in L^1(\RR^d)$, i.e. via a study of the quantities
%
\[ \int f(x) \phi(x)\; dx. \]
%
Similarily, if $K$ is a compact topological space, then the dual space to $C(K)$ is the space $M(K)$ of finite Borel measures on $K$. Thus we can think of the class of measures $M(K)$ as a family of `generalized integrands' which can be understood by testing these measures against continuous functions.

Notice that as we shrink the family of test functions, the resulting family of `generalized functions' becomes larger and larger, and so elements are allowed to behave more erratially. A distribution is a `generalized function' understood by testing against the very regular family of functions in the space $C_c^\infty(\RR^d)$, functions which in this situation are classical denoted as $\DD(\RR^d)$. We obtain a slightly smaller class by considering generalized functions tested against the larger class of test functions $C^\infty(\RR^d)$, this family often being denoted $\EC(\RR^d)$. An intermediate class of test functions is the space of Schwartz functions $\SW(\RR^d)$, which is often the most convenient for problems studied in harmonic analysis. 

One can apply the ideas described in this chapter to many other classes of test functions. Provided that the test functions can be suitably localized, one will likely obtain similar results to that described in this chapter. On the other hand, if one deals with families of test functions which cannot be appropriately localized, one is likely to obtain quite a different theory of generalized functions. This is encountered, for instance, if one takes the family of analytic functions as the test functions, which gives the theory of \emph{hyperfunctions}, not discussed here.

\begin{remark}
  From the perspective of experimental physics, viewing functions as integrands is more natural than viewing functions in the set-theoretic sense. Indeed, points in space are idealizations which do not correspond to real world phenomena. One can never measure the exact value of some quantity of a function at a point, but rather only understand the function by looking at it's averages over a small region around that point. Thus the only physically meaningful properties of a `function' are those obtained by testing that function against some family of test functions, obtained from some physical measurements. And indeed, physicists had experimented with using distributions in their calculations before a formal definition was introduced by mathematicians.
\end{remark}

\section{Test Functions and Distributions}

Fix an open subset $\Omega$ of $\RR^d$. Let us review the family of test functions we use to give a theory of distributions:
%
\begin{itemize}
    \item The main choice is the space $\DD(\Omega) = C_c^\infty(\Omega)$ of compactly supported smooth functions, equipped with the topology of compact convergence, e.g. the LF space consisting of the inductive limit of the Fr\'{e}chet spaces $C^\infty_c(K)$ of smooth functions on $\RR^d$, which are compactly supported on a compact set $K$, equipped with the topology of uniform convergence of the functions are all of their derivatives. Taking the dual of this space yields the most general space of distributions $\DD(\Omega)^*$.

    \item If $\Omega = \RR^d$, we can use the space $\SW(\Omega)$ of Schwartz functions on $\Omega$, i.e. the Fr\'{e}chet space consisting of functions $f$ whose derivatives are all rapidly decreasing, by which we mean that the seminorms
    %
    \[ \| f \|_{\SW^{n,m}(\Omega)} = \sup_{x \in \Omega} \sup_{|\alpha| \leq m} |D^\alpha f(x)| \langle x \rangle^n \]
    %
    are finite for all integers $n$ and $m$. $\SW(\Omega)$ becomes a Fr\'{e}chet space if we treat these seminorms as defining a topology on this space. The dual of $\SW(\Omega)$ is called the space of \emph{tempered distributions} $\SW(\Omega)^*$.

    \item The space $\mathcal{E}(\Omega) = \loc{C^\infty}(\Omega)$ consists of all smooth functions on $\Omega$, and is equipped with the topology of locally uniform convergence of the function and all of it's derivatives. Using these functions as test functions gives the space $\mathcal{E}(\Omega)^*$ of \emph{compactly supported distributions}.

    \item We can use the space $\DD^n(\Omega) = C_c^n(\Omega)$ of compactly supported $n$-times continuously differentiable functions, under the topology of compact convergence, e.g. equipped with the LF topology analogous to that of $\DD(\Omega)$. This gives the space $\DD^n(\Omega)^*$ of \emph{distributions of order $n$}. Simiarily, we can use the space $\EC^n(\Omega) = C^n_{\text{loc}}(\Omega)$, and the dual is the space of \emph{compactly supported distributions of order $n$}.
\end{itemize}
%
Despite being apriori defined as duals of different vector spaces, we will later see we can identify all these spaces as subspaces of the most general space of distributions $\DD(\Omega)$, and so we will begin by studying this most general space. As an LF space, $\DD(\Omega)$ is \emph{not metrizable}. This is in some sense necessary; it is \emph{impossible} to make $C_c^\infty(\Omega)$ into a Fr\'{e}chet space, such that each of the subspaces
%
\[ \DD(K) = \{ f \in C_c^\infty(\Omega): \text{supp}(f) \subset K \} \]
%
are closed in $\DD(\Omega)$. The interior of each of these subspaces is empty because no translation of these subspaces is absorbing. The Baire category theorem would then imply that a countable union of such subspaces has nonempty interior. But $\DD(\Omega)$ is the countable union of such spaces, which would give a contradiction. Nonetheless, as an LF space, $\DD(\Omega)$ is equipped with a topology which makes each of the subspaces $\DD(K)$ closed, while still having many of the useful properties that Fr\'{e}chet spaces come with.
%
%To see more practically what the problem is, let us see why $\DD(\RR^d)$ is not closed as subspace of the Fr\'{e}chet space $C^\infty_b(\RR^d)$ of smooth functions with bounded derivatives of all orders. Given $\psi \in \DD(\RR^d)$, the sum
%
%\[ \sum_{n = 1}^\infty 2^{-n} \cdot \text{Trans}_n \psi \]
%
%converges in $C^\infty_b(\RR^d)$ to a non compactly supported function. Thus under the topology of uniform convergence of a function and all of its derivatives, the limit of compactly supported functions can be made non compactly supported.
%
In particular, it follows from the general theory of LF spaces that $\DD(\Omega)$ is a complete, locally convex space. The space $\DD(\Omega)$ is also Montel, since it is the inductive limit of Montel spaces.

We recall some useful properties of the inductive limit. A sequence $\{ \phi_n \}$ converges in $\DD(\Omega)$ to $\phi$ if $\bigcup_n \text{supp}(\phi_n)$ is precompact, and if $\{ \phi_n \}$ and all derivatives of this sequence converge uniformly to $\phi$. The space is Bornological, so that every bounded linear map $T: \DD(\Omega) \to Y$ is continuous, and so in particular, all sequentially continuous linear maps are continuous. Moreover, if $X$ is first countable, then for any bounded linear map $T: X \to \DD(\Omega)$, there exists a compact set $K \subset \Omega$ such that $T(X) \subset K$. The Arzela-Ascoli theorem implies that for any compact set $K$, each of the spaces $\DD(K)$ has the Heine-Borel property, and so $\DD(\Omega)$ also has the Heine-Borel property, i.e. $\DD(\Omega)$ is a Montel space.

%The process we perform here is quite general and can be viewed as a way to construct the `categorical limit' of a family of complete, locally convex spaces. For each compact set $K \subset \Omega$, the subspace $C_c^\infty(K) \subset \DD(\Omega)$ is a complete metric space under the family of seminorms $\| \cdot \|_{C^n(K)}$. We consider a convex topology on $\DD(\Omega)$ by considering the family of sets $\{ \phi + W \}$ as a basis, where $\phi$ ranges over all elements of $\DD(\Omega)$, and $W$ ranges over all convex, balanced subsets of $\DD(\Omega)$ such that $W \cap C_c^\infty(K)$ is open in $C_c^\infty(K)$ for each $K \subset \Omega$.

%\begin{theorem}
%    This gives a basis of a Hausdorff topology on $\DD(\Omega)$.
%\end{theorem}
%\begin{proof}
%    If $\phi_1 + W_1$ and $\phi_2 + W_2$ both contain $\phi$, then $\phi - \phi_1 \in W_1$ and $\phi - \phi_2 \in W_2$. The functions $\phi, \phi_1$, and $\phi_2$ are all supported on some compact set $K$. By continuity of multiplication on $C_c^\infty(K)$, and the fact that $W_n \cap C_c^\infty(K)$ is open, there is a small constant $\delta$ such that $\phi - \phi_n \in (1 - \delta) W_n$ for each $n \in \{ 1, 2 \}$. The convexity of the $W_n$ implies that $\phi - \phi_n + \delta W_n \subset W_n$. But then $\phi + \delta W_n \subset \phi_n + W_n$, and so $\phi + \delta (W_1 \cap W_2) \subset (\phi_1 + W_1) \cap (\phi_2 + W_2)$. Thus we have verified the family of sets specified above is a basis. Now we show $\DD(\Omega)$ is Hausdorff under this topology. Suppose $\phi$ is in every open neighbourhood of the origin, then in particular, for each $\varepsilon > 0$, $\phi$ lies in the set $W_\varepsilon = \{ f \in \DD(\Omega): \| f \|_{L^\infty(\Omega)} < \varepsilon \}$, and it is easy to see these sets are open. Since $\bigcap_{\varepsilon > 0} W_\varepsilon = \{ 0 \}$, this means $\phi = 0$.
%\end{proof}

%\begin{theorem}
%    $\DD(\Omega)$ is a locally convex space.
%\end{theorem}
%\begin{proof}
%    Fix $\phi$ and $\psi$, and consider any neighbourhood $W$ of the origin. By convexity, we have $(\phi + W/2) + (\psi + W/2) \subset (\phi + \psi) + W$. This shows addition is continuous. To show multiplication is continuous, fix $\lambda$, $\phi$, and a neighbourhood $W$ of the origin. Then $\phi$ is supported on some compact set $K$, and $W \cap C_c^\infty(K)$ is open, in particular absorbing, so there is $\varepsilon > 0$ such that if $|\alpha| < \varepsilon$, $\alpha \phi \in W/2$. Then if $|\gamma - \lambda| < \varepsilon$, then because $W$ is balanced and convex,
    %
%    \begin{align*}
%        \gamma \left(\phi + \frac{W}{2(|\lambda| + \varepsilon)} \right) &= \lambda \phi + (\gamma - \lambda) \phi + \frac{\gamma}{2(|\lambda| + \varepsilon)} W\\
%        &\subset \lambda \phi + W/2 + W/2 \subset \lambda \phi + W
%    \end{align*}
    %
%    so multiplication is continuous.
%\end{proof}

%\begin{theorem}
%    For each compact set $K \subset \Omega$, the canonical embedding of $C_c^\infty(K)$ in $\DD(\Omega)$ is continuous.
%\end{theorem}
%\begin{proof}
%    We shall prove a convex, balanced neighbourhood $V$ is open in $\DD(\Omega)$ if and only if $C_c^\infty(K) \cap V$ is open in $C_c^\infty(K)$ for each $K$. Since $V$ is open, $V$ is the union of convex, balanced sets $W_\alpha$ with $W_\alpha \cap C_c^\infty(K)$ open in $C_c^\infty(K)$ for each $K$. But then $V \cap C_c^\infty(K) = (\bigcup W_\alpha) \cap C_c^\infty(K)$ is open in $C_c^\infty(K)$. The converse is true by definition of the topology. But this statement means exactly that the map $C_c^\infty(K) \to \DD(\Omega)$ is an embedding, because it is certainly continuous, and if $W$ is a convex neighbourhood of the origin equal to the set of $\phi$ supported on $K$ with $\| \phi \|_{C^n(K)} \leq \varepsilon$ for some $n$, then the image is the intersection of $C_c^\infty(K)$ with the set of all $\phi$ supported on $\Omega$ satisfying the inequality, which is open. This shows that the map is open onto its image, hence an embedding.
%\end{proof}

%\begin{theorem}
%    Consider any $E \subset \DD(\Omega)$. Then $E$ is a bounded subset of $\DD(\Omega)$ if and only if $E$ is contained in $C_c^\infty(K)$ for some compact set $K$, and there is a sequence of constants $\{ M_n \}$ such that $\| \phi \|_{C^n(\Omega)} \leq M_n$ for all $\phi \in E$.
%\end{theorem}
%\begin{proof}
%    We shall now prove that if $E$ is not contained in some $C_c^\infty(K)$ for any compact set $K \subset \Omega$, then $E$ is not bounded. If our assumption is true, we can find functions $\phi_n \in E$ and a set of points $x_n \in X$ with no limit point such that $\phi_n(x_n) \neq 0$. For each $n$, set
    %
%    \[ W_n = \left\{ \psi \in \DD(\RR^d): |\psi(x_n)| < n^{-1} |\phi_n(x_n)| \right\}. \]
    %
%    Certainly $W_n$ is convex and balanced, and for each compact set $K$, if $\psi \in W_n \cap C_c^\infty(K)$, then there is $\varepsilon > 0$ such that $|\psi(x_n)| < n^{-1} |\phi_n(x_n)| - \varepsilon$. Thus if $\eta \in C_c^\infty(K)$ satisfies $\| \eta \|_{L^\infty(\RR^d)} < \varepsilon$, then $\psi + \eta \in W_n$. In particular, this means $W_n \cap C_c^\infty(K)$ is open in $C_c^\infty(K)$ for each $K$, so $W_n$ is open.

%    Now we claim $W = \bigcap_{n = 1}^\infty W_n$ is open. Certainly this set is convex and balanced. Moreover, each compact set $K$ contains finitely many of the points $\{ x_n \}$, so $W \cap C_c^\infty(K)$ can be replaced by a finite intersection of the $W_n$, and is therefore open. Since $\phi_n \not \in nW$ for all $n$, this implies that $E$ is not bounded. The fact that $\| \cdot \|_{C^n(\Omega)}$ specifies the topological structure of $C_c^\infty(K)$ for each compact $K$ now shows that if $E$ is bounded, there exists constants $\{ M_n \}$ such that $\| \phi \|_{C^n(\Omega)} \leq M_n$ for all $\phi \in E$. The converse property follows because $C_c^\infty(K)$ is embedded in $\DD(\Omega)$.
%\end{proof}

%\begin{theorem}
%    $\DD(\Omega)$ has the Heine Borel property.
%\end{theorem}
%\begin{proof}
%    This follows because if $E$ is bounded and closed, it is a closed and bounded subset of some $C_c^\infty(K)$ for some compact set $K$, hence $E$ is compact since $C_c^\infty(K)$ satisfies the Heine-Borel property (this can be proved by a technical application of the Arzela-Ascoli theorem).
%\end{proof}

%\begin{corollary}
%    $\DD(\Omega)$ is quasicomplete.
%\end{corollary}
%\begin{proof}
%    If $\phi_1, \phi_2, \dots$ is a Cauchy sequence in $\DD(\Omega)$, then the sequence is bounded, hence contained in some common $C_c^\infty(K)$. Since the sequence is Cauchy, they converge in $C_c^\infty(K)$ to some $\phi$, since $C_c^\infty(K)$ is complete, and thus the $\phi_n$ converge to $\phi$ in $\DD(\Omega)$.
%\end{proof}

TODO: Move next lemma to tensor products section.

\begin{theorem}
    For any two open sets $\Omega_1$ and $\Omega_2$, $C^\infty_{\text{loc}}(\Omega_1 \times \Omega_2)$ is naturally isomorphic to $C^\infty_{\text{loc}}(\Omega_2, C^\infty_{\text{loc}}(\Omega_1))$.
\end{theorem}
\begin{proof}
    The correspondence is obtained by mapping $f \in C^\infty_{\text{loc}}(\Omega_2, C^\infty_{\text{loc}}(\Omega_1))$ to $F \in C^\infty_{\text{loc}}(\Omega_1 \times \Omega_2)$ given by setting $F(x,y) = f(y)(x)$. The map is clearly one to one and continuous. If $F$ is an arbitrary element of $C^\infty_{\text{loc}}(\Omega_1 \times \Omega_2)$, and we define $f[y](x) = F(x,y)$, then the mean-value theorem implies that the quantities
    %
    \[ \frac{D^\alpha_x F(x,y + he_i) - D^\alpha_x F(x,y)}{h} \]
    %
    converge locally uniformly in $x$ to $D_y^i F$, and thus $f$ lies in $C^1(\Omega_2, C^\infty(\Omega_1))$. But iterating this process shows that $f$ is actually $C^\infty$. Thus the correspondence $f \mapsto F$ is a bijection. and since both spaces are Fr\'{e}chet spaces, the open mapping theorem implies that the correspondence is an isomorphism.
\end{proof}

\begin{theorem}
    Finite sums of tensor functions are dense in $\DD(\RR^d)$.
\end{theorem}
\begin{proof}
    Recall from the theory of multiple Fourier series that if $f \in C^\infty(\RR^d)$ is $N$ periodic, in the sense that $f(x + n) = f(x)$ for all $x \in \RR^d$ and $n \in (N \ZZ)^d$, then there are coefficients $a_m$ for each $m \in \ZZ^n$ such that $f = \lim_{M \to \infty} S_M f$, where the convergence is dominated by the seminorms $\| \cdot \|_{C^n(\RR^d)}$, for all $n > 0$, and
    %
    \[ (S_M f)(x) = \sum_{\substack{m \in \ZZ^d\\|m| \leq M}} a_m e^{\frac{2 \pi i m \cdot x}{N}}. \]
    %
    Note that since
    %
    \[ e^{\frac{2 \pi i m \cdot x}{N}} = \prod_{k = 1}^d e^{2 \pi i m_ix_i/N} \]
    %
    is a tensor product, $S_M f$ is a finite sum of tensor functions. If $\phi \in \DD(\RR^d)$ is compactly supported on $[-N,N]^d$, we let $f$ be a $10N$ periodic function which is equal to $\phi$ on $[-N,N]^d$. We then find coefficients $\{ a_m \}$ such that $S_M f$ converges to $f$. If $\psi: \RR \to \RR$ is a compactly supported bump function equal to one on $[-N,N]^d$, and vanishing outside of $[-2N,2N]^d$, then $\psi^{\otimes d} S_M f$ converges to $\psi$ as $M \to \infty$, and each is a finite sum of tensor functions.
\end{proof}

%We can actually go one step further than this.

%\begin{theorem}
%    For any open sets $\Omega$ and $\Psi$, $\DD(\Omega \times \Psi)$ is isomorphic to the \emph{projective} tensor product $\DD(\Omega) \otimes \DD(\Psi)$.
%\end{theorem}
%\begin{proof}
%    Let $X$ denote the \emph{algebraic} tensor product of $\DD(\Omega)$ and $\DD(\Psi)$. Then we have an injective map $i: X \to \DD(\Omega \times \Psi)$ with dense image. Because $i$ is bilinearly continuous, $i$ is continuous in the projective tensor product topology. Conversely, for any two compact sets $K_1 \subset \Omega$ and $K_2 \subset \Psi$, $i(C_c^\infty(K_1) \otimes C_c^\infty(K_2)) \subset \DD(K_1 \times K_2)$. For any $N > 0$, pick multi-indices $\alpha_i = \lambda_i + \gamma_i$ such that $\| f_i \|_{C^N(K_1)} = |D^{\lambda_i} f_i(x_i)|$ and $\| g_i \|_{C^N(K_2)} = |D^{\gamma_i} g_i(y_i)|$.

%    Doesn't diagonal example show this map is not open (i.e. $h(x) = \sum_{k = 1}^{n-1} \phi(nx - k) \phi(ny - k)$, with $\| h \|_{C^N} \sim n^N$, but with the projective tensor product norm proportional to $n^{2N}$)

%    find a multi-index $\alpha = \alpha_1 + \alpha_2$ with $|\alpha| \leq N$ and $(x_0,y_0)$ such that
    %
%    \[ \| h \|_{C^N(K_1 \times K_2)} = |D^\alpha h(x_0,y_0)|. \]
    %
%    Then $D^\alpha h(x_0,y_0) = \sum D^{\alpha_1} f_i(x_0) D^{\alpha_2} g_i(y_0)$



%    We claim this is continuous when we equip $X$ with the projective tensor topology. For any $f_1,\dots,f_n \in C_c^\infty(K_1)$, $g_1,\dots,g_n \in C_c^\infty(K_2)$, $h = f_1 \otimes g_1 + \dots + f_n \otimes g_n$ is supported on $K_1 \times K_2$, and for any $N > 0$,
    %
%    \begin{align*}
%        \| h \|_{C^N(K_1 \times K_2)} &\leq \| f_1 \otimes g_1 \|_{C^N(K_1 \otimes K_2)} + \dots + \| f_n \otimes g_n \|_{C^N(K_1 \times K_2)}\\
%        &\leq \| f_1 \|_{C^N(K_1 \otimes K_2)} \| g_1 \|_{C^N(K_1 \otimes K_2)} + \dots + \| f_n \|_{C^N(K_1 \otimes K_2)} \| g_n \|_{C^N(K_1 \otimes K_2)}.
%    \end{align*}
    %
%    Taking infima over all representations of $h$ as a sum of tensor products therefore gives that $\| h \|_{C^N(K_1 \times K_2)} \leq \| h \|_{C^N(K_1) \otimes C^N(K_2)}$. Conversely, given any function $h \in i(X)$, fix $N > 0$, and suppose $(x_0,y_0)$ and $\alpha$ are such that $\| h \|_{C^N(K_1 \times K_2)} = |D^\alpha h(x_0,y_0)|$. Then if $h = \sum f_i \otimes g_i$, $\sum D^\alpha (f_i \otimes g_i)(x) = h(x_0,y_0)$, so 
%\end{proof}

%Because $\DD(\Omega)$ is the limit of metrizable spaces, it's linear operators still have many of the same properties as metrizable spaces.

%\begin{theorem}
%    If $T: \DD(\Omega) \to X$ is a map from $\DD(\Omega)$ to some locally convex space $X$, then the following are equivalent:
    %
%    \begin{itemize}
%        \item[(1)] $T$ is continuous.
%        \item[(2)] $T$ is bounded.
%        \item[(3)] If $\{ \phi_n \}$ converges to zero, then $\{ T\phi_n \}$ converges to zero.
%        \item[(4)] For each compact set $K \subset \Omega$, $T$ is continuous restricted to $C_c^\infty(K)$.
%    \end{itemize}
%\end{theorem}
%\begin{proof}
%    We already known that (1) implies (2). If $T$ is bounded, and we have a sequence $\{ \phi_n \}$ converging to zero, then the sequence is bounded, hence contained in some $C_c^\infty(K)$. Then $T$ is bounded as a map from $C_c^\infty(K)$ to $X$, hence $\{ T\phi_n \} \to 0$. (3) implies (4) because each $C_c^\infty(K)$ is metrizable, and any convergent sequence is contained in some common $C_c^\infty(K)$. To prove that (4) implies (1), we let $V$ be a convex, balanced, open subset of $X$. Then $T^{-1}(V) \cap C_c^\infty(K)$ is open for each $K$, and $T^{-1}(V)$ is convex and balanced, so $T^{-1}(V)$ is an open set.
%\end{proof}

Because convergence is so strict in $\DD(\Omega)$, almost every operation we want to perform on smooth functions is continuous in this space.
%
\begin{itemize}
    \item Since $f \mapsto D^\alpha f$ is a continuous operator from $\DD(K)$ to itself, it is therefore continuous on the entire space $\DD(\Omega)$. More generally, any linear differential operator with coefficients in $\DD(\Omega)$ is a continuous operator on $\DD(\Omega)$.

    \item The inclusion $\DD(\Omega) \to L^p_c(\Omega)$ is continuous. To prove this, it suffices to prove for each compact $K$, the inclusion $C_c^\infty(K) \to L^p(K)$ is continuous, and this follows because if $f \in C_c^\infty(K)$, then
    %
    \[ \| f \|_{L^p(K)} \leq |K|^{1/p} \| f \|_{L^\infty(K)}. \]

    \item Multiplication gives continuous operators
    %
    \[ \DD(\Omega) \times \DD(\Omega) \to \DD(\Omega) \]
    %
    and
    %
    \[ C^\infty_b(\Omega) \times \DD(\Omega) \to \DD(\Omega). \]
    %
    \emph{However}, the operator
    %
    \[ \loc{C^\infty}(\Omega) \times \DD(\Omega) \to \DD(\Omega) \]
    %
    is sequentially continuous, and thus bounded, but \emph{not} continuous.

    \item The convolution operators
    %
    \[ \DD(\RR^d) \times \DD(\RR^d) \to \DD(\RR^d) \]
    %
    and
    %
    \[ L^1_c(\RR^d) \times \DD(\RR^d) \to \DD(\RR^d) \]
    %
    are continuous.
%    for any $g \in \DD(\RR^d)$, $f * g \in \DD(\RR^d)$. This is because $f * g$ is continuous since $g \in L^\infty(\RR^n)$, and it's support is contained in the algebraic sums of the support of $f$ and $g$, as well as the identity $D^\alpha(f * g) = f * (D^\alpha g)$. In fact, the map $g \mapsto f * g$ is a continuous operator on $\DD(\RR^n)$. This is because if we restrict our attention to $C_c^\infty(K)$, and $f$ has supported on $K'$, then our convolution operator maps into the compact set $K+K'$, and since
    %
%    \[ \| D^\alpha (g * f) \|_{L^\infty(K + K')} = \| D^\alpha g * f \|_{L^\infty(K + K')} \leq \| D^\alpha g \|_{L^\infty(K)} \| f \|_{L^1(K')}, \]
    %
%    we conclude
    %
%    \[ \| g * f \|_{C^n(K+K')} \leq \| g \|_{C^n(K)} \| f \|_{L^1(K')}, \]
    %
%    which gives continuity of the operator as a map from $C_c^\infty(K)$ to $C_c^\infty(K+K')$. Since the latter space embeds in $\DD(\RR^n)$, we obtain continuity of the operator on $\DD(\RR^n)$.
\end{itemize}
%
Thus $\DD(\Omega)$ is an ideal place to study many of the natural operations which occur in analysis.

%\begin{theorem}
%    If a map $T: C_c^\infty(K_0) \to \DD(\RR^n)$ is continuous, then the image of $C_c^\infty(K_0)$ is actually $C_c^\infty(K_1)$ for some compact set $K_1$.
%\end{theorem}
%\begin{proof}
%    Suppose there is a sequence $\{ x_i \}$ in $\RR^d$ with no limit point and smooth functions $\{ \phi_i \}$ compactly supported on $C_c^\infty(K_0)$ such that
    %
%    \[ (T\phi_i)(x_i) \neq 0. \]
    %
%    Then for any sequence $\{ \alpha_i \}$ of positive scalars, the sequence $\{ \alpha_i T\phi_i \}$ does not converge to zero, since the union of the supports of $\alpha_i T\phi_i$ is unbounded. This means $\alpha_i \phi_i$ does not converge to zero. But this is clearly not true, for if we let
    %
%    \[ \alpha_i = \frac{1}{2^i \| \phi_i \|_{C^i(\RR^d)}}, \]
    %
%    then for any fixed $n$, $\lim_{i \to \infty} \| \alpha_i \phi_i \|_{C^n(\RR^d)} = 0$, so the sequence $\{ \alpha_i \phi_i \}$ converges to zero. Thus there cannot exist a sequence $\{ x_i \}$, and so the union of the supports of $T(C_c^\infty(K_0))$ is supported on some compact set $K_1$.
%\end{proof}
%Thus the topology on the space $\DD(\RR^d)$ is as strict as can be. As a consequence, we shall see that the weak-$*$ topology on $\DD^*(\RR^d)$ is essentially the weakest topology available in analysis. This is surprising, because we are still able to obtain the continuity of many operators in the dual space to $\DD(\RR^d)$.

Let us now discuss the idea of a distribution. If $f \in \loc{L^1}(\Omega)$, then the linear functional $\Lambda[f]$ on $\DD(\Omega)$ defined for each $\phi \in \DD(\Omega)$ by setting
%
\[ \Lambda[f](\phi) = \int f(x) \phi(x)\; dx \]
%
is continuous. Moreover, $\Lambda[f]$ determines $f$ uniquely, and so we can safely identify $f$ with $\Lambda[f]$. We thus speak of `the distribution' $f$. The idea of the theory of distributions is to treat any continuous linear functional $\Lambda$ on $\DD(\Omega)$ as if it were given by integration against a test function. Thus for such a linear functional $\Lambda$, we often abuse notation by denoting the quantity $\Lambda(\phi)$ by
%
\[ \int_\Omega \Lambda(x) \phi(x)\; dx, \]
%
even if $\Lambda$ is not given by integration against some locally integrable function. The space $\DD^*(\Omega)$ will be called the space of distributions on $\Omega$. The class of distributions induced by elements of $\loc{L^1}(\Omega)$ is a fundamental class of distributions, but we will soon see that $\DD^*(\Omega)$ contains a much more erratic family of distributions. Nonetheless, using duality, we will still be able to extend many analytical operations to this class, such as the derivative operators. Let us now discuss this extension.

One huge advantage of the approach above is that we can generalize many analytical operations defined on $\DD(\Omega)$ \emph{distributionally} to give an operation on $\DD^*(\Omega)$, even if the original analytical operations required some degree of smoothness to define. If $A: \DD(\Omega) \to \DD(\Omega)$ is a continuous operator, then we can consider it's adjoint $A^*: \DD(\Omega)^* \to \DD(\Omega)^*$. If $A^*$ maps $\DD(\Omega)$ continuously into itself, then we can define an extension of $A$ to a map from $\DD(\Omega)^* \to \DD(\Omega)^*$ by defining, for a distribution $\Lambda$, a distribution $A \Lambda$ by the formula
%
\[ \langle A \Lambda, \phi \rangle = \langle \Lambda, A^* \phi \rangle. \]
%
This definition has the property that $A(\Lambda[\phi]) = \Lambda[A \phi ]$ for any $\phi \in \DD(\Omega)$, so that we have really constructed an extension of $A$ to a definition defined for all distributions.

Let us use this idea to define the derivative of an arbitrary distribution. For $\phi,\psi \in \DD(\RR)$, integration by parts tells us that
%
\[ \int_{-\infty}^\infty \phi'(x) \psi(x)\; dx = - \int_{-\infty}^\infty \phi(x) \psi'(x)\; dx. \]
%
Thus if $A\phi = \phi'$ is the derivative operator then it's adjoint behaves on distributions by setting $A^* \psi = - \psi'$. Thus, for a distribution $\Lambda$ on $\RR$, we define it's derivative to be the distribution $\Lambda'$ such that for $\phi \in \DD(\RR)$,
%
\[ \Lambda'(\phi) = \Lambda(A^* \phi) = - \Lambda(\phi'). \]
%
More generally, a similar calculation allows us to consider, for a distribution $\Lambda$ defined on an open subset $\Omega$ of $\RR^d$, and a multi-index $\alpha$, the partial derivative $\partial^\alpha \Lambda$ of a distribution on $\RR^d$, by setting, for $\phi \in \DD(\Omega)$,
%
\[ \int \partial^\alpha \Lambda(x) \phi(x)\; dx = (-1)^{|\alpha|} \int \Lambda(x) \partial^\alpha \phi(x)\; dx, \]
%
i.e. a repeated integration by parts. We can even define the gradient $\nabla \Lambda$, provided we are willing to work with \emph{vector valued distributions} without a proper introduction (such a distribution will act on the space $\DD(\Omega, \RR^n)$ of vector-valued test functions).

\begin{example}
    Let $H(x) = \mathbf{I}(x > 0)$ denote the {\it Heaviside step function}. Then $H$ is locally integrable, and so for any test function $\phi$, we calculate
    %
    \[ \int_{-\infty}^\infty H'(x) \phi(x)\; dx = - \int_{-\infty}^\infty H(x) \phi'(x) = - \int_0^\infty \phi'(x) = \phi(0) \]
    %
    Thus the \emph{distributional derivative} of the Heaviside step function is the Dirac delta function. It is not a function, but if we were to think of it as a `generalized function', it would be zero everywhere except at the origin, where it is infinitely peaked.
\end{example}

\begin{example}
    Consider the Dirac delta function at the origin, which is the distribution $\delta$ such that for any $\phi \in \DD(\RR)$,
    %
    \[ \int_{-\infty}^\infty \delta(x) \phi(x)\; dx = \phi(0). \]
    %
    Then
    %
    \[ \int_{-\infty}^\infty \delta'(x) \phi(x)\; dx = - \int_{\RR^d} \delta(x) \phi'(x)\; dx = - \phi'(0). \]
    %
    This is a distribution that does not arise from integration with respect to a locally integrable function nor integration against a measure. But it occurs in physics, as an appropriate model of certain physical situations, i.e. for the distribution of electrical charge in a polarized point mass with positive charge infinitisimally to the left of the origin, and negative charge infinitisimally to the right of the origin.
\end{example}

In general, we define a \emph{distribution} to be a continuous linear functional on the space of test functions $\DD(\Omega)$, i.e. an element of $\DD(\Omega)^*$. In the last section, our exploration of continuous linear transformations on $\DD(\Omega)$ guarantees that a linear functional $\Lambda$ on $\DD(\Omega)$ is continuous if and only if for every compact $K \subset X$ there is an integer $n_k$ such that $|\Lambda \phi| \lesssim_K \| \phi \|_{C^{n_k}(K)}$ for $\phi \in C_c^\infty(K)$. If one integer $n$ works for all $K$, and $n$ is the smallest integer with such a property, we say that $\Lambda$ is a distribution of \emph{order $n$}. If such an $n$ doesn't exist, we say the distribution has infinite order. Applying the Hahn-Banach theorem shows that if $\Lambda \in \DD^*(\Omega)$ has order $n$, then $\Lambda$ extends uniquely to a continuous linear functional on $\DD^n(\Omega)$, since $\DD(\Omega)$ is dense in $\DD^n(\Omega)$. In fact, we can actually \emph{identify} $\DD^n(\Omega)^*$ with the space of distributions of order $n$.

In many other ways, distributions act like functions. For instance, any distribution $\Lambda$ can be uniquely written as $\Lambda_1 + i \Lambda_2$ for two distributions $\Lambda_1, \Lambda_2$ that are real valued for any real-valued smooth continuous function. However, we cannot write a real-valued distribution as the difference of two positive distributions, i.e. those which are non-negative when evaluated at any non-negative functional. This is because any non-negative distribution is given by integration against a Radon measure, and thus has order zero. To see this, given such a non-negative functional $\Lambda$ (which is automatically continuous),  we define $\Lambda f$ for a compactly supported continuous function $f \geq 0$ as
%
\[ \Lambda f = \sup \{ \Lambda g: g \in \DD(\RR^n), g \leq f \} \]
%
and then in general define $\Lambda (f^+ - f^-) = \Lambda f^+ - \Lambda f^-$. Then $\Lambda$ is obviously a positive extension of $\Lambda$ to all continuous functions, and is linear. But then the Riesz representation theorem implies that there is a positive Radon measure such that $\Lambda = \Lambda_\mu$, completing the proof.

\begin{example}
    If $\mu$ is a complex-valued Radon measure, then we can define a distribution $\Lambda[\mu]$ such that for each $\phi \in \DD(\RR^d)$.
    %
    \[ \Lambda[\mu](\phi) = \int_{\RR^d} \phi(x) d\mu(x) \]
    %
    Thus $\Lambda[\mu]$ is a distribution, since if $\phi$ is supported on $K$, then
    %
    \[ |\Lambda[\mu](\phi)| \leq \mu(K) \| \phi \|_{L^\infty(K)}. \]
    %
    The fact that this bound does not require information about the derivatives of $\phi$ implies that $\Lambda[\mu]$ is a distribution of order zero. The Riesz-Markov-Kakutani representation theorem, shows that \emph{any} distribution of order zero is given by a complex-valued Radon measure.
\end{example}

\begin{example}
    Let $U \subset \RR^d$ be any open set such that $\partial U$ is a $C^1$ hypersurface. Then we can find a $C^1$ function $\rho: \RR^d \to \RR$ such that $U = \{ x : \rho(x) > 0 \}$, and $\nabla \rho$ is non-zero on $\partial U$. Let us calculate the derivatives of the distribution $u = \mathbf{I}_U$. Clearly $\nabla u$ is supported on the surface $S = \partial U$. Let us work locally around a point $x_0 \in S$, and without loss of generality, let us rotate so that in a neighborhood of $x_0$, if we write $x = (x',x_d)$, then $S$ is described by the equation $x_d = \psi(x')$, where $\psi$ is $C^1$. Pick $f \in C^\infty(\RR)$ such that $f(t) = 0$ for $t < 0$ and $f(t) = 1$ for $t \geq 1$. Then, locally around $x_0$, $u$ is the distributional limit of the functions $u_\varepsilon$, where
    %
    \[ u_\varepsilon(x) = f \left( \frac{x_d - \psi(x')}{\varepsilon} \right). \]
    %
    But
    %
    \[ \nabla u_\varepsilon(x) = \frac{f' \left( \frac{x_d - \psi(x')}{\varepsilon} \right)}{\varepsilon} \begin{pmatrix} 1 \\ - \nabla \psi(x') \end{pmatrix} \]
    %
    which implies that for any $\phi \in \DD(\RR^d)$ supported near $x_0$, using a change of variables,
    %
    \begin{align*}
        \int &\phi(x) \nabla u(x)\; dx\\
        &= \lim_{\varepsilon \to 0} \int \phi(x) \frac{f' \left( \frac{x_d - \psi(x')}{\varepsilon} \right)}{\varepsilon} \begin{pmatrix} 1 \\ - \nabla \psi(x') \end{pmatrix}\\
        &= \lim_{\varepsilon \to 0} \int \phi(x', \psi(x') + \varepsilon t) f'(t) \begin{pmatrix} 1 \\ - \nabla \psi(x') \end{pmatrix}\; dt\; dx'\\
        &= \int \phi(x', \psi(x')) \begin{pmatrix} 1 \\ -\nabla \psi(x') \end{pmatrix}\; dx.
    \end{align*}
    %
    Since the surface measure on $S$ is given by $dS = (1 + |\psi'|^2)^{1/2}\; dx'$, and the normal vector to the surface is given by
    %
    \[ n = \frac{1}{(1 + |\psi'(x)|^2)^{1/2}} \begin{pmatrix} 1 \\ - \nabla \psi(x) \end{pmatrix}, \]
    %
    it follows that
    %
    \[ \int \phi(x) \nabla u(x)\; dx = \int_S \phi(x) n(x)\; dS. \]
    %
    Switching to the global viewpoint, we thus see that $\nabla u = n \cdot dS$. In particular, we have proved that for any smooth, compactly supported vector field $X = (X_1,\dots,X_n)$ on $\RR^d$,
    %
    \[ \int_S (\nabla \cdot X) = \sum \int u(x) \partial_i X_i(x)\; dx = - \int_S X \cdot n\; dS, \]
    %
    so we see we have essentially proved the Gauss-Green divergence theorem. The fact that $n \cdot dS$ is a distribution of order zero now implies that the Gauss-Green formula continues to hold for any $C^1$ compactly supported vector field.

    Looking forward to other topics, perhaps the most general setting in which the distributional derivative calculation continues to hold for any domain $U$ which is a \emph{Caccioppoli set}, i.e. such that $u = \mathbf{I}_U$ is a function with bounded variation. We can then define a Radon measure analogous to $n \cdot dS$ such that an analogue of the integration formulas continue to hold. In particular, we can still use the calculation for open sets with Lipschitz boundary, in which case the normal vector is only defined almost everywhere on the boundary.    
\end{example}

\begin{example}
    Consider a functional $\Lambda$ defined for functions $\phi \in \DD(\RR)$ vanishing in a neighbourhood of the origin by setting
    %
    \[ \Lambda(\phi) = \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx. \]
    %
    Such functions are \emph{not} dense in $\DD(\RR)$. But we claim $\Lambda$ is bounded on it's domain, and thus by the Hahn-Banach theorem, extends to at least one continuous functional on the entirety of $\DD(\RR)$. To prove this, fix $\phi \in C_c^\infty[-N,N]$ vanishing on a neighbourhood $(-\varepsilon,\varepsilon)$ of the origin. Then
    %
    \[ |\Lambda \phi| = \left| \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx \right| = \left| \int_{\varepsilon \leq |x| \leq N} \frac{\phi(x) - \phi(0)}{x}\; dx \right|. \]
    %
    Applying the mean-value theorem, we find
    %
    \[ |\Lambda \phi| \leq N \| \phi \|_{C^1[-N,N]}. \]
    %
    Since $N$ was arbitrary, it follows that $\Lambda$ is continuous in the topology induced by that of $\DD(\RR)$, and thus by the Hahn-Banach theorem, extends uniquely to at least one distribution on the entirety of $\DD(\RR)$.

    One canonical choice of $\Lambda$ is the \emph{principal value distribution} $\text{p.v}(1/x)$, defined such that
    %
    \[ \int_{-\infty}^\infty \text{p.v}(1/x) \phi(x)\; dx = \lim_{\delta \to 0} \int_{|x| \geq \delta} \phi(x) / x\; dx. \]
    %
    We essentially showed that this functional was continuous above. Another choice is the distribution $\lim_{\varepsilon \to 0} (x + i \varepsilon)^{-1}$, defined such that
    %
    \[ \int_{-\infty}^\infty \lim_{\varepsilon \to 0} \frac{1}{x + i \varepsilon} \cdot \phi(x)\; dx = \lim_{\varepsilon \to 0} \int_{-\infty}^\infty \frac{\phi(x)}{x + i \varepsilon}\; dx. \]
    %
    If we pick $\delta = \varepsilon^{1/4}$, then we can show using the fact that $1/x$ and $1/(x + i \varepsilon)$ are not too different for large $x$ that
    %
    \begin{align*}
        \left| \int_{|x| \geq \delta} \frac{\phi(x)}{x} - \int_{-\infty}^\infty \frac{\phi(x)}{x + i\varepsilon} \right| \leq \| \phi \|_1 \cdot \varepsilon^{1/2}.
    \end{align*}
    %
    A contour integral shift shows that
    %
    \begin{align*}
        \int_{-\delta}^\delta \frac{\phi(x)}{x + i\varepsilon} &= \int_{-\delta}^\delta \frac{\phi(0)}{x + i \varepsilon} + O(\delta)\\
        &= -i \pi \phi(0) + O(\varepsilon / \delta) + O(\delta)\\
        &= -i \pi \phi(0) + O(\varepsilon^{1/4}).
    \end{align*}
    %
    Taking $\varepsilon \to 0$ shows that
    %
    \[ \text{p.v}(1/x) = i \pi \delta + \lim_{\varepsilon \to 0} \frac{1}{x + i \varepsilon}, \]
    %
    where $\delta$ is the Dirac delta distribution at the origin.

    More generally, if $\Lambda_1$ and $\Lambda_2$ are two distributions which extend the functional $\Lambda$, then one can show that for any function $\phi$ vanishing away from the origin, $\Lambda_1(\phi) - \Lambda_2(\phi) = 0$. We will later define the \emph{support} of a distribution, and so we have shown here that $\Lambda_1 - \Lambda_2$ is supported at $\{ 0 \}$. It follows from later theorems in this chapter than $\Lambda_1$ and $\Lambda_2$, applied to a function $\phi \in \DD(\RR)$, will differ by a finite linear combination of the values of $\phi$ and it's derivatives at the origin.

    The distribution $\text{p.v}(1/x)$ can also be described as the distributional derivative of the locally integrable function $\log |x|$, since an integration by parts shows that for each $\phi \in \DD(\RR^d)$,
    %
    \begin{align*}
        \int (\log |x|)'\; \phi(x)\; dx &= - \int \log |x| \phi'(x)\; dx\\
        &= \lim_{\varepsilon \to 0} \int_{|x| \geq \varepsilon} \log |x| \phi'(x)\\
        &= \lim_{\varepsilon \to 0} \left( \log(\varepsilon) \cdot \left( \phi(x) - \phi(-x) \right) + \int_{|x| \geq \varepsilon} \frac{\phi(x)}{x} \right)\\
        &= \text{p.v} \int \frac{\phi(x)}{x}\; dx.
    \end{align*}
    %
    An important analysis of these distributions arises in the theory of the Hilbert transform.
\end{example}

\begin{example}
    If $\Omega$ is an open subset of $\CC$, let us calculate $\partial E_{z_0} / \partial \overline{z}$ in $\Omega$, where $E_{z_0} = \text{p.v} \{ (z - z_0)^{-1} \}$. To begin with, we note that if $X$ is another open subset of $\CC$ containing $\Omega$, and if $\partial \Omega$ (the boundary of $\Omega$ \emph{relative to $X$}) is $C^1$, then for $\phi \in \DD(X)^*$, Green's formula gives
    %
    \[ \int_\Omega \frac{\partial \phi}{\partial \overline{z}} = (-i/2) \int_{\partial \Omega} \phi\; dz. \]
    %
    This formula implies the product rule, that for $\phi \in \DD(\Omega)^*$,
    %
    \begin{align*}
        \int_{\Omega - B_\varepsilon(z_0)} \frac{1}{z - z_0} \frac{\partial \phi}{\partial \overline{z}} &= \int_{\Omega - B_\varepsilon(z_0)} \frac{\partial}{\partial \overline{z}} \left\{ \frac{1}{z - z_0} \phi \right\}\\
        &= (i/2) \int_{\partial B_\varepsilon(z_0)} \frac{1}{z - z_0} \phi\; dz.
    \end{align*}
    %
    Letting $\varepsilon \to 0$ gives $\int E_{z_0} \partial_{\overline{z}} \phi = - \pi \phi(z_0)$, or in other words, we conclude that in $\Omega$, $\partial_{\overline{z}} E_{z_0} = \pi \delta_{z_0}$.
\end{example}

\begin{example}
    One reason we could define a distribution agreeing with $1/x$ away from the origin is because there is a lot of cancellation at the origin from either side of the origin, since $1/x$ switches sign here. One has to rely on other tricks to make sense of a distribution extending $1/x^2$. Indeed, if we write
    %
    \[ \Lambda(\phi) = \int \frac{\phi(x)}{x^2} \]
    %
    for $\phi$ ranging over all functions vanishing in the neighborhood of the origin, then we can use the mean value theorem to obtain a bound $|\phi(x)| \leq x^2 \| \phi'' \|_\infty$, from which it follows that
    %
    \[ \Lambda(\phi) \lesssim \| \phi'' \|_\infty, \]
    %
    and so Hahn-Banach extends $\Lambda$ to a family of distributions. But in this case the principal value
    %
    \[ \lim_{\delta \to 0} \int_{|x| \geq \delta} \frac{\phi(x)}{x^2} \]
    %
    rarely exists. Indeed, for any fixed $\phi \in \DD(\RR)$ we have
    %
    \[ \int_{|x| \geq \delta} \frac{\phi(x)}{x^2} = \frac{2 \phi(0)}{\delta} + O(\delta). \]
    %
    which will only converge if $\phi(0) = 0$. Thus, to get around this, we define the \emph{finite part distribution} (or \emph{Hadamard regularization}) of $1/x^2$, i.e. the distribution $\text{f.p}(1/x^2)$ obtained by setting
    %
    \[ \int \text{f.p}(1/x^2)\; \phi(x)\; dx = \lim_{\delta \to 0} \left( \int_{|x| \geq \delta} \phi(x)/x^2 - \frac{2 \phi(0)}{\delta} \right), \]
    %
    which gets around the result that the distribution might explode near the origin if $\phi(0) \neq 0$. Note that we do not need to account for $\phi'(0)$ because of cancellation on both sides of the integral.

    Another approach to extending $\Lambda$ is to consider the derivative of the distribution $- \text{p.v}(1/x)$, since the derivative of this distribution agrees with integration against $1/x^2$ away from the origin. In fact, the derivative of $- \text{p.v}(1/x)$ is precisely $\text{f.p}(1/x^2)$. We leave it to the reader to use similar tricks to define the finite parts of higher order singularities, such as $1/x^3$.
\end{example}

\begin{example}
    Let $f$ be a left continuous function on the real line with bounded variation and with $f(-\infty) = 0$. Then $f'$ exists almost everywhere in the classical sense, and $f' \in L^1(\RR)$. By Fubini's theorem, if we let $\mu$ be the measure defined by $\mu([a,b)) = f(b) - f(a)$, then for any $\phi \in \DD(\RR)$,
    %
    \begin{align*}
        \int_{-\infty}^\infty \phi(x) d\mu(x) &= - \int_{-\infty}^\infty \int_x^\infty \phi'(y)\; dy\; d\mu(x)\\
        &= - \int_{-\infty}^\infty \phi'(y) \int_{-\infty}^y d\mu(x)\; dy\\
        &= - \int_{-\infty}^\infty \phi'(y) f(y) dy
    \end{align*}
    %
    Thus if $\Lambda$ is the distribution corresponding to integration with respect to $f(x)\; dx$, then $\Lambda'$ is given by integration with respect to $\mu$. In particular, $\Lambda'$ is given by integration with respect to $f'(x)\; dx$ precisely when $f$ is absolutely continuous.
\end{example}

\begin{example}
    If $f \in C^1(\RR - \{ 0 \})$, and if the function $v(x)$ defined to be $f'(x)$ for $x \neq 0$ is integrable, then the limits $f(0-)$ and $f(0+)$ both exist (a simple argument using the fundamental theorem of calculus), and the distributional derivative of $f$ is equal to
    %
    \[ f' = v + (f(0+) - f(0-)) \delta_0. \]
    %
    To see this, we calculate that for $\phi \in \DD(\RR)$,
    %
    \begin{align*}
        \int f'(x) \phi(x)\; dx &= -\int f(x) \phi'(x)\; dx\\
        &= \lim_{\varepsilon \to 0} - \int_{-\infty}^{-\varepsilon} f(x) \phi'(x)\; dx - \int_\varepsilon^\infty f(x) \phi'(x)\; dx\\
        &= \lim_{\varepsilon \to 0} f(\varepsilon) \phi(\varepsilon) - f(-\varepsilon) \phi(-\varepsilon) + \int_{-\infty}^{-\varepsilon} v(x) \phi(x)\; dx + \int_{-\infty}^{-\varepsilon} v(x) \phi(x)\; dx\\
        &= \int v(x) \phi(x)\; dx + [f(0+) - f(0-)] \phi(0).
    \end{align*}
    %
    As a particular example of this, the distributional derivative of $|x|$ is $\text{sgn}(x)$, and the distributional derivative of the Heaviside step function $H$ given above is evaluated to be $\delta_0$.
\end{example}

\begin{example}
    The boundary values of analytic functions are distributions, in the following manner. Let $\Omega \subset \RR^n$ be an open set, and let $\Gamma$ be a convex open cone in $\RR^n$. For $\gamma > 0$, let
    %
    \[ Z_\gamma = \{ z \in \CC^n: \text{Re}(z) \in \Omega, \text{Im}(z) \in \Gamma, |\text{Im}(z)| < \gamma \}. \]
    %
    If $f$ is analytic in $Z_\gamma$, and there is some $N > 0$ such that $|f(x + iy)| \lesssim |y|^{-N}$. We claim then that, if for each $y \in \Gamma$, we consider the analytic function $f_y(x) = f(x + iy)$, then as $y \to 0$, $\{ f_y \}$ converges distributionally to a distribution of order at most $N+1$ on $\Omega$. In fact, we will obtain an explicit formula for this distribution. For simplicity we deal with the case $n = 1$, where the higher dimensional case is similar (see H\"{o}rmander Theorem 3.1.15). Then we might as well assume that $Z_\gamma = \{ x + i y : x \in \Omega, 0 < y < \gamma \}$. Given $\phi \in C_c^{N+1}(\Omega)$, write
    %
    \[ \phi_y(x) = \phi(x + i y) = \sum_{\alpha = 0}^N \partial^\alpha_x \phi(x) \frac{(i y)^\alpha}{\alpha!}. \]
    %
    Then
    %
    \[ 2 \frac{\partial \phi}{\partial \overline{z}} = \partial^{N+1} \phi(x) \frac{(iy)^N}{N!}. \]
    %
    Thus if $0 < y_0 < \gamma$ is fixed, and if $0 < y < \gamma - y_0$, then the Cauchy integral formula implies that
    %
    \[ \int \phi(x) f(x + iy)\; dx - \int \phi(x + iy) f(x + iy + iy_0)\; dx = 2i \int \int_0^{y_0} f(x + iy + it) \frac{\partial \phi}{\partial \overline{z}} dt\; dx. \]
    %
    Thus
    %
    \[ \int \phi(x) f_y(x)\; dx = \int \phi_{y_0}(x) f_{y + y_0}(x)\; dx + \int \int_0^1 f_{y + ty_0}(x) \partial^{N+1} \phi(x) \frac{(i y_0)^{N+1} t^N}{N!}\; dt\; dx. \]
    %
    Thus we conclude that as $y \to 0$,
    %
    \[ \int \phi(x) f_y(x)\; dx \to \int \phi_{y_0}(x) f_{y_0}(x)\; dx + \frac{1}{N!} \int \int_0^1 f_{ty_0}(x) \partial^{N+1} \phi(x) (i y_0)^{N+1} t^N\; dt\; dx. \]
    %
    The right hand side clearly defines a distribution of order $N+1$. In higher dimensions, we obtain the similar representation formula
    %
    \[ \int \phi(x) f_y(x)\; dx \to \int \phi_{y_0}(x) f_{y_0}(x)\; dx + \frac{1}{N!} \int \int_0^1 f_{ty_0}(x) \sum_{|\alpha| = N+1} \partial^\alpha \phi(x) (iy_0)^\alpha t^N\; dt\; dx. \]
    %
    Thus we have a theory of boundary values of analytic functions.

    For $n = 1$, we denote the distribution obtained by $f(x + i 0)$. If we, by a similar process, obtained a distribution as a limit of an analytic function defined on the lower half plane, then we would denote that distribution by $f(x - i0)$. If $f$ is analytic above and below the half plane, and satisfies estimates of the form above, then the distribution $u$ given by
    %
    \[ \int \left( u(x + i y) \phi(x,y)\; dx \right)\; dy \]
    %
    (\emph{the order of integration matters}) defines a distribution of order $N$ in the complex plane, the derivative $\partial u / \partial \overline{z}$ is supported on the real line, and on that real line, we have
    %
    \[ \frac{\partial u}{\partial \overline{z}}(x) = (i/2) \left( f(x + i0) - f(x - i0) \right). \]
    %
    We can use this, for instance, to calculate the difference beteween the two distributions $(x + i0)^{-1}$ and $(x - i0)^{-1}$. We have calculated above that the distribution $u(z) = 1/z$ has
    %
    \[ \frac{\partial u}{\partial \overline{z}} = \pi \delta, \]
    %
    and so $(x - i0)^{-1} = (x + i0)^{-1} + 2 \pi i \delta$.
\end{example}

\begin{remark}
    Roughly speaking, this result is tight. If an analytic function $f$ has boundary values defining a distribution of order $N+1$, then it is \emph{necessary} that
    %
    \[ |f(z)| \lesssim |\text{Im}(z)|^{-N-2}. \]
    %
    See Theorem 3.1.11 of H\"{o}rmander, Volume 1, for a discussion of this.
\end{remark}

There are many other important operations one can apply to distributions. If $\Omega$ is a conic subset of $\RR^d$, and $\phi,\psi \in \DD(\Omega)$, we find
%
\[ \int_{\Omega} \text{Dil}_\lambda \phi(x) \psi(x)\; dx = \lambda^{-d} \int_{\Omega} \phi(x) \cdot \text{Dil}_{1/\lambda} \psi(x)\; dx, \]
%
Thus if $\Lambda$ is a distribution on $\Omega$, then we define $\text{Dil}_\lambda \Lambda$ by setting
%
\[ \text{Dil}_\lambda \Lambda (\phi) = \lambda^{-d} \Lambda( \text{Dil}_{1/\lambda} \phi). \]
%
For $f \in C^\infty(\Omega)$, we have an operator $\phi \mapsto f \phi$ on $\DD(\Omega)$. The adjoint is clearly $\psi \mapsto f \psi$, so for a distribution $\Lambda$ on $\Omega$, we define $f \Lambda$ by setting $(f\Lambda)(\phi) = \Lambda(f \phi)$. Thus $\DD^*(\Omega)$ is naturally a $C^\infty(\Omega)$ module. Similarily, the family $\DD^*(\Omega)_k$ consisting of distributions of order $k$ form a $C^k(\Omega)$ module.

\begin{remark}
    H\"{o}rmander developed a sophisticated theory that enables us to define the product of two \emph{distributions},  using an appropriately localized Fourier transform. In many basic situations, one can perform a spatial decomposition to define the product. Given a distribution $\Lambda$, we define it's \emph{singular support} $\text{supp}_{\text{sing}}(\Lambda)$ to be the \emph{complement} of the set of all points $x$ which have a neighborhood $U$ such that $\Lambda|_U \in C^\infty(U)$. For any two distributions $\Lambda$ and $\Psi$ whose singular supports are disjoint, a decomposition argument enables us to define the product $\Lambda \cdot \Psi$ in a natural way.
\end{remark}

\section{Topologies on the Space of Distributions}

As a dual space to an LF space, we can equip the space of distributions $\DD(\Omega)^*$ with several topologies. The most important for our purposes in the strong topology, which makes $\DD(\Omega)^*$ into a complete locally convex space, and the weak $*$ topology, which is quasi-complete. These topologies are roughly the same for many purposes. For instance, the uniform boundedness theorem implies that a sequence $\{ u_n \}$ of distributions converges in the weak $*$ topology if and only if it converges in the strong dual topology, and we call this convergence \emph{distributional convergence}. We note also that $\DD(\Omega)^*$, as the strong dual of a Montel space, is also a Montel space, i.e. it is locally convex, barelled, and satisfies the Heine-Borel property.

\begin{example}
    If $u \in \DD(\RR^d)$, and we set $u_\varepsilon(x) = \varepsilon^{-d} \text{Dil}_\varepsilon u(x)$, then for any $\phi \in \DD(\RR^d)$,
    %
    \[ \lim_{\varepsilon \to 0} \int u_\varepsilon(x) \phi(x)\; dx \to \phi(0) \int u(x)\; dx. \]
    %
    Thus $u_\varepsilon$ converges distributionally to $(\int u(x)\; dx) \cdot \delta_0$. Similarily, if $u \in \DD(\RR^d)$ and for any multi-index $\alpha$ with $|\alpha| \leq k$,
    %
    \[ \int u(x) x^\alpha\; dx = 0, \]
    %
    and we define $u_\varepsilon(x) = \varepsilon^{-d-k} \text{Dil}_\varepsilon u(x)$, then for any $\phi \in \DD(\RR^d)$,
    %
    \[ \lim_{\varepsilon \to 0} u_\varepsilon(x) \phi(x)\; dx \to \frac{1}{k!} \sum_{|\alpha| = k} \left( \int x^\alpha u(x)\; dx \right) \cdot D^\alpha \phi(0) \]
    %
    Thus $u_\varepsilon$ converges distributionally to an appropriate linear combination of $D^\alpha \delta_0$.
\end{example}

\begin{example}
    The distribution $\lim_{\varepsilon \to 0} 1/(x + i\varepsilon)$ defined above is precisely the limit of the distributions $1/(x + i \varepsilon)$ in the weak $*$ topology. Similarily, $\text{p.v}(1/x)$ is the weak $*$ limit of the functions $\mathbf{I}_{|x| \geq \delta}(x) \cdot (1/x)$. The distribution $\text{f.p}(1/x^2)$ is the distributional limit of $\mathbf{I}_{|x| \geq \delta}(x) \cdot (1/x^2) - 2 \delta_0 / \delta$, where $\delta_0$ is the Dirac delta function at the origin.
\end{example}

\begin{example}
    If $n$ is a positive integer, then integration by parts shows that for any $\phi \in \DD(\RR)$,
    %
    \[ \int_{-\infty}^\infty t^n e^{2 \pi itx} \phi(x)\; dx = i^{n+1} t^{-1} \int_{-\infty}^\infty e^{itx} \phi^{(n+1)}(x)\; dx, \]
    %
    which converges to zero as $t \to \infty$. Thus $t^n e^{2 \pi itx}$ converges distributionally to zero as $t \to \infty$. Another way to see this is to note that the distribution $\Lambda_t$ given by integration against $t^n e^{itx}$ can be written as $\Lambda_t(\phi) = t^n \widehat{\phi}(-t)$, and the Fourier transform of $\phi$ decays rapidly. Note that if we tested against functions that were less smooth (say, viewing these distributions as linear functionals on $L^1(\RR^d)$, or even $C^\infty$ functions that are only of polynomial decrease as they approach $\infty$) then this statement would no longer be true.
\end{example}

\begin{example}
    Let $u_t(x) = t^{1/k} e^{itx^k}$, where $k$ is an integer bigger than one. Let
    %
    \[ F(x) = \int_0^x e^{iy^k}\; dy. \]
    %
    When $x > 0$, a contour integration shift shows that
    %
    \[ F(x) = e^{i \pi / 2k} \int_0^x e^{-y^k}\; dy + O(|x|^{-(k-1)}). \]
    %
    If $k$ is even, then for $x < 0$,
    %
    \[ F(x) = - e^{i \pi / 2k} \int_0^x e^{-y^k}\; dy + O(|x|^{-(k-1)}) \]
    %
    and for $k$ odd,
    %
    \[ F(x) = - e^{-i \pi / 2k} \int_0^x e^{-y^k}\; dy + O(|x|^{-(k-1)}). \]
    %
    Thus given $\phi \in \DD(\RR)$, we can apply an integration by parts to write
    %
    \begin{align*}
        \int_{-\infty}^\infty u_t(x) \phi(x)\; dx &= \int_{-\infty}^\infty t^{1/k} e^{itx^k} \phi(x)\; dx \\
        &= \int_{-\infty}^\infty t^{1/k} F'(t^{1/k} x) \phi(x)\; dx\\
        &= - \int_{-\infty}^\infty F(t^{1/k} x) \phi'(x)\; dx,
     \end{align*}
     %
     By decomposing this integral into the region where $|x| \geq t^{1/k}$ and $|x| \leq t^{1/k}$ shows that this quantity converges to
     %
     \[ - F(\infty) \int_0^\infty \phi'(x)\; dx - F(-\infty) \int_{-\infty}^0 \phi'(x)\; dx = (F(\infty) - F(-\infty)) \phi(0). \]
     %
     Thus $u_t$ converges distributionally to $\left( 2 e^{i \pi / 2k} \int_0^\infty e^{-y^k}\; dy \right) \cdot \delta_0$ if $k$ is even, and to $\left( 2 \cos(\pi / 2k) \int_0^\infty e^{-y^k}\; dy \right) \cdot \delta_0$ if $k$ is odd.
\end{example}

It is often of interest to focus on subfamilies of $\DD(\Omega)^*$, equipped with a topology which is compatible with the behaviour of distributions. We thus define a \emph{space of distributions} to be a vector subspace $X$ of $\DD(\Omega)^*$, equipped with a topology which makes the inclusion map $X \to \DD(\Omega)^*_b$ continuous. Most function spaces are spaces of distributions, for instance, $\DD(\Omega)$, $\loc{L^1}$, and so on. We will later encounter the space of \emph{tempered distributions} $\mathcal{S}(\Omega)^*$, which will turn out to be a subspace of $\DD(\Omega)^*$ equipped with the relative topology. We can then speak of `distributional convergence' in these spaces, i.e. convergence in the strong dual.

Since convergence in $\DD(\Omega)$ is incredibly strict, a sequence of distributions can very easily converge distributinoally. It is therefore surprising that, since a differential operator $L: \DD(\Omega) \to \DD(\Omega)$ is continuous, it's extension to a map $L: \DD(\Omega)^* \to \DD(\Omega)^*$, roughly speaking, a rescaling of it's adjoint, is also continuous, both in the weak $*$ topologies and in the strong topology.

With either the weak $*$ topology or the strong topologies described above, the bilinear multiplication map
%
\[ \loc{C^\infty}(\Omega) \times \DD(\Omega)^* \to \DD(\Omega)^* \]
%
is sequentially continuous, but \emph{not} jointly continuous.

%There is also an often useful result resulting from bounded countable families of distributions.

%\begin{theorem}
%    Suppose $\mathcal{U} \subset \DD^*(\Omega)$ is a family of distributions such that for each $\phi \in \DD(\Omega)$, $\sup_{u \in \mathcal{U}} |u(\phi)| < \infty$. Then for every compact set $K$, there exists $m$ such that for an $u \in \mathcal{U}$ and $\phi \in C_c^\infty(K)$,
    %
%    \[ |u(\phi)| \lesssim \| \phi \|_{C^m(K)}. \]
    %
%    If $\{ u_n \}$ is a sequence of distributions for which $\lim_n u_n(\phi)$ exists for every $\phi \in \DD(\Omega)$, then $u(\phi) = \lim_n u_n(\phi)$ defines a distribution, and for every compact set $K$ there is an integer $m$ such that for each $\phi \in C_c^\infty(K)$,
    %
%    \[ |u_n(\phi)| \lesssim \| \phi \|_{C^m(K)} \]
    %
%    and
    %
%    \[ \lim_{n \to \infty} \sup_{\phi \in C_c^\infty(K)} \frac{|u(\phi) - u_n(\phi)|}{\| \phi \|_{C^m(K)}} = 0. \]
%\end{theorem}
%\begin{proof}
%    Each distribution in $\mathcal{U}$ acts as a continuous operator on the Frech\'{e}t space $C_c^\infty(K)$, and this family satisfies the uniform boundedness principle, and the existence of an $n$ as above follows as a result of the uniform boundedness principle, i.e. it shows that restricted to $K$, the distributions in $\mathcal{U}$ are equicontinuous.

%    Now assume the second condition. This clearly implies the first, hence we get the uniform boundedness property above. Now a ball of finite radius in $C^{m+1}(K)$ is precompact in $C^m(K)$, by the Arzela-Ascoli theorem. Thus we can find $\phi_1,\dots,\phi_N \in C_c^\infty(K)$ such that if $\phi \in C_c^\infty(K)$ and $\| \phi \|_{C^{n+1}(K)} \leq 2$, then there exists $i$ such that $\| \phi - \phi_i \|_{C^n(K)} \leq \varepsilon$. Pick $n_0$ such that for any $n \geq n_0$ and $1 \leq i \leq N$, $|(u - u_n)(\phi_i)| \leq \varepsilon$. Then given any $\phi \in C_c^\infty(K)$ with $\| \phi \|_{C^{n+1}(K)} \leq 1$, we can find $i$ as above, and then
    %
%    \begin{align*}
%        |(u - u_n)(\phi)| &\leq |(u - u_n)(\phi - \phi_i)| + |(u - u_n)(\phi_i)|\\
%        &\lesssim \| \phi - \phi_i \|_{C^n(K)} + \varepsilon\\
%        &\lesssim \varepsilon.
%    \end{align*}
    %
%    Thus we have proven the required limiting statement.
%\end{proof}

\section{Homogeneous Distributions}

An important family of distributions are the \emph{homogenous distributions}. Given any open \emph{conic} subset $\Omega$ of $\RR^d$, i.e. a set such that $\lambda \Omega \subset \Omega$ for any $t > 0$, we can define a distribution $\text{Dil}_t u$ on $\Omega$ for each distribution $u$ on $\Omega$. A distribution $u$ on $\Omega$ is \emph{homogeneous} of order $\alpha$ if for any $t > 0$, $\text{Dil}_t u = t^{-\alpha} u$.

\begin{example}
    If $f \in L_{1,\text{loc}}(\Omega)$ and $f(\lambda x) = \lambda^\alpha f(x)$ for all $x \in \Omega$ and $\lambda > 0$, then integration against $f(x)\; dx$ defines a homogenous distribution of order $\alpha$ on $\Omega$.
\end{example}

\begin{example}
  Let $\delta$ be the Dirac-delta distribution at the origin in $\RR^d$. Then for $\phi \in \DD(\RR^d)$,
  %
  \begin{align*}
    \int_{\RR^d} (\text{Dil}_\lambda \delta)(x) \phi(x)\; dx = \lambda^{-d} \int_{\RR^d} \delta(x) \text{Dil}_{1/\lambda} \phi(x)\; dx = \lambda^{-d} \phi(0).
  \end{align*}
  %
  Thus $\text{Dil}_\lambda \delta = \lambda^{-d} \delta$, which implies $\delta$ is a homogenous distribution of order $-d$.
\end{example}

\begin{example}
    For any complex number $a \in \CC$, we define a function
    %
    \[ x^a_+ = \begin{cases} x^a: x > 0, \\ 0 &: x \leq 0. \end{cases} \]
    %
    This function is locally integrable on $\RR - \{ 0 \}$, and so defines a distribution on this set, with the following properties:
    %
    \begin{itemize}
        \item The map $a \mapsto x^a_+$ is a continuous map.

        \item The distribution $x^a_+$ is homogeneous of degree $a$.

        \item We have $(x^a_+)' = a x^{a-1}_+$, and $x \cdot x^a_+ = x^{a+1}_+$.
    \end{itemize}
    %
    By the Hahn-Banach theorem, these distributions all extend to distributions on $\RR^n$. It is of interest whether we can perform this extension so that the resulting distributions are \emph{homogeneous}, and that the prpoerties above continue to hold. It is clear that any two such extensions of the distributions $x^a_+$ differ by a linear combination of Dirac delta functions, and their derivatives, so, unless $a \in \{ -1, -2, \dots \}$ (since this is the homogeneity of the Dirac delta function and it's derivatives), this homogeneous extension will then be \emph{unique}.

    Firstly, if $\text{Re}(a) > -1$, then the distribution $x^a$ is locally integrable on $\RR$, and so it is easy to check that $x^a_+$ is well defined and homogeneous of order $a$ on $\RR$. For $\text{Re}(a) > 0$, it also remains true that
    %
    \[ (x^a_+)' = a x^{a-1}_+. \]
    %
    To continue this extension to a larger range of values $\text{Re}(a) \leq -1$, we rely on analytic continuation. For any $\phi \in \DD(\RR)$, the function
    %
    \[ a \mapsto \langle x^a_+, \phi \rangle \]
    %
    is analytic in the region $\text{Re}(a) - 1$. Integration by parts shows that in such a range, we have
    %
    \[ \langle x^{a+1}_+, \phi' \rangle = - (a+1) \langle x^a_+, \phi \rangle. \]
    %
    The formula $\langle x^a_+, \phi \rangle = - (a+1)^{-1} \langle x^{a+1}_+, \phi' \rangle$ allows us to extend the definition of $x^a_+$ to all $a \in \CC$ with $\text{Re}(a) > -2$, \emph{except} that we have a pole of order one when $a = -1$, which prevents us from defining the distribution at this value. Iterating this integration by parts trick allows us to analytically continuous the function $\langle x^a_+, \phi \rangle$ to all complex numbers $a$, except for the negative integers. Using this as a \emph{definition} of a distribution $x^a_+$, it is immediate to check that all of these distributions are homogeneous of order $a$, so we have found the unique homogeneous extension of $x^a_+$ required above. The formulas above all continue to hold, \emph{except} that the derivative formula does not hold for $a = 0$, since we have not defined the distributions $\{ x^{-k}_+ \}$.

    As we expected, the negative integers prove to be problematic. Marcel Riesz used some other complex-analytic tricks to define $x^{-k}_+$, but this is not without it's problems. For any $\phi \in \DD(\RR)$, the function $a \mapsto \langle x^a_+, \phi \rangle$ is meromorphic, with simple poles at each integer $-k$ for $k > 0$, and the residue at $-k$ is equal to
    %
    \[ (-1)^k \frac{D^{k-1} \phi(0)}{(k-1)!}. \]
    %
    Thus we conclude that, as $a \to -k$,
    %
    \[ \langle (a + k) x^a_+, \phi \rangle \to (-1)^{k-1} \frac{D^{k-1} \phi(0)}{(k-1)!}. \]
    %
    In fact, expanding things out gives a constant $C_{-k}(\phi)$ such that as $a \to -k$,
    %
    \[ \langle x^a_+, \phi \rangle = \frac{(-1)^{k-1} D^{k-1} \phi(0)}{(k-1)!} \cdot \frac{1}{a + k} + C_{-k}(\phi) + O(a+k). \]
    %
    We define $\langle x^{-k}_+, \phi \rangle = C_{-k}(\phi)$, i.e. by keeping only the \emph{finite part} of the integral. This gives an extension of the definition of $x^{-k}_+$ on $\DD(\RR - \{ 0 \})$, because the infinite part of the expansion above vanishes for functions supported away from the origin. For values $a$ close to $k$, we have
    %
    \begin{align*} \langle x^a_+, \phi \rangle &- \frac{(-1)^{k-1} D^{k-1} \phi(0)}{(k-1)!} \cdot (a+k)^{-1}\\
        &= (-1)^k (a+1)^{-1} \cdots (a+k-1)^{-1} \int_0^\infty \frac{x^{a + k} - 1}{a+k} D^k \phi(x)\; dx\\
        &\quad\quad + \frac{(-1)^{k-1}}{a+k} \left( (-1-a)^{-1} \dots (1-a-k) - \frac{1}{(k-1)!} \right) D^{k-1} \phi(0)\\
        &\to \frac{-1}{(k-1)!} \int_0^\infty \log(x) D^k \phi(x)\; dx + \frac{1}{(k-1)!} \left(\sum_{j = 1}^k 1/j \right) D^{k-1} \phi(0).
    \end{align*}
    %
    and thus
    %
    \[ \langle x^{-k}_+, \phi \rangle = \frac{-1}{(k-1)!} \int_0^\infty \log(x) D^k \phi(x)\; dx + \frac{1}{(k-1)!} \left(\sum_{j = 1}^k 1/j \right) D^{k-1} \phi(0). \]
    %
    This definition leads to a definition of $\{ x^a_+ \}$ for all $a \in \CC$. The algebraic formula
    %
    \[ x \cdot x^a_+ = x^{a+1}_+ \]
    %
    continues to hold in this range.

    Our extension of $x^a_+$ for all $a \in \CC$ continues to satisfy $x \cdot x^a_+ = x^{a+1}_+$ for all $a \in \CC$. The derivative formula is \emph{not} maintained when $k$ is an integer, however. Namely, we have
    %
    \[ D x^{-k}_+ = -k x^{-k-1}_+ + (-1)^k D^k \delta / k! \]
    %
    Moreover, $x^{-k}_+$ is no longer homogeneous of degree $-k$. Plugging into the formula shows that
    %
    \[ (tx)^{-k}_+ = t^{-k} x^{-k}_+ + \frac{\log t}{(k-1)!} \cdot D^{k-1} \delta. \]
    %
    One can analogously define the homogeneous distributions $x^a_-$, and $|x|^a$, by reflecting and symmetrizing the constructions we have given above.
%One can also define $x^a_+$ by first removing the singularity, considering the distributions
  %
% \[ \langle x^a_\varepsilon, \phi \rangle = \int_\varepsilon^\infty x^a \phi(x)\; dx. \]
  %
% If $k$ is the smallest non-negative integer such that $k + \text{Re}(a) > -1$, then we can integrate by parts to conclude that there are constants $C_k$ such that
  %
% \[ \langle x^a_\varepsilon, \phi \rangle = \sum_{i = 0}^{k-1} C_i \varepsilon^{-i} + (-1)^k \int_0^\infty \frac{1}{(a+1) \dots (a+k)} x^{a + k} D^k \phi(x)\; dx + o(1). \]
  %
% Discarding the singular terms, and letting $\varepsilon \to 0$ gives the distributions $x^a_+$ above.
\end{example}

\begin{example}
    Another way to fix the definition of the distributions $\{ x^{-k}_+ \}$ is by appropriately normalizing the distributions to remove the singularities here when we apply analytic continuation. Namely, set
    %
    \[ \chi^a_+ = \frac{x^a_+}{\Gamma(a+1)}. \]
    %
    Then $D(\chi^a_+) = - \chi^{a-1}_+$, and because the Gamma function has no zeroes, this allows us to extend the definition of $\{ \chi^a_+ \}$ to a family of homogeneous distributions of order $a$, for \emph{any} $a \in \CC$. Since $\chi^0_+$ is the Heaviside step function, we conclude that $\chi^{-1}_+ = - \delta$, and more generally, that $\chi_+^{-k} = (-1)^k D^{k-1} \delta$, which is somewhat undesirable.
\end{example}

Given any $a \in \CC$, and any distribution $v$ on $S^{n-1}$, we can define a homogeneous distribution $u$ of order $a$ on $\RR^n - \{ 0 \}$, such that for $\phi \in \DD(\RR^n - \{ 0 \})$,
%
\[ \langle u, \phi \rangle = \int_0^\infty r^{a+n-1} \int_{S^{n-1}} v(x) \phi(rx)\; d\sigma(x). \]
%
For a fixed $a$, this is actually a \emph{bijective correspondence}. Given any distribution $u \in \DD(\RR^n - \{ 0 \})^*$, which is homogeneous of degree $a$, there exists a \emph{unique} distribution $v$ on $S^{n-1}$ with this property. Indeed, if $\eta \in \DD((0,\infty))$ is supported on a neighborhood of $1$ and has
%
\[ \int_0^\infty \eta(x)\; dx = 1, \]
%
and if $v$ existed, then for $\psi \in \DD(S^{n-1})$, if for $r > 0$ and $|x| = 1$ we set $\phi(rx) = \psi(x) r^{1 - n - a} \eta(r)$, then we would have
%
\[ \langle v, \psi \rangle = \langle u, \phi \rangle. \]
%
One can check that, given any $u$, we can use this construction to define a distribution $v$ on $S^{n-1}$ that induces $u$. On the other hand, one can change the order of integration, i.e. we have
%
\[ \langle u, \phi \rangle = \int_{S^{n-1}} v(x) \int_0^\infty r^{a+n-1} \phi(rx)\; d\sigma(x). \]
%
In particular, this implies that for any $\phi \in \DD(\RR^n - \{ 0 \})$, such that
%
\[ \int_0^\infty r^{a + n - 1} \phi(rx)\; dr = 0 \]
%
for all $x \in \RR^d - \{ 0 \}$, we have $\langle u, \phi \rangle = 0$.

%When $n = 1$, this actually implies that $u$ is a multiple of $|x|^a$ on each coordinate axis. The identity also implies that for any $\psi \in \DD(\RR^n - \{ 0 \})$ with $\int_0^\infty r^{a + n-1} \psi(rx)\; dr = 0$ for all $x \neq 0$, $\langle u, \phi \rangle = 0$ by rewriting the formula in polar coordinates.

\begin{theorem}
    Let $u$ be a homogeneous distribution on $\RR^n - \{ 0 \}$ which has order $a \in \CC$, where $a$ is \emph{not} an integer less than or equal to $-n$. Then $u$ has a unique extension to a distribution $E(u)$ on $\RR^n$, such that for any homogeneous polynomial $P$,
    %
    \[ E(Pu) = P E(u), \]
    %
    and if $a \neq -(n-1)$, $E(\partial_i u) = \partial_i E(u)$. Moreover, the map $u \mapsto E(u)$ is continuous from $\DD(\RR^n - \{ 0 \})^*$ to $\DD(\RR^n)^*$.
\end{theorem}
\begin{proof}
    The uniqueness is obvious, because any distribution supported at the origin is a linear combination of derivatives of the Dirac delta function, which are all homogeneous of integer order $\leq -n$. To show existence, we apply the theory we discussed before the notes above. Any homogeneous distribution $u$ on $\RR^n - \{ 0 \}$ of order $a$ induces a homogeneous distribution $v$ on $S^{n-1}$ such that for $\phi \in \DD(\RR^n - \{ 0 \})$,
    %
    \[ \langle u, \phi \rangle = \int_{S^{n-1}} v(x) \int_0^\infty r^{a + n - 1} \phi(rx)\; d\sigma(x). \]
    %
    The challenge is to interpret the right hand side for $\phi \in \DD(\RR^n)$. A natural choice, given $\phi \in \DD(\RR^n)$, is to define $R_a \phi \in \DD(S^{n-1})$ by setting
    %
    \[ R_a \phi(x) = \int t^{a + n - 1}_+ \phi(tx)\; dt, \]
    %
    the right hand side being well defined whenever $a$ is not a negative integer less than or equal to $-n$. But we can now define
    %
    \[ \langle Eu, \phi \rangle = \int_{S^{n-1}} v(x) R_a \phi(x)\; dx. \]
    %
    This clearly gives an extension of $u$ to a distribution on $\RR^n$. To show that $Eu$ remains homogeneous of degree $a$, we have to show that
    %
    \[ \langle Eu, \text{Dil}_t \phi \rangle = t^{a + n} \langle Eu, \phi \rangle. \]
    %
    But we calculate that $R_a \{ \text{Dil}_t \phi \} = t^{a + n} R_a \phi$, which gives the required result. Continuity follows from the continuity of the map $u \mapsto v$ and the map $\phi \mapsto R_a \phi$.
\end{proof}

When $a$ is an integer smaller than or equal to $-n$, one can still use the construction performed above to define an operator $E$ from homogeneous distributions on $\RR^n - \{ 0 \}$ to distributions on $\RR^n$. \emph{However}, the resulting distribution can fail to be homogeneous, and may fail to satisfy the identities $E(Pu) = PE(u)$ and $E(\partial_i u) = \partial_i E(u)$. Fortunately, we do see that an extension exists, and the extension \emph{will} be unique, up to a linear combination of Dirac delta functions.

There is a special family of homogeneous distributions that often occurs in harmonic analysis, that being the homogeneous distributions of order $a$ on $\RR^n$ that are $C^\infty$ away from the origin, i.e. distributions $u$ that agree with the action of a $C^\infty$ function $u_0$ as a distribution tested against elements of $\DD(\RR^n - \{ 0 \})$. Of course, $u_0$ must be a homogeneous function of order $a$. If $\text{Re}(a) > -n$, then this implies in fact that $u_0$ is \emph{locally integrable}, and that, in fact, for any $\phi \in \DD(\RR^n)$,
%
\[ \langle u, \phi \rangle = \int u_0(x) \phi(x)\; dx. \]
%
On the other hand, if $\text{Re}(a) \leq -n$, there may be more funny business at the origin. Nonetheless, the borderline case when $\text{Re}(a) = -n$ is of interest. In this case, if
%
\[ \int_{|x| = 1} u_0(x)\; d\sigma(x) = 0, \]
%
then we can define a principal value distribution $\text{p.v}(u_0)$ by setting
%
\[ \langle \text{p.v}(u_0), \phi \rangle = \lim_{\varepsilon \to 0} \int_{|x| \geq \varepsilon} u_0(x) \phi(x)\; dx. \]
%
The limit converging. If we consider a radial $\psi \in \SW(\RR^d)$, we can also write the distribution so
%
\[ \langle \text{p.v}(u_0), \phi \rangle = \int u_0(x) \left( \phi(x) - \phi(0)\psi(x) \right)\; dx, \]
%
since then the integrand is an element of $L^1$ by virtue of the rapid decay of the function inside the brackets, and that this same function is $O(|x|)$ as $x \to 0$. The integral also does not depend on the choice of $\psi$ since, given any two choices $\psi_1$ and $\psi_2$, we have
%
\[ \int u_0(x) ( \psi_1(x) - \psi_2(x) )\; dx = 0, \]
%
because $u_0$ has cancellation properties on circles about the origin. Clearly $u - \text{p.v}(u_0)$ is a distribution supported at the origin, and thus there exists some constant $c$ such that
%
\[ u = c \delta + \text{p.v}(u_0). \]
%
More generally, if we have
%
\[ c = \fint_{|x| = 1} u_0(x)\; d\sigma(x), \]
%
then one need only define the distribution $E_\psi r^{-n}$ by setting
%
\[ \langle E_\psi r^{-n}, \phi \rangle = \int |x|^{-n} \left( \phi(x) - \phi(0) \psi(x) \right). \]
%
Unlike in the principal value case, this assumption \emph{depends} on $\psi$, i.e. we have
%
\[ E_{\psi_1} r^{-n} - E_{\psi_2} r^{-n} = \left[ \int |x|^{-n} ( \psi_1(x) - \psi_2(x) )\; dx \right] \delta. \]
%
Moreover, $E_\psi r^{-n}$ is not homogeneous, since one can verify via a calculation that
%
\[ \text{Dil}_t ( E_\psi r^{-n} ) = t^n E_\psi r^{-n} + \left( A_{n-1} t^n \log t \right) \delta, \]
%
where $A_{n-1}$ is the surface area of $S^{n-1}$. In particular, we see from this computation that if $u$ is a homogeneous distribution of degree $n$ \emph{on $\RR^n$} (rather than just on $\RR^n - \{ 0 \}$), then we \emph{must} have
%
\[ \int_{|x| = 1} u(x)\; dx = 0, \]
%
since otherwise $u$ would not be homogeneous.

The study of homogeneous functions of order $a$ when $a$ is an integer less than or equal to $-n$ is often, unfortunately, necessary. A common example occurs when constructing fundamental solutions to the Laplace operator $\Delta$ in $\RR^2$, i.e. tempered distributions $u$ on $\RR^2$ solving the equation $\Delta u = \delta$. Taking Fourier transforms yields that $-4 \pi^2 |\xi|^2 \widehat{u} = 1$. We are thus lead to conclude that, away from the origin, the tempered distribution $\widehat{u}$ agrees with the homogeneous function $-1 / 4 \pi^2 |\xi|^2$. We have
%
\[ \int_{|\xi| = 1} \frac{-1}{4 \pi^2 |\xi|^2}\; d\xi = \frac{-1}{2 \pi}. \]
%
Thus if we let $\psi(x) = e^{- \pi |x|^2}$, then the distribution $\widehat{u}$ agrees with the distribution $(-1 / 4\pi^2) (E_\psi r^{-2})$ away from the origin. Thus we can write
%
\[ \widehat{u} = c \delta - \frac{1}{4 \pi^2} \left( E_\psi r^{-2} \right). \]
%
To determine $u$, we need to take the inverse Fourier transform of $E_\psi r^{-2}$. But this is not too difficult, because $E_\psi r^{-2}$ is a radial distribution, so it's inverse Fourier transform is also radial. Moreover, we have the dilation formula
%
\[ \text{Dil}_t \left( E_\psi r^{-2} \right) = t^2 \left[ \left( E_\psi r^{-2} \right) + + 2 \pi \log t \delta \right]. \]
%
Thus if $v$ is the inverse Fourier transform of $E_\psi r^{-2}$, then taking Fourier transforms of both sides yields that
%
\[ v(tx) = v(x) + 2 \pi \log t. \]
%
Since $v$ is radial, away from the origin we see that $v(x) = a + 2 \pi \log |x|$, and this function is locally integrable, so we conclude that
%
\[ u(x) = a + 2 \pi \log |x|. \]
%
The fact we were dealing with a homogeneous partial differential equation of degree two on $\RR^2$ lead us to construct non-homogeneous fundamental solutions. For $n > 2$, the fundamental solution is a homogeneous function of degree $2-n$.

\section{Localization of Distribuitions}

Just as we can consider the local behaviour of functions around a point, we can consider the local behaviour of a distribution around points, and this local behaviour contains most of the information of the distribution. For instance, given an open subset $U$ of $X$, we say two distributions $\Lambda$ and $\Psi$ are equal on $U$ if $\Lambda \phi = \Psi \phi$ for every test function $\phi \in \DD(U)$. We recall the notion of a partition of unity, which, for each open cover $U_\alpha$ of Euclidean space, gives a family of $C^\infty$ functions $\psi_\alpha$ which are positive, {\it locally finite}, in the sense that only finitely many functions are positive on each compact set, and satisfy $\sum \psi_\alpha = 1$ on the union of the $U_\alpha$.

\begin{theorem}
    If $X$ is covered by a family of open sets $U_\alpha$, and $\Lambda$ and $\Psi$ are locally equal on each $U_\alpha$, then $\Lambda = \Psi$. If we have a family of distributions $\Lambda_\alpha$ which agree with one another on $U_\alpha \cap U_\beta$, then there is a unique distribution $\Lambda$ locally equal to each $\Lambda_\alpha$.
\end{theorem}
\begin{proof}
    Since we can find a $C^\infty$ partition of unity $\psi_\alpha$ compactly supported on the $U_\alpha$, upon which we find if $\phi$ is supported on $K$, then finitely many of the $\psi_\alpha$ are non-zero on $K$, and so
    %
    \[ \Lambda(\phi) = \sum \Lambda(\psi_\alpha \phi) = \sum \Psi(\psi_\alpha \phi) = \Psi(\phi) \]
    %
    Thus $\Lambda = \Psi$. Conversely, if we have a family of distributions $\Lambda_\alpha$ like in the hypothesis, then we can find a partition of unity $\psi_{\alpha \beta}$ subordinate to $U_\alpha \cap U_\beta$, and we can define
    %
    \[ \Lambda(\phi) = \sum \Lambda_\alpha(\psi_{\alpha \beta} \phi) = \sum \Lambda_\beta(\psi_{\alpha \beta} \phi) \]
    %
    The continuity is verified by fixing a compact $K$, from which there are only finitely many nonzero $\psi_{\alpha \beta}$ on $K$, and the fact that this definition is independant of the partition of unity follows from the first part of the theorem.
\end{proof}

In the language of commutative algebra, the association of $\DD^*(U)$ to each open subset $U$ of $\Omega$ gives the structure of a sheaf of modules on $\Omega$. Given a distribution $\Lambda$, we might have $\Lambda(\phi) = 0$ for every $\phi$ supported on some open set $U$. The complement of the largest open set $U$ for which this is true is called the \emph{support} of $\Lambda$. This agrees with the sheaf theoretic definition.

\begin{theorem}
    If a distribution $\Lambda \in \DD^*(\Omega)$ has compact support, then $\Lambda$ has some finite order $n$, and extends uniquely to a continuous functional on $C^n_{\text{loc}}(\Omega)$.
\end{theorem}
\begin{proof}
    Let $\Lambda$ be a distribution supported on a compact set. If $\psi$ is a function with compact support with $\psi(x) = 1$ on the support of $\Lambda$, then $\psi \Lambda = \Lambda$, because for any $\phi$, $\phi - \phi \psi$ is supported on a set disjoint from the support of $\Lambda$. But if $\psi$ is supported on some compact set $K$, then there is $n$ such that for any $\phi \in C_c^\infty(K)$,
    %
    \[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(K)}, \]
    %
    and so for any other compact set $K$,
    %
    \[ |\Lambda(\phi)| = |\Lambda(\phi \psi)| \lesssim \| \phi \psi \|_{C^n(K)} \lesssim \| \psi \|_{C^n(K)} \| \phi \|_{C^n(K)}. \]
    %
    which shows $\Lambda$ has order $N$. We have shown that $\Lambda$ is continuous with respect to the seminorm $\| \cdot \|_{C^N(K)}$ on $C^\infty(X)$, and so by the Hahn Banach theorem, $\Lambda$ extends uniquely to a continuous functional on $C^\infty(X)$.
\end{proof}

If $\mathcal{E}(\Omega)$ denotes $C^\infty(\Omega)$, equipped with the topology such that $f_n \to f$ if $D^\alpha f_n$ converges to $D^\alpha f$ locally uniformly for all $\alpha$, then the last theorem implies the family of compactly supported distributions embeds itself in $\mathcal{E}(\Omega)^*$. Conversely, \emph{every} element of $\mathcal{E}(\Omega)^*$ is a compactly supported distribution. Indeed, since $\mathcal{E}(\Omega)$ is a Frech\'{e}t space, if $\Lambda$ is a continuous linear functional on $\mathcal{E}(\Omega)$, then there exists a compact set $K$ and some $n > 0$ such that
%
\[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(K)}. \]
%
It follows from this that $\Lambda$ is a distribution with support contained in $K$.

\begin{remark}
    For general compact sets $K$, it is \emph{not} true that if $\Lambda$ is a distribution supported on a set $K$, then there exists $n > 0$ such that
    %
    \[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(K)}. \]
    %
    Suppose $K$ is not the union of finitely many compact connected sets. Then we can find a family of disjoint compact sets $\{ K_i \}$ in $K$ such that $K - (K_1 \cup \dots \cup K_n)$ is compact for any $n > 0$. Fix $x_i \in K_i$, let $x \in K$ be a limit point of this sequence, consider a sequence of numbers $\{ a_i \}$ such that $\sum a_i |x_i - x| = 1$, and $\sum a_i = \infty$, and let $\Lambda$ be the distribution
    %
    \[ \Lambda(\phi) = \sum_i a_i (\phi(x_i) - \phi(x)). \]
    %
    Then
    %
    \[ |\Lambda(\phi)| \leq \| \phi' \|_{L^\infty(\RR^d)}, \]
    %
    so $\Lambda$ is a distribution of order at most 1. On the other hand, if we choose a function $\phi \in \DD(\Omega)$ which is equal to one on a neighborhood of $K_1 \cup \dots \cup K_n$, and zero on a neighborhood of $K - (K_1 \cup \dots \cup K_n)$, then
    %
    \[ \Lambda(\phi) = \sum_{i = 1}^n a_i, \]
    %
    so we cannot have a bound of the form
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)} \lesssim 1. \]
    %
    On the other hand, for any precompact neighborhood $U$ of $K$, we have a bound
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq 1} \| D^\alpha \phi \|_{L^\infty(U)}. \]
    %
    which is almost as good as the bound above.
\end{remark}

In general, if $\Lambda$ is a distribution of order $k$ supported on a compact set $K$, though we do not have a uniform bound of the form
%
\[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)}, \]
%
what \emph{is} true is that if the right hand side vanishes, so does the left hand side.

\begin{lemma}
    Suppose $\Lambda$ is a distribution of order $k$ supported on $K$, and $\phi \in C^k(\Omega)$ satisfies $D^\alpha \phi(x) = 0$ for all $|\alpha| \leq k$ and $x \in K$, then $\Lambda(\phi) = 0$.
\end{lemma}
\begin{proof}
    By a density argument, we may assume that $\phi \in C^\infty(\Omega)$ without loss of generality. Find $\chi_\varepsilon \in \DD(\Omega)$ such that $\chi_\varepsilon(x) = 1$ for $x \in K$, $\chi_\varepsilon(x) = 0$ if $d(x,K) \geq \varepsilon$, and $\| D^\alpha \chi_\varepsilon \|_{L^\infty} \lesssim \varepsilon^{-|\alpha|}$ for all $|\alpha| \leq k$. Then for any $\phi \in \DD(\Omega)$,
    %
    \[ |\Lambda(\phi)| = |\Lambda(\phi \chi_\varepsilon)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha(\phi \chi_\varepsilon) \|_{L^\infty} \lesssim \sum_{|\alpha| \leq k} \varepsilon^{|\alpha|-k} \| D^\alpha \phi \|_{L^\infty(K_\varepsilon)}. \]
    %
    For any $y \in K_\varepsilon$, we can pick $x \in K$ such that $|x - y| \leq \varepsilon$. Taylor's formula at $x$, together with the fact that all the derivatives of $\phi$ up to order $k$ vanish at $x$, implies that
    %
    \[ |(D^\alpha \phi)(y)| \lesssim \varepsilon^{k+1 - |\alpha|}. \]
    %
    Thus we conclude that $|\Lambda(\phi)| \lesssim \varepsilon$, and we can then take $\varepsilon \to 0$.
\end{proof}

The last lemma implies that the value of \emph{any distribution} $\Lambda$ of order $k$ supported on a point $x_0$ depends solely on the values $D^\alpha \phi(x_0)$ for $|\alpha| \leq k$. Thus there exists constants $\lambda_\alpha$ such that
%
\[ \Lambda(\phi) = \sum_{|\alpha| \leq k} \lambda_\alpha D^\alpha \phi(x_0). \]
%
This means that $\Lambda$ is a sum of Dirac delta functions and their derivatives. If we work harder, using the Whitney extension theorem as a black box, we can obtain a similar process for more general supports.

\begin{theorem}[Whitney]
    Let $K$ be a compact set in $\RR^d$, and for each $|\alpha| \leq k$, a function $u_\alpha \in C(K)$. If
    %
    \[ U_\alpha(x,y) = \sum_{|\alpha| \leq k} \sup_{x,y \in K} \left| u_\alpha(x) - \sum_{|\beta| \leq k - |\alpha|} u_{\alpha + \beta}(y) \cdot (x - y)^\beta / \beta! \right| \cdot |x - y|^{|\alpha| - k}  \]
    %
    for $x \neq y$, and $U_\alpha(x,x) = 0$, then provided $U_\alpha$ is continuous on $K \times K$, we can find a function $v \in C^k(\RR^d)$ such that $D^\alpha v = u_\alpha$ on $K$ for $|\alpha| \leq k$, and
    %
    \[ \sum_{|\alpha| \leq k} \| D^\alpha v \|_{L^\infty} \lesssim \sum_{|\alpha| \leq k} \| U_\alpha \|_{L^\infty(K \times K)} + \sum_{|\alpha| \leq k} \| u_\alpha \|_{L^\infty(K)}. \]
\end{theorem}

A consequence is the following strengthening of the last lemma.

\begin{lemma}
    For \emph{any} compact set $K$, and any distribution $\Lambda$ of order $k$ supported on $K$, we have
    %
    \begin{align*}
        |\Lambda(\phi)| &\lesssim \sum_{|\alpha| \leq k} \sup_{x,y \in K} \left| D^\alpha \phi(x) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) \cdot (x - y)^\beta / \beta! \right| \cdot |x - y|^{|\alpha| - k}\\
        &\quad\quad + \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)}.
    \end{align*}
\end{lemma}
\begin{proof}
    To do this, we apply the Whitney extension theorem, setting $u_\alpha = D^\alpha \phi |_K$. We then apply the Whitney extension theorem to find $\psi \in C^k(\RR^n)$ extending $u_\alpha$ with the required bounds above. Then $D^\alpha(\phi - \psi) = 0$ on $K$ for all $|\alpha| \leq K$, from which it follows that $\Lambda(\phi) = \Lambda(\psi)$. The bound
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \psi \|_{L^\infty}, \]
    %
    which gives the required bound above.
\end{proof}

Recall that a compact set $K$ is \emph{Whitney regular}, which means that $K$ is a finite union of compact, connected components, and for any two points $x,y \in K$ contained in a common component, there exists a rectifiable curve $\gamma$ from $x$ to $y$ with length $O(|x - y|)$.

\begin{lemma}
    If $K$ is Whitney regular, then for any distribution $\Lambda$ supported on $K$, there exists $k$ such that we have a bound
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)}. \]    
\end{lemma}
\begin{proof}
    Fix a rectifiable unit velocity curve $\gamma: [0,L] \to K$ between two points $x$ and $y$ in $K$, and let
    %
    \[ F_\alpha(s) = D^\alpha \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) (\gamma(s) - y)^\beta / \beta! \]
    %
    Then $|F_\alpha(s)| \lesssim s^{k-|\alpha|} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}$. This is immediate if $|\alpha| = k$. For $|\alpha| < k$ we prove this result by induction, noting that the case for higher order $k$ implies that
    %
    \begin{align*}
        \left| dF_\alpha / ds \right| &\leq \sum_{i = 1}^d \left| \left( D^{\alpha + i} \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{(\alpha + i) + (\beta - i)} \phi(y) (\gamma(s) - y)^{\beta - i} / (\beta - 1)! \right) \cdot \gamma_i'(s) \right|\\
        &\lesssim s^{k - |\alpha| - 1} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}
    \end{align*}
    %
    Integrating this inequality in $s$ together with the fact that $F_\alpha(0) = 0$ gives the higher order bound. But this means that
    %
    \begin{align*}
        \left| D^\alpha \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) (\gamma(s) - y)^\beta / \beta! \right| &= |F_\alpha(L)|\\
        &\lesssim L^{k-|\alpha|} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}.
    \end{align*}
    %
    Choosing $\gamma$ optimally gives
    %
    \[ \left| D^\alpha \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) (\gamma(s) - y)^\beta / \beta! \right| \lesssim |x - y|^{k - |\alpha|} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}. \]
    %
    The last Lemma, together with this bound, completes the proof.
\end{proof}

\begin{remark}
    Similar arguments can be used to show that if $\Lambda$ is a distribution of order $k$ supported on a compact set $K$, and there exists $\gamma \leq 1$ such that $K$ is a finite union of connected components, such that for any pair of points $x,y$ in that component, there exists a rectifiable path from $x$ to $y$ with length $O(|x - y|^\gamma)$, and $m \geq k / \gamma$, then
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq m} \| D^\alpha \phi \|_{L^\infty(K)}. \]
\end{remark}

Let us finish by considering a consequence of these results, applied to distributions supported on hyperplanes. For simplicity in notation, we assume this hyperplane is axis oriented.

\begin{theorem}
    Let $x = (x_0,x_1)$, where $x_0 \in \RR^{d_1}$, $x_1 \in \RR^{d_2}$, and $d = d_1 + d_2$. Let $H = \{ (x_0,x_1) \in \RR^d: x_1 = 0 \}$. If $\Lambda$ is a distribution of order $k$ compactly supported on $H$, then there exists distributions $\Lambda_\alpha$ of order $k - |\alpha|$ on $\RR^{d_1}$ for each $|\alpha| \leq k$, where $\alpha$ is a multi-index in the $\RR^{d_2}$ variables, and constants $\gamma_\alpha$ such that
    %
    \[ \Lambda(\phi) = \sum \Lambda_\alpha(D^\alpha \phi |_H). \]
\end{theorem}
\begin{proof}
    Fix a function $\psi \in \DD(\RR^{d_1})$ equal to one in a neighborhood of the origin. Given $\phi \in \DD(\RR^{d_1})$, all derivatives of the function
    %
    \[ \sum_{|\alpha| \leq k} D^\alpha \phi(x_0,0) \cdot (x_1^\alpha / \alpha!) \cdot \psi(x_1) = \sum_{|\alpha| \leq k} D^\alpha \phi |_H (x_0) \cdot (x_1^\alpha / \alpha!) \]
    %
    agree with $\phi$ on $H$, where $\alpha$ ranges over all derivatives in the $x_1$ direction. It follows that if we define a distribution $\Lambda_\alpha$ on $\RR^{d_1}$ such that for $\psi \in \DD(\RR^{d_1})$,
    %
    \[ \Lambda_\alpha(\psi) = \Lambda( \psi \otimes (x_1^\alpha / \alpha!)), \]
    %
    then
    %
    \[ \Lambda(\phi) = \sum_{|\alpha| \leq k} \Lambda_\alpha( D^\alpha \phi |_H ). \]
    %
    The hard part is showing that $\Lambda_\alpha$ has order $k - |\alpha|$. If the support of $\Lambda$ in the $x_0$ variable is contained in a compact ball $B$, then, because $B$ is Whitney regular,
    %
    \begin{align*}
        |\Lambda_\alpha(\psi)| &\lesssim \sum_{|\beta_1| + |\beta_2| \leq k} \| D^{\beta_1 + \beta_2} \left\{ \psi \otimes (x_1^\alpha / \alpha!) \right\} \|_{L^\infty(B \times \{ 0 \})}\\
        &= \sum_{|\beta| \leq k - |\alpha|} \| D^\beta \psi \|_{L^\infty(B)}.
    \end{align*}
    %
    This implies $\Lambda_\alpha$ has order $k-|\alpha|$.
\end{proof}

\begin{remark}
    This argument does not really need the power of the full extension theorem machinery, since the Whitney extension theorem is relatively trivial in the application we give (we can consider a simple convolution argument to extend a function on a hyperplane to the full space). But the more developed machinery can be applied to characterize distributions on more general sets, which we leave to the reader to experiment with.
\end{remark}

\section{Derivatives of Continuous Functions}

One of the main reasons to consider the theory of distributions is so that we can take the derivative of any function we want. We now show that, at least locally, every distribution is the derivative of some continuous function, which means the theory of distributions is essentially the minimal such class of objects which enable us to take derivatives of continuous functions.

\begin{theorem}
    If $\Lambda$ is a distribution on $\Omega$, and $K$ is a compact set, then there is a continuous function $f$ and $\alpha$ such that for every $\phi$,
    %
    \[ \Lambda \phi = (-1)^{|\alpha|} \int_\Omega f(x) (D^\alpha \phi)(x)\; dx \]
\end{theorem}
\begin{proof}
    TODO
\end{proof}

\begin{theorem}
    If $K$ is compact, contained in some open subset $V$, which in turn is a subset of $\Omega$, and $\Lambda$ has order $N$, then there exists finitely many continuous functions $f_\beta \in C(\Omega)$ supported on $V$, for each $|\beta| \leq N + 2$, with supports on $V$, and with $\Lambda = \sum D^\beta f_\beta$.
\end{theorem}

\begin{theorem}
    If $\Lambda$ is a distribution on $\Omega$, then there exists continuous functions $g_\alpha$ on $\Omega$ such that each compact set $K$ intersects the supports of finitely many of the $g_\alpha$, and $\Lambda = \sum D^\alpha g_\alpha$. If $\Lambda$ has finite order, then only finitely many of the $g_\alpha$ are nonzero.
\end{theorem}

\section{Convolutions of Distributions}

Using the convolution of two functions as inspiration, we will define the convolution of a distribution $\Lambda$ with a test function $\phi$, and under certain conditions, the convolution of two distributions. Recall that if $f,g \in L^1(\RR^n)$, then their convolution is the function in $L^1(\RR^n)$ defined by
%
\[ (f * g)(x) = \int f(y) g(x - y)\; dy \]
%
If we define the translation operators $T_y g(x) = \text{Trans}_y g(x) = g(x - y)$, then $(f * g)(x) = \int f(y) (T_x g^*)(y)\; dy$, where $g^*$ is the function defined by $g^*(x) = g(-x)$. Thus, if $\Lambda$ is any distribution on $\RR^n$, and $\phi$ is a test function on $\RR^n$, we can define a function $\Lambda * \phi$ by setting $(\Lambda * \phi)(x) = \Lambda(T_x \phi^*)$. Notice that since
%
\begin{align*}
    \int (T_x f)(y) g(y)\; dy &= \int f(y-x) g(y)\; dy = \int f(y) g(x+y)\; dy\\
    &= \int f(y) (T_{-x}g)(y)\; dy,
\end{align*}
%
so we can also define the translation operators on distributions by setting $(T_x \Lambda)(\phi) = \Lambda (T_{-x} \phi)$. One mechanically verifies that convolution commutes with translations, i.e. $T_x (\Lambda * \phi) = (T_x \Lambda) * \phi = \Lambda * (T_x \phi)$.

\begin{theorem}
    $\Lambda * \phi$ is $C^\infty$, and
    %
    \[ D^\alpha(\Lambda * \phi) = (D^\alpha \Lambda) * \phi = \Lambda * (D^\alpha \phi). \]
\end{theorem}
\begin{proof}
    It is easy to calculate that
    %
    \begin{align*}
        (D^\alpha \Lambda * \phi)(x) &= (D^\alpha \Lambda)(\phi^*_x) = (-1)^{|\alpha|} \Lambda(D^\alpha (T_x \phi^*))\\
        &= \Lambda(T_x (D^\alpha \phi)^*) = (\Lambda * D^\alpha \phi)(x)
    \end{align*}
    %
    If $k \in \{ 1, \dots, d \}$ and $h \in \RR$, we set
    %
    \[ (\Delta_h f)(x) = \frac{f(x + he_k) - f(x)}{h} \]
    %
    then $\Delta_h \phi$ converges to $D^k \phi$ in $\DD(\RR^d)$, and as such
    %
    \begin{align*}
      \Delta_h(\Lambda * \phi)(x) &= \frac{(\Lambda * \phi)(x + he_k) - (\Lambda * \phi)(x)}{ h}\\
      &= \Lambda \left( \frac{T_{-x - he_k} \phi^* - T_{-x} \phi^*}{h} \right)
    \end{align*}
    %
    As $h \to 0$, in $\DD(\RR^d)$ we have
    %
    \[ \frac{T_{-x - he_k} \phi^* - T_{-x} \phi^*}{h} \to - T_{-x} D_k \phi^* = T_{-x} (D_k \phi)^*. \]
    %
    Thus, by continuity,
    %
    \[ \lim_{h \to 0} \Delta_h(\Lambda * \phi)(x) = \Lambda(T_{-x} (D_k \phi)^*) = (\Lambda * D_k \phi)(x) \]
    %
    Iteration gives the general result that $\Lambda * \phi \in C^\infty(\RR^d)$. An easy calculation then shows that for each $x \in \RR^d$,
    %
    \begin{align*}
      [(D^\alpha \Lambda) * \phi](x) &= (D^\alpha \Lambda)(T_{-x} \phi^*)\\
      &= (-1)^{|\alpha|} \Lambda(T_{-x} D^\alpha \phi^*)\\
      &= \Lambda(T_{-x} (D^\alpha \phi)^*)\\
      &= (\Lambda * D^\alpha \phi)(x). \qedhere
    \end{align*}
\end{proof}

There is a certain duality going on here. Distributions can be viewed as linear functionals on $\DD(\RR^d)$, but one can also view them as a certain family of linear operators from $\DD(\RR^d) \to C^\infty(\RR^d)$ , and the convolution operator uniquely represents the distribuition. In fact, any such operator that is translation invariant and continuous can be represented as convolution by a distribution.

\begin{theorem}
  Let $T: \DD(\RR^d) \to \loc{C^\infty}(\RR^d)$ be a translation invariant continuous operator. Then there exists a distribution $\Lambda$ such that $T\phi = \Lambda * \phi$ for all $\phi \in \DD(\RR^d)$.
\end{theorem}
\begin{proof}
  If we knew $T\phi = \Lambda * \phi$ for some $\Lambda$, then we could recover $\Lambda$ since
  %
  \[ \int \Lambda(x) \phi(x)\; dx = T \phi(0). \]
  %
  Since $T$ is a continuous operator, the right hand side defines a distribution $\Lambda$, and translation invariance allows us to conclude that $T\phi = \Lambda * \phi$ for all $\phi \in \DD(\RR^d)$.
\end{proof}

\begin{example}
        A linear differential operator $P: \DD(\RR^d) \to \DD(\RR^d)$ is translation invariant, from which it follows that there exists a distribution $\Lambda$ such that $P\phi = \Lambda * \phi$. Of course, $\Lambda(\phi) = P\phi(0)$ is just given by applying the differential operator at the origin.
\end{example}

\begin{theorem}
    If $\phi, \psi \in \DD(\RR^n)$, then $\Lambda * (\phi * \psi) = (\Lambda * \phi) * \psi$.
\end{theorem}
\begin{proof}
  Let $K$ be a compact set containing the supports of $\phi$ and $\psi$. It is simple to verify that for each $x \in \RR^d$,
    %
    \[ (\phi * \psi)^*(x) = \int \phi^*(x + y) \psi(y)\; dy = \int (T_y \phi^*)(x) \psi(y)\; dy \]
    %
    since the map $y \mapsto (T_y \phi)^* \psi(y)$ is continuous, and vanishes out of the compact set $K$, we can consider the $C_c^\infty(K)$ valued integral
    %
    \[ (\phi * \psi)^* = \int_K \psi^*(y) T_y \phi^*\; ds \]
    %
    This means precisely that
    %
    \begin{align*}
        (\Lambda * (\phi * \psi))(0) &= \Lambda((\phi * \psi)^*) = \int_K \psi^*(y) \Lambda(T_y \phi^*)\; dy\\
        &= \int_K \psi^*(y) (\Lambda * \phi)(y)\; dy = ((\Lambda * \phi) * \psi)(0)
    \end{align*}
    %
    The commutativity in general results from applying the commutativity of the translation operators.
\end{proof}

A sequence $\{ \phi_n \}$ in $\DD(\RR^n)$ is known as an {\it approximate identity} in the space of distributions if $\Lambda * \phi_n$ converges to $\Lambda$ as $n \to \infty$, for every distribution $\Lambda$, and an approximate identity in the space of test functions if $\psi * \phi_n$ converges to $\psi$ in $\DD(\RR^n)$ for every $\psi \in \DD(\RR^n)$.

\begin{theorem}
    If $\{ \phi_n \}$ is a family of non-negative functions in $\DD(\RR^n)$ which are eventually supported on every neighbourhood of the origin, and all integrate to one, then $\{ \phi_n \}$ is an approximation to the identity in the space of test functions and in the space of distributions.
\end{theorem}
\begin{proof}
    It is easy to verify that if $f$ is a continuous function, then $f * \phi_n$ converges locally uniformly to $f$ as $n \to \infty$. But now we calculate that if $f \in \DD(\RR^n)$, then $D^\alpha(f * \phi_n) = (D^\alpha f) * \phi_n$ converges locally uniformly to $D^\alpha \phi$, which gives that $f * \phi$ converges to $f$ in $\DD(\RR^n)$. Now if $\Lambda$ is a distribution, and $\psi$ is a test function, then continuity gives
    %
    \begin{align*}
        \Lambda(\psi^*) &= \lim_{\delta \to 0} \Lambda(\phi_\delta * \psi) = \lim_{\delta \to 0} (\Lambda * (\phi_\delta * \psi))(0)\\
        &= \lim_{\delta \to 0} ((\Lambda * \phi_\delta) * \psi)(0) = \lim_{\delta \to 0} (\Lambda * \phi_\delta)(\psi^*)
    \end{align*}
    %
    and $\psi$ was arbitrary.
\end{proof}

If $\Lambda$ is a distribution on $\RR^n$, then the map $\phi \mapsto \Lambda * \phi$ is a linear transformation from $\DD(\RR^n)$ into $\EC(\RR^n)$, which commutes with translations. It is also continuous. To see this, we consider a fixed compact $K$, and consider the map from $C_c^\infty(K)$ to $\loc{C^\infty}(\RR^n)$. Both of these spaces are Fr\'{e}chet, so we can apply the closed graph theorem. Consider a sequence $\{ \phi_n \}$ converging in $C_c^\infty(K)$ to some $\phi$, and we suppose that $\{ \Lambda * \phi_n \}$ converges in $C_c^\infty(K)$ to a function $f$. It suffices to show that $\Lambda * \phi = f$. But we calculate that for each $x \in \RR^d$,
%
\[ f(x) = \lim_n (\Lambda * \phi_n)(x) = \lim \Lambda(T_x \phi^*_n) = \Lambda (\lim T_x \phi^*_n) = \Lambda(T_x \phi^*) = (\Lambda * \phi)(x). \]
%
Here we have used the fact that $T_x \phi_n^*$ converges to $T_x \phi^*$ in $\DD(\RR^n)$. Thus $\phi \mapsto \Lambda * \phi$ is a continuous, translation invariant operator from $\DD(\RR^n)$ to $\EC(\RR^n)$. Surprisingly, the converse is also true.

\begin{theorem}
    If $L: \DD(\RR^n) \to \EC(\RR^n)$ is a continuous linear transformation commuting with translations, then there is a distribution $\Lambda$ such that $L(\phi) = \Lambda * \phi$.
\end{theorem}
\begin{proof}
    If $L(\phi) = \Lambda * \phi$, then we would have
    %
    \[ \Lambda(\phi) = (\Lambda * \phi^*)(0) = L(\phi^*)(0) \]
    %
    and we take this as the definition of $\Lambda$ for an arbitrary operator $L$. Indeed, it then follows that $\Lambda$ is continuous because all the operations here are continuous, and because $L$ commutes with translations, we conclude
    %
    \[ (\Lambda * \phi)(x) = \Lambda(T_x \phi^*) = L(T_{-x} \phi)(0) = L(\phi)(x) \]
    %
    which gives the theorem.
\end{proof}

We now move onto the case where a distribution $\Lambda$ has compact support. Then $\Lambda$ extends to a continuous linear functional on $\EC(\RR^n)$, and we can define the convolution $\Lambda * \phi$ if $\phi \in \EC(\RR^n)$ as above. This is an extension of the convolution operator above to a continuous operator from $\mathcal{E}(\RR^n)$ to itself. The same techniques as before, or a density argument, verify that translations and derivatives are carried into the convolution.

\begin{theorem}
    If $\phi$ and $\Lambda$ have compact support on $\RR^d$, then $\Lambda * \phi$ has compact support, and moreover,
    %
    \[ \text{supp}(\Lambda * \phi) \subset \text{supp}(\Lambda) + \text{supp}(\phi). \]
    %
    The map $\phi \mapsto \Lambda * \phi$ is a continuous operator from $\mathcal{D}(\RR^d)$ to itself.
\end{theorem}
\begin{proof}
    Let $\phi$ be supported on a compact set $K$, and $\Lambda$ be supported on $K_0$. Then $(\Lambda * \phi)(x) = \Lambda(T_x \phi^*)$. Since $T_x \phi^*$ is supported on $x - K$, $(\Lambda * \phi)(x) = 0$ unless $K_0 \cap (x - K) \neq \emptyset$, i.e. $x \in K_0 + K$.

    To obtain continuity of the operator, it suffices to prove that $\phi \mapsto \Lambda * \phi$ is a continuous operator from $C_c^\infty(K)$ to $\DD(\RR^d)$ for any compact set $K$. Let $\Lambda$ be supported on a compact set $K_0$. Then $\Lambda * \phi$ is supported on $K + K_0$, and so it suffices to show $\phi \mapsto \Lambda * \phi$ is a continuous operator from $C_c^\infty(K)$ to $C_c^\infty(K + K_0)$. But this follows because the map is continuous into $\loc{C^\infty}(\RR^d)$.
\end{proof}

\begin{theorem}
    If $\Lambda$ and $\psi$ have compact support, and $\phi \in C^\infty(\RR^n)$, then
    %
    \[ \Lambda * (\phi * \psi) = (\Lambda * \phi) * \psi = (\Lambda * \psi) * \phi \]
\end{theorem}
\begin{proof}
    Let $\Lambda$ and $\psi$ be supported on some balanced compact set $K$. Let $V$ be a bounded, balanced open set containing $K$. If $\phi_0$ is a function with compact support equal to $\phi$ on $V + K$, then for $x \in V$,
    %
    \[ (\phi * \psi)(x) = \int \phi(x - y) \psi(y)\; dy = \int \phi_0(x - y) \psi(y)\; dy = (\phi_0 * \psi)(x) \]
    %
    Thus
    %
    \[ (\Lambda * (\phi * \psi))(0) = (\Lambda * (\phi_0 * \psi))(0) = ((\Lambda * \psi) * \phi_0)(0) \]
    %
    But $\Lambda * \psi$ is supported on $K + K$, so $((\Lambda * \psi) * \phi_0)(0) = ((\Lambda * \psi) * \phi)(0)$. Now we also calculate
    %
    \[ (\Lambda * (\phi * \psi))(0) = ((\Lambda * \phi_0) * \psi)(0) = ((\Lambda * \phi) * \psi)(0) \int (\Lambda * \phi_0)(-y) \psi(y) \]
    %
    where the last fact follows because $\Lambda * \phi_0$ agrees with $\Lambda * \phi$ on $K$. The general fact follows by applying the translation operators.
\end{proof}

Now we come to the grand finale, defining the convolution of two distributions. Given two distributions $\Lambda$ and $\Psi$, one of which has compact support, we define the linear operator
%
\[ L(\phi) = \Lambda * (\Psi * \phi) \]
%
This gives a continuous, translation invariant linear operator from $\DD(\RR^d)$ to $\EC(\RR^d)$; if $\Psi$ is compactly supported, then $\phi \mapsto \Psi * \phi$ is a continuous operator on $\DD(\RR^d)$, which gives continuity. If $\Lambda$ is compactly supported, then $\Lambda \mapsto \Lambda * \eta$ is a continuous linear operator on $\EC(\RR^d)$, which gives continuity. But this means that $L$ corresponds to convolution with a distribution, and we define this distribution to be $\Lambda * \Psi$.

\begin{theorem}
    If $\Lambda$ and $\Psi$ are distributions, one of which has compact support, then $\Lambda * \Psi = \Psi * \Lambda$. Let $S_\Lambda$ and $S_\Psi$, and $S_{\Lambda * \Psi}$ denote the supports of $\Lambda$, $\Psi$, and $\Lambda * \Psi$. Then $S_{\Lambda * \Psi} \subset S_\Lambda + S_\Psi$.
\end{theorem}
\begin{proof}
    We calculate that for any two test functions $\phi$ and $\psi$,
    %
    \[ (\Lambda * \Psi) * (\phi * \psi) = \Lambda * (\Psi * (\phi * \psi)) = \Lambda * ((\Psi * \phi) * \psi) \]
    %
    If $\Lambda$ has compact support, then
    %
    \[ \Lambda * ((\Psi * \phi) * \psi) = (\Lambda * \psi) * (\Psi * \phi) \]
    %
    Conversely, if $\Psi$ has compact support, then
    %
    \[ \Lambda * ((\Psi * \phi) * \psi) = \Lambda * (\psi * (\Psi * \phi)) = (\Lambda * \psi) * (\Psi * \phi) \]
    %
    We also calculate
    %
    \begin{align*}
        \Psi * ((\Lambda * \phi) * \psi) &= \Psi * (\Lambda * (\phi * \psi)) = \Psi * (\Lambda * (\psi * \phi))\\
        &= \Psi * ((\Lambda * \psi) * \phi) = (\Psi * \phi) * (\Lambda * \psi)
    \end{align*}
    %
    But since convolution is commutative, we have
    %
    \[ ((\Lambda * (\Psi * \phi)) * \psi) = \Lambda * ((\Psi * \phi) * \psi) = \Psi * ((\Lambda * \phi) * \psi) = (\Psi * (\Lambda * \phi)) * \psi \]
    %
    Since $\psi$ was arbitrary, we conclude
    %
    \[ (\Lambda * \Psi) * \phi = \Lambda * (\Psi * \phi) = \Psi * (\Lambda * \phi) = (\Psi * \Lambda) * \phi \]
    %
    and now since $\phi$ was arbitrary, we conclude $\Lambda * \Psi = \Psi * \Lambda$. Now we know convolution is commuatative, we may assume $S_\Psi$ is compact. The support of $\Psi * \phi^*$ lies in $S_\Psi - S_\phi$. But this means that if $S_\phi - S_\Psi$ is disjoint from $S_\Lambda$, which means exactly that $S_\phi$ is disjoint from $S_\Lambda + S_\Psi$, then
    %
    \[ (\Lambda * \Psi)(\phi) = (\Lambda * (\Psi * \phi))(0) = 0 \]
    %
    and this gives the support of $\Lambda * \Psi$.
\end{proof}

This means that the convolution of two distributions with compact support also has compact support. This means that if we have three distributions $\Lambda, \Psi$, and $\Phi$, two of which have compact support, then the distributions $\Lambda * (\Psi * \Phi)$ and $(\Lambda * \Psi) * \Phi$ are well defined, so convolution is associative and commutative. We calculate that for any test function $\phi$,
%
\[ (\Lambda * (\Psi * \Phi)) * \phi = \Lambda * (\Psi * (\Phi * \phi)) \]
\[ ((\Lambda * \Psi) * \Phi) * \phi = (\Lambda * \Psi) * (\Phi * \phi) \]
%
If $\Phi$ has compact support, then $\Phi * \phi$ has compact support, and so we can move $(\Lambda * \Psi)$ into the equation to prove equality. If $\Phi$ does not have compact support, then $\Lambda$ and $\Psi$ have compact support, and
%
\[ \Lambda * (\Psi * \Phi) = \Lambda * (\Phi * \Psi) \]
%
and we can apply the previous case to obtain that this is equal to $(\Lambda * \Phi) * \Psi$. Repeatedly applying the previous case brings this to what we want.

\begin{theorem}
    If $\Lambda$ and $\Psi$ are distributions, one of which having compact support, then
    %
    \[ D^\alpha(\Lambda * \Psi) = (D^\alpha \Lambda) * \Psi = \Lambda * (D^\alpha \Psi). \]
\end{theorem}
\begin{proof}
    The Dirac delta function $\delta$ satisfies
    %
    \[ (\delta * \phi)(x) = \int \phi(y) \delta(x-y)\; dy = \phi(x) \]
    %
    so $\delta * \phi = \phi$. Now $D^\alpha \delta$ is also supported at $x$, since
    %
    \[ (D^\alpha \delta)(\phi) = (-1)^{|\alpha|} \int \delta(x) (D^\alpha \phi)(x)\; dx = (-1)^{|\alpha|} (D^\alpha \phi)(0) \]
    %
    which means that for any distribution $\Lambda$, then $(D^\alpha \delta) * \Lambda$ has compact support,
    %
    \[ (((D^\alpha \delta) * \Lambda) * \phi)(0) = (D^\alpha \delta)((\Lambda * \phi)^*) = (-1)^{|\alpha|} D^\alpha (\Lambda * \phi)^* = ((D^\alpha \Lambda) * \phi)(0) \]
    %
    which verifies that $(D^\alpha \delta) * \Lambda = \delta * (D^\alpha \Lambda)$. But now we find
    %
    \[ D^\alpha(\Lambda * \Psi) = (D^\alpha \delta) * \Lambda * \Psi = ((D^\alpha \delta) * \Lambda) * \Psi = D^\alpha \Lambda * \Psi \]
    \[ D^\alpha(\Lambda * \Psi) = D^\alpha(\Psi * \Lambda) = (D^\alpha \Psi) * \Lambda = \Lambda * (D^\alpha \Psi) \]
    %
    which verifies the theorem in general.
\end{proof}

\section{Schwartz Space and Tempered Distributions}

We have already encountered the fact that Fourier transforms are well behaved under differentiation and multiplication by polynomials. If we let $\mathcal{S}(\RR^d)$ denote a class of functions under which to study this phenomenon, it must be contained in $L^1(\RR^d)$ and $C^\infty(\RR^d)$, and closed under multiplication by polynomials, and closed under applications of arbitrary constant-coefficient differential operators. A natural choice is then the family of functions which \emph{decays rapidly}, as well as all of it's derivatives; i.e. we let $\mathcal{S}(\RR^d)$ be the space of all functions $f \in C^\infty(\RR^d)$ such that for any integer $n$ and multi-index $\alpha$, $|x|^n D^\alpha f \in L^\infty(\RR^d)$. The space $\mathcal{S}(\RR^d)$ is then locally convex if we consider the family of seminorms
%
\[ \| f \|_{\mathcal{S}^{n,m}(\RR^d)} = \sup_{|\alpha| \leq n} \| \langle x \rangle^m D^\alpha f \|_{L^\infty(\RR^d)}. \]
%
Elements of $\mathcal{S}(\RR^d)$ are known as \emph{Schwartz functions}, and $\mathcal{S}(\RR^d)$ is often known as the \emph{Schwartz space}. The seminorms naturally give $\mathcal{S}(\RR^d)$ the structure of a Fr\'{e}chet space. Sometimes, it is more convenient to use the equivalent family of seminorms $\| f \|_{\mathcal{S}^{\alpha, \beta}(\RR^d)} = \| x^\alpha D^\beta f \|_{L^\infty(\RR^d)}$, because $x^\alpha$ often behaves more nicely under various Fourier analytic operations. It is obvious that $\mathcal{S}(\RR^d)$ is separated by the seminorms defined on it, because $\| \cdot \|_{L^\infty(\RR^d)} = \| \cdot \|_{\mathcal{S}^{0,0}(\RR^d)}$ is a norm used to define the space. We now show the choice of seminorms make the space complete.

\begin{theorem}
    $\mathcal{S}(\RR^d)$ is a complete metric space.
\end{theorem}
\begin{proof}
    Let $\{ f_i \}$ be a Cauchy sequence with respect to the seminorms $\| \cdot \|_{\mathcal{S}^{n,\alpha}(\RR^d)}$. This implies that for each integer $m$, and multi-index $\alpha$, the sequence of functions $\langle x \rangle^m D^\alpha f_k$ is Cauchy in $L^\infty(\RR^d)$. Since $L^\infty(\RR^d)$ is complete, there are functions $g_{m,\alpha}$ such that $\langle x \rangle^m D^\alpha f_k$ converges uniformly to $g_{m,\alpha}$. If we set $f = g_{0,0}$, then it is easy to see using the basic real analysis of uniform continuity that $f$ is infinitely differentiable, and $\langle x \rangle^m D^\alpha f = g_{m,\alpha}$. It is then easy to show that $f_i$ converges to $f$ in $\mathcal{S}(\RR^d)$.
\end{proof}

\begin{example}
    The Gaussian function $\phi: \RR^d \to \RR$ defined by $\phi(x) = e^{-|x|^2}$ is Schwartz. For any multi-index $\alpha$, there is a polynomial $P_\alpha$ of degree at most $|\alpha|$ such that $D^\alpha \phi = P_\alpha \phi$; this can be established by a simple induction. But this means that for each fixed $\alpha$, $|P_\alpha(x)| \lesssim_\alpha 1 + |x|^{|\alpha|}$. Since $e^{-|x|^2} \lesssim_{m,\alpha} \langle x \rangle^{-m -|\alpha|}$ for any fixed $m$ and $\alpha$, we find that for any $x \in \RR^d$,
    %
    \[ | (1 + |x|^m) D^\alpha \phi| \lesssim_{\alpha,m} 1. \]
    %
    Since $m$ and $\alpha$ were arbitrary, this shows $\phi$ is Schwartz.
\end{example}

\begin{example}
    Any compactly supported smooth function is Schwartz. In particular, the inclusion map
    %
    \[ \DD(\RR^d) \to \SW(\RR^d) \]
    %
    is bounded. The proof is left to the reader. An important consequence is that elements of $\SW(\RR^d)^*$, which we will call \emph{tempered distributions}, can be viewed as a subspace of the space $\DD(\RR^d)^*$ of all distributions.
\end{example} 

To show that an operator $T$ on $\mathcal{S}(\RR^d)$ is bounded, it suffices to show that for each $n_0$ and $m_0$, there is $n_1$, $m_1$ such that
%
\[ \| Tf \|_{\mathcal{S}^{n_0,m_0}(\RR^d)} \lesssim_{n_0,m_0} \| f \|_{\mathcal{S}^{n_1,m_1}(\RR^d)}. \]
%
For a functional $\Lambda: \mathcal{S}(\RR^d) \to \RR$, it suffices to show that there exists $n$ and $m$ such that $|\Lambda f| \lesssim \| f \|_{\mathcal{S}^{n,m}(\RR^d)}$. The minimal such choice of $n$ is known as the \emph{order} of the functional $\Lambda$. We normally do not care about the constant behind the operators for these norms, since the norms are not translation invariant and therefore highly sensitive to the positions of various functions. We really just care about proving the existence of such a constant.
%\begin{lemma}
%  The map $(f,g) \mapsto fg$ for $f,g \in \mathcal{S}(\RR^d)$ gives a bounded bilinear map from $\mathcal{S}(\RR^d) \times \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$.
%\end{lemma}
%\begin{proof}
%  A simple application of the Leibnitz formula shows that for any multi-index $\alpha$ with $|\alpha| = m$, and two non-negative integers $n_1$ and $n_2$ with $n_1 + n_2 = n$,
  %
%  \[ \| fg \|_{\mathcal{S}^{n,\alpha}(\RR^d)} \lesssim_n \| f \|_{\mathcal{S}^{n_1,m}(\RR^d)} \| g \|_{\mathcal{S}^{n_2,m}(\RR^d)}. \]
  %
%  More generally, this argument shows that the analogoue bilinear map from $C^\infty(\RR^d) \times \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$ is bounded.
%\end{proof}
%
Here are some examples:
%
\begin{itemize}
    \item Multiplication gives a continuous bilinear map
    %
    \[ \SW(\RR^d) \times \SW(\RR^d) \to \SW(\RR^d). \]
    %
    More generally, the bilinear multiplication map
    %
    \[ C^\infty_b(\RR^d) \times \SW(\RR^d) \to \SW(\RR^d) \]
    %
    is continuous.

    \item For each $x \in \RR^d$, the translation operator
    %
    \[ \text{Trans}_x: \SW(\RR^d) \to \SW(\RR^d) \]
    %
    is an isomorphism. For each $\xi \in \RR^d$, the modulation operator
    %
    \[ \text{Mod}_\xi: \SW(\RR^d) \to \SW(\RR^d) \]
    %
    is an isomorphism.

    \item The $L^p$ norms are continuous.

    \item The Fourier transform is an isomorphism of $\SW(\RR^d)$.
\end{itemize}
%
The last point follows by an application, e.g. of the compatibility of differentiation and polynomial multiplication with the Fourier transform.
%\end{theorem}
%\begin{proof}
%   Let $(T_h f)(x) = f(x - h)$. We calculate that if $|\alpha| \leq n$, then
    %
%   \begin{align*}
%       (1 + |x|^m) (T_h f)_\alpha &= T_h((1 + |x + h|^m) f_\beta)\\
%       &\leq 2^m T_h((1 + |x|^m + |h|^m) f_\alpha)\\
%       &\leq 2^m |h|^m \| f_\alpha \|_{n,0} + 2^m \| f \|_{n,m}.
%   \end{align*}
    %
%   Thus $\| T_h f \|_{n,m} \leq 2^m(1 + |h|^m) \| f \|_{n,m}$, so $T_h$ is continuous.

%   Similarily, we calculate using the Leibnitz formula and the formula for the derivatives of $e(\xi \cdot x)$ that if $|\alpha| \leq n$, then
    %
%   \[ (1 + |x|^m) |(e(\xi \cdot x) f)_\alpha| \leq 4^n (2\pi)^n (1 + |\xi|^n) \| f \|_{n,m} \]
    %
%   Thus $\| M_\xi f \|_{n,m} \leq (8 \pi)^n (1 + |\xi|^n) \| f \|_{n,m}$.

%   For any Schwartz function $f$, and $|\alpha| \leq n$,
    %
%   \[ f(x) \leq \frac{\| f \|_{0,d+1}}{1 + |x|^{d+1}} \]
    %
%   Integrating this equation gives
    %
%   \[ \| f_\alpha \|_{L^1(\RR^d)} \leq 2^d \| f \|_{0,d+1}. \]
    %
%   Thus $\| \cdot \|_1$ is a bounded norm on the space. Interpolation then shows that for any $1 < p < \infty$,
    %
%   \[ \| f \|_{L^p(\RR^d)} \leq \| f \|_{L^1(\RR^d)}^{1 - 1/p} \| f \|_{L^\infty(\RR^d)}^{1/p} \leq \| f \|_{L^1(\RR^d)} + \| f \|_{L^\infty(\RR^d)} \leq 2 \| f \|_{0,d+1}. \]
    %
%   This implies $\| \cdot \|_{L^p(\RR^d)}$ is bounded.

%   A simple calculation using the Leibnitz formula shows that if $|\alpha| \leq n$,
    %
%   \begin{align*}
%       (1 + |x|^m) |\mathcal{F}(f)_\alpha| &\leq |\mathcal{F}(f)_\alpha| + \sum_{k = 1}^d |x_k^m \mathcal{F}(f)_\alpha|\\
%       &\leq (2 \pi)^n \left( \| \mathcal{F} f \|_{L^\infty(\RR^d)} + \sum_{k = 1}^d |\mathcal{F}((x^\alpha f)_{me_k})| \right)\\
%       &\leq n! (2 \pi)^n 2^m (n+1) \max_{0 \leq k \leq d} \max_{1 \leq l \leq m} \left( \| \mathcal{F} f \|_{L^\infty(\RR^d)} + \sum_{k = 1}^n \max_{1 \leq l \leq m} \| \mathcal{F}(f_{le_k}) \|_{L^\infty(\RR^d)} \right)\\
%       &\leq n! (2 \pi)^n 2^m \left( \| f \|_{L^1(\RR^d)} + \sum_{k = 1}^n \max_{1 \leq l \leq m} \| f_{le_k} \|_{L^1(\RR^d)} \right)\\
%       &\leq n! (2 \pi)^n 2^m 2^d (n+1) \| f \|_{n,d+1}.
%   \end{align*}

%   there are constants $c_{\alpha \beta \gamma}$ for each $\gamma \leq \alpha \wedge \beta$ such that
    %
%   \begin{align*}
%       |x^\alpha \mathcal{F}(f)_\beta| &= (2 \pi)^{|\beta|} |x^\alpha \cdot \mathcal{F}(x^\beta f)|\\
%       &= (2\pi)^{|\beta| - |\alpha|} \mathcal{F}((x^\beta f)_\alpha)\\
%       &\leq (2\pi)^{|\beta| - |\alpha|} \sum_{\gamma \leq \alpha \wedge \beta} c_{\alpha \beta \gamma} |\mathcal{F}(x^{\beta - \gamma} f_{\alpha - \gamma})|.
%   \end{align*}
    %
%   This calculation shows
    %
%   \begin{align*}
%       \| \mathcal{F} f \|_{\alpha,\beta} &\lesssim_{\alpha,\beta} \sum \| \mathcal{F}(x^{\beta - \gamma} f_{\alpha - \gamma}) \|_{L^\infty(\RR^n)}\\
%       &\leq \sum \| x^{\beta - \gamma} f_{\alpha - \gamma} \|_{L^1(\RR^n)}.
%   \end{align*}
    %
%   The right hand side is a continuous function of $f$, so the Fourier transform is bounded. The smoothness of the Schwartz space implies that $\mathcal{F}$ is a bijective map. But then the open mapping theorem implies that $\mathcal{F}^{-1}$ is a bounded operation, and therefore $\mathcal{F}$ is a homeomorphism.

%    We leave all but the last point as exercises. Here it will be convenient to use the norms $\| \cdot \|_{\mathcal{S}^{\alpha,\beta}(\RR^d)}$ as well as the norms $\| \cdot \|_{\mathcal{S}^{n,m}(\RR^d)}$. If $|\alpha| \leq m$, $|\beta| \leq n$, then we can use the Leibnitz formula to conclude that
    %
%    \begin{align*}
%        \| \xi^\alpha D^\beta \mathcal{F}(f) \|_{L^\infty(\RR^d)} &\lesssim_{\alpha,\beta} \| \mathcal{F}(D^\alpha(x^\beta f)) \|_{L^\infty(\RR^d)}\\
%        &\lesssim_{\alpha,\beta} \max_{\gamma \leq \alpha \wedge \beta} \| \mathcal{F}(x^{\gamma} D^\gamma f) \|_{L^\infty(\RR^d)}\\
%        &\leq \max_{\gamma \leq \alpha \wedge \beta} \| x^\gamma D^\gamma f \|_{L^1(\RR^d)}\\
%        &\lesssim \| f \|_{\mathcal{S}^{\gamma,|\gamma| + d+1}(\RR^d)}.
%    \end{align*}
    %
%    Thus $\mathcal{F}$ is a bounded linear operator on $\mathcal{S}(\RR^d)$. Since all Schwartz functions are arbitrarily smooth, the Fourier inversion formula applies to all Schwartz functions, and so $\mathcal{F}$ is a bijective bounded linear operator with inverse $\mathcal{F}^{-1}$. The open mapping theorem then immediately implies that $\mathcal{F}^{-1}$ is bounded.
%\end{proof}

\begin{corollary}
    Convolution is a continuous operator
    %
    \[ \SW(\RR^d) \times \SW(\RR^d) \to \SW(\RR^d). \]
\end{corollary}
\begin{proof}
    We have
    %
    \[ f * g = \mathcal{F}^{-1} \{ \mathcal{F} \{ f \} \cdot \mathcal{F} \{ g \} \}, \]
    %
    and the result then follows from the previous examples.
\end{proof}

\begin{remark}
    This result allows us to define the convolution of any two tempered distributions in a natural way extending the theory of convolution of distributions defined before.
\end{remark}

Now we get to the interesting part of the theory of Schwartz functions. We have defined a homeomorphic linear transform from $\mathcal{S}(\RR^d)$ to itself. The theory of functional analysis then says that we can define a dual map, which is a homeomorphism from the dual space $\SW(\RR^d)^*$ to itself. Note the inclusion map $\DD(\RR^d) \to \mathcal{S}(\RR^d)$ is continuous, and $\DD(\RR^d)$ is dense in $\mathcal{S}(\RR^d)$. This implies that we have an injective, continuous map from $\SW(\RR^d)^*$ to $\DD(\RR^d)^*$, so every functional on the Schwarz space can be identified with a distribution. We call such distributions \emph{tempered}. They are precisely the linear functionals on $\DD(\RR^d)$ which have a continuous extension to $\mathcal{S}(\RR^d)$. Intuitively, this corresponds to having limited growth at infinity.

\begin{example}
    Recall that for any $f \in L^1_{\text{loc}}(\RR^d)$, we can consider the distribution $\Lambda[f]$ defined by setting
    %
    \[ \Lambda[f](\phi) = \int f(x) \phi(x)\; dx. \]
    %
    However, this distribution is not always tempered. If $f \in L^p(\RR^d)$ for some $p$, then, applying H\"{o}lder's inequality, we obtain that
    %
    \[ |\Lambda[f](\phi)| \leq \| f \|_{L^p(\RR^d)} \| \phi \|_{L^q(\RR^d)}. \]
    %
    Since $\| \cdot \|_{L^q(\RR^d)}$ is a continuous norm on $\mathcal{S}(\RR^d)$, this shows $\Lambda[f]$ is bounded. More generally, if $f \in L^1_{\text{loc}}(\RR^d)$, and $f(x) (1 + |x|)^{-m}$ is in $L^p(\RR^d)$ for some $m$, then $\Lambda[f]$ is a tempered distribution. If $p = \infty$, such a function is known as \emph{slowly increasing}.
\end{example}

\begin{example}
    For any Radon measure, $\mu$, we can define a distribution
    %
    \[ \Lambda[\mu](\phi) = \int \phi(x) d\mu(x) \]
    %
    But this distribution is not always tempered. If $|\mu|$ is finite, the inequality $\| \Lambda[\mu](\phi) \| \leq \| \mu \| \| \phi \|_{L^\infty(\RR^d)}$ gives boundedness. More generally, if $\mu$ is a measure such that for some $n$,
    %
    \[ \int_{\RR^d} \frac{d|\mu|(x)}{1 + |x|^n}\; dx < \infty \]
    %
    then $\mu$ is known as a \emph{tempered measure}, and acts as a tempered distribution since
    %
    \begin{align*}
      |\Lambda[\mu](\phi)| &\leq \int_{\RR^d} |\phi(x)|\; d|\mu|(x)\\
      &\leq \left( \int_{\RR^d} \frac{d|\mu|(x)}{1 + |x|^n}\; dx \right) \cdot \| \phi \|_{\mathcal{S}^{0,n}(\RR^d)}.
    \end{align*}
\end{example}

\begin{example}
  Any compactly supported distribution is tempered. Indeed, if $\Lambda$ is a distribution supported on a compact set $K$, then it has finite order $n$ for some integer $n$, and extends to an operator on $C^\infty(\RR^d)$. We then find
  %
  \[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(\RR^d)} \leq \| \phi \|_{\mathcal{S}^{0,n}(\RR^d)}. \]
\end{example}

\begin{example}
  The distribution $\Lambda$ on $\RR$ given by
  %
  \[ \Lambda(\phi) = \text{p.v} \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx \]
  %
  is tempered, since
  %
  \[ \int_{|x| \geq 1} \frac{\phi(x)}{x} \lesssim \| \phi \|_{\mathcal{S}^{1,0}(\RR^d)} \]
  %
  and
  %
  \[ \text{p.v} \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx \lesssim \| \phi \|_{C^1(\RR^d)} = \| \phi \|_{\mathcal{S}^{0,1}(\RR^d)} \]
  %
  and so $\Lambda$ is tempered of order 1. This distribution is called the \emph{(Cauchy) principal value} of $1/x$, often denoted $\text{p.v}(1/x)$.
\end{example}

The derivative of a tempered distribution is tempered, and gives a continuous operator on $\SW(\RR^d)^*$. Multiplication gives a continuous map
%
\[ C^\infty_b(\RR^d) \times \SW(\RR^d)^* \to \SW(\RR^d)^*. \]
%
Furthermore, multiplication by a polynomial is also a continuous operator on $\SW(\RR^d)$, or more generally, by any smooth function whose derivatives are all slowly increasing.

Let us now apply the distributional method to define the Fourier transform of a tempered distribution. Recall that we heuristically think of $\Lambda$ as formally corresponding to a regular function $f$ such that
%
\[ \Lambda(\phi) = \int f(x) \phi(x)\; dx \]
%
The multiplication formula
%
\[ \int_{\RR^d} \widehat{f}(\xi) g(\xi)\; d\xi = \int_{\RR^d} f(x) \widehat{g}(x)\; dx \]
%
gives us the perfect opportunity to move the analytical operations on $f$ to analytical operations on $g$. Thus if $\Lambda$ is the distribution corresponding to a Schwartz $f \in \mathcal{S}(\RR^d)$, the distribution $\widehat{\Lambda}$ corresponding to $\widehat{f}$, then for any Schwartz $\phi \in \mathcal{S}(\RR^d)$,
%
\[ \widehat{\Lambda}(\phi) = \Lambda \left( \widehat{g} \right). \]
%
In particular, this motivates us to define the Fourier transform of \emph{any} tempered distribution $\Lambda$ to be the unique tempered distribution $\widehat{\Lambda}$ such that the equation above holds for all Schwartz $\phi$. This distribution exists because the Fourier transform is an isomorphism on the space of Schwartz functions. Clearly, the Fourier transform is a homeomorphism on the space of tempered distributions under the weak topology, and moreover, satisfies all the symmetry properties that the ordinary Fourier transform does, once we interpret scalar, rotation, translation, differentiation, etc, in a natural way on the space of distributions.

\begin{example}
    Consider the constant function $1$, interpreted as a tempered distribution on $\RR^d$. Then for any $\phi \in \mathcal{S}(\RR^d)$,
    %
    \[ 1(\phi) = \int \phi(x)\; dx, \]
    %
    Thus for any $\phi \in \mathcal{S}(\RR^d)$,
    %
    \[ \widehat{1} \left( \widehat{\phi} \right) = 1(\phi) = \int \phi(\xi)\; d\xi = \widehat{\phi}(0). \]
    %
    Thus $\widehat{1}$ is the Dirac delta function at the origin. Similarily, the Fourier inversion formula implies that
    %
    \[ \widehat{\delta} \left( \widehat{\phi} \right) = \phi(0) = \int \widehat{\phi}(\xi)\; d\xi = 1 \left( \widehat{\phi} \right) \]
    %
    so the Fourier transform of the Dirac delta function is the constant 1 function.
\end{example}

\begin{example}
    Let $u$ denote a compactly supported distribution. We claim that $\widehat{u} \in C^\infty(\RR^d)$ is a smooth function, such that
    %
    \[ \widehat{u}(\xi) = \langle u, e^{-2 \pi i \xi \cdot x} \rangle. \]
    %
    Indeed, formally speaking,
    %
    \[ \langle \widehat{u}, \phi \rangle = \langle u, \widehat{\phi} \rangle = \langle u, \int \phi(x) e^{-2 \pi i \xi \cdot x}\; dx \rangle = \int \phi(x) \langle u, e^{-2 \pi i \xi \cdot x} \rangle\; dx. \]
    %
    The proof that $\widehat{u}$ is smooth follows because we have control of the derivatives of $e^{-2 \pi i \xi \cdot x}$ on the support of $u$. 
\end{example}

\begin{example}
  The theory of tempered distributions enables us to take the Fourier transform of $f \in L^p(\RR^d)$, when $p > 2$ or when $p < 1$. The introduction of distributions is in some sense, essential to this process, because for each $p \not \in [1,2]$, there is $f \in L^p(\RR^d)$ such that $\widehat{f}$ is \emph{not} a locally integrable function. Otherwise, we could define an operator $T: L^p(\RR^d) \to L^1(\RR^d)$ given by
  %
  \[ Tf = \widehat{f} \mathbf{I}_{|\xi| \leq 1}. \]
  %
  If a sequence of functions $\{ f_n \}$ converges to $f$ in $L^p(\RR^d)$, and $Tf_n$ converges to $g$ in $L^1(\RR^d)$, then $Tf_n$ converges distributionally to $g$, which implies $Tf = g$. The closed graph theorem thus implies that $T$ is a continuous operator from $L^p(\RR^d)$ to $L^1(\RR^d)$, so there exists $M > 0$ such that
  %
  \[ \int_{|\xi| \leq 1} |\widehat{f}(\xi)| \leq M \| f \|_{L^p(\RR^d)}. \]
  %
  If $f_\alpha(x) = e^{-\pi \alpha |x|^2}$, then $\widehat{f_\alpha}(\xi) = \alpha^{-d/2} e^{-\pi |x|^2 / \alpha}$. We have
  %
  \begin{align*}
    \| f_\alpha \|_{L^p(\RR^d)} &= \left( \int_{\RR^d} e^{- \pi \alpha p |x|^2}\; dx \right)^{1/p}\\
    &= (\alpha p)^{-d/2p} \left( \int_{\RR^d} e^{- \pi |x|^2}\; dx \right)^{1/p} \lesssim_d (\alpha p)^{-1/2p}.
  \end{align*}
  %
  On the other hand, for $|\xi| \leq 1$, $|\widehat{f_\alpha}(\xi)| \geq \alpha^{-d/2} e^{-\pi/\alpha}$, so
  %
  \[ \int_{|\xi| \leq 1} |\widehat{f_\alpha}(\xi)| \gtrsim_d \alpha^{-d/2} e^{-\pi/\alpha}. \]
  %
  Thus we conclude that $\alpha^{-d/2} e^{-\pi/\alpha} \lesssim_d M (\alpha p)^{-d/2p}$, or equivalently,
  %
  \[ \alpha^{d/2(1/p-1)} e^{-\pi/\alpha} \lesssim_d M p^{-d/2p}. \]
  %
  Taking $\alpha \to \infty$ gives a contradiction if $p < 1$. For $p > 2$, we give the Gaussian an oscillatory factor that does not affect the $L^p$ norm but boosts the $L^1$ norm of the Fourier transform. We set
  %
  \[ g_\delta(x) = \prod_{k = 1}^d \frac{e^{- \pi x_k^2 / (1 + i \delta)}}{(1 + i \delta)^{1/2}}. \]
  %
  The Fourier transform formula of the Gaussian, when applied using the theory of analytic continuation, shows that
  %
  \[ \widehat{g_\delta}(\xi) = \prod_{k = 1}^d e^{- \pi (1 + i \delta) \xi_k^2}. \]
  %
  We have
  %
  \[ \int_{|\xi| \leq 1} |\widehat{g_\delta}(\xi)| = \int_{|\xi| \leq 1} e^{- \pi |\xi|^2} \gtrsim 1. \]
  %
  On the other hand, for $\delta \geq 1$,
  %
  \begin{align*}
    \| g_\delta \|_{L^p(\RR^d)} &= \left( \int |g_\delta(x)|^p\; dx \right)^{1/p}\\
    &= |1 + i \delta|^{-d/2} \left( \int_{-\infty}^\infty e^{- p \pi x^2/(1 + \delta^2)}\; dx \right)^{d/p}\\
    &\lesssim_d \delta^{-d/2} \delta^{d/p} p^{-d/p} = \delta^{d(1/p - 1/2)} p^{-d/p}.
  \end{align*}
  %
  Thus we conclude $1 \lesssim_d M \delta^{d(1/p - 1/2)} p^{d/p}$, which gives a contradiction as $\delta \to \infty$ if $p > 2$.
\end{example}

\begin{example}
  Consider the Riesz Kernel on $\RR^d$, for each $\alpha \in \CC$ with positive real part, as the function
  %
  \[ K_\alpha(x) = \frac{\Gamma(\alpha/2)}{\pi^{\alpha/2}} |x|^{-\alpha}. \]
  %
  Then for $0 < \text{Re}(\alpha) < d$, $\widehat{K_\alpha} = K_{d-\alpha}$. We recall that $\Gamma$ is defined by the integral formula
  %
  \[ \Gamma(s) = \int_0^\infty e^{-t} t^{s-1}\; ds, \]
  %
  where $\text{Re}(s) > 0$. We note that if $p = d/\text{Re}(\alpha)$, $K_\alpha \in L^{p,\infty}(\RR^d)$. The Marcinkiewicz interpolation theorem implies that if $d/2 < \text{Re}(\alpha) < d$, then $K_\alpha$ can be decomposed as the sum of a $L^1(\RR^d)$ function and a $L^2(\RR^d)$ function, and so we can intepret the Fourier transform of $\widehat{K_\alpha}$ using techniques in $L^1(\RR^d)$ and $L^2(\RR^d)$, and moreover, the Marcinkiewicz interpolation theorem implies that
  %
  \[ \| \widehat{K_\alpha} \|_{L^{q,\infty}(\RR^d)} \leq \| K_\alpha \|_{L^{p,\infty}(\RR^d)}. \]
  %
  where $q$ is the dual of $p$. In particualr, the Fourier transform of $K_\alpha$ is a function. We note that $K_\alpha$ obeys multiple symmetries. First of all, $K_\alpha$ is radial, so $\widehat{K_\alpha}$ is also radial. Moreover, $K_\alpha$ is homogenous of degree $-\alpha$, i.e. for each $x \in \RR^d$, $K_\alpha(\varepsilon x) = \varepsilon^{-\alpha} K_\alpha(x)$. This actually uniquely characterizes $K_\alpha$ among all locally integrable functions. Taking the Fourier transform of both sides of the equation for homogeneity, we find
  %
  \[ \varepsilon^{-d} \widehat{K_\alpha}(\xi/\varepsilon) = \varepsilon^{-\alpha} \widehat{K_\alpha}(x). \]
  %
  Thus $\widehat{K_\alpha}$ is homogenous of degree $\alpha - d$. But this uniquely characterizes $\widehat{K_{d-\alpha}}$ out of any distribution, up to multiplicity, so we conclude that for $d/2 < \text{Re}(\alpha) < d$, that $\widehat{K_\alpha}$ is a scalar multiple of $K_{d-\alpha}$. But we know that by a change into polar coordinates, if $A_d$ is the surface area of a unit sphere in $\RR^d$, then
  %
  \begin{align*}
    \int_{\RR^d} K_\alpha(x) e^{- \pi |x|^2}\; dx &= \frac{\Gamma(\alpha/2)}{\pi^{\alpha/2}} \int_{\RR^d} |x|^{-\alpha} e^{-\pi |x|^2}\; dx\\
    &= A_d \frac{\Gamma(\alpha/2)}{\pi^{\alpha/2}} \int_0^\infty r^{d-1-\alpha} e^{- \pi r^2}\; dr\\
    &= A_d \frac{\Gamma(\alpha/2)}{2 \pi^{d/2}} \int_0^\infty s^{(d-\alpha)/2 - 1} e^{-s}\; ds\\
    &= A_d \frac{\Gamma(\alpha/2) \Gamma((d-\alpha)/2)}{\pi^{d/2}}.
  \end{align*}
  %
  But this is also the value of
  %
  \[ \int_{\RR^d} K_{d - \alpha}(x) e^{- \pi |x|^2}, \]
  %
  so we conclude $\widehat{K_\alpha} = K_{d-\alpha}$ if $d/2 < \text{Re}(\alpha) < d$. We could apply Fourier inversion to obtain the result for $0 < \text{Re}(\alpha) < d/2$, but to obtain the case $\text{Re}(\alpha) = d/2$, we must apply something different. For each $s \in \CC$ with $0 < \text{Re}(s) < d$, and for each Schwartz $\phi \in \mathcal{S}(\RR^d)$ we define
  %
  \[ A(s) = \int K_s(\xi) \widehat{\phi}(\xi)\; d\xi = \frac{\Gamma(s/2)}{\pi^{s/2}} \int |\xi|^{-s/2} \widehat{\phi}(\xi)\; d\xi. \]
  %
  and
  %
  \[ B(s) = \int K_{d-s}(\xi) \widehat{\phi}(\xi)\; d\xi = \frac{\Gamma((d-s)/2)}{\pi^{(d-s)/2}} \int |\xi|^{(d-s)/2} \widehat{\phi}(\xi)\; d\xi. \]
  %
  The integrals above converge absolutely for $0 < \text{Re}(s) < d$, and the dominated convergence theorem implies that $A$ and $B$ are both complex differentiable. Since $A(s) = B(s)$ for $d/2 < \text{Re}(s) < d$, analytic continuation implies $A(s) = B(s)$ for all $0 < \text{Re}(s) < d$, completing the proof. For $\text{Re}(\alpha) \geq d$, $K_\alpha$ is no longer locally integrable, and so we must interpret the distribution given by integration by $K_\alpha$ in terms of principal values. The fourier transform of these functions then becomes harder to define.
\end{example}

\begin{example}
  Let us consider the complex Gaussian defined, for a given invertible symmetric matrix $T: \RR^d \to \RR^d$, as $G_T(x) = e^{- i \pi (Tx \cdot x)}$. Then
  %
  \[ \widehat{G_T} = e^{- i \pi \sigma/4} |\det(T)|^{-1/2} G_{-T^{-1}}, \]
  %
  where $\sigma$ is the \emph{signature} of $T$, i.e. the number of positive eigenvalues, minus the number of negative eigenvalues, counted up to multiplicity. Thus we need to show that for any Schwartz $\phi \in \mathcal{S}(\RR^d)$,
  %
  \[ e^{-i \pi \sigma/4} |\det(T)|^{-1/2} \int_{\RR^d} e^{i \pi (T^{-1}\xi \cdot \xi)} \widehat{\phi}(\xi)\; d\xi = \int_{\RR^d} e^{- i \pi (Tx \cdot x)} \phi(x)\; dx. \]
  %
  Let us begin with the case $d = 1$, in which case we also prove the theorem when $T$ is a complex symmetric matrix. If $T$ is given by multiplication by $-iz$, and if $\sqrt{\cdot}$ denotes the branch of the square root defined for all non-negative numbers and positive on the real-axis, then we note that when $z = \lambda i$,
  %
  \[ e^{- i \pi \sigma/4} |\det(T)|^{-1/2} = e^{- i \pi \text{sgn}(\lambda)/4} |\lambda|^{-1/2} = \sqrt{z}. \]
  %
  Thus it suffices to prove the analytic family of identities
  %
  \[ \int_{-\infty}^\infty e^{- (\pi/z) \xi^2} \widehat{\phi}(\xi)\; d\xi = \sqrt{z} \int_{-\infty}^\infty e^{-\pi z x^2} \phi(x)\; dx, \]
  %
  where both sides are well defined and analytic whenever $z$ has positive real part. But we already know from the Fourier transform of the Gaussian that this identity holds whenever $z$ is positive and real, and so the remaining identities follows by analytic continuation. We note that the higher dimensional identity is invariant under changes of coordinates in $SO(n)$. Thus it suffices to prove the remaining theorem when $T$ is diagonal. But then everything tensorizes and reduces to the one dimensional case. More generally, if $T = T_0 - i T_1$ is a complex symmetric matrix, which is well defined if $T_1$ is positive semidefinite, then
  %
  \[ \widehat{G_T} = \frac{1}{\sqrt{i \det(T)}} \cdot G_{-T^{-1}}, \]
  %
  which follows from analytic continuation of the case for real $T$.
\end{example}

\begin{example}
    The \emph{Airy function} on $\RR$ is the tempered distribution defined to be the inverse Fourier transform of $e^{2 \pi i \xi^3 / 3}$, i.e.
    %
    \[ \text{Ai}(x) = \int e^{2 \pi i (\xi^3 / 3 + \xi x)}\; d\xi. \]
    %
    In fact, $\text{Ai}$ is an analytic function on $\RR$. For $\varepsilon > 0$, let $\zeta = \xi + i \varepsilon$. Then
    %
    \[ 2 \pi i \zeta^3 / 3 = (2\pi) \left( i ( \xi^3 / 3 - \varepsilon^2 \xi) - (\varepsilon \xi^2 - \varepsilon^3 / 3) \right). \]
    %
    This shows that for each $\varepsilon > 0$, $e^{2 \pi i (\xi + i \varepsilon)^3 / 3}$ is a tempered distribution. Since
    %
    \[ e^{2 \pi i (\xi + i \varepsilon)^3 / 3} - e^{2 \pi i \xi^3 / 3} = e^{2 \pi i \xi^3 / 3} \left( e^{2 \pi i \varepsilon^2 \xi} e^{- 2 \pi \varepsilon \xi^2 + (2 \pi / 3) \varepsilon^3} - 1 \right).  \]
    %
    Thus these functions converge locally uniformly to zero, and are uniformly bounded, and thus $e^{2 \pi i(\xi + i \varepsilon)^3 / 3}$ converges in the sense of tempered distributions to $e^{2 \pi i \xi^3 / 3}$. But since $e^{2\pi i (\xi + i \varepsilon)^3 / 3}$ decreases exponentially, the Fourier transforms of these distributions are holomorphic in a strip of width $O(\varepsilon)$. TODO: Look up Section 7.6.8 of H\"{o}rmander, Volume 1.
\end{example}

%Thus we conclude that
%
%\[ |\langle \widehat{u}, \phi \rangle| = |\langle u, \widehat{\phi} \rangle| \lesssim \| (1 + |x|)^K \phi \|_{L^\infty(\RR^d)}. \]
%
%Thus $\widehat{u}$ is a distribution of order zero, and thus a measure. But $x^\alpha u$ is a compactly supported distribution for all $\alpha$, which implies that $D^\alpha \widehat{u}$ is a distribution of order zero, and thus a measure. 

\begin{example}
    We know $((-2 \pi i x)^\alpha)^\ft = ((- 2 \pi i x)^\alpha \cdot 1)^\ft = D^\alpha \delta$, which essentially provides us a way to compute the Fourier transform of any polynomial, i.e. as a linear combination of dirac deltas and the distribution derivatives of dirac deltas, which are derivatives evaluated at points.
\end{example}

\begin{example}
    Consider the Hilbert kernel $\Lambda = \text{p.v}(1/x)$. We have seen this distribution is tempered, so we can take it's Fourier transform. Now $x \Lambda = 1$, so the dericative of $\widehat{\Lambda}$ is $- 2 \pi i \delta$, where $\delta$ is the Dirac delta function at the origin. But this means there exists $A$ such that $\widehat{\Lambda}(\xi) = A - 2 \pi i \cdot \mathbf{I}(\xi > 0)$. But $\Lambda(-x) = - \Lambda(x)$, implying that $\widehat{\Lambda}(-\xi) = -\widehat{\Lambda}(\xi)$, and thus $A - 2 \pi i = -A$, i.e. $A = i \pi$. Thus
    %
    \[ \widehat{\Lambda}(\xi) = \pi i - 2 \pi i \cdot \mathbf{I}(\xi > 0) = - i \pi \cdot \text{sgn}(\xi). \]
\end{example}

\begin{theorem}
    If $\mu$ is a finite measure, $\widehat{\mu}$ is a uniformly continuous bounded function with $\| \widehat{\mu} \|_{L^\infty(\RR^d)} \leq \| \mu \|$, and
    %
    \[ \widehat{\mu}(\xi) = \int e(- 2 \pi i x \cdot \xi) d\mu(x) \]
    %
    The function $\widehat{\mu}$ is also smooth if $\mu$ has moments of all orders, i.e. $\int |x|^k d\mu(x) < \infty$ for all $k > 0$.
\end{theorem}
\begin{proof}
    Let $\phi \in \mathcal{S}(\RR^d)$. We must understand the integral
    %
    \[ \int_{\RR^d} \widehat{\phi}(x)\; d\mu(x). \]
    %
    Applying Fubini's theorem, which applies since $\mu$ has finite mass, we conclude that
    %
    \[ \int_{\RR^d} \widehat{\phi}(x)\; d\mu(x) = \int_{\RR^d} \int_{\RR^d} \phi(\xi) e^{-2 \pi i \xi \cdot x} d\mu(x)\; d\xi = \int_{\RR^d} \phi(\xi) f(\xi)\; d\xi, \]
    %
    where
    %
    \[ f(\xi) = \int_{\RR^d} e^{-2 \pi i \xi x} d\mu(x). \]
    %
    Thus $\widehat{\mu}$ is precisely $f$, and it suffices to show that $\| f \|_{L^\infty(\RR^d)} \leq \| \mu \|$, and that $f$ is uniformly continuous. The inequality follows from a simple calculation of the triangle inequality, and the second inequality follows because for some $y$,
    %
    \begin{align*}
      |f(\xi + \eta) - f(\xi)| &= \left| \int_{\RR^d} e^{-2 \pi i \xi \cdot x} (e^{-2 \pi i \eta \cdot x} - 1)\; d\mu(x) \right|\\
      &\leq \int_{\RR^d} |e^{-2 \pi i \eta \cdot x} - 1|\; d|\mu|(x).
    \end{align*}
    %
    As $\eta \to 0$, the dominated convergence theorem implies that this quantity tends to zero, which proves uniform continuity. On the other hand, if $x_i \mu$ is finite for some $i$, then
    %
    \begin{align*}
      \frac{f(\xi + \varepsilon e_i) - f(\xi)}{\varepsilon} &= \int_{\RR^d} e^{-2 \pi i \xi \cdot x} \frac{(e^{- 2 \pi \varepsilon i x_i} - 1)}{\varepsilon} d\mu(x).
    \end{align*}
    %
    We can apply the dominated convergence theorem to show that as $\varepsilon \to 0$, this quantity converges to the classical partial derivative $f_i$, which has the integral formula
    %
    \[ f_i(\xi) = (-2 \pi i) \int_{\RR^d} e^{-2 \pi i \xi \cdot x} x_i d\mu(x), \]
    %
    which is the Fourier transform of $x_i \mu$. Higher derivatives are similar.
\end{proof}

Not being compactly supported, we cannot compute the convolution of tempered distributions with all $C^\infty$ functions. Nonetheless, if $\phi$ is Schwartz, and $\Lambda$ is tempered, then the definition $(\Lambda * \phi)(x) = \Lambda(T_{-x} \phi^*)$ certainly makes sense, and gives a $C^\infty$ function satisfying $D^\alpha(\Lambda * \phi) = (D^\alpha \Lambda) * \phi = \Lambda * (D^\alpha \phi)$ just as for $\phi \in \DD(\RR^d)$. Moreover, $\Lambda * \phi$ is a slowly increasing function; to see this, we know there is $n$ such that
%
\[ |\Lambda \phi| \lesssim \| \phi \|_{\mathcal{S}^{n,m}(\RR^d)}. \]
%
Now for $|y| \geq 1$,
%
\[ \| T_y \phi \|_{\mathcal{S}^{n,m}(\RR^d)} \leq |x-y|^n \leq 2^n (1 + |y|^n) \| \phi \|_{\mathcal{S}^{n,m}(\RR^d)}, \]
%
and so
%
\[ (\Lambda * \phi)(x) = \Lambda(T_{-x} \phi^*) \lesssim_n (1 + |x|^n) \| \phi \|_{\mathcal{S}^{n,m}(\RR^d)}, \]
%
which gives that $\Lambda * \phi$ is slowly increasing. In particular, we can take the Fourier transform of $\Lambda * \phi$. Now for any $\psi \in \mathcal{S}(\RR^d)$ with $\widehat{\psi} \in \DD(\RR^d)$,
%
\begin{align*}
  \int_{\RR^d} \widehat{\Lambda * \phi}(\xi) \psi(\xi)\; d\xi &= \int_{\RR^d} (\Lambda * \phi)(x) \widehat{\psi}(x)\; dx\\
  &= \int_{\RR^d} \Lambda( \widehat{\psi}(x) \cdot T_{-x} \phi^*)\; dx\\
  &= \Lambda \left( \int_{\RR^d} \widehat{\psi}(x) T_{-x} \phi^*\; dx \right)\\
  &= \Lambda \left( \widehat{\psi} * \phi^* \right) = \Lambda \left( \widehat{\psi} * \widehat{\widehat{\phi}} \right)\\
  &= \Lambda \left( \widehat{\psi \widehat{\phi}} \right) = \widehat{\Lambda} \left( \psi \widehat{\phi} \right) = \widehat{\phi} \widehat{\Lambda}(\psi).
\end{align*}
%
We therefore conclude that $\widehat{\Lambda * \phi} = \widehat{\phi} \widehat{\Lambda}$.

Because of the dilation symmetry of the Fourier transform, the family of homogeneous distributions (which are all tempered) is invariant under the Fourier transform. More precisely, the Fourier transform of a distribution on $\RR^d$ which is homogeneous of degree $\sigma$ is a homogeneous distribution of degree $-d - \sigma$.

\begin{lemma}
    If $u$ is homogeneous and $\singsupp(u) \subset \{ 0 \}$, then $\widehat{u}$ is homogeneous, and $\singsupp(\widehat{u}) \subset \{ 0 \}$.
\end{lemma}
\begin{proof}
    Suppose first that $u$ is homogeneous of order $a$, with $\text{Re}(a) < -n$. Then we can write $u = u_0 + u_1$, where $u_0$ is supported in a neighborhood of the origin, and $u_1$ is an integrable function. But the Fourier transform of both of these terms is continuous. Thus $\widehat{u}$ is continuous in this case.

    To upgrade this fact, given any homogeneous function $u$ with $\singsupp(u) \subset \{ 0 \}$, then $D^\alpha u$ is homogeneous with real part less than $-n$ for sufficiently large $\alpha$, and $\singsupp(D^\alpha u) \subset \{ 0 \}$, which implies that $|\xi|^\alpha \widehat{u}$ is continuous, and thus $\widehat{u}$ is continuous away from the origin. But since $x^\beta u$ is homogeneous if $u$ is homogeneous, we conclude that $\widehat{x^\beta u} = D^\beta \widehat{u}$ is continuous in $\RR^n - \{ 0 \}$ for all $\beta$. Thus $\singsupp(\widehat{u}) \subset \{ 0 \}$.
\end{proof}


\section{Kernel Operators}

We have seen that all translation-invariant operators $T: \DD(\RR^d) \to \EC(\RR^d)$ are given by convolution by a distribution. Thus convolutions by a distribution are suitably general to represent all continuous translation-invariant operations. Surprisingly, when studying non translation invariant operators $T$ from $\DD(\RR^d)$ to $\EC(\RR^d)$, or more generally, from $\DD(\Omega_1)$ to $\DD(\Omega_2)^*$ for some open subsets $\Omega_1$ and $\Omega_2$ of $\RR^n$ and $\RR^m$ respectively, we can obtain a similar characterization. Instead of studying operators of the form
%
\[ T\phi(x) = \int \Lambda(x - y) \phi(y)\; dy \]
%
we instead study \emph{kernel} operators of the form
%
\[ T\phi(x) = \int K(x,y) \phi(y)\; dy \]
%
where $K$ is a distribution on $\Omega_2 \times \Omega_1$, acting as a continuous linear operator from $\DD(\Omega_1)$ to $\DD(\Omega_2)^*$ by defining, for $\psi \in \DD(\Omega_2)$,
%
\[ \int \psi(x) (T\phi)(x)\; dx = \int \psi(x) K(x,y) \phi(y)\; dx\; dy, \]
%
i.e. by testing $K$ against $\psi \otimes \phi$. The behaviour of the operator $T$ uniquely determines the distribution $K$, and we call $K$ the \emph{Schwartz kernel} of $T$. In 1953, Schwartz found the surprising result that kernels define all continuous operators from $\DD(\Omega_1)$ to $\DD(\Omega_2)^*$, which explains the prevalence of kernel operators in analysis.

\begin{theorem}
  Let $T: \DD(\Omega_1) \to \DD^*(\Omega_2)$ be a continuous linear operator. Then there exists a unique distribution $K \in \DD^*(\Omega_2 \times \Omega_1)$ such that for $\phi \in \DD(\Omega_1)$ and $\psi \in \DD(\Omega_2)$,
  %
  \[ \int T\phi(x) \psi(x)\; dy = \int K(x,y) \psi(x) \phi(y)\; dx\; dy. \]
\end{theorem}

\begin{remark}
    There are many variants of Schwartz's result:
    %
    \begin{itemize}
        \item Every continuous map $T: \SW(\RR^n) \to \SW(\RR^m)^*$ is given by a distribution kernel $K \in \SW(\RR^m \times \RR^n)^*$. Indeed, the vanilla version of Schwartz's theorem applies in this situation to produce a distribution kernel $K \in \DD(\RR^m \times \RR^n)$, and the fact that $\langle K, \phi \otimes \psi \rangle$ is well defined and bilinearly continuous for any $\phi \in SW(\RR^n)$ and $\psi \in \SW(\RR^m)$ implies that $K$ is actually a tempered distribution.

        \item Any continuous map $T: \EC(\Omega_1)^* \to \EC(\Omega_2)$ is given by a kernel $K \in C^\infty(\Omega_2 \times \Omega_1)$. Any such kernel certainly induces a continuous map of this form. Conversely, if $T$ is given, then the continuity of the map implies that the distribution kernel $K$ induced by the vanilla Schwartz theorem implies that $K \in C(\Omega_1, \EC(\Omega_2))$ since as $y \to y_0$, $\delta_y$ converges in the strong topology to $\delta_{y_0}$, and so $T \delta_y$ converges to $T \delta_{y_0}$ in $\EC(\Omega_2)$. A similar argument shows that $K$ actually lies in $C^\infty(\Omega_1, \loc{C^\infty}(\Omega_2))$, where
        %
        \[ D^\alpha_x D^\beta_y K(x,y) = D^\alpha T \{ D^\beta \delta_y \}. \]
        %
        Thus $K$ is smooth.
    \end{itemize}
    %
    One could also view the characterization of translation invariant operators as convolution operators as a special case of Schwartz's result. When $\Omega_1 = \Omega_2 = \RR^d$ it is sometimes more elegant to work with a representation of kernel operators in \emph{convolution form}, i.e. writing
    %
    \[ T \phi(x) = \int k(x,z) \phi(x-z)\; dz \]
    %
    which is just another way to represent the operators above by considering the change of variables $z = x - y$, i.e. we have $k(x,z) = K(x,x-z)$, or $K(x,y) = k(x,x-y)$. We call $k$ the \emph{Schwartz convolution kernel} associated with the operator $T$. If $k(z)$ is independent of the $x$-variable, then we have $T \phi = k * \phi$, i.e. the operator $T$ is really given by convolution.
    %As another variant, if $K \in C^\infty(\Omega_2 \times \Omega_1)$ is a kernel, then we can define
    %
    %\[ Tu(x) = \int K(x,y) u(y)\; dy \]
    %
    %for any $u \in \mathcal{E}(\Omega_1)^*$, where we interpret the integral in a distributional sense, and then $Tu \in C^\infty(\Omega_2)$ because $u$ is a continuous linear functional, and $K$ can be viewed as an element of $C^\infty(\Omega_2, \loc{C^\infty}(\Omega_1))$. Moreover, the operator then extends to a continuous map
    %
    %\[ T: \EC(\Omega_1)^* \to \loc{C^\infty}(\Omega_2), \]
    %
    %Conversely, if $T: \EC(\Omega_1)^* \to \loc{C^\infty}(\Omega_2)$, then the continuity of $T$ implies that
    %
    %\[ K(x,y) = (T \delta_y)(x) \]
    %
    %lies in $C^\infty(\Omega_2 \times \Omega_1)$. Indeed, it is immediately verified from the continuity of $T$ that $K \in C(\Omega_1, \loc{C^\infty}(\Omega_2))$ since as $y \to y_0$, $\delta_y$ converges in the strong topology to $\delta_{y_0}$, and so $T \delta_y$ converges to $T \delta_{y_0}$ in $\loc{C^\infty}(\Omega_2)$. A 
\end{remark}

\begin{proof}
    Since Schwartz kernels act via a tensor product, understanding the Schwartz kernel theorem requires an understanding of these tensor products. The key property here is that $\DD^*$ is \emph{nuclear}. If $X$ and $Y$ are complete locally convex spaces, $X$ is barelled, and $X^*_b$ is nuclear, then $L_b(X,Y)$ is isomorphic to the topological tensor product
    %
    \[ X^* \CT Y. \]
    %
    But this is \emph{precisely} what the theorem of Schwartz is saying.
\end{proof}

\begin{remark}
    The fact that, e.g. the spaces $L^2(\Omega)$ are \emph{not} nuclear spaces (no infinite dimensional norm space can be nuclear) is one reason why, for instance, there are continuous linear operators $T: L^2(\Omega_1) \to L^2(\Omega_2)$ for which there does not exist a kernel $K \in L^2(\Omega_2 \times \Omega_1)$ such that
    %
    \[ Tf(x) = \int K(x,y) f(y)\; dy, \]
    %
    i.e. the class of Hilbert-Schmidt operators does not constitute the class of all continuous operators in the $L^2$ norm.
\end{remark}

Given an operator $T: \DD(\Omega_1) \to \DD(\Omega_2)^*$ with associated kernel $K(x,y)$, we can consider the transpose operator $T^t: \DD(\Omega_2) \to \DD(\Omega_1)^*$ given by the kernel $K(y,x)$. Then
%
\[ \langle T\phi, \psi \rangle = \int K(x,y) \psi(x) \phi(y)\; dx\; dy = \langle \phi, T^* \psi \rangle. \]
%
Thus $T^t$ is formally adjoint to $T$, in some sense. In particular, if we consider the adjoint $T^*: \DD(\Omega_2)^{**} \to \DD(\Omega_1)^*$, then $T^* \phi = T^t \phi$ for each $\phi \in \DD(\Omega_2)$.

Looking at the properties of kernels defining an operator is often a useful technique to gain insight in how an operator behaves, since one can study the singularities and smoothness of the kernel separately from the operator itself. A basic result along this form is that an operator $T$ has Schwartz kernel $K$, then for any test function $\phi$, $\text{supp}(T\phi) \subset \text{supp}(K) \circ \text{supp}(\phi)$. Let us consider some more general properties of operator that can be defined in terms of the kernel $K$ of the operator.

\begin{theorem}
    Let $T: \DD(\Omega_1) \to \DD(\Omega_2)^*$ be an operator with Schwartz kernel $K \in \DD(\Omega_2 \times \Omega_1)^*$:
    %
\begin{itemize}
    \item[(i)] $T$ maps $\DD(\Omega_1)$ into $\EC(\Omega_2)$ if and only if $K \in C^\infty(\Omega_2, \DD(\Omega_1)^*)$.

    \item[(ii)] $T$ extends to a continuous linear operator from $\EC(\Omega_1)^*$ to $\DD(\Omega_2)^*$ if and only if $K \in C^\infty(\Omega_1, \DD(\Omega_2)^*)$.

    \item[(iii)] $K$ is called \emph{separately regular} if it is an element of
    %
    \[ C^\infty(\Omega_1, \DD(\Omega_2)^*) \cap C^\infty(\Omega_2, \DD(\Omega_1)^*). \]
    %
    Then $K$ is completely regular if and only if $T$ maps $\DD(\Omega_1)$ into $\EC(\Omega_2)$, and extends to a map from $\EC(\Omega_1)$ to $\DD(\Omega_2)^*$.

    \item[(iv)] Suppose $\Omega_1 = \Omega_2$ is the same open set $\Omega$. Then $K$ is called \emph{very regular} if it is separately regular, and agrees with a $C^\infty$ function away from the diagonal
    %
    \[ \Delta = \{ (x,x) : x \in \Omega \}. \]
    %
    If $K$ is very regular, then $T$ is \emph{pseudolocal}, i.e. for any compactly supported distribution $u$, $\singsupp(Tu) \subset \singsupp(u)$.

    To make a remark, an operator $T: \DD(\Omega) \to \EC(\Omega)^*$ is called \emph{local} if $\text{supp}(Tu) \subset \text{supp}(u)$ for any $u \in \DD(\Omega)^*$. It is a result of Peetre that any local operator (continuous or non continuous) is a partial differential operator with coefficients in $\DD(\Omega)^*$.

    \item[(v)] We say $T$ is \emph{smoothing}, or \emph{regularizing}, if $T$ extends to a map from $\mathcal{E}(\Omega_2)^*$ to $C^\infty(\Omega_1)$. Then $T$ is smoothing if and only if $K \in C^\infty(\Omega_2 \times \Omega_1)$.

    \item[(vi)] We say $T$ is \emph{proper} if $T$ maps $\DD(\Omega_1)$ into $\EC(\Omega_2)^*$, and $T^t$ maps $\DD(\Omega_2)$ into $\EC(\Omega_1)^*$. This holds if and only if for any $\phi \in \DD(\Omega_1)$ and $\psi \in \DD(\Omega_2)$, $K \phi$ and $\psi K$ are in $\EC(\Omega_2 \times \Omega_1)^*$, or equivalently, if for any precompact open set $U \Subset \Omega_1$, there is a precompact open set $V \Subset \Omega_2$ such that if $\text{supp}(\phi) \subset U$, then $\text{supp}(T \phi) \subset V$, and conversely, for each such $V$, there is $U$ such that if $\text{supp}(\psi) \subset V$, then $\text{supp}(T^t \psi) \subset U$.

    Under the assumption that both (ii) and (vi) holds, i.e. $K \in C^\infty(\Omega_1, \DD(\Omega_2)^*)$ and $T$ is proper, the operator $T$ extends to a map from $\DD(\Omega_1)^*$ to $\DD(\Omega_2)^*$
\end{itemize}

\end{theorem}
\begin{proof}
    Let us begin with the proof of (i). Suppose $K \in C^\infty(\Omega_2, \DD(\Omega_1)^*)$. If $\phi \in \DD(\Omega_1)$, then the function
    %
    \[ u(x) = \int K(x,y) \phi(y)\; dy \]
    %
    then lies in $\EC(\Omega_2)$, since one calculates that
    %
    \[ D^\alpha u(x) = \int (D^\alpha K)(x,y) \phi(y)\; dy. \]
    %
    Conversely, if $T$ maps $\DD(\Omega_1)$ into $\EC(\Omega_2)$, then for any $\phi$,
    %
    \[ \int \frac{K(x + \delta e_i ,y) - K(x,y)}{\delta} \phi(y)\; dy = \int \Delta_{y_i,\delta} K(x,y) \phi(y)\; dy \]
    %
    converges locally uniformly in $x$ to $D^i T\phi(x)$. Thus $\{ \Delta_{y_i, \delta} K \}$ converges in the weak $*$ topology to $D^i T$, and the uniform boundedness theorem implies that it actually converges in the strong topology to $D^i T$, and that $D^i T: \DD(\Omega_1) \to \DD(\Omega_2)^*$ is continuous for all $i$. The Schwartz kernel of $D^i T$ is clearly the derivative $D^i K$, where $K$ is viewed as a map from $\DD(\Omega_1)$ to $\DD(\Omega_2)^*$. Iterating this argument shows that $K \in C^\infty(\DD(\Omega_1), \DD(\Omega_2)^*)$.

    Now let us prove (ii). Suppose $K \in C^\infty(\Omega_1, \DD(\Omega_2)^*)$. Then (i) implies that $T^t$ maps $\DD(\Omega_2)$ into $\EC(\Omega_1)$. Taking adjoints shows that the adjoint of $T^t$ is an extension of $T$ to a continuous map from $\EC(\Omega_1)^*$ to $\DD(\Omega_2)^*$. Conversely, if $T$ extends to a continuous map from $\EC(\Omega_1)^*$ to $\DD(\Omega_2)^*$, then it is simple to prove that if $K$ is the kernel of $T$, then $K(x,y) = T \delta_y(x)$, and thus lies in $C^\infty(\Omega_1, \DD(\Omega_2)^*)$.

    Result (iii) follows immediately from (i) and (ii).

    To prove result (iv), we note that if $K$ is very regular, then $T$ maps $\DD(\Omega)$ into $\EC(\Omega)$. Furthermore, if $\tilde{K} \in C^\infty(X^2 - \Delta)$ is the smooth function agreeing with $K$ away from the origin, then for any $u \in \EC(\Omega)^*$, and any $x \not \in \text{supp}(u)$,
    %
    \[ Tu(x) = \int K(x,x') u(x')\; dy = \int \tilde{K}(x,x') u(x')\; dy. \]
    %
    The right hand side defines a smooth function of $x$ for $x \in \Omega - \text{supp}(u)$. But this gives us the initial estimate $\singsupp(Tu) \subset \text{supp}(u)$. To prove the full statement, if $u \in \EC(\Omega)^*$, and $x_0 \not \in \singsupp(u)$, then there is $\phi \in \DD(\Omega)$ which equals one in a neighborhood $U$ of $x_0$, such that $\phi u \in \DD(\Omega)$. Thus $T(\phi u) \in \EC(\Omega)$. But $\text{supp}((1 - \phi) u)$ does not contain $x_0$, which implies that $x_0$ does not lie in $\singsupp(T((1 - \phi)u))$. But this means that both $T(\phi u)$ and $T((1 - \phi)u)$ are both smooth in a neighborhood of $x_0$, which means the same is true of $Tu$. Thus $x_0 \not \in \singsupp(Tu)$.

    We have already proved (v) in a remark following the statement of the Schwartz kernel theorem.

    The first part of the proof of (vi) is left to the reader. The assumptions of (ii) imply $T^t$ maps $\DD(\Omega_2)$ to $\EC(\Omega_1)$ continuously, and the assumptions of (vi) imply that $T^t$ maps $\DD(\Omega_2)$ to $\EC(\Omega_1)^*$ continuously. Taking both these properties into account, we conclude that $T^t$ maps $\DD(\Omega_2)$ into $\DD(\Omega_1)$ continuously. But taking adjoints gives an extension of $T$ as a continous map from $\DD(\Omega_1)^*$ to $\DD(\Omega_2)^*$.
\end{proof}
%
The pseudodifferential operators we will study later are very regular, so in particular, pseudolocal. In fact, they are \emph{microlocal}, in the sense that they never expand the \emph{wavefront set} of an operator, a subtle refinement of the singular support of a function.




\section{Test Functions on a Manifold}

For a general smooth manifold $M$, it is unnatural to define the space of test functions $\DD(M)$ to be $C_c^\infty(M)$. This is because there is no natural inclusion map from $C^\infty(M)$ to this dual, given that there is no natural definition of integration on a manifold $M$. Thus one cannot naturally think of the dual of $C_c^\infty(M)$ as being a space of `generalized functions' on $M$.

We remedy this, we work with \emph{scalar densities} rather than scalar-valued functions. Recall that on any manifold $M$, we can define a line bundle $\text{Vol}(TM)$, and scalar densities are sections of this line bundle. In coordinates, a scalar density corresponds to a family of functions $\omega_x \in C^\infty(U)$ for each coordinate chart $(x,U)$, such that for any other coordinate chart $(y,V)$, on $U \cap V$,
%
\[ \omega_y = \omega_x \cdot \left| \det \left( \frac{\partial y^i}{\partial x^j} \right) \right|. \]
%
We define $\DD(M)$ to be the space of all compactly supported smooth scalar densities, which we can equip with a natural locally convex structure analogous to the topology on the space of test functions in Euclidean space. Given any $f \in C^\infty(M)$, and any $\omega \in \mathcal{D}(M)$, the quantity
%
\[ \langle f, \omega \rangle = \int_M f \cdot \omega \]
%
is well defined, where the integral on the right is defined by working in local coordinates. Moreover, the map $\omega \mapsto \langle f, \omega \rangle$ is then a continuous linear functional on $\mathcal{D}(M)$. Thus we have a continuous inclusion $C^\infty(M) \to \mathcal{D}(M)^*$, which means it makes sense to define $\mathcal{D}(M)^*$ be the space of generalized functions on $M$.

\begin{remark} 
    If it helps to think more generally, given a smooth line bundle $E$ over $M$, we define $\mathcal{D}(M,E)$ to be the space of all smooth, compactly supported sections of $E^*$, the \emph{dual} line bundle to $E$. Then the space $\Gamma(E)$ of all smooth sections of $E$ is naturally included in $\mathcal{D}(M,E)^*$, which we call the space of \emph{generalized sections} of $E$.

    As an example, we can consider the line bundle $\text{Vol}^\alpha(TM)$ for each $0 \leq \alpha \leq 1$, whose sections $\omega$ consist of \emph{scalar densities of order $\alpha$}, which transform in coordinates via the relation
    %
    \[ \omega_y = \omega_x \cdot \left| \det \left( \frac{\partial y^i}{\partial x^j} \right) \right|^\alpha. \]
    %
    Thus $\text{Vol}(TM) = \text{Vol}^1(TM)$, and $TM = \text{Vol}^0(TM)$. The dual bundle to $\text{Vol}^\alpha(TM)$ can naturally be identified with $\text{Vol}^{1-\alpha}(TM)$ since if $\omega$ is a scalar density of order $\alpha$, and $\eta$ is a scalar density of order $1 - \alpha$, then $\omega \eta$ is a scalar density of order one, and thus can be integrated on $M$ in an invariant manner. Thus we can define the space $\mathcal{D}^\alpha(M)^*$ of generalized scalar densities of order $\alpha$ to be the dual to the space of compactly supported scalar densities of order $1 - \alpha$.
\end{remark}

Much of the basic theory of distributions follows for distributions on manifolds. In particular, a version of the Schwartz kernel theorem holds, i.e. for any smooth manifolds $M$ and $N$, and any continuous linear operator $T: \DD(M) \to \DD(N)^*$, there exists a generalized section $K$ of $\text{Vol}(M) \oplus TN$ such that for any smooth, compactly supported function $f$ on $M$, we formally have
%
\[ Tf(x) = \int K(x,y) f(y)\; dy, \]
%
in the sense that for any smooth, compactly supported scalar density $\omega$ on $N$,
%
\[ \langle Tf, \omega \rangle = \int \omega(x) K(x,y) f(y)\; dx\; dy. \]
%
The idea of the proof is to work locally in coordinates, applying the Schwartz kernel theorem in Euclidean space, and then noting that the kernels patch together if we viwe them as sections of $\text{Vol}(M) \oplus TN$.

It is more difficult to see how one would build a canonical definition of the space $\mathcal{S}^*(M)$ of tempered distributions on a manifold $M$, because there is no natural direction to measure the rate of decay of a function. Thus it is often wiser to do the things one does in Schwartz space (e.g. Fourier-type arguments) by applying a partition of unity so that we may assume our distributions are compactly supported.

\section{Paley-Wiener Theorem}

TODO: See Rudin, Functional Analysis, or Treves, Chapter 29, or H\"{o}rmander Vol 1, Section 7.3.

\begin{theorem}
    Let $K \subset \RR^n$ be a convex, compact subset with supporting function $H$. If $u$ is a distribution of order $m$, supported on $K$, then the Fourier transform of $u$ is pointwise defined by
    %
    \[ \widehat{u}(\xi) = \langle u, e^{- 2 \pi i \xi \cdot x} \rangle = \int u(x) e^{-2 \pi i \xi \cdot x}. \]
    %
    Moreover, this integral formula gives an extension of $\widehat{u}$ to an entire function on $\CC^n$, and
    %
    \[ |\widehat{u}(\xi)| \lesssim (1 + |\xi|)^N e^{2 \pi H(\text{Im}(\xi))}. \]
    %
    Conversely, any entire function $f: \CC^n \to \CC$ satisfying estimates of the form
    %
    \[ |f(\xi)| \lesssim (1 + |\xi|)^N e^{2 \pi H(\text{Im}(\xi))} \]
    %
    is tempered, and it's inverse Fourier transform is supported on $K$. In particular, if $f$ satisfies estimates of the form
    %
    \[ |f(\xi)| \lesssim_N (1 + |\xi|)^{-N} e^{2 \pi H(\text{Im}(\xi))} \]
    %
    for all $N > 0$, then the inverse Fourier transform of $f$ is smooth and compactly supported on $K$.
\end{theorem}
\begin{proof}
    Suppose $u$ is a distribution of order $N$ supported on $K$. For each $\delta > 0$, define a smooth function $\chi_\delta$ supported on $K_\delta$, equal to one on $K_{\delta/2}$, and with $\| \partial^\alpha \chi_\delta \| \lesssim_\alpha \delta^{-|\alpha|}$. Then
    %
    \begin{align*}
        |\widehat{u}(\xi)| &= \int u(x) \chi_\delta(x) e^{-2 \pi i \xi \cdot x}\\
        &\lesssim \sup_{|\alpha| \leq N} \| \partial^\alpha_x \left\{ \chi_\delta e^{-2 \pi i \xi \cdot x} \right\} \|\\
        &\lesssim e^{2 \pi H(\text{Im}(\xi)) + \delta |\text{Im}(\xi)|} \sum_{i = 0}^N \delta^{-i} (1 + |\xi|)^{N-i}.
    \end{align*}
    %
    Taking $\delta = (1 + |\xi|)^{-1}$ gives the result.

    Conversely, let us begin with the case where $f$ satisfies the decay estimates for all $N > 0$, and show this it's Fourier transform is smooth and compactly supported on $K$. Then we can define the inverse Fourier transform pointwise via the integral formula
    %
    \[ u(x) = \int f(\xi) e^{2 \pi i \xi \cdot x}. \]
    %
    To prove that $u$ is supported on $K$, we note that we can perform a contour shift, writing
    %
    \[ u(x) = \int f(\xi + i \eta) e^{2 \pi i (\xi + i \eta) \cdot x}. \]
    %
    Applying the required decay estimate with $N = n+1$ gives
    %
    \[ |u(x)| \leq e^{2 \pi (H(\eta) - \eta \cdot x)} \int (1 + |\xi|)^{-n-1}\; d\xi \]
    %
    Thus if, for a given $x$, there exists $\eta$ with $H(\eta) \leq \eta \cdot x$, then scaling $\eta$ gives $u(x) = 0$. But if $H(\eta) \geq \eta \cdot x$ for all $\eta \in \RR^d$, it follows that $x \in K$.

    Now we consider the general case. Consider an entire function $f$ satisfying estimates of the form above for a fixed $N$, and let $u$ denote it's Fourier transform. Consider a smooth function $\phi$ supported in the unit ball, with $\int \phi(x)\; dx = 1$, and let $\phi_\delta(x) = \delta^{-n} \phi(x/\delta)$. Then the inverse Fourier transform of $f_\delta(\xi) = f(\xi) \widehat{\phi}(\delta \xi)$ is $u * \phi_\delta$. Now because $\phi$ is supported in a unit ball, it's Fourier transform has the estimates proved above, and so in particular,
    %
    \[ |f_\delta(\xi)| \lesssim_M (1 + |\xi|)^{N-M} e^{2 \pi (H(\text{Im}(\eta)) + \delta |\text{Im}(\xi)|)}. \]
    %
    Thus by the last paragraph, we conclude that $u * \phi_\delta$ is supported on $K_\delta$, and taking $\delta \to 0$ completes the proof since $u * \phi_\delta$ converges to $u$ distributionally.
\end{proof}


\section{Hyperfunctions}

TODO: Treves Chapter 22, and H\"{o}rmander 7.3,7.4,7.5,8.4,8.5,8.6,8.7,Chapter 9.







\chapter{Microlocal Analysis of Singularities}

Suppose $u$ is a distribution on $\RR^d$. The \emph{singular support} of $u$ is the set of points $x_0 \in \RR^d$ which \emph{do not} have an open neighbourhood upon which $u$ acts as integration against a $C^\infty$ function. Understanding the singular support of a distribution, and how to control it, is often a useful perspective in harmonic analysis; to reduce the study of $u$ to the study of a $C^\infty$ function one need only smoothen around the singular support of $u$.

The smoothess of a distribution is linked to the decay of it's Fourier transform. In particular, suppose there is a compactly supported bump function $\phi \in C^\infty(\RR^d)$ with $\phi(x) = 1$ in a neighbourhood of some point $x_0 \in \RR^d$. Since $\phi u$ is compactly supported, the Paley-Wiener theorem implies $\widehat{\phi u}$ is an entire function with polynomial growth at infinity. The Fourier inversion formula implies that $\phi u \in \DD(\RR^d)$ if and only if for all $N \geq 0$, $|\widehat{\phi u}(\xi)| \lesssim_N |\xi|^{-N}$. Thus we can infer the singular support of $u$ via purely spectral means, provided we localize about a point.

We can therefore gain more detailed information about singularities of a distribution $u$ through the Fourier transform. If $x_0$ is a singularity of $u$, then for any bump function $\phi \in C^\infty(\RR^d)$ with $\phi(x) = 1$ in a neighbourhood of $x_0$, there must exist some direction in frequency space on which $\widehat{\phi u}$ does not decay. However, this does not mean that $\phi$ is unable to decay in certain directions; there might exist a conical neighbourhood $U$ about the origin containing some frequency $\xi_0$ such that for all $\xi \in U$ and all $N > 0$,
%
\begin{equation} \label{nonsingularfourierdecay}
  |\widehat{u \phi}(\xi)| \lesssim_N |\xi|^{-N}.
\end{equation}
%
the set of values $\xi_0$ which do \emph{not} satisfy \eqref{nonsingularfourierdecay} for any choice of bump function $\phi$ about $x_0$ forms a closed conical subset of $\RR^d$, and we call this the \emph{wavefront} of $u$ about the singularity $x_0$. The set
%
\[ \text{WF}(u) = \{ (x_0,\xi_0) : \xi_0\ \text{is in the wavefront of $u$ at $x_0$} \} \]
%
is the \emph{wavefront set} of the distribution, and provides a deeper characterization of the singularities of $u$. For instance, in order to smoothen out a distribution $u$ one need only average along the directions in the wave-front set. This is the beginning of \emph{microlocal analysis}, localization not only in space, but also localization in a conic subset of space / frequency, e.g. the tangent bundle. This chapter will show the advantage of a microlocal mindset.

\begin{remark}
    The term \emph{wavefront set} was used to bring analogy to the to the theory of Huygens on wave propogation. If one knows the location and tangent plane to a wave, then it is translated along the normal direction to the plane. We will later see that if the principal symbol of a constant coefficient linear partial differential operator is real, then the wavefront set of linear partial differential equations is invariant under the bicharacteristic flow of this operator, which in the case of the wave equation, gives Huygen's theory as a special case.
\end{remark}

Let us now discuss the wavefront set a little more precisely. If $u$ is a compactly supported distribution on $\RR^d$, we define $\Gamma(u)$ to be the set of $\xi_0 \in \RR^d$ which have no conical neighbourhood $U$ such that for each $N > 0$ and $\xi \in U$,
%
\begin{equation} \label{fastDecayEquation}
    |\widehat{u}(\xi)| \lesssim_N |\xi|^{-N}.
\end{equation}
%
A compactness argument justifies that if $\Gamma(u) = \emptyset$, then $u \in C^\infty(\RR^d)$.

\begin{lemma} \label{wavefrontlocalizationlemma}
  If $u$ is a compactly supported distribution and $\phi \in \DD(\RR^d)$, then
  %
  \[ \Gamma(\phi u) \subset \Gamma(u). \]
\end{lemma}
\begin{proof}
  Suppose $\xi_0 \not \in \Gamma(u)$, so $\xi_0$ has a conical neighbourhood $U$ such that \eqref{fastDecayEquation} holds. Then there exists $\varepsilon > 0$ such that $U$ contains
  %
  \[ \left\{ \eta \in \RR^d : \frac{\xi_0 \cdot \eta}{|\xi_0| |\eta|} \geq 1 - 2\varepsilon \right\} \]
  %
  Let $V$ be the conical neighbourhood of $\xi_0$ defined by setting
  %
  \[ V = \left\{ \eta \in \RR^d : \frac{\xi_0 \cdot \eta}{|\xi_0| |\eta|} \geq 1 - \varepsilon \right\}. \]
  %
  We claim $V$ satisfies \eqref{fastDecayEquation}. Fix $\xi \in V$. Then
  %
  \[ |\widehat{\phi u}(\xi)| = (\widehat{\phi} * \widehat{u})(\xi) = \int_{\RR^d} \widehat{\phi}(\eta) \widehat{u}(\xi - \eta)\; d\xi. \]
  %
  If $|\xi - \eta| \leq 0.25 \varepsilon |\xi|$, then it is simple to verify that
  %
  \[ (\xi_0 \cdot \eta) \geq (1 - 2\varepsilon) |\xi_0| |\eta| \]
  %
  so $\eta \in U$. Thus for any $N > 0$, $\widehat{u}(\eta) \lesssim_N 1/(1 + |\eta|)^N$. Since $\phi \in L^\infty(\RR^d$, we conclude
  %
  \begin{align*}
    \int_{|\eta| \leq 0.25 \varepsilon |\xi|} \widehat{\phi}(\eta) \widehat{u}(\xi - \eta)\; d\xi &\lesssim_{\phi} \int_{|\eta| \leq 0.25 \varepsilon |\xi|} \frac{1}{1 + |\xi - \eta|^N}\\
    &\lesssim_{\varepsilon,d} \frac{|\xi|^d}{(1 + 2 |\xi|^{N})} \lesssim \frac{1}{1 + |\xi|^{N-d}}.
  \end{align*}
  %
  On the other hand, since $u$ is compactly supported, $\widehat{u}$ is slowly increasing, i.e. there exists $m > 0$ such that
  %
  \[ |\widehat{u}(\xi)| \leq 1 + |\xi|^m. \]
  %
  Since $\phi \in \DD(\RR^d)$, we have $|\widehat{\phi}(\eta)| \lesssim_M 1/(1 + |\eta|^M)$ for all $M > 0$ and thus we conclude that if $M > m + d$
  %
  \begin{align*}
    \int_{|\eta| \geq 0.25 \varepsilon |\xi|} \widehat{\phi}(\eta) \widehat{u}(\xi - \eta) &\lesssim_M \int_{|\eta| \geq 0.25 \varepsilon |\xi|} \frac{1 + |\xi - \eta|^m}{1 + |\eta|^M}\\
    &\lesssim_{\varepsilon,m} \int_{|\eta| \geq 0.25 \varepsilon |\xi|} \frac{1 + |\eta|^m}{1 + |\eta|^M}\\
    &\lesssim_{\varepsilon,d} \frac{1}{1 + |\xi|^{M-m-d}}.
  \end{align*}
  %
  Choosing the parameter $M$ and $N$ appropriately, we obtain the required bound which shows that $\xi_0 \not \in \Gamma(\phi u)$.
\end{proof}

This fact means that for each distribution $u$, and any pair of distributions $\phi_1,\phi_2 \in \DD(\RR^d)$ such that $\text{supp}(\phi_2)$ is contained in the interior of the support of $\phi_1$, then $\phi_2/\phi_1 \in \DD(\RR^d)$, and so we conclude that
%
\[ \Gamma(\phi_2 u) = \Gamma((\phi_2/\phi_1) \phi_1 u) \subset \Gamma(\phi_1 u). \]
%
Thus if $u$ is a distribution, and $x \in \RR^d$, then we define $\Gamma_x(U)$ to be equal to
%
\[ \bigcap \left\{ \Gamma(\phi u) : \phi \in \DD(\RR^d), x \in \text{supp}(\phi) \right\}. \]
%
If $\{ \phi_n \}$ is a sequence in $\DD(\RR^d)$ such that $\text{supp}(\phi_{n+1})$ is compactly supported in $\text{supp}(\phi_n)$ for each $n$, and if $\bigcap \text{supp}(\phi_n) = \{ x \}$, then $\Gamma_x(u) = \lim_{n \to \infty} \Gamma(\phi_n u)$. Finally, we define
%
\[ \text{WF}(u) = \{ (x,\xi): \xi \in \Gamma_x(u) \}. \]
%
This is the \emph{wavefront set} of $u$.

\begin{remark}
    The theory of wavefront sets can also be defined via a sheaf theoretic framework. The distributions on a manifold form a sheaf $\DD^*$, since one can restrict and glue distributions defined on open subsets of a manifold. Similarily, the smooth functions on a manifold form a sheaf $C^\infty$, which is a subsheaf of $\DD^*$. Thus we can consider the quotient sheaf $\mathcal{F} = \DD^* / C^\infty$. The support of a distribution in $\mathcal{F}$ is then precisely the singular support of that distribution. Given a manifold $M$, we can consider a natural sheaf on $T^*M$. For each open set $U \subset T^* M$, we consider the family of all distributions on $M$, modulo the space of distributions $u$ with $\text{WF}(u) \cap U = \emptyset$. This is called the \emph{sheaf of microdistributions on $M$}. The support of a distribution in this sheaf is precisely the wavefront set of the distribution.
\end{remark}

\begin{lemma}
    If $u$ is a distribution, then $\pi_x(\text{WF}(u))$ is the singular support of $u$. If $u$ is compactly supported, then $\pi_\xi(\text{WF}(u)) = \Gamma(u)$.
\end{lemma}
\begin{proof}
    Fix $x_0 \in \RR^d$. If $(x_0,\xi_0) \not \in \text{WF}(u)$ for all $\xi_0 \in \RR^d$, then there exists $\phi \in \DD(\RR^d)$ such that $\phi(x_0) \neq 0$ and $\Gamma(\phi u) = \emptyset$. But this means $\phi u \in \DD(\RR^d)$, so $x_0$ is not in the singular support of $u$. This shows $\pi_x(\text{WF}(u))$ is a subset of the singular support. The converse is obvious.

    On the other hand, let us assume $u$ is compactly supported, and that $\xi_0 \not \in \Gamma(u)$. Then $(x_0,\xi_0) \not \in \text{WF}(u)$ for any $x_0 \in \RR^d$ since $\Gamma(\phi u) \subset \Gamma(u)$ for any $\phi \in \DD(\RR^d)$. But if $(x_0.\xi_0) \not \in \text{WF}(u)$ for any $x_0 \in \RR^d$ we can cover the support of $u$ by a partition of unity $\phi_1,\dots,\phi_N \in \DD(\RR^d)$ such that $\xi_0 \not \in \Gamma(\phi_i u)$ for each $i$, and summing up shows $\xi_0 \not \in \Gamma(u)$.
\end{proof}

\begin{example}
  Suppose $u$ is a homogenous distribution which is $C^\infty$ away from the origin. Then $\widehat{u}$ is homogenous and $C^\infty$ away from the origin, and we claim that
  %
  \[ \text{WF}(u) = \{ (0,\xi): \xi \in \text{supp}(\widehat{u}) \} = \{ 0 \} \times \Gamma(u). \]
  %
  Since the singular support of $u$ is $\{ 0 \}$, we know $\text{WF}(u) \subset \{ 0 \} \times \RR^d$, and so it suffices to calculate $\Gamma_0(u)$. Fix a non-negative radial function $\phi \in \DD(\RR^d)$ such that $\widehat{\phi}$ is a non-negative Schwartz function with total mass one. Let $\phi_t(x) = \phi(tx)$, let $\psi(\xi) = \widehat{\phi}(\xi)$, and let $\psi_t(\xi) = \widehat{\phi_t}(\xi) = t^{-d} \psi(\xi/t)$. Set $u_t = \psi_t u$. Then
  %
  \[ \Gamma_0(u) = \lim_{t \to \infty} \Gamma(u_t). \]
  %
  If $v$ is the homogeneous distribution given by the Fourier transform of $u$, and $v_t$ is the Fourier transform of $u_t$, then
  %
  \[ v_t = \widehat{\phi_t u} = \psi_t * v. \]
  %
  Since $\phi_t u$ is no longer homogeneous, neither are the distributions $\{ v_t \}$. But they do satisfy the homogeneity relations
  %
  \[ v_t(\xi) = (t/r)^s \text{Dil}_{t/r} v_r \]
  %
  for any $t,r > 0$. In particular, we see from this that $\Gamma(u_t) = \Gamma(u_r)$ for all $t,r > 0$. Thus $\Gamma_0(u) = \Gamma(u_t)$ for any $t > 0$. If $v$ vanishes in a neighborhood of $\xi_0$, then it vanishes in a conical neighborhood of $\xi_0$. It thus follows that $v_t$ vanishes in a conical neighborhood of $\xi_0$ if we pick $t$ to be sufficiently small, and thus $\xi_0 \not \in \Gamma(u_t) = \Gamma_0(u)$. Conversely, if $\xi_0 \not \in \Gamma_0(u)$, then for all $t > 0$, there is an open cone $U_t \subset \RR^d$ containing $\xi_0$ such that $|v_t(\eta)| \lesssim_{t,N} |\eta|^{-N}$ for all $\eta \in U_t$. The homogeneity relation above implies that we actually have
  %
  \[ |v_t(\eta)| \lesssim_N t^{N + |s|} |\eta|^{-N}. \]
  %
  for all $\eta \in U_1$. As $t \to 0$, $|v_t(\eta)| \to |v(\eta)|$, and if $N$ is taken larger than $|s|$ in the inequality above, this implies that
  %
  \[ |v(\eta)| \lesssim_N \limsup_{t \to 0} t^{N + |s|} |\eta|^{-N} = 0. \]
  %
  Thus $v(\eta) = 0$ for all $\eta \in U_1$, so in particular, $\xi_0 \not \in \text{supp}(v)$.
\end{example}

  Here are some special cases of the above example:
  %
  \begin{itemize}
    \item If $\delta$ is the Dirac delta distribution at the origin in $\RR^d$, then $\widehat{\delta}$ is the constant function, and so
    %
    \[ \text{WF}(\delta) = \{ 0 \} \times \RR^d. \]

    \item If $u(x) = \text{p.v}(1/x)$, then $\widehat{u}(\xi) = -i \pi \text{sgn}(\xi)$, and so
    %
    \[ \text{WF}(u) = \{ 0 \} \times \RR. \]

    \item If $H \subset \RR^d$ is a plane, and $\sigma_H$ is the distribution given by integration against the surface measure on $H$, then $\sigma_H$ is homogeneous, and we claim that $\widehat{\sigma}_H = \sigma_{H^\perp}$, from which the argument above implies that
    %
    \[ \Gamma_0(\sigma_H) = H^\perp. \]
    %
    Since $\sigma_H$ is invariant under translation by elements of $H$, it follows that for any $x \in H$, $\Gamma_x(\sigma_H) = H^\perp$. But $\sigma_H$ is $C^\infty$ away from $H$, so
    %
    \[ \text{WF}(u) = H \times H^\perp. \]
  \end{itemize}
  %
  Thus one sees that the wavefront set is often `conormal' to a distribution supported on a singular set.

\begin{example}
    Let $f_0$ be a distribution of order $N+1$ defined on an open set $\Omega \subset \RR^n$ by taking the boundary values of an analytic function $f$ defined on the set $\Omega \times \Gamma \subset \CC^n$, where $\Gamma$ is a convex open cone in $\RR^n$, and $|f(x + iy)| \lesssim |y|^{-N}$. Let $\Gamma^\circ = \{ \xi \in \RR^n: y \circ \xi \geq 0\ \text{for all $y \in \Gamma$} \}$ denote the dual cone of $\Gamma$. Then $\text{WF}(f_0) \subset \Omega \times (\Gamma^\circ - \{ 0 \})$. To figure this out, we have that for any $\nu \geq N$,
    %
    \begin{align*}
        \widehat{f_0 \phi}(\xi) &= \int \phi_{y_0}(x) f_{y_0}(x) e^{-2 \pi i (x + i y_0) \cdot \xi}\; dx\\
        &\quad + \frac{1}{\nu!} \int \int_0^1 f_{ty_0}(x) e^{-2 \pi i (x + i ty_0) \cdot \xi} \sum_{|\alpha| = \nu + 1} \partial^\alpha \phi(x) (i y_0)^\alpha t^\nu\; dx\; dt.
    \end{align*}
    %
    If $y_0 \cdot \xi < 0$, the first quantity decays exponentially as $\xi$ scales, and the second term is $O((1 + |\xi|)^{N-\nu})$. Taking $\nu \to \infty$ yields the claim.
\end{example}

The fact that $(x_0,\xi_0) \not \in \text{WF}(u)$ implies precisely that there exists a neighbourhood $U_0$ of $x_0$ such that for any $\phi \in \DD(U_0)$, and any $N > 0$,
%
\[ \int_{\RR^d} u(x) \phi(x) e^{-2 \pi i \lambda \xi \cdot x}\; dx \lesssim_N \langle \xi \rangle^{-N}. \]
%
It will be useful to consider a nonlinear analogue of this statement, which will be useful for showing the invariance of the wavefront set under changes of variables.

\begin{theorem}
    Let $u$ be a distribution, and let $(x_0,\xi_0) \not \in \text{WF}(u)$. Let $U$ be an open subset of $\RR^d$ containing $x_0$, let $V$ be an open subset of $\RR^p$ containing $a_0$, and let $\psi: U \times V \to \RR$ be a $C^\infty$ function with $\nabla_x \psi(x_0,a_0) = \xi_0$. Then there is an open set $U_0$ of $x_0$, an open set $V_0$ of $a_0$ such that for any $\phi \in \DD(U_0)$, and any $N > 0$,
    %
    \[ \left| \int u(x) \phi(x) e^{-2 \pi i \lambda \psi(x,a)}\; dx \right| \lesssim_N \lambda^{-N} \]
    %
    where the bound is uniform on $V_0$.
\end{theorem}
\begin{proof}
    Fix $\varepsilon > 0$, to be chosen later, and choose $U_0$ and $V_0$ such that $|\nabla_x \psi(x,a) - \xi_0| \leq \varepsilon/2$ for $x \in U_0$ and $a \in V_0$. For any given $\phi \in \DD(U_0)$, consider $\tilde{\phi} \in \DD(U_0)$ with $\tilde{\phi} \phi = \phi$. Then
    %
    \begin{align*}
        \int u(x) \phi(x) e^{-2 \pi i \lambda \psi(x,a)}\; dx &= \int u(x) \phi(x) \phi_1(x) e^{-2 \pi i \lambda \psi(x,a)}\; dx\\
        &= \int \widehat{u \phi}(\xi) \left( \int \phi_1(x) e^{-2 \pi i (\lambda \psi(x,a) - \xi)}\; dx \right)\; d\xi\\
        &= \lambda^d \int \widehat{u \phi}(\xi) \left( \int \phi_1(x) e^{-2 \pi \lambda i(\psi(x,a) - \xi)}\; dx \right)\; d\xi\\
        &= \lambda^d \int \widehat{u \phi}(\lambda \xi) J(\lambda,\xi,a)\; d\xi.
    \end{align*}
    %
    Let $\eta \in \DD(\RR^d)$ be a smooth bump function supported on $|\xi| \leq 1$ and with $\eta(\xi) = 1$ for $|\xi| \leq 1/2$. Fix $\varepsilon > 0$, and write $J(\lambda,\xi,a) = J_1(\lambda,\xi,a) + J_2(\lambda,\xi,a)$, where
    %
    \[ J_1(\lambda,\xi,a) = \eta \left( \frac{\xi - \xi_0}{\varepsilon} \right) \int_{\RR^d} \phi_1(x) e^{-2 \pi \lambda i(\psi(x,a) - \xi)}\; dx \]
    %
    and
    %
    \[ J_2(\lambda,\xi,a) = \left(1 - \eta \left( \frac{\xi - \xi_0}{\varepsilon} \right) \right) \int_{\RR^d} \phi_1(x) e^{-2 \pi \lambda i (\psi(x,a) - \xi)}\; dx. \]
    %
    If $\varepsilon$ is chosen appropriately small, then $|\widehat{u \phi}(\lambda \xi)| \lesssim_N \lambda^{-N}$ uniformly for $|\xi - \xi_0| \leq \varepsilon$. Since $|J_1(\lambda,\xi,a)| \lesssim 1$, this implies
    %
    \[ \left| \int \widehat{u \phi}(\lambda \xi) J_1(\lambda,\xi,a) \right|\; d\xi \lesssim_N \lambda^{-N}. \]
    %
    On the other hand, if $|\xi - \xi_0| \geq \varepsilon$, then $|\nabla_x \phi(x,a) - \xi| = |\xi_0 - \xi| - \varepsilon/2 \geq \varepsilon/2$. Thus the method of stationary phase implies that
    %
    \[ |J_2(\lambda,\xi,a)| \lesssim_N \lambda^{-N}, \]
    %
    uniformly in $a$. Combined with the fact that $\widehat{u \phi}$ is of polynomial growth, this implies that
    %
    \[ \left| \int \widehat{u \phi}(\lambda \xi) J_1(\lambda,\xi,a)\; d\xi \right| \lesssim_N \lambda^{-N}. \]
    %
    Combining these two estimates completes the proof.
\end{proof}

For a smooth function $\phi \in \DD(V)$ and a smooth diffeomorphism $f: U \to V$, we can define $f^* \phi \in \DD(U)$ by setting $f^* \phi(x) = \phi(f(x))$. Then for $\psi \in \DD(V)$,
%
\[ \int f^* \phi(x) \psi(x) = \int \phi(f(x)) \psi(x) = \int \phi(y) \psi(f^{-1}(y)) \cdot \frac{1}{|f'(f^{-1}(y))|} \; dy. \]
%
Thus for a distribution $u$ on $V$, to define a distribution $f^* u$ on $U$ such that for $\psi \in \DD(\RR^d)$,
%
\[ \int (f^* u)(x) \psi(x) = \int u(y) \phi(f^{-1}(y)) \cdot \frac{1}{|f'(f^{-1}(y))|}\; dy. \]
%
There is a simple relation between the wavefront set of $u$ and $f^* u$. We consider $f^*: V \times \RR^d \to U \times \RR^d$ by defining $f^*((y,v)) = (f^{-1}(y), f'(y)^T v)$. This agrees with the definition of $f^*$ encountered in differential geometry if we identify $V \times \RR^d$ and $U \times \RR^d$ with the cotangent bundle $T^* V$ and $T^* U$.

\begin{theorem}
    For any distribution $u$ on $V$, $\text{WF}(f^* u) = f^*(\text{WF}(U))$.
\end{theorem}
\begin{proof}
    Assume $(y_0,\eta_0) \not \in \text{WF}(u)$, let $(x_0,\xi_0) = f^*((y_0,\eta_0))$, and then define $\psi(y,\xi) = f^{-1}(y) \cdot \xi$. Then
    %
    \[ \nabla_y \psi(y_0,\xi_0) = (f^{-1}(y_0)')^T(\xi_0) = \eta_0. \]
    %
    Thus, applying the previous theorem, since
    %
    \[ \widehat{f^*(u \phi)}(\lambda \xi) = \int u(y) \frac{\phi(f^{-1}(y))}{|f'(f^{-1}(y))|} e^{-2 \pi i \lambda \xi \cdot f^{-1}(y)} = \int u(y) \tilde{\phi}(y) e^{-2 \pi i \lambda \psi(y,\xi)}\; dy, \]
    %
    we conclude that $|\widehat{f^*(u \phi)}(\lambda \xi) \lesssim_N \lambda^{-N}$, which implies $(x_0,\xi_0) \in \text{WF}(f^*(u))$. Thus $\text{WF}(f^* u) \subset f^*(\text{WF}(u))$. The converse statement that $f^*(\text{WF}(u)) \subset \text{WF}(f^* u)$ is obtained by symmetry.
\end{proof}

Using this change of variables formula, we see that the wavefront set transforms under a change of coordinates like a covector. Since this gives an invariant definition, we can define the wavefront set of distributions on any smooth manifold $M$, and the wavefront set will then be a closed, conical subset of $T^* M$.



\section{Singular Operations on Distributions}

A subset $\Gamma$ of $\Omega \times \RR^d$ is \emph{conic} if $(x,\xi) \in \Gamma$ implies that $(x,\lambda \xi) \in \Gamma$. Given a closed conic set $\Gamma$, let $\DD^*_\Gamma(\Omega)$ denote the family of all distributions $u$ with $\text{WF}(u) \subset \Gamma$, with the seminorms
%
\[ u \mapsto \sup_{\substack{\xi \in V\\\lambda > 0}} \lambda^N |\widehat{\phi u}(\lambda \xi)| \]
%
where $V$ is a closed conic set disjoint from $\Gamma$. Then $\DD^*_\Gamma(\Omega)$ is a Fr\'{e}chet space. To analyze this space, we require a lemma about general distributions.

\begin{lemma}
    Let $\mathcal{U}$ be a family in $\DD^*(\Omega)$ such that $\sup_{u \in \mathcal{U}} |u(\phi)| < \infty$ for all $\phi \in \DD(\Omega)$. Then for any $\phi \in \DD(\Omega)$, there exists $m > 0$ such that for any $\xi \in \mathbf{R}^d$,
    %
    \[ |\widehat{\phi u}(\xi)| \lesssim (1 + |\xi|)^m, \]
    %
    uniformly in $u$ and $\xi$. If we have a sequence $\{ u_n \}$ converging to some distribution $u$, then as $n \to \infty$,
    %
    \[ |\widehat{\phi u_n}(\xi) - \widehat{\phi u}(\xi)| = o((1 + |\xi|^m)). \]
    %
    In particular, $\widehat{\phi u_n}$ converges to $\widehat{\phi u}$ on compact subsets.
\end{lemma}
\begin{proof}
    For any compact set $K \subset \Omega$, the assumptions imply there exists $m$ such that for $u \in \mathcal{U}$ and $\phi \in C_c^\infty(K)$,
    %
    \[ |u(\phi)| \lesssim \| \phi \|_{C^m(K)}. \]
    %
    This is a result we have proven earlier following from the uniform boundedness principle. If $\phi$ is supported on $K$, then
    %
    \[ |u(\phi e^{-2 \pi i \xi \cdot x})| \lesssim \| \phi e^{-2 \pi i \xi \cdot x} \|_{C^m(K)} \lesssim (1 + |\xi|)^m. \]
    %
    A similar argument shows the result for a convergent sequence.
\end{proof}

\begin{theorem}
    A sequence of distributions $u_n$ converges to $u$ in $\DD^*_\Gamma(U)$ if and only if $u_n$ converges to $u$ distributionally, and for any conic set $V$ disjoint from $\Gamma$, and $N > 0$,
    %
    \[ \sup_{\substack{\xi \in V}} \lambda^N |\widehat{\phi u_n}(\lambda \xi)| \]
    %
    is bounded independantly of $n$.
\end{theorem}
\begin{proof}
    This conditions are certainly necessary for convergence. Conversely, if these conditions are satisfied, the previous lemma implies that as $n \to \infty$,
    %
    \[ \sup_{\lambda \geq 1} \sup_{\xi \in V} \lambda^{-m} |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| = o(1). \]
    %
    We also know that
    %
    \[ \sup_{\lambda \geq 1} \sup_{\xi \in V} \lambda^{N+1} |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| < \infty. \]
    %
    Let us call this supremum $C > 0$. Given any $\varepsilon > 0$, we find that
    %
    \[ \sup_{\lambda \geq C/\varepsilon} \lambda^N |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| \leq \varepsilon. \]
    %
    But
    %
    \[ \sup_{1 \leq \lambda \leq C/\varepsilon} \sup_{\xi \in V} \lambda^N |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| = o((C/\varepsilon)^{N+m}). \]
    %
    Taking $n$ suitably large, depending on $C$, $\varepsilon$, $N$, and $m$, we conclude that
    %
    \[ \sup_{1 \leq \lambda \leq C/\varepsilon} \sup_{\xi \in V} \lambda^N |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| \leq \varepsilon. \]
    %
    Combining this with the supremum above shows that we have convergence in $\DD^*_\Gamma(U)$.
\end{proof}

\begin{theorem}
    $\DD(\Omega)$ is sequentially dense in $\DD^*_\Gamma(\Omega)$.
\end{theorem}
\begin{proof}
    Consider a distribution $u \in \DD^*_\Gamma(\Omega)$. Without loss of generality we may assume $u$ is compactly supported. Consider an approximation to the identity $\{ \phi_\delta \}$. Then $u * \phi_{1/n} \in C^\infty(\Omega)$, and thus an element of $\DD^*_\Gamma(\Omega)$. $u * \phi_{1/n}$ converges to $u$ in $\DD^*(\Omega)$, so by the last result, it suffices to show that for any admissable choice of $\psi$, $V$, and $N > 0$,
    %
    \[ \sup_{\substack{\xi \in V}} \sup_n \lambda^N |\widehat{\psi (u * \phi_n)}(\lambda \xi)| < \infty. \]
    %
    But this is simple, for we get arbitrarily fast decay if $n$ is suitably large, depending on the distance from $V$ to $\Gamma$, and the finitely many smaller choices of $n$ are negligible.
\end{proof}

We have a continuous map $(\phi,\psi) \to \phi \psi$ from $\DD(\Omega) \times \DD(\Omega) \to \DD(\Omega)$, which extends to a continuous map $(\phi,u) \to \phi u$ from $\DD(\Omega) \times \DD^*(\Omega) \to \DD^*(\Omega)$. However, it is \emph{not} possible to extend this to a continuous map $(u,v) \mapsto uv$ from $\DD^*(\Omega) \times \DD^*(\Omega) \to \DD^*(\Omega)$. For instance, if $\{ \phi_\varepsilon \}$ is an approximation to the identity, then $\phi_\varepsilon$ converges to the Dirac delta distribution $\delta$ at the origin, so we would expect $\phi_\varepsilon^2$ to converge to a distribution representing the product $\delta \cdot \delta$, but this does not happen because if $\psi \in \DD(\RR^d)$ and $\psi(x) = 1$ for $|x| \leq 1$, then
%
\[ \left| \int \phi_\varepsilon^2(x) \psi(x) \right| \gtrsim 1/\varepsilon \]
%
and thus does not converge. It is a surprising fact that we can use the wavefront set of a distribution to define the product of two distributions, \emph{provided that the wavefront sets satisfy a disjointness relation}.

To see how this is possible, we note that for $\phi,\psi \in \DD(\RR^d)$, we might expect us to be able to take Fourier transforms, so that
%
\begin{align*}
    \int u(x) v(x) \phi(x) \psi(x)\; dx &= \int (\phi u)(x) (\psi v)(x)\; dx\\
    &= \int \int (\widehat{\phi u} * \widehat{\psi v})(\xi) e^{2 \pi i \xi \cdot x}\; d\xi\; dx\\
    &= \int \int \widehat{\phi u}(\eta) \widehat{\psi v}(\xi - \eta) e^{2 \pi i \xi \cdot x}\; d\xi\; dx.
\end{align*}
%
The only problem with taking this as the \emph{definition} of the product is that the integral we have obtained might not converge in general. However, if at least one of the Fourier transforms decreases rapidly in the right directions.

\begin{theorem}
    Fix conic sets $\Gamma_1,\Gamma_2 \subset \Omega \times \mathbf{R}^d - \{ 0 \}$. If $\Gamma_3 = \Gamma_1 + \Gamma_2$ does not contain any points in $0_\Omega = \Omega \times \{ 0 \}$, then we have a unique continuous map from $\DD^*_{\Gamma_1}(\Omega) \times \DD^*_{\Gamma_2}(\Omega) \to \DD^*_{\Gamma_3}(\Omega)$ which agrees with multiplication for elements of $C^\infty(\Omega)$.
\end{theorem}

\begin{example}
    Consider the distributions $\Lambda_1$ and $\Lambda_2$ on $\RR^2$, given by integration along the $x$ and $y$ axis respectively, i.e.
    %
    \[ \int \Lambda_1(x,y) \phi(x,y)\; dx\; dy = \int \phi(x,0)\; dx \]
    %
    and
    %
    \[ \int \Lambda_2(x,y) \phi(x,y)\; dx\; dy = \int \phi(0,y)\; dy. \]
    %
    We have seen that $\text{WF}(\Lambda_1) = \{ (x,0;0,\eta) : \eta \neq 0 \}$ and $\text{WF}(\Lambda_2) = \{ (0,\xi;y,0) : \xi \neq 0 \}$. Now
    %
    \[ \text{WF}(\Lambda_1) + \text{WF}(\Lambda_2) = \{ (x,\xi,y,\eta): \xi, \eta \neq 0 \}, \]
    %
    which is disjoint from $0_{\RR^2}$, and so a product $\Lambda_1 \cdot \Lambda_2$ is well defined. To determine what the product is, we consider a non-negative bump function $\phi \in \DD(RR^d)$ equal to one in a neighborhood of the origin, and define
    %
    \[ \phi_{x,\delta}(x,y) = (1/2\delta) \mathbf{I}(|x| \leq 1/\delta, |y| \leq \delta) \]
    %
    %
    \[ \phi_{y,\delta}(x,y) = (1/2\delta) \mathbf{I}(|x| \leq \delta, |y| \leq 1/\delta). \]
    %
    Then as $\delta \to 0$, $\phi_{x,\delta} \to \Lambda_1$ and $\phi_{y,\delta} \to \Lambda_2$. We find that
    %
    \[ \phi_{x,\delta} \phi_{y,\delta} = (1/4\delta^2) \mathbf{I}(|x| \leq \delta, |y| \leq \delta). \]
    %
    As $\delta \to 0$, $\phi_{x,\delta} \phi_{y,\delta}$ thus converges to the Dirac delta distribution $\delta$ at the origin. Thus $\Lambda_1 \cdot \Lambda_2 = \delta$.
\end{example}

\begin{example}
    Let $\Lambda = (x + i0^+)^{-1}$, i.e. the distribution
    %
    \[ \int \Lambda(x) \phi(x)\; dx = \lim_{y \to 0^+} \int \frac{\phi(x)}{x + iy}\; dx = \lim_{y \to 0^+} \Lambda_y(\phi). \]
    %
    The $\Lambda$ is homogeneous. Moreover, some formal manipulations, plus some contour integrals, show that
    %
    \[ \widehat{\Lambda}(\xi) = - 2 \pi i \cdot \mathbf{I}(\xi < 0). \]
    %
    In particular, $\text{WF}(\Lambda) = \{ (0,\xi) : \xi < 0 \}$. this means $\text{WF}(\Lambda) + \text{WF}(\Lambda)$ does not contain any zero vectors, so the product $\Lambda \cdot \Lambda$ is well defined. Now $\Lambda$ is the limit of the $C^\infty$ functions $\phi_y(x) = 1/(x + iy)$ in $\DD^*(\RR)$, and it requires only a simple calculation to show that $\Lambda$ is also the limit in $\DD^*_\Gamma(\RR)$, where $\Gamma = \{ (0,\xi): \xi < 0 \}$. Since
    %
    \[ \phi_y(x)^2 = 1/(x + iy)^2, \]
    %
    we find by continuity that
    %
    \[ \Lambda \cdot \Lambda = (x + i0^+)^{-2}, \]
    %
    i.e.
    %
    \[ \int \Lambda(x) \Lambda(x) \phi(x)\; dx = \lim_{y \to 0} \int \frac{\phi(x)}{(x + iy)^2}\; dx. \]
\end{example}

To define more sophisticated operations on distributions, we define the generic operations of \emph{pullback}, \emph{pushforward}, and \emph{tensoring}. Intuitively, the pullback of a distribution gives a way to `compose' a distribution with a smooth function in the domain, the push forward enables one to `integrate a distribution along fibres', and tensoring enables us to take the product of distributions.

Let us begin with the pullback. For a smooth map $f: \Omega \to \Psi$, not necessarily a diffeomorphism, and $\phi \in \DD(\Psi)$, we can define $f^* \phi = \phi \circ f \in C^\infty(\Omega)$. This map is continuous in the appropriate topology, and if $f$ is a proper map, $f^*$ is continuous from $\DD(\Psi) \to \DD(\Omega)$. To obtain a distributional definition, we apply the Fourier inversion formula; if $\psi \in \DD(\RR^d)$, then
%
\[ \int (f^* \phi)(x) \psi(x)\; dx = \int \phi(f(x)) \psi(x)\; dx = \int \int \widehat{\phi}(\eta) \psi(x) e^{2 \pi i \eta \cdot f(x)}\; d\xi\; dx. \]
%
For a compactly supported distribution $u$ on $\Psi$, it is therefore natural to define $f^* u$ on $\Omega$ such that
%
\[ \int (f^* u)(x) \psi(x)\; dx = \int \widehat{u}(\eta) \left( \int \psi(x) e^{2 \pi i \eta \cdot f(x)}\; dx \right)\; d\eta. \]
%
We can decompose this integral so that $\psi$ is supported on various small sets. If $\psi$ is supported in a neighbourhood of $x_0$, then the oscillatory integral on the inside decays fast as $\eta \to \infty$ provided that $Df(x_0)^T \eta \neq 0$. Thus, provided that $\widehat{u}(\eta)$ decays fast whenever $Df(x_0)^T \eta = 0$, the integral above is well defined. Proceeding through this argument more rigorously gives the following result, left as an exercise.

\begin{theorem}
    Given a smooth map $f: \Omega \to \Psi$, let
    %
    \[ N = \{ (f(x),\eta): Df(x)^T \eta = 0 \}. \]
    %
    Fix a closed cone $\Gamma$ with $\Gamma \cap N = \emptyset$. Then $f^*: \DD(\Psi) \to C^\infty(\Omega)$ extends to a continuous map from $\DD^*_\Gamma(\Psi) \to \DD^*_{f^* \Gamma}(\Omega)$, where
    %
    \[ f^* \Gamma = \{ (x,Df(x)^T \xi) : (f(x), \xi) \in \Gamma \}. \]
\end{theorem}

\begin{example}
    Given a smooth map $f: \Omega \to \RR^d$, with the property that for any $x \in f^{-1}(0)$, $Df(x)$ has rank $d$, the set $N$ above is disjoint from $\{ 0 \} \times \RR^d$, and so we can define the pullback of the Dirac delta function at the origin, $f^* \delta$, also denoted $\delta(f(x))$.

    As examples of this construction, we can consider the distributions $\delta(x)$ and $\delta(y)$ on $\RR^2$. This are equal to $\pi_x^* \delta$ and $\pi_y^* \delta$, where $\pi_x: \RR^2 \to \RR$ and $\pi_y: \RR^2 \to \RR$ are the obvious projection maps, then we have
    %
    \begin{align*}
        \int (\pi_x^* \delta)(x,y) \phi(x,y)\; dx\; dy &= \int \widehat{\delta}(\xi) \phi(x,y) e^{2 \pi i \xi \cdot x}\; dx\; dy\; d\xi\\
        &= \int \phi(x,y) e^{2 \pi i \xi \cdot x}\; dx\; dy\; d\xi\\
        &= \int \phi(0,y)\; dy.
    \end{align*}
    %
    Thus $\delta(x) = \pi_x^* \delta$ is the distribution given by integration on the $y$-axis. Similarily, one can calculate that $\delta(y) = \pi_y^* \delta$ is the distribution given by integration on the $x$-axis. It is simple to calculate explicitly, or using the properties of pullback, that
    %
    \[ \text{WF}(\pi_x^* \delta) \subset \{ (0,y;\xi,0) : \xi \neq 0 \} \]
    %
    and
    %
    \[ \text{WF}(\pi_y^* \delta) \subset \{ (x,0;0,\eta): \eta \neq 0 \}. \]
    %
    In fact, in these two cases these equations are equalities.
\end{example}

Next, let us define the tensor product. Given a distribution $u_1$ on $\Omega_1$ and a distribution $u_2$ on $\Omega_2$, we define a distribution $u_1 \otimes u_2$ on $\Omega_1 \times \Omega_2$ such that for $\phi \in \DD(\Omega_1 \times \Omega_2)$,
%
\[ \int (u_1 \otimes u_2)(x_1,x_2) \phi(x_1,x_2)\; dx_1\; dx_2 = \int u_1(x_1) \left( \int u_2(x_2) \phi(x_1,x_2)\; dx_2 \right)\; dx_1, \]
%
where the function
%
\[ \tilde{\phi}(x_1) = \int u_2(x_2) \phi(x_1,x_2)\; dx_2 \]
%
is smooth, where one can easily verify that
%
\[ D^\alpha \tilde{\phi}(x_1) = \int u_2(x_2) D^\alpha \phi(x_1,x_2)\; dx_2. \]
%
Thus the tensor product of any two distributions is well defined. It is simple to check that
%
\[ \text{WF}(u_1 \otimes u_2) \subset \text{WF}(u_1) \times \text{WF}(u_2) \cup \text{WF}(u_1) \times \{ 0 \} \cup \{ 0 \} \times \text{WF}(u_1). \]
%
obtained by isolating each variable separately with a bump function and then tensoring the Fourier transform.

\begin{example}
    Given $\phi,\psi \in \DD(\Omega)$, we have
    %
    \[ \phi \cdot \psi = i^*(\phi \otimes \psi), \]
    %
    where $i(x) = (x,x)$, which gives us another way to define the product of distributions by a tensoring, combined with a pullback.
\end{example}

Finally, we define the pushforward of a distribution. This is most naturally defined distributionally. Given a smooth map $f: \Omega \to \Psi$, $\phi \in \DD(\Omega)$, and $\psi \in \DD(\Psi)$, we define
%
\[ \int f_* \phi(y) \psi(y) dy = \int \phi(x) \psi(f(x))\; dx. \]
%
Thus $f_*$ is just the adjoint of $f^*$. One problem which prevents us from directly using this definition to extend the definition to distributions is that $\psi \circ f$ need not be compactly supported if $\psi$ is compactly supported. One way to resolve this is to consider only the pushforwards of compactly supported distributions. Another way to solve the problem is to assume $f$ is a \emph{proper map}, i.e. inverse images of compact sets are compact. It is then simple to define
%
\[ \int f_* u(y) \psi(y)\; dy = \int u(x) \psi(f(x))\; dx. \]
%
for a distribution $u$ on $\Omega$ and $\psi \in \DD(\Psi)$. To understand the wavefront set of $u$, we consider a bump function $\phi$ supported in a neighbourhood  on $\Omega$ and consider
%
\[ \int f_*(u \phi)(y) e^{-2 \pi i \eta \cdot y}\; dy = \int u(x) \phi(x) e^{-2 \pi i \eta \cdot f(x)}\; dx. \]
%
We have already show that for such an oscillatory integral, provided that $(f(x_0),Df(x_0)^T \eta) \not \in \text{WF}(u)$, this integral converges. Thus
%
\[ \text{WF}(f_* u) \subset \{ (y,\eta) : \text{There is $(x,\xi) \in \text{WF}(u)$ and $Df(x)^T \eta = \xi$} \}. \]
%
Now we have defined pushforward, pullback, and tensoring, let us see how they can be used to define useful operations on distributions.

\begin{example}
    Let $M$ be a manifold with a $C^\infty$ immersed submanifold $M_0$. Then we have a smooth inclusion map $f: M_0 \to M$. That $f$ is proper is equivalent to the assumption that $M_0$ is a closed submanifold of $M$. If $u \in \DD(M_0)^*$, then $f_* u$ is precisely the distribution on $M$ given by $\langle f_* u, \phi \rangle = \langle u, \phi|_{M_0} \rangle$. The wavefront set $\text{WF}(\phi_* u)$ is equal to the unique of the \emph{conormal bundle of $M_0$}, i.e. the set
    %
    \[ N^*(M_0) = \{ (x,\xi) \in T^*M: x \in M_0\ \text{and}\ f^*(x)(\xi) = 0 \}, \]
    %
    and $\text{WF}(u)$.
\end{example}

Let us consider an important example which occurs in the theory of kernel operators. Recall that the Schwartz kernel theorem says that if $T: \DD(Y) \to \DD^*(X)$ is any continuous linear map, then there exists a distribution $K \in \DD^*(X \times Y)$ such that, formally speaking, if $\phi \in \DD(Y)$ and $\psi \in \DD(X)$,
%
\[ \int T\phi(x) \psi(x)\; dx = \int \psi(x) K(x,y) \phi(y)\; dy. \]
%
In other words, if $\pi(x,y) = x$ and $\Delta(x,y) = (x,y,y)$, then, unwinding the definition, we find
%
\[ T\phi = \pi_*(\Delta^* (K \otimes \phi)). \]
%
Now define the \emph{wavefront} or \emph{canonical relation}
%
\[ \text{WF}(K)' = \{ (x,\xi;y,\eta) : (x,\xi;y,-\eta) \in \text{WF}(K) \}, \]
%
and
%
\[ \text{WF}_X(K)' = \text{WF}(K)' \circ 0_Y = \{ (x,\xi): (x,\xi;y,0) \in \text{WF}(K)\ \text{for some $y \in Y$}  \}. \]
%
Working through the definition shows that $\text{WF}(T\phi) \subset \text{WF}_X(K)'$. We can also use the pushforward equation to extend the domain of $T$ to certain compactly supported distributions. Going through the definition shows that for a compactly supported distribution $u$, the expression $\pi_*(\Delta^*(K \otimes u))$ is well defined provided that $\text{WF}(u)$ is disjoint from $\text{WF}_Y(K)'$, where
%
\[ \text{WF}_Y(K)' = \{ (y,\eta) : (x,0;y,-\eta) \in \text{WF}(K)\ \text{for some $x \in X$} \}. \]
%
In this case, we define $Tu = \pi_*(\Delta^*(\phi \otimes K))$. This gives a sequentially continuous map from the subspace of compactly supported distributions in $\DD^*_\Gamma(\Omega)$ to $\DD^*(\Omega)$ for any $\Gamma$ with $\text{WF}_Y(K)' \cap \Gamma = \emptyset$. If, in addition, the projection map $\pi(x,y) = x$ is proper on $\text{supp}(K)$, then this can be extended to a sequentially continuous map from $\DD^*_\Gamma(\Omega)$ to $\DD^*(\Omega)$. Again, working through the definitions shows that
%
\[ \text{WF}(Tu) \subset \text{WF}(K)' \circ \{ \text{WF}(u) \cup 0_Y \}. \]
%
A simple way to remember the results of this construction is that $K$ can be applied to any compactly supported distribution $u$ such that
%
\[ \text{WF}(K)' \circ (\text{WF}(u) \cup 0_\Omega) \]
%
contains no zero vector, and then $\text{WF}(Ku)$ is equal to this composition.

\begin{example}
    Consider a pseudodifferential operator $T$ given by a symbol $a$, i.e.
    %
    \[ T\phi(x) = \int a(x,\xi) \widehat{\phi}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi = \int a(x,\xi) \phi(y) e^{2 \pi i \xi \cdot (x - y)}\; d\xi\; dy. \]
    %
    We can also think of $T$ as a kernel operator with kernel
    %
    \[ K(x,y) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)} \; d\xi. \]
    %
    The kernel is a distribution defined by an oscillatory integral distribution, and our calculations for such distributions show that
    %
    \[ \text{WF}(K) \subset \{ (x,-\xi;x,\xi) : x \in \Omega, \xi \in \RR^n - \{ 0 \} \}. \]
    %
    Thus
    %
    \[ \text{WF}(K)' \subset \{ (x,\xi;x,\xi) : x \in \Omega, \xi \in \RR^n - \{ 0 \} \}. \]
    %
    In particular, $\text{WF}(K)'$, viewed as a relation, contains no zero vectors, and so $T$ extends to a continuous operator from $\mathcal{E}(\RR^d)^*$ to $\DD(\RR^d)^*$, and if $a$ is compactly supported in the $x$ variable, $T$ extends to a continuous operator from $\DD(\RR^d)^*$ to itself. For any distribution $u$, we find that $\text{WF}(Tu) \subset \text{WF}(u)$. This is part of the \emph{pseudolocal} nature of pseudodifferential operators; when $T$ is applied to some distribution $u$ supported near $(x_0,\xi_0)$ in phase space, we should expect the same will be true of $Tu$.
\end{example}

\begin{example}
    Given a distribution $u$, the operator given by convolution by $u$ has kernel
    %
    \[ K(x,y) = u(x-y). \]
    %
    In other words, $K = f^* u$, where $f: \RR^{2d} \to \RR^d$ is given by $f(x,y) = x - y$. Since $f$ is surjective, the pullback $f^* u$ is always well defined, and moreover,
    %
    \[ \text{WF}(K) \subset f^* \text{WF}(u) = \{ (x_1,-\xi,x_2,\xi): (x_2 - x_1, \xi) \in \text{WF}(u) \}, \]     
    %
    and therefore
    %
    \[ \text{WF}(K)' \subset \{ (x+a,\xi;x,\xi): (a,\xi) \in \text{WF}(u) \}. \]
    %
    We actually have equality here. To see this, for $a \in \RR^d$, and let $g: \RR^d \to \RR^{2d}$ such that $g(x) = (x + a, a)$. Then $u = g^* K$, and so it follows that
    % I 0
    \[ \text{WF}(u) \subset g^* \text{WF}(K) = \{ (x,\xi): (x+a, \xi; a, \eta) \in \text{WF}(K) \}. \]
    %
    It follows from this that we have equality. Thus the operation $v \mapsto u * v$ is a continuous operator from $\mathcal{E}^*(\RR^d)$ to $\DD(\RR^d)^*$, and
    %
    \[ \text{WF}(u * v) \subset \{ (x+a,\xi): (a,\xi) \in \text{WF}(u), (x,\xi) \in \text{WF}(v) \}. \]
    %
    If $u$ is a distribution with singular support only at the origin, then $\text{WF}(K)'$ is a subset of the diagonal in $T^* \RR^d \times T^* \RR^d$, and so $\text{WF}(u * v) \subset \text{WF}(v)$ for any distribution $v$ for which the convolution can be computed.
\end{example}

How about the \emph{composition} of kernel operators? Intuitively, if $A: \DD(Y) \to \DD^*(X)$ and $B: \DD(Z) \to \DD^*(Y)$, with kernels $K_A(x,y)$ and $K_B(y,z)$, then, if we could define a kernel operator $C = A \circ B: \DD(Z) \to \DD^*(X)$, it should have kernel
%
\[ K_C(x,z) = \int K_A(x,y) K_B(y,z)\; dy. \]
%
This would be possible and well defined, for instance, if the kernel of $B$ lay in $\DD(Y \times Z)$. The integral of $K_C$ would be well defined, the composition of operators would be well defined, for if $\phi \in \DD(Z)$, then $B\phi \in \DD(Y)$, and so $A(B\phi)$ is well defined, and one finds that $K_C$ is the kernel of this operator. To generalize this composition, we might want to define $K_C = \pi_* \Delta^*(K_A \otimes K_B)$, for the appropriate maps $\Delta$ and $\pi$. Now this operation is well defined provided that $(x,0;y,\eta) \in \text{WF}(K_A)'$ and $(y,\eta;z,0) \in \text{WF}(K_B)'$ for some $x \in X$, $y \in Y$, $z \in Z$, and $\eta \in \RR^d$, and the projection map $\pi(x,y,z) = (x,z)$ is proper on the support of $\Delta^* (K_A \otimes K_B)$, which would hold, for instance, if either $\pi(x,y) = x$ was proper on the support of $K_A$, or $\pi(y,z) = z$ was proper on the support of $K_B$. In this situation, we have
%
\[ \text{WF}(K_C)' \subset \{ \text{WF}(K_A)' \circ \text{WF}(K_B)' \} \cup \{ \text{WF}_X(K_A)' \times 0_Z \} \cup \{ 0_X \times \text{WF}_Z(K_B)' \}. \]
%
Thus we have defined a fairly general composition operator on distributions, which is the unique bilinear continuous extension of the composition of two operators with kernels in $\DD(X \times Y)$ and $\DD(Y \times Z)$ to the pair $\DD_{\Gamma_A}^*(X \times Y)$ and $\DD_{\Gamma_B}^*(Y \times Z)$ for any pair of conic sets $\Gamma_A$ and $\Gamma_B$ for which there does not exist any $(x,0;y,-\eta) \in \Gamma_A$ and $(y,\eta;z,0) \in \Gamma_B$.

%Recall first that an operator $Q$ on $U$ is \emph{proper} if, for any compact set $C_1 \subset U$, there is another compact set $C_2$ such that if $\phi \in \DD(U)$ and $\text{supp}(\phi) \subset C_1$, then $\text{supp}(Q\phi) \subset C_2$. Equivalently, if $K$ is the kernel of $Q$, then for any $(x,y) \in \text{supp}(K)$ with $y \in C_1$, we have $x \in C_2$. Under these assumptions, we claim that the projection map $\pi(x,y,z) = (x,z)$ is proper on the support of
    %
%    \[ K_3(x,y,z) = \Delta^*(K_1 \otimes K_2)(x,y,z) = K_1(x,y) K_2(y,z). \]
    %
%    Indeed, if $C_1$ and $C_2$ are compact sets of $U$, then there is a third compact set $C_3$ such that if $(y,z) \in \text{supp}(K_2)$, and $z \in C_2$, then $y \in C_3$. Since $(x,y,z) \in \text{supp}(K_3)$ only if $(x,y) \in \text{supp}(K_1)$ and $(y,z) \in \text{supp}(K_2)$, this implies that
    %
%    \[ \pi^{-1}(C_1 \times C_2) \cap \text{supp}(K_3) \subset C_1 \times C_3 \times C_2. \]

\begin{example}
    Let us use this construction to define the composition of two pseudodifferential operators $P$ and $Q$ on some domain $U$, such that one of these operators is proper in the sense above. Indeed, the wave front sets of $P$ and $Q$ are never incompatible, so we can always define $P \circ Q$ using the theory above, and we find that
    %
    \[ \text{WF}(P \circ Q)' = \text{WF}(P) \circ \text{WF}(Q). \]
    %
    In particular, since $\text{WF}(P)$ and $\text{WF}(Q)$ are both subsets of the diagonal in $T^*U \times T^*U$, it follows that $P \circ Q$ is also pseudolocal in the sense that $\text{WF}((P \circ Q)(u)) \subset \text{WF}(u)$. Of course, in the theory of pseudodifferential operators one shows that $P \circ Q$ is also a pseudolocal operator for any two psuedolocal operators $P$ and $Q$, and then this result follows from that theory.
\end{example}

\begin{example}
    Suppose $T: \DD(Y) \to \DD^*(X)$ is continuous, and thus has a Schwartz kernel $K \in \DD^*(X \times Y)$. Then if we consider the operator $T^*: \DD(X) \to \DD(Y)^*$ induced by the kernel $K^*(y,x) = \overline{K(x,y)}$, then we find that
    %
    \[ \langle T\phi, \psi \rangle = \langle \phi, T^* \psi \rangle \]
    %
    for any $\phi \in \DD(Y)$ and $\psi \in \DD(X)$. Thus $T^*$ is the formal adjoint of $T$. It is simple to verify that
    %
    \[ \text{WF}(K^*)' = \{ (y,\eta; x, \xi) : (x,\xi;y,\eta) \in \text{WF}(K)' \}. \]
    %
    Thus if $\pi(x,y) = y$ is a proper map on $\text{supp}(K)$ and $\text{WF}_X(K)' = \emptyset$, we can define $T^* \circ T$, and we have
    %
    \[ \text{WF}(T^* \circ T)' \subset \{ (y_1,\eta_1;y_2,\eta_2) : (x,\xi;y_1,\eta), (x,\xi;y_2,\eta_2) \in \text{WF}(K)' \}. \]
    %
    In particular, if $\text{WF}(K)$ is contained in the graph of a function, i.e. there exists a function $f$ such that
    %
    \[ \text{WF}(K) \subset \{ (x,\xi;y,\eta) : (y,\eta) = f(x,\xi) \}, \]
    %
    then $\text{WF}(K^* \circ K)$ is a subset of the diagonal of $T^* Y \times T^* Y$, and thus $T^* \circ T$ has various pseudolocal properties. This idea comes up in the theory of Fourier integral operators, for then if $T$ is a Fourier integral operator defined by a Lagrangian distribution that is locally a graph of a function, then $T^* T$ will be a pseudodifferential operator.
\end{example}










\chapter{Distributional Methods to PDEs}

Distribution theory was originally invented to provide a more amenable setting to the theory of existence for linear partial differential equations. Let us use the theory we have now established to solve some differential equations in the language of distributions. We begin with the most basic differential equation, namely solutions to the transport equation $D^i u = 0$.

\begin{theorem}
  If $u \in \DD^*(\RR^d)$ and there exists an index $i$ such that $D^i u = 0$, then there exists $v \in \DD^*(\RR^{d-1})$ such that
  %
  \[ \int_{\RR^d} u(x) \phi(x)\; dx = \int_{\RR^{d-1}} v(x) \left( \int_{-\infty}^\infty \phi(x)\; dx^i \right)\; dx, \]
  %
  i.e. $u$ is `constant' in the direction $i$. In particular, if $d = 1$, and $D u = 0$, then $u$ is a constant.
\end{theorem}
\begin{proof}
  Suppose without loss of generality that $i = d$. Suppose $\phi \in \DD(\RR^d)$ and for each $x \in \RR^{d-1}$,
  %
  \[ \int_{-\infty}^\infty \phi(x,t)\; dt = 0. \]
  %
  Then the function
  %
  \[ \psi(x,t) = \int_{-\infty}^t \phi(x,s)\; ds = 0 \]
  %
  has compact support and $D^i \psi = \phi$. Thus
  %
  \begin{align*}
    \int_{-\infty}^\infty u(x,t) \phi(x,t)\; dx\; dt &= \int_{-\infty}^\infty u(x,t) D^i \psi(x,t)\; dx\; dt\\
    &= - \int_{-\infty}^\infty D^i u(x,t) \psi(x,t)\; dx\; dt = 0.
  \end{align*}
  %
  Now fix $\phi_0 \in \DD(\RR)$ with $\int_{-\infty}^\infty \phi_0(x) = 1$. Then given any $\phi \in \DD(\RR^d)$,
  %
  \[ \int_{-\infty}^\infty u(x,t) \phi(x,t)\; dx\; dt = \int_{-\infty}^\infty u(x,t) \phi_0(t) \left( \int_{-\infty}^\infty \phi(x,s)\; ds \right)\; dx\; dt. \]
  %
  Thus it suffices to set
  %
  \[ v(x) = \int_{-\infty}^\infty u(x,t) \phi_0(t)\; dt. \qedhere \]
\end{proof}

\begin{remark}
    Applying this result repeatedly shows that if $u \in \DD^*(\RR^d)$ is a distribution, and $\nabla u = 0$, then $u$ is a constant.
\end{remark}

A change of variables gives versions of this result for any transport equation of the form $w \cdot \nabla u = 0$ for a fixed vector $w \in \RR^d$. A corollary is a regularity result for distributional solutions to the equation $w \cdot \nabla u(x) + a \cdot u = f$, where $f \in C(\RR)$, and $a \in C^\infty(\RR)$. We begin with the case $d = 1$.

\begin{lemma}
    If $u \in \DD(\RR)^*$ and $Du + au = f$, for $f \in C(\RR)$, and $a \in C^\infty(\RR)$, then $u \in C^1(\RR)$, and so $u$ is a classical solution to the equation.
\end{lemma}
\begin{proof}
    We just apply classical techniques distributionally. First assume $a = 0$. If $F$ is an antiderivative of $f$ in the $i$th direction, then $F \in C^1(\RR)$, and $D(u - F) = 0$, so $u$ differs from $F$ by a constant, and is therefore also in $C^1(\RR)$. For $a \neq 0$, let $A$ be an antiderivative of $a$, and set
    %
    \[ E(x) = e^{A(x)}. \]
    %
    Then $E \in C^\infty(\RR)$. Thus if $u$ is a distribution solving $D u + a u = f(x)$, and if $v = E u$ then the product rule shows that $Dv = Ef$. The $a = 0$ case implies that $v \in C^1(\RR)$, and so $u \in C^1(\RR)$.
\end{proof}

\begin{remark}
    The idea of this result generalizes to a system of differential equations given by a matrix $a$ with $C^\infty$ entries, and where $f$ is a vector with continuous entries, by finding an invertible matrix $E(x)$ such that $E'(x) = E(x) \cdot a(x)$. In particular, since higher order ordinary differential equations can be reduced to one dimensional systems of ordinary differential equations, we conclude that if $u$ is a distribution satisfying the equation
    %
    \[ D^m u + a_{m-1} D^{m-1} u + \dots + au = f, \]
    %
    for $a_i \in C^\infty(\RR)$, and $f \in C(\RR)$, then $u$ actually lies in $C^m(\RR)$, and satisfies this equation pointwise in the classical sense.
\end{remark}

Higher dimensional analogues of these results are not as strong. Indeed, we have already seen that distributional solutions to $D^i u = 0$ may fail to be classical solutions `normal to the direction $i$'. On the other hand, we can `almost' obtain such a result if we assume apriori that $u$ is a continuous function.

\begin{lemma}
    Suppose $u$ and $f$ are continuous functions in $C(\RR^d)$, and $u$, viewed as a distribution, satisfies the equation $D^i u = f$. Then $D^i u$ exists pointwise, in the classical sense, for all $x \in \RR^d$, and $D^i u (x) = f(x)$ for all $x \in \RR^d$.
\end{lemma}
\begin{proof}
    Assume $i = d$ without loss of generality, and write $x = (x_0,t)$, for $x_0 \in \RR^{d-1}$ and $t \in \RR$. Set
    %
    \[ v(x_0,t) = \int_0^t f(x_0,s)\; ds. \]
    %
    Then $v$ is a distributional solution to the equation $D^i v = f$, and so $D^i(u - v) = 0$. It follows that there exists a distribution $w \in \DD(\RR^{d-1})^*$ such that $u(x,t) - v(x,t) = w(x)$. The proof of the existence of $w$ actually implies that $w$ is continuous, since $u$ and $v$ are continuous. But then $u(x,t) = v(x,t) + w(x)$ is differentiable in the $t$-variable by the fundamental theorem of calculus.
\end{proof}

\begin{theorem}
    Fix $a_1,\dots,a_n \in C^1(\RR^d)$, and $b \in C^0(\RR^d)$, and suppose that $u \in C(\RR^d)$ is pointwise differentiable, and in a pointwise sense, the equation $a_1 D_1 u + \dots + a_n D_n u + b u = f$, where $f \in C(\RR^d)$. Then the same equation holds in a distributional sense (which makes sense because $D_i u$ is a distribution of order one, and thus can be multiplied against $C^1$ functions).
\end{theorem}
\begin{proof}
    We adapt the proof of Cauchy's theorem due to Goursat. Our goal is to prove, given the assumptions in the theorem, that for any $\phi \in C_c^\infty(\RR^d)$,
    %
    \[ \int (b \phi - D_1(a_1 \phi) + \dots + D_n(a_n \phi)) \cdot u = \int f \phi. \]
    %
    For any cube $I$, let
    %
    \[ A_I = \int_I (f \phi - (b \phi - D_1(a_1 \phi) - \dots - D_n(a_n \phi)) \cdot u) + \int_{\partial I} u (a \cdot n)\; dS. \]
    %
    For any fixed $x_0 \in \RR^d$, we claim that
    %
    \[ \lim_{\substack{x_0 \in I\\|I| \to 0}} \frac{|A_I|}{|I|} = 0. \]
    %
    To prove this, we may replace $u$ in the formula above with it's first order Taylor expansion, and $f$ with the resultant formula $a_1 D_1 u + \dots + a_n D_n u + bu$, without loss of generality, since the error term here disappears in the limit. But then the formula is easy to verify. But now it follows that we must have $A_I = 0$ for all $I$, because otherwise we could find a nested family of cubes $A_I$ with $|A_I| \gtrsim |I|$. But if we now take $I$ large enough that it contains the support of $\phi$, the theorem is proved.
\end{proof}

Using techniques from the next section, we obtain a higher dimensional variant of the ODE result above.

\begin{theorem}
    Let $U = V_x \times I_t$, where $V \subset \RR^n$ is open, and $I \subset \RR$ is an open interval. If $u \in \DD(U)^*$ satisfies
    %
    \[ \partial_t^m u + L_{m-1} \{ \partial_t^{m-1} u \} + \dots + L_0 \{ u \} = f, \]
    %
    where $f \in C(I, \DD(V)^*)$, and $L_0,\dots,L_{m-1}$ are differential operators with coefficients in $C^\infty(U)$, then $u \in C^m(I,\DD(V)^*)$.
\end{theorem}
\begin{proof}
    Assuming we are working with vector-valued inputs reduces us to the study of $m = 1$, i.e. an equation of the form $\partial_t u + Lu = f$, and it suffices to show that $u \in C^1(I,\DD(V)^*)$. The case $n = 0$ has already been considered above. Localizing if necessary, write $u = \sum_{\beta_1,\beta_2} \partial_t^{\beta_1} D^{\beta_2}_x u_\beta$, where $u_\alpha \in C(U)$, and write $f = \sum_{|\alpha| \leq N} D^\alpha_x f_\alpha$, where $f_\alpha \in C(U)$. If $u_\beta = 0$ for any $\beta$ with $\beta_1 > 0$, then $u \in C(I, \DD(V)^*)$. Otherwise, let $M$ be the smallest integer such that $u_\beta = 0$ for any $\beta$ with $\beta_1 > M$. Then
    %
    \[ \partial_t u = f - Lu = \sum D^\alpha f_\alpha - \sum L D^\alpha u_\alpha. \]
    %
    But, antidifferentiating, we can write
    %
    \[ \sum D^\alpha f_\alpha - \sum L D^\alpha u_\alpha = \partial_t \left\{ \sum_\beta \partial_t^{\beta_1} D^{\beta_2} g_\beta \right\}, \]
    %
    where $g_\beta = 0$ for $\beta_1 > M-1$. But we have already seen from the fact that these quantities are equal, that
    %
    \[ u - \sum_\beta \partial_t^{\beta_1} D^{\beta_2} g_\beta \]
    %
    lies in $C(I,\DD(V)^*)$. Applying induction on $M$, we conclude $u \in C(I,\DD(V)^*)$. But $\partial_t u = u - Lf$ also lies in $C(I,\DD(V)^*)$, and so $u \in C^1(I,\DD(V)^*)$.
\end{proof}

\begin{remark}
    If $f$ extends to an element of $C(\overline{I}, \mathcal{D}(V)^*)$, and $u$ extends to a distribution defined in an open neighborhood of $\overline{I} \times V$, then the proof actually shows that $u \in C^m(\overline{I}, \DD(V)^*)$.
\end{remark}

We can also consider some Fourier analytic techniques.

\begin{theorem}
    Let $P$ be a polynomial with constant coefficients. For a compactly supported distribution $f \in \EC(\RR^d)$, the equation
    %
    \[ P(D_x) u = f \]
    %
    has a compactly supported distributional solution $u$ if and only if the equation
    %
    \[ \xi \mapsto \frac{\widehat{f}(\xi)}{P(\xi)} \]
    %
    is entire in $\xi$. In this case the compactly supported solution is unique, and the convex hull of the support of $u$ is equal to the convex hull of the support of $f$.
\end{theorem}
\begin{proof}
    If a solution $u$ exists, then we obtain that
    %
    \[ P(\xi) \widehat{u}(\xi) = \widehat{f}(\xi), \]
    %
    where $\widehat{u}$ and $\widehat{f}$ are entire functions of $\xi$. It follows that $\xi \mapsto \widehat{f}(\xi) / P(\xi)$ is entire. Conversely, suppose that
    %
    \[ h(\xi) = \frac{\widehat{f}(\xi)}{P(\xi)} \]
    %
    is entire. Let $P$ be a polynomial of degree $m$, and, possibly by changing our coordinates, we may assume without loss of generality that the coefficient $a$ of $\xi_1^m$ in $P$ is nonzero. The function
    %
    \[ z \mapsto P(\xi + z e_1) \]
    %
    has leading coefficient $a$. A maximal-principle argument (see Hormander, Lemma 7.3.3) shows that
    %
    \[ |a h(\xi)| \leq \sup_{|z| = 1} | P(\xi + ze_1) h(\xi + z e_1) | = \sup_{|z| = 1} | \widehat{f} (\xi + z e_1)|.  \]
    %
    If $f$ is a distribution of order $N$, compactly supported on some compact set $K$ with supporting function $H$, then the Paley-Wiener theorem implies we have an estimate of the form
    %
    \[ |\widehat{f}(\xi)| \lesssim (1 + |\xi|)^N e^{H(\text{Im} \xi)}. \]
    %
    It follows that we also have estimates of the form
    %
    \[ |h(\xi)| \lesssim (1 + |\xi|)^N e^{H(\text{Im} \xi)}. \]
    %
    It thus follows that if $u$ is the inverse Fourier transform of $h$, then $u$ is a distribution of order $N$ supported on $K$. But then $P(D_x) u = f$.
\end{proof}

\begin{remark}
    Modifying these calculations somewhat (see Theorem 7.3.8 of Hormander), we can show that the convex hull of the \emph{singular} support of $u$ is equal to the convex hull of the \emph{singular} support of $f$. In particular, if $u$ is a compactly supported distribution, and $f = P(D_x) u$, then
    %
    \[ \frac{\widehat{f}(\xi)}{P(\xi)} = \widehat{u}(\xi) \]
    %
    is always entire. Thus if $u$ is a compactly supported distribution, and $P(D_x) u$ is smooth, then $u$ is smooth. This is certainly not true for differential operators $L$ with non-constant coefficients. An example is the equation $Lu = x u'$ on the real line; if $u$ is a compactly supported distribution with a `jump at the origin', i.e. which agrees with $\mathbf{I}(x \geq 0)$ near the origin, and is smooth away from the origin, then $Lu$ is smooth, but $u$ is certainly not smooth. TODO: Is this something to do with the microlocal behaviour of constant coefficients operators, i.e. from an analytic perspective I'm not too comfortable with right now?*
\end{remark}

One consequence of this result is that one can \emph{separate variables} when solving constant coefficient partial differential equations on convex domains.

\begin{theorem}
    If $X$ is convex, then the span of all solutions to the equation
    %
    \[ P(D_x) \phi_{Q,\xi} = 0 \]
    %
    where $\phi_{Q,\xi}$ is of the form
    %
    \[ \phi_{Q,\xi}(x) = Q(x) e^{2 \pi i \xi \cdot x} \]
    %
    for some polynomial $Q$, and some $\xi \in \RR^d$, is dense in the space of all $\phi \in \EC(X)$ such that $P(D_x) \phi = 0$.
\end{theorem}
\begin{proof}
    Fix a compactly supported distribution $u \in \EC(X)^*$, and suppose that
    %
    \[ \int u(x) \phi_{Q,\xi}(x)\; dx = 0 \]
    %
    for all $\phi_{Q,\xi}$ such that $P(D_x) \phi_{Q,\xi} = 0$. By the Hahn-Banach theorem, it suffices to show that for any $\phi \in \EC(X)$ satisfying $P(D_x) \phi = 0$,
    %
    \[ \int u(x) \phi(x)\; dx = 0. \]
    %
    This will follow if we can show that $h(\xi) = \widehat{u}(\xi) / P(-\xi)$ is an entire function of $\xi$, for then $u = P(-D_x) v$ for some compactly supported function $v$ on $X$, and the result then follows by an integration by parts. TODO: Lemma 7.3.7 of Hormander.
\end{proof}






\section{Fundamental Solutions}

Let us now discuss the idea of a \emph{fundamental solution} to a partial differential equation, a technique very useful to the study of the existence and uniqueness of such equations. For a differential operator $L = \sum c_\alpha D^\alpha$ with constant coefficients on $\RR^n$, a \emph{fundamental solution} for $L$ is a distribution $\Phi \in \DD(\RR^n)^*$ such that $L\Phi = \delta$ is the Dirac delta function at the origin. The reason that fundamental solutions are so useful to the study of constant coefficient partial differential equations is that for any compactly supported distribution $v \in \DD(\RR^d)^*$, the distribution $u = \Phi * v$ is a solution to the equation $Lu = v$, since $L u = (L \Phi) * v = \delta * v = v$. Thus fundamental solutions give rise to a natural right inverse to a differential operator. It is a general result that \emph{all} constant coefficient differential equations have fundamental solutions, though here we only consider particular examples.

\begin{example}
    Consider the differential operator $\Delta$, defining Poisson's equation $\Delta u = v$. To guess a fundamental solution for $\Delta$, we first note that since $\Delta$ is invariant under rotations, as is the Dirac delta, the equation $\Delta u = \delta$ is radially symmetric. Thus we might expect to find a radially symmetric fundamental solution. Since $\Delta$ is \emph{elliptic}, we expect fundamental solutions to be smooth away from the origin. Thus to make a guess on the fundamental solution, it will be a useful calculation to determine all smooth, radially symmetric functions $u: \RR^n - \{ 0 \} \to \CC$ such that $\Delta u = 0$. If $u(x) = f(|x|)$ for $x \neq 0$ and $f \in C^\infty((0,\infty))$, then for $r > 0$,
    %
    \[ f''(r) + \frac{n-1}{r} f'(r) = 0. \]
    %
    For $n > 2$, this implies that $f(r) = a_1 r^{2-n} + a_2$, and for $n = 2$, $f(r) = a_1 \log(r) + a_2$. We might expect that some choice of constants gives the fundamental solution if we extend these functions to distributions on $\RR^n$. We may without loss of generality pick $a_2 = 0$, since constants do not factor into the output of the operator $\Delta$. The correct choice of the constant $a_1$ gives the \emph{Poisson kernel}
    %
    \[ \Phi(x) = \begin{cases} - \frac{1}{2 \pi} \log |x| &: \text{if $n = 2$} \\ - \frac{1}{c_n} \frac{1}{n-2} \frac{1}{|x|^{n-2}} &: \text{if $n > 2$.} \end{cases} \]
    %
    Here $c_n$ is the surface area of the unit sphere in $\RR^n$. These distributions are all locally integrable near the origin and thus extend uniquely to distributions on $\RR^n$. To prove that $\Phi$ is a fundamental solution, it suffices to show for any $\phi \in \DD(\RR^d)$,
    %
    \[ \phi(0) = \int \Phi(x) \Delta \phi(x)\; dx. \]
    %
    Since $\Phi$ is locally integrable, Gauss' formula implies that as $\varepsilon \to 0$,
    %
    \[ \int_{|x| \geq \varepsilon} \Phi(x) \Delta \phi(x)\; dx = \int_{|x| = \varepsilon} \Phi(x) [\nabla \phi(x) \cdot n(x)] dS - \int \nabla \Phi(x) \cdot \nabla \phi(x)\; dx. \]
    %
    Now a simple estimate gives that as $\varepsilon \to 0$,
    %
    \[ \int_{|x| = \varepsilon} \Phi(x) [\nabla \phi(x) \cdot n(x)] dS \to 0. \]
    %
    Thus we conclude that
    %
    \[ \int \Phi(x) \Delta \phi(x)\; dx = - \int \nabla \Phi(x) \cdot \nabla \phi(x)\; dx. \]
    %
    Again, we approximate away from the origin by a $\varepsilon$ ball, integrate by parts, and calculate that
    %
    \begin{align*}
        \int_{|x| \geq \varepsilon} \nabla \Phi(x) \cdot \nabla \phi(x)\; dx &= \int_{|x| = \varepsilon} \phi(x)\ [\nabla \Phi(x) \cdot n(x)] dS - \int_{|x| \geq \varepsilon} \Delta \Phi(x) \phi(x)\; dx\\
        &= \int_{|x| = \varepsilon} \phi(x)\ [\nabla \Phi(x) \cdot n(x)] dS.
    \end{align*}
    %
    For $n = 2$, we have $\nabla \Phi(x) = (2 \pi)^{-1} (x/|x|^2)$, hence
    %
    \begin{align*}
        \int_{|x| = \varepsilon} \phi(x) [\nabla \Phi(x) \cdot n(x)] dS &= \frac{1}{2 \pi \varepsilon} \int_{|x| = \varepsilon} \phi(x)\; dx\\
        &= \phi(0) + O(\varepsilon).
    \end{align*}
    %
    For $n > 2$, $\nabla \Phi(x) = c_d^{-1} (x / |x|^d)$, so
    %
    \begin{align*}
        \int_{|x| = \varepsilon} \phi(x) [\nabla \Phi(x) \cdot n(x)] dS &= \frac{1}{c_d \varepsilon^{d-1}} \int_{|x| = \varepsilon} \phi(x)\; dS = \phi(0) + O(\varepsilon).
    \end{align*}
    %
    Taking $\varepsilon \to 0$ gives the result.

    An alternate approach to obtaining this fundamental solution is to take Fourier transforms, assuming that we can find a \emph{tempered} fundamental solution $\Phi$. If $\Psi = \widehat{\Phi}$, then we conclude that $\Phi$ is a fundamental solution if and only if $\Psi$ is tempered and
    %
    \[ - 4\pi^2 |\xi|^2 \cdot \Psi(\xi) = 1. \]
    %
    For $n > 2$, we can interpret the formula $\Psi(\xi) = (-1/4\pi^2) |\xi|^{-2}$ as defining a distribution by integration against a locally integrable function. For $n = 2$ a version of this equation remains true provided that we interpret the distribution $1/|\xi|^2$ at the origin in the right way. Thus we have the alternate expression for the fundamental solution above.
\end{example}

\begin{example}
    Next, consider the operator $L = \partial_t - \Delta$ on $\RR^{n+1}$, which gives rise to the heat equation. Set
    %
    \[ \Phi_+(x,t) = \frac{1}{(4 \pi t)^{n/2}} \exp \left( - \frac{|x|^2}{4t} \right) \]
    %
    for $t > 0$, and $\Phi(x,t) = 0$ for $t \leq 0$. Then $\Phi$ is locally integrable, and a fundamental solution for $L$. Indeed, $\Phi$ is tempered in the $x$-variable, and the Fourier transform of $\Phi$ in the $x$ variable is verified to be
    %
    \[ U(\xi,t) = e^{- 4 \pi^2 t |\xi|^2} \]
    %
    which satisfies $\partial_t U = - 4 \pi^2 |\xi|^2 U$, which is equivalent to the equation $L \Phi = \delta$. We see immediately that $\Phi(0+) = \lim_{t \to 0} \Phi(t)$ is the Dirac delta function at the origin.

    More generally, similar calculations enable us to find fundamental solutions to any operator of the form $L = \partial_t - S$, where $S = \sum A_{ij} \partial_i \partial_j$. If we assume that there exists a fundamental solution $\Phi_+$ to $L$, tempered in the $x$-variable and supported on $t \geq 0$, then taking Fourier transforms of the equation $L\Phi = \delta$ in the $x$-variable, and setting $\Psi_+$ to be this Fourier transform, we are lead to conclude that $\partial_t \Psi + 4\pi^2 (\xi^T A \xi) \Psi = \delta(t)$. Let us assume that $\Phi$ is supported on $t \geq 0$. Thus we can write
    %
    \[ \Psi(\xi,t) = H(t) A(\xi) e^{- 4 \pi^2 (\xi^T A \xi) t} \]
    %
    for some distribution $A \in \DD(\RR^n)^*$. But we then calculate that
    %
    \[ L \Psi = \delta(t) A(\xi) \]
    %
    and so we must have $A(\xi) = 1$, i.e.
    %
    \[ \Psi(\xi,t) = H(t) e^{-4 \pi^2 (\xi^T A \xi) t}. \]
    %
    But this means that, in order to get a tempered fundamental solution we must assumed $\text{Re}(A)$ is positive semidefinite. If we, in addition, assume that $A$ is invertible, then we have the Fourier transform for $\Psi$, namely, we conclude that
    %
    \[ \Phi(x,t) = \frac{H(t)}{(4 \pi t)^{n/2} ( \det(A))^{1/2}} e^{- x^T A^{-1} x / 4t}. \]
    %
    If the real part of $A$ is positive \emph{definite}, then the same is true for $A^{-1}$, and so $\Phi$ can be interpreted as locally integrable on $\RR \times \RR^n$. On the other hand, if $A$ is positive \emph{semidefinite} this is not the case, for instance, the Schr\"{o}dinger equation $L = \partial_t - i \Delta_x$ has fundamental solution
    %
    \[ \Phi(x,t) = \frac{H(t)}{(4 \pi i t)^{n/2}} e^{i |x|^2 / 4t},  \]
    %
    which is not locally integrable, but we must treat this solution as a principal value in the $t$-variable, using the principle of stationary phase to show the limit is well defined, which allows us to conclude $\Phi$ is a distribution of order $n+1$.
\end{example}

Before we consider other quadratic partial differential operators, let us perform a few calculations. Take an operator of the form
%
\[ L_A = \sum_{i,j = 1}^n A_{ij} D^{ij}_x \]
%
for some symmetric $n \times n$ matrix $A$. If $T$ is an invertible linear transformation, then the chain rule implies that
%
\[ D^i \{ f \circ T \} = \sum_{k = 1}^n T_{ki} \cdot (D^k \{ f \} \circ T), \]
%
i.e. $\nabla \{ f \circ T \} = T^t \{ (\nabla f) \circ T \}$. Iterating the chain rule, we find that
%
\[ D^{ij} \{ f \circ T \} = \sum_{k = 1}^n \sum_{l = 1}^n T_{lj} T_{ki} \cdot (D^{kl} \{ f \} \circ T). \]
%
Thus the Hessian is $H \{ f \circ T \} = T^t \cdot \{ Hf \circ T \} \cdot T$. This means that if $T^* L_A$ is the operator given by the equation $T^*L_A \{ f \} = L_A \{ f \circ T \} \circ T^{-1}$, then
%
\[ T^*L_A f = (L_{TAT^t} f) \circ T. \]
%
The use of these pullbacks is that if $f \in C^\infty(\RR^n)$, and if $T^* f = f \circ T^{-1}$, then
%
\[ T^* \{ L_A f \} = L_A f \circ T^{-1} = L_A \{ T^* f \circ T \} \circ T^{-1} = (T^* L_A) \{ T^* f \}. \]
%
We can take several important points away from this result:
%
\begin{itemize}
    \item $T^*L = L$ precisely when $TAT^t = A$, which is equivalent to the condition that if $B_A(x,y) = x^t A y$ is the symmetric bilinear form specified by $A$, then $B_A(Tx,Ty) = B(x,y)$. The family of such linear maps from a \emph{generalized orthogonal group}.

    \item Sylvester's law of inertia implies we can write any symmetric $n \times n$ matrix $A$ as $T^{-1} B T^{-t}$, where $B$ is a diagonal matrix consisting of zeroes, ones, and negative ones. But this means that
    %
    \[ T^* L = \sum B_{ii} (D^{ii} \{ f \} \circ T). \]
    %
    Thus the theory of a real-coefficient order two differential equation with constant coefficients is equivalent to one of the form
    %
    \[ Lf = \sum_{1 \leq i < n_1} \frac{\partial^2 f}{\partial x_i^2} - \sum_{n_1 \leq i < n_2} \frac{\partial^2 f}{\partial x_i^2}, \]
    %
    where $n_1 + n_2 \leq n$. This simplifies our calculations considerably, e.g. the theory of an operator $L$ given by a positive definite matrix $A$, i.e. one which has signature $(n,0)$, is equivalent to the theory of the Laplacian $\Delta$. The theory of $L$ given by a $(n+1) \times (n+1)$ matrix with signature $(1,n)$ is equivalent to the theory of the wave operator $\Box = \partial_t^2 - \Delta_x$, and so on and so forth.
\end{itemize}
%
Inspired by these calculations, we now find a fundamental solution to any quadratic partial differential operator $L = \sum B_{ij} \partial^{ij}$, such that $B$ is invertible. Abusing notation, we identify a matrix $A$ with the function given by it's associated quadratic form, i.e. the function $x \mapsto x^T A x$.

\begin{lemma}
    Let $A$ be a real, invertible matrix with signature $(n_+,n_-)$. If $c_n$ is the surface area of the unit sphere in $\RR^n$, then for $n > 2$, if we let $B = A^{-1}$, and
    %
    \[ L_B = \sum B_{ij} D^{ij}, \]
    %
    then $L_B \{ (A \pm i 0)^{1 - n/2} \} = - (n-2) c_n |\det(A)|^{-1/2} e^{\mp i \pi n_- / 2} \delta_0$.
\end{lemma}
\begin{proof}
    By conjugation, it suffices to show that
    %
    \[ L_B \{ (A + i 0)^{1-n/2} \} = - (n-2) c_n |\det A|^{-1/2} e^{- i \pi n_- / 2} \delta_0. \]
    %
    We will begin by showing that if $A$ is a symmetric matrix with complex coefficients such that $\text{Re}(A)$ is positive definite, and if $B$ is the inverse of $A$, then
    %
    \[ L_B \{ A^{1-n/2} \} = -(n-2) c_n (\det A)^{-1/2} \delta \]
    %
    where the determinant power is defined to be the unique analytic branch such that $(\det A)^{-1/2} > 0$ if $A$ is positive definite. Analytic continuation means we only need to prove this formula if $A$, and thus $B$, is positive definite. But then we can find a matrix $S$ such $S B S^t = I$, and thus $S^{-t} A S^{-1} = I$. But then
    % \det(S) = det(A)^{1/2}
    \begin{align*}
        S^* \{ L_B \{ A^{1-n/2} \} \} &= (S^* L_B) \{ S^* A^{1-n/2} \}\\
        &=  L_I \{ |x|^{2-n} \}\\
        &= \Delta \{ |x|^{2-n} \}\\
        &= - (n-2) c_n \delta_0.
    \end{align*}
    %
    The result then follows because
    %
    \[ (S^{-1})^* \delta_0 = \det(S)^{-1} \delta_0 = \det(A)^{-1/2}. \]
    %
    To obtain the general result, we now note that if
    %
    \[ A_\varepsilon = \varepsilon - i A \quad\text{and}\quad B_\varepsilon = (\varepsilon - iA)^{-1}. \]
    %
    Then
    %
    \[ \det(A_\varepsilon)^{-1/2} = |\det(A)|^{-1/2} e^{i \pi \text{sgn}(A) / 4}, \]
    %
    and $B_\varepsilon \to i B$ and $A_\varepsilon^{1-n/2} \to i^{-1} e^{i \pi n / 4} (A + i0)^{1-n/2}$, so that this gives the result in the limit.
\end{proof}
 
We would hope to define a fundamental solution to the equation $L_B$ as the pullback
%
\[ A^* \chi_+^{1-n/2}. \]
%
This is not quite possible using the spectral analysis of singularities since $A$ is singular at the origin. But provided $A$ is nonsingular, we can define the pullback viewing $A$ as a map from $\RR^n - \{ 0 \} \to \RR$, thus giving us a distribution away from the origin. Since $A^* \chi_+^{1-n/2}$ is then a homogeneous distribution of degree $2-n$ on $\RR^n - \{ 0 \}$, this distribution then uniquely extends to a distribution on $\RR^n$, and we claim this is a constant multiple of a fundamental solution.

\begin{corollary}
    Using the setup to the previous lemma,
    %
    \[ L_B \{ A^* \chi_{\pm}^{1-n/2} \} = \pm 4 \pi^{n/2 - 1} \sin (\pi n_{\pm} / 2) |\det A|^{-1/2} \delta_0. \]
\end{corollary}
\begin{proof}
    The result follows from the previous result given that
    %
    \[ \chi_+^a(s) = \frac{i}{2\pi} \Gamma(-a) ((s - i0)^a e^{i \pi a} - (s + i0)^a e^{-i \pi a}) \]
    %
    for all $a$ that is not a positive integer. To obtain this, we use the fact that $\Gamma(a+1) \Gamma(-a) = - \pi / \sin(\pi a)$, which means that
    %
    \begin{align*}
        \chi_+^a(s) &= \frac{1}{\Gamma(a+1)} s_+^a\\
        &= - \frac{1}{\pi} \Gamma(-a) \sin(\pi a) \cdot s_+^a\\
        &= \frac{i}{2 \pi} \Gamma(-a) (e^{i \pi a} - e^{- i \pi a}) s_+^a.
    \end{align*}
    %
    For $\text{Re}(a) > 0$, $s_+^a$ is locally integrable, and
    %
    \[ (s \pm i0)^a = \begin{cases} s^a &: s \geq 0, \\ |s| e^{\pm i \pi a} &: s < 0. \end{cases} \]
    %
    Thus we conclude that
    %
    \[ (e^{i \pi a} - e^{-i \pi a}) s_+^a = e^{i \pi a} (s - i 0)^a - e^{-i \pi a} (s + i0)^+. \]
    %
    The general case follows by analytic continuation.
\end{proof}

%These calculations are closed related to the behaviour of operators under changes of variables, i.e. working in the language of differential geometry, if we consider two coordinate systems $x: \RR^n \to \RR^n$ and $y: \RR^n \to \RR^n$ on $\RR^n$, where $y$ is equal to $T^{-1}$, then we have the two operators $\nabla_x$ and $\nabla_y$, where $\nabla_x$ is the usual gradient, and
%
%\[ \nabla_y f = \nabla \{ f \circ y^{-1} \} \circ y, \]
%
%then our calculations show that $\nabla_y f = T^t \cdot \nabla_x f$. If we define the Hessians $H_x$ and $H_y$, where $H_x$ is the usual Hessian, and
%
%\[ H_y f = H \{ f \circ y^{-1} \} \circ y, \]
%
%then our calculations show that $H_y = T^t \cdot H_x f \cdot T$. In particular, if we consider a second order constant coefficient partial differential equation
%
%\[ L = \sum g_{ij} D^{ij}, \]
%
%whre $G = \{ g_{ij} \}$ is a real-valued symmetric matrix. Sylvester's law of inertia shows that we can write $G = T A T^t$, where $A$ is a diagonal matrix consisting of zeroes, ones, and minus ones. If we let $y = T$, then

\begin{example}
    Consider the d'Alembertian, or wave operator $\Box f = \partial_t^2 f - \Delta_x f$. The fundamental solutions for this equation are significantly richer than for the Laplace equation. There is no single preferred fundamental solution in this setting. Physical intuition tells us that waves travel at a \emph{finite speed of propagation}, in this case, at a unit velocity. Thus we expect to find a fundamental solution supported on the interior of the \emph{light cone}
    %
    \[ \Sigma = \{ (x,t) \in \RR^n \times \RR: Q(x,t) = 0 \}, \]
    %
    i.e. supported on $\Sigma_+ = \{ (x,t) \in \RR^n \times \RR: Q(x,t) \geq 0 \}$, where $Q(x,t) = t^2 - |x|^2$. In fact, for $n \geq 2$, we have already done the calculations to find such a fundamental solution, namely we have a fundamental solution of the form
    %
    \[ \Phi = \frac{1}{4 \pi^{\frac{n-1}{2}}} Q^* \left(\chi_+^{-\frac{n-1}{2}} \right). \]
    %
    For $n = 1$, this formula actually continues to hold, namely, we have
    %
    \[ \Phi(x,t) = (1/2) \mathbf{I}((x,t) \in \Sigma_+) = (1/2) H(t - x) H(t + x), \]
    %
    though we have to make do with more rudimentary calculations. These choices give fundamental solutions to the wave equation. To verify the equation gives a fundamental solution to the wave operator for $n = 1$, we calculate that
    %
    \begin{align*}
        \partial_t \Phi(x,t) &= (1/2) \delta(t - x) H(t + x) + (1/2) \delta(t + x) H(t - x)\\
        &= (1/2) \left( \delta(t - x) + \delta(t + x) \right) H(t),
    \end{align*}
    %
    and so
    %
    \begin{align*}
        \partial_t^2 \Phi(x,t) &= (1/2) \left( \delta(t - x) + \delta(t + x) \right) \delta(t) + (1/2) \left( \delta'(t-x) + \delta'(t + x) \right) H(t)\\
        &= \delta(x,t) + (1/2) \left( \delta'(t-x) + \delta'(t + x) \right) H(t).
    \end{align*}
    %
    Next, we calculate that
    %
    \begin{align*}
        \partial_x \Phi(x,t) &= (1/2) H(t - x) \delta(t + x) - (1/2) H(t + x) \delta(t-x)\\
        &= (1/2) \left( \delta(t + x) - \delta(t - x) \right) H(t),
    \end{align*}
    %
    and thus
    %
    \begin{align*}
        \partial_x^2 \Phi(x,t) &= (1/2) \left( \delta(t + x) - \delta(t - x) \right) \delta(t) + (1/2) \left( \delta'(t + x) + \delta'(t - x) \right) H(t)\\
        &= (1/2) \left( \delta'(t + x) + \delta'(t - x) \right) H(t).
    \end{align*}
    %
    Thus $\Box \Phi(x,t) = \delta(t,x)$. In particular, we note that when $n$ is odd, then the support of
    %
    \[ \chi_+^{- \frac{n-1}{2}} \]
    %
    is equal to $\{ 0 \}$. This means that when $n \geq 3$ is odd, then $\Phi$ is actually \emph{supported} on $\Sigma$, which hints at \emph{Huygen's principle}, i.e. that in odd dimensions, if $u$ is a solution to the Cauchy problem $\Box u = 0$ with initial conditions $u_0$, then the behaviour of $u$ at a point $(t,x)$ is determined by the values of $u_0$ on a sphere of radius $t$ around $x$.

    There are two important alternate fundamental solutions, the \emph{forward} and \emph{backward}, or \emph{advanced} and \emph{retarded} fundamental solution
    %
    \[ \Phi_+(x,t) = 2 H(t) \Phi(x,t) \quad\text{and}\quad \Phi_-(x,t) = 2 H(-t) \Phi(x,t). \]
    %
    That these two distributions are also fundamental solution follows from the symmetry of all objects involved under time reflection. These are actually the \emph{unique} fundamental solutions supported on the forward and backward light cone and their interior. Indeed, if $u \in \DD^*(\RR^n \times \RR)$ is supported on the forward light cone and $\Box u = 0$, then
    %
    \[ u = (\Box \Phi_+) * u = \Phi_+ * \Box u = 0, \]
    %
    where the convolution is well defined because the projection
    %
    \[ ((x,t), (y,s)) \mapsto (x + y, t + s) \]
    %
    is then proper on $\text{supp}(u) \times \text{supp}(\Phi_+)$.

    The wave equation plays nicely with the Fourier transform. If $\Phi$ is any fundamental solution, and we assume that it is tempered in the $x$-variable (which is the case for the distributions we consider above), supported on $\Sigma$, then applying the Fourier transform in this variable, i.e. setting $\Psi = \mathcal{F}_x \Phi$, then
    %
    \[ \partial_t^2 \Psi(\xi,t) + 4 \pi^2 |\xi|^2 \Psi(\xi,t) = \delta(t) \]
    %
    This implies that, for $t > 0$, we have
    %
    \[ \Psi(\xi,t) = A_+(\xi) e^{2 \pi i |\xi| t} + B_+(\xi) e^{-2 \pi i |\xi| t}, \]
    %
    and a similar formula, allowing different functions, for $t < 0$. Because $\Psi$ is smooth away from the boundary of the light cone, this implies that $A_+$ and $B_+$ are both smooth functions. We calculate that
    %
    \[ \partial_t \Psi(\xi,0) = 2 \pi i |\xi| [A_+(\xi) - B_+(\xi)] \]
    %
    If we assume that $\Psi$ is supported on $t \geq 0$, and we denote it by $\Psi_+$, then for any $\phi \in \DD(\RR^n \times \RR)$, an integration by parts shows that
    %
    \begin{align*}
        \int_0^\infty &\int_{\RR^n} (\partial_t^2 \phi(\xi,t) + 4 \pi^2 |\xi|^2 \phi(\xi,t)) \Psi_+(\xi,t)\\
        &= - [A_+(\xi) + B_+(\xi)] \partial_t \phi(\xi,0) + 2 \pi i |\xi| [A_+(\xi) - B_+(\xi)] \phi(\xi,0).
    \end{align*}
    %
    Thus to get a fundamental solution, we should have $A_+(\xi) + B_+(\xi) = 0$, and $A_+(\xi) - B_+(\xi) = 1 / 2 \pi i |\xi|$. Thus we conclude that
    %
    \[ \Psi_+(\xi,t) = \frac{\sin(2 \pi |\xi| t)}{4 \pi |\xi|}. \]
    %
    This implies that there is a \emph{unique} fundamental solution supported on $t > 0$ and tempered in the $x$-variable, i.e. the fundamental solution $\Phi_+$ we define above, and moreover, we have the Fourier representation
    %
    \[ \Phi_+(x,t) = \frac{H(t)}{2} \int \frac{\sin(2 \pi |\xi| t)}{2 \pi |\xi|} e^{2 \pi i \xi \cdot x}\; d\xi. \]
    %
    % (x,t) -> (0,c)
    % t^2 - |x|^2 = c^2
    %
    % T(0,c) = (x,t)
    %
    % T is [A B]
    %      [C D]
    % A is n x n
    % B is n x 1
    % C is 1 x n
    % D is 1 x 1
    %
    % Bc = x
    % Dc = t
    %
    % D = t/c
    % B = x/c
    %
    % [A  x/c]
    % [C  t/c]
    % [A  x/c] [-1 0] [A^T   C^T]
    % [C  t/c] [ 0 1] [x^T/c t/c]
    % [-A x/c] [A^T   C^T]
    % [-C t/c] [x^T/c t/c]
    % [-AA^T + |x|^2/c^2     -AC^T + xt/c^2]
    % [-CA^T + tx^T/c^2      -CC^T + t^2/c^2]
    % AA^T = 1 + |x|^2/c^2 = t^2/c^2
    % AC^T = xt/c^2
    % CC^T = t^2/c^2 - 1 = |x|^2/c^2
    %
    % so A = (t/c) * O(n)
    % |C| = |x|/c
    % AC^T = xt/c^2
    % Very easy to do this
    % We can pick any C (n degrees of freedom)
    % then there are dim(O(n-1)) degrees of freedom to pick A.
    % Thus total degrees of freedom in picking are n + (n-1)(n-2)/2 = (n^2 - n + 2)/2
    % Total degrees of freedom of Lorenz transformations are (n+1)n/2 = (n^2 + n)/2
    % Thus picking a vector to do this to requires losing 2(n-1) degrees of freedom
    % Thus we should be able to map m <= (n^2 - n + 2) / 4(n-1) approx n/4 vectors to arbitrary positions.
    %
    % A = (t/c) * O(n)
    % B = x/c
    % |C| = |x|/c
    % D = t/c
    %
    % det((t/c)*M  x/c)
    %    (|x|/c    t/c)
    % ( (t/c) * M    x/c ) (M^{-1}   0)
    % (  v    t/c        )  ( 0       1)
    %  (t/c)      x/c
    % vM^{-1}     t/c
    % Has determinant (t/c)^{n+1}
    %
    A similar formula holds for the other fundamental solutions we constructed above, namely
    %
    \[ \Phi_-(x,t) = \frac{H(-t)}{2} \int \frac{\sin(- 2 \pi |\xi| t)}{2 \pi |\xi|} e^{2 \pi i \xi \cdot x}\; d\xi, \]
    %
    and
    %
    \[ \Phi(x,t) = \frac{1}{4} \int \frac{\sin(2 \pi |\xi t|)}{2 \pi |\xi|} e^{2 \pi i \xi \cdot x}\; d\xi. \]
    %
    However, the Fourier calculation above yields some other interesting fundamental solutions, such as the \emph{Feynman fundamental solution}
    %
    \[ \Phi_F(x,t) = \frac{1}{4i} \int \frac{1}{2 \pi |\xi|} e^{2 \pi i (\xi \cdot x + |\xi t|)}\; d\xi  \]
    %
    One quirk of this fundamental solution is that it is \emph{not} contained in the light cone, despite the finite speed of propogation of the d'Alembertian. In fact, $\text{supp}(\Phi_F) = \RR \times \RR^n$. To see this, let $u(t) = \Phi_F(0,t)$ and $v(x) = \Phi_F(x,0)$. That $\text{supp}(\Phi_F) = \RR \times \RR^n$ will follow from the symmetry of $\Phi_F$ under the Lorentz transformation, and that $\text{supp}(u) = \RR$, $\text{supp}(v) = \RR^n$. To obtain this, we can explicitly calculate that for $n = 1$, $v(x)$ is a multiple of $\text{sgn}(x)$, and for $n > 1$, $v(x)$ is a multiple of $|x|^{1-n}$. In both cases, $\text{supp}(v) = \RR^n$. Next, we calculate that
    %
    \[ u(t) = \frac{1}{4i} \int \frac{e^{2 \pi i |\xi t|}}{2\pi|\xi|}\; d\xi = \frac{A_{n-1}}{4i} \int_0^\infty \tau^{n-2} e^{2 \pi i \tau t}\; d\tau. \]
    %
    Thus $u$ is the Fourier transform of a homogeneous function of order $n-2$ in the $\tau$ variable, and is thus a homogeneous function of order $1-n$ in the $t$ variable. Applying time reversal symmetry, and the fact that $u(t)$ is not supported at the origin (since it's Fourier transform is not a polynomial) imply that $\text{supp}(u) = \RR$.

    TODO: Move to Cauchy Problem For the study of the Cauchy problem for the wave operator, it is useful to study the behaviour of $\Phi_+$ for $t > 0$. Since $\partial_t^2 \Phi - \Delta_x \Phi = 0$, it follows from the general theory of distributional solutions to ODEs that $\Phi \in C^2([0,\infty), \DD(\RR^n)^*)$. In particular, if we consider the distributions $\Phi(t)$ on $\DD(\RR^n)^*$, then both $\Phi(0+) = \lim_{t \to 0^+} \Phi(t)$ and $\partial_t \Phi(0+) = \lim_{t \to 0^+} \partial_t \Phi(t)$ are well defined. Moreover, for $\phi \in \DD(\RR^{n+1})$ we have the representation formula
    %
    \[ \langle \Phi_+, \phi \rangle = \int_0^\infty \langle \Phi_+(t), \phi(t) \rangle\; dt, \]
    %
    since both sides of the equation define homogeneous distributions of order $1-n$ which agree for $\phi \in \DD(\RR^{n+1} - \{ 0 \})$, and thus agree for all $\phi \in \DD(\RR^{n+1})$. But integration by parts implies that
    %
    \begin{align*}
        \phi(0) &= \langle \Box \Phi_+, \phi \rangle\\
        &= \int_0^\infty \langle \Phi_+(t), \Box \phi(t) \rangle\; dt\\
        &= \int_0^\infty \langle \Phi_+(t), \partial_t^2 \phi(t) \rangle - \langle \Phi_+(t), \Delta \phi(t) \rangle\; dt\\
        &= \langle \partial_t \Phi_+(0+), \phi(0) \rangle - \langle \Phi_+(0+), \partial_t \phi(0) \rangle.
    \end{align*}
    %
    Since this is true for arbitrary $\phi \in \DD(\RR^{n+1})$, we conclude that $\Phi_+(0+) = 0$ and $\partial_t \Phi_+(0+) = \delta$. For $t > 0$, we can compute a formula for the distribution $\Phi_+$. The map $(t,x) \mapsto (t^2 - |x|^2, x)$ then has an inverse
    %
    \[ H(s,x) = ( (s + |x|^2)^{1/2} , x). \]
    %
    Thus $|\det(DH)| = (1/2) (s + |x|^2)^{-1/2}$. If $\phi \in \DD(\RR^n \times \RR)$ is supported on $t > 0$, and we set
    %
    \[ \langle \Phi_+, \phi \rangle = \frac{1}{4 \pi^{\frac{n-1}{2}}} \langle \chi_+^{- \frac{n-1}{2}}, \psi \rangle, \]
    %
    where
    %
    \[ \psi(s) = \int \phi(H(s,x)) (s + |x|^2)^{-1/2}\; dx. \]
    %
    If we set
    %
    \[ \tilde{\phi}(t,r) = \frac{1}{r} \int_{|x| = r} \phi(t, x)\; dx, \]
    %
    then
    %
    \[ \psi(s) = \int_{s^{1/2}}^\infty \tilde{\phi}(t, (t^2 - s)^{1/2})\; dt \]
    %
    If we consider the compactly supported distribution $\Phi_+(t)$ on $\RR^n$, then for $\eta \in C^\infty(\RR^n)$,
    %
    \[ \langle \Phi_+(t), \eta \rangle = \frac{1}{4 \pi^{\frac{n-1}{2}}} \int_0^{t^2} \chi_+^{-\frac{n-1}{2}}(s) \tilde{\eta}((t^2 - s)^{1/2})\; ds, \]
    %
    where
    %
    \[ \tilde{\eta}(r) = \frac{1}{r} \int_{|x| = r} \eta(x)\; dx.  \]
    %
    For $n = 1$, we have $\chi_+^0(s) = H(s)$, and
    %
    \[ \Phi_+(t) = (1/2) \mathbf{I}_{[-t,t]}. \]
    %
%    \begin{align*}
%        \langle \Phi_+(t), \eta \rangle &= \frac{1}{4} \int_0^{t^2} \tilde{\eta}((t^2 - s)^{1/2})\; ds\\
%        &= \frac{1}{2} \int_0^t \tilde{\eta}(r) r\; dr\\
%        &= \frac{1}{2} \int_0^t \left( \eta(r) + \eta(-r) \right)\; d\\
%        &= \frac{1}{2} \int_{-t}^t \eta(s)\; ds.
%    \end{align*}
    %
    For $n = 2$, we have $\chi_+^{-1/2} = x_+^{-1/2} \pi^{-1/2}$, and so
    %
    \[ \Phi_+(t) = (1/2 \pi) \cdot \max(t^2 - |x|^2, 0)^{-1/2}. \]
    %
    For odd values $n = 2 m + 1$, we have $\chi_+^{- \frac{n-1}{2}} = \chi_+^{-m} = D^{m-1} \delta_0$, and this leads to the conclusion that
    %
    \[ \langle \Phi_+(t), \eta \rangle = \frac{1}{4 \pi^m} \left. \frac{d^{m-1}}{ds^{m-1}} \left( \tilde{\eta}(s^{1/2}) \right) \right|_{s = t^2}. \]
    %
    Thus this value depends on the values of $\eta$, and their normal derivatives up to order $m-1$, on a sphere of radius $t$. In particular, for $n = 3$, we have
    %
    \[ \langle \Phi_+(t), \eta \rangle = \frac{1}{4 \pi} \tilde{\eta}(t) = \frac{1}{4 \pi t} \int_{|x| = t} \eta(x)\; dx. \]
\end{example}

TODO: Move to Cauchy Problem The existence and uniqueness of solutions to the Cauchy problem for the wave equation follow immediately from this calculation. Namely, if $\phi_0, \phi_1 \in C^\infty(\RR^n)$, and $f \in C^\infty(\RR^n \times [0,\infty))$, then there exists a unique $u \in C^\infty(\RR^n \times [0,\infty))$ such that $\Box u = f$ on $\RR^n \times [0,\infty)$, and we have
%
\[ u(t) = \Phi_+(t) * \phi_1 + (\partial_t \Phi_+)(t) * \phi_0 + \int_0^t (\Phi_+(t-s) * f(s))\; ds. \]
%
Uniqueness follows the fact the fact that if $u$ is a distribution supported on the forward light cone and $\Box u = 0$, then $u = 0$. Conversely, the equation above certainly defines an element of $C^\infty([0,\infty) \times \RR^n)$ and gives a solution since
%
\[ \Box (\Phi_+ * \phi_1) = \delta * \phi_1 = \phi_1 \]
%
\[ \Box (\partial_t \Phi_+ * \phi_0) = \partial_t (\Box \Phi_+ * \phi_0) = \partial_t \phi_0 = 0 \]
%
and since $\Phi_+(0) = 0$, and $\partial_t \Phi_+(0) = \delta$, we find that
%
\begin{align*}
    \partial_t \left\{ \int_0^t (\Phi_+(t-s) * f(s))) \right\} = \int_0^t (\partial_t \Phi_+(t-s) * f(s))
\end{align*}
%
and so
%
\[ \partial_t^2 \left\{ \int_0^t (\Phi_+(t-s) * f(s))\; ds \right\} = f(t) + \int_0^t (\partial_t^2 \Phi_+(t-s) * f(s)). \]
%
Since $\Box \Phi_+$ vanishes away from the origin,
%
\[ \Box \left\{ \int_0^t (\Phi_+(t-s) * f(s))\; ds \right\} = f(t), \]
%
which completes the proof.

\begin{example}
    Consider the Cauchy-Riemann equations on $\RR^2$, i.e. the operators $\partial_z = (1/2)(\partial_x - i \partial_y)$ and $\partial_{\overline{z}} = (1/2)(\partial_x + i \partial_y)$. The divergence theorem tells us that
    % F = (phi/2, -i \phi / 2)
    \[ \int_\Omega \frac{\partial \phi}{\partial z}\; dx\; dy = \frac{1}{2} \int_{\partial \Omega} \phi\; d\overline{z} \]
    %
    and
    %
    \[ \int_\Omega \frac{\partial \phi}{\partial \overline{z}}\; dx\; dy = \frac{1}{2} \int_{\partial \Omega} \phi\; dz \]
    %
    The variant of Green's formula then tells us that
    %
    \[ \int_\Omega \left( u \frac{\partial v}{\partial z} + \frac{\partial u}{\partial z} v \right)\; dx\; dy = \frac{1}{2} \int_{\partial \Omega} uv\; d\overline{z}. \]
    %
    Thus the operators $\partial_z$ and $\partial_{\overline{z}}$ are self adjoint. In particular, applying this formula gives that for any $\phi \in \DD(\RR^2)$,
    %
    \begin{align*}
        \int_{|z| \geq \varepsilon} \frac{\partial \phi}{\partial \overline{z}} \left( \frac{1}{\pi i} \frac{1}{z} \right)\; dx\; dy &= \frac{1}{2 \pi i} \int_{|z| = \varepsilon} \frac{\phi}{z}\; dz\\
        &= \frac{1}{2 \pi} \int_0^{2\pi} \phi(\varepsilon e^{i \theta})\; d\theta\\
        &= \phi(0) + O(\varepsilon).
    \end{align*}
    %
    Taking $\varepsilon \to 0$ allows us to conclude that
    %
    \[ \Phi(x,y) = \frac{1}{i \pi} \frac{1}{x + iy} \]
    %
    is a fundamental solution to the operator $\partial_{\overline{z}}$. Similarily,
    %
    \[ \Phi(x,y) = \frac{1}{i \pi} \frac{1}{x - iy} \]
    %
    is a fundamental solution to the operator $\partial_z$. The first fundamental solution is called the \emph{Cauchy Kernel}.
\end{example}

A simple consequence of the fundamental solution technique is the intriguing statement that \emph{any} distribution is a successive derivative of a family of continuous functions.

\begin{theorem}
    For any open set $U \subset \RR^n$, and any distribution $u \in \DD(U)^*$, there exists $f_\alpha \in C(U)$, such that the cover $\{ \text{supp}(f_\alpha) \}$ is locally finite on $U$, and such that $u = \sum_\alpha D^\alpha f_\alpha$.
\end{theorem}
\begin{proof}
    Suppose first that $U = \RR^n$. For any $m$, the function
    %
    \[ \Phi(x) = \max(x_1,0)^m \dots \max(x_n,0)^m / (m!)^n \]
    %
    is a fundamental solution to the operator $L = (\partial_1 \cdots \partial_n)^{m+1}$, and lies in $C^{m-1}(\RR^d)$. If $u$ is a distribution of order $m-1$, then it follows that $v = \Phi * u$ lies in $C(\RR^d)$, and $Lv = u$, which completes the proof in this case. In general, we just localize.
\end{proof}

Using Fourier analytic techniques, we can construct fundamental solutions to all homogeneous elliptic constant coefficient partial differential equations, and \emph{parametrices} for any elliptic constant coefficient partial differential equation $P(D_x)$, i.e. a distribution $u$ such that $P(D_x) u = \delta + \phi$, where $\phi \in C^\infty(\RR^d)$.

\begin{theorem}
    Every elliptic constant coefficient partial differential operator $P(D_x)$ has a parametrix $u$, and a fundamental solution if $P(D_x)$ is homogeneous.
\end{theorem}
\begin{proof}
    If $P$ is elliptic and homogeneous of some degree $m$, then $P(\xi)$ is non-vanishing away from the origin. It thus follows that $1/P(\xi)$ is homogeneous of degree $-m$ away from the origin, and thus extends to some distribution $v$ on $\RR^d$, though we note that if $m \geq d$ it may fail to be homogeneous, though we can still make this choice in such a way that $P \cdot v = 1$. It will still be tempered, however, and if we let $u$ denote it's inverse Fourier transform, then the Fourier transform of $P(D_x) u$ is equal to one, and thus $P(D_x) u = \delta$.

    If $P$ is no longer homogeneous, but it is elliptic, then there exists $\chi \in C^\infty(\RR^d)$ supported away from the origin and such that $\chi(\xi) = 1$ if $|\xi|$ is sufficiently large, such that the function
    %
    \[ v(\xi) = \frac{\chi(\xi)}{P(\xi)} \]
    %
    is well-defined and smooth. Then it is tempered, so we can take it's inverse Fourier transform $u$. The Fourier transform of $P(D_x) u - \delta$ is then supported on a neighborhood of the origin, which by the Paley-Wiener theorem, impies $P(D_x) u - \delta$ is a smooth function.
\end{proof}

If $P$ is elliptic and homogeneous, then the calculations above show that one choice of fundamental solution for the differential operator $P(D_x)$ can be written as
%
\[ u(x) = \int \frac{e^{2 \pi i \xi \cdot x}}{P(\xi)}\; d\xi. \]
%
By deforming the integration contour, one can actually show that $u$ is \emph{analytic} away from the origin. TODO: See Remark following Theorem 7.1.22 in Hormander.

The fundamental solutions to the heat equation and Cauchy-Riemann equation are smooth away from the origin. It will turn out that this is true for any constant coefficient partial differential equation which is \emph{hypoelliptic}. Here are several consequences.

\begin{lemma}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\singsupp(\Phi) = \{ 0 \}$. Then for any open set $U \subset \RR^n$, and any distribution $u$ on $U$, $\singsupp(Lu) = \singsupp(u)$. Thus any distribution $u$ on $U$ with $Lu = 0$ lies in $C^\infty(U)$. If $\{ u_n \}$ is a sequence of solutions to the equation $Lu = 0$, with $u_n \to u$ distributionally, then $u_n \to u$ in $C^\infty(U)$.
\end{lemma}
\begin{proof}
    It is simple to see that $\singsupp(Lu) \subset \singsupp(u)$. Conversely, fix a compact set $K \subset U$, and consider $\psi \in \DD(U)$ equal to one on a neighbourhood of $K$. Then for any distribution $u$ on $U$ with $Lu = 0$,
    %
    \begin{align*}
        K \cap \singsupp(Lu) &= K \cap \singsupp(L(\psi u))\\
        &= K \cap \singsupp(\Phi * (\psi u))\\
        &= K \cap [\singsupp(\Phi) + \singsupp(\psi u)]\\
        &= K \cap \singsupp(u).
    \end{align*}
    %
    The first part is therefore completed, since $K$ was arbitrary. Now given the Fr\'{e}chet space $X = \{ u \in \DD(U)^* : Lu = 0 \}$, we have a natural inclusion map $i: X \to C^\infty(U)$. It's graph is obvious closed, so by the closed graph theorem, this map is continuous, and this implies the sequence property above.
\end{proof}

The fundamental solutions above are actually better than just being smooth away from the origin, they are \emph{analytic} away from the origin. This is true of any \emph{elliptic} partial differential equation with constant coefficietns. The following lemma then applies.

\begin{lemma}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\Phi$ is real analytic away from the origin. Then for any open set $U \subset \RR^n$, there is an open set $V \subset \CC^n$ such that if $u$ is a distribution on $U$, and $Lu = 0$, then $u$ is an analytic function extending to a complex analytic function on $V$. In particular, we conclude that if $u$ vanishes in a neighborhood of a point $x_0 \in U$, then $u$ vanishes on the connected component of $U$ containing $x_0$. Moreover, if $u_n$ is a sequence in $C^\infty(U)$ with $Lu_n = 0$, and with $u_n \to u$, then the extension of the functions $u_n$ to analytic functions on $V$ converge locally uniformly to the extension of $u$.
\end{lemma}
\begin{proof}
    Choose any open set $\RR^n - \{ 0 \} \subset V_0 \subset \CC^n$ such that $\Phi$ extends to a complex analytic function on $V_0$. Since the question is local, consider a compact set $K$, and $\psi \in \DD(U)$ equal to one on a neighborhood of $K$. Then for $x \in K$, we have
    %
    \[ u(x) = (\psi u)(x) = (\Phi * L(\psi u))(x) = \int \Phi(x-y) L(\psi u)(y)\; dy, \]
    %
    and this formula continues to define a complex analytic function if we replace $x$ with a complex parameter $z$ provided that for any $y \in \text{supp}(\nabla (\psi u))$, $z - y \in V_0$. This is a neighborhood of $K$. We can then perform this extension for many different choices of $\psi$, and thus of $K$, to show that $u$ extends to an analytic function on some set $V$ depending only on $U$. To get the latter part of the Lemma, we just apply the closed graph theorem.
\end{proof}

Let us now extend the approximation theorem of Runge to the case of general elliptic partial differential equations.

\begin{lemma}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\Phi$ is real analytic away from the origin. Consider two open sets $V \subset U \subset \RR^n$, such that $U - V$ does not have a compact connected component. Then every solution $v \in C^\infty(V)$ to the equation $Lv = 0$ is a limit in $C^\infty(V)$ of the restriction of solutions $u \in C^\infty(U)$ to the equation $Lu = 0$.
\end{lemma}
\begin{proof}
    By duality, it suffices to show that if $w$ is a compactly-supported distribution in $V$, and
    %
    \[ \int_V w(x) u(x)\; dx = 0\ \]
    %
    for any $u \in C^\infty(U)$ such that $Lu = 0$, then for any $v \in C^\infty(V)$ with $Lv = 0$,
    %
    \[ \int_V w(x) v(x)\; dx = 0. \]
    %
    If $L^*$ is the adjoint of the operator $L$, and we set $\Psi(x) = \Phi(-x)$, then $\Psi$ is an analytic fundamental solution to $L^*$. If we can show that $\Psi * w$ is a compactly supported distribution in $V$, then for any $v \in C^\infty(V)$ with $Lv = 0$,
    %
    \[ \int w(x) v(x)\; dx = \int L^* (\Psi * w)(x) v(x)\; dx = \int (\Psi * w)(x) Lv(x)\; dx = 0. \]
    %
    This would therefore complete the proof.

    Let $K$ denote the support of $w$. The distribution $\Psi * w$ is analytic function outside of $K$. Moreover, the support of $\Psi * w$ is certainly contained in $U$, because if $x \not \in U$, then the function $u(y) = \Psi(x-y)$ satisfies $Lu = 0$, and therefore by assumption on $w$, $(\Psi * w)(x) = 0$. Applying analyticity, it follows that $\Psi * w$ vanishes in every component of $K^c$ containing a point in $U^c$. We claim this is sufficient to prove the result. If $W$ is a bounded connected component of $K^c$ contained in $U$, then the set $W \cap V^c$ is a compact connected component of $U - V$. This contradicts the hypothesis of the Lemma, and therefore $W$ cannot exist. Because $K^c$ has at most one unbounded connected component, we conclude that the theorem is proved, except in the case where $U$ contains the unbounded connected component of $K^c$. We will address this case in two paragraphs. For now, note that this proves the theorem when $U$ is a open ball.

    Next, we address the case where $U = \RR^d$, and $V$ is a ball $B$, without loss of generality, centred at the origin. This is because if $v \in C^\infty(B)$ solves $Lv = 0$, then for each $k$, we can recursively find a sequence $u_{k,i} \in C^\infty(k B)$, such that $Lu_{k,i} = 0$, and such that $u_{1,i}$ converges to $v$ in $C^\infty(B)$ as $i \to \infty$, such that $\| u_{k+1,i} - u_{k,i} \|_{L^\infty(k B)} \leq 1/2^{k+i}$ for any $|\alpha| \leq k + i$. It follows that we can define $u_i \in C^\infty(\RR^d)$ as the pointwise limit of the functions $u_{k,i}$ (smooth because of analyticity). Then $Lu_i = 0$, and $u_i \to u$ in $C^\infty(B)$.

    Now returning to the general case of the proof, if $K$ is contained in a ball $B$ of radius $R$, then for $|x| > R$, the function $u_x(y) = \Phi(y-x)$ solves the equation $Lu = 0$ in $B$, and thus is the limit in $C^\infty(B)$ of functions $u_i$ solving $Lu_i = 0$ in $C^\infty(\RR^n)$. But then
    %
    \[ (\Phi * w)(x) = \int w(x) u(x)\; dx = \lim_{i \to \infty} \int w(x) u_i(x)\; dx = 0, \]
    %
    which completes the proof.
\end{proof}

\begin{remark}
    This result is \emph{only} possible given the topological hypothesis. Suppose the result is true, and $K$ is a compact connected component of $U - V$. If $u_i \in C^\infty(U)$ is a sequence of solutions to the equation $Lu_i = 0$ such that $u_i$ converges to a function $u \in C^\infty(V)$, then we claim that $u_i$ converges to some $u \in C^\infty(V \cup K)$. In particular, we conclude every solution on $C^\infty(V)$ extends to a solution on $C^\infty(V \cup K)$. This causes a contradiction, since if $x_0 \in K$, then the function $u(y) = \Phi(y - x_0)$ solves the equation on $V$, but cannot be extended to a solution on $V \cup K$ (e.g. because any such solution would be analytic).

    Let us now prove that $u$ can be extended under our assumptions. If we consider $\phi \in \DD(V \cup K)$ equal to one on a neighborhood $W$ of $K$, then $L(\phi u_i)$ vanishes on $W$, and hence is supported in $V$. Since $u_i$ converges to $u$ in $V$, so $L(\phi u_i)$ converges to $Lu$ in $V \cup K$, and this means that $u_i = \Phi * L(\phi u_i)$ converges in $C^\infty(V \cup K)$ to some function $u$ in $C^\infty(V \cup K)$, which completes the proof of our claim.
\end{remark}

Using Runge's approximation theorem, we can now finally prove our first major existence theorem for partial differential equations on proper subsets $U$ of $\RR^n$, assuming the existence of a fundamental solution (i.e. the existence of solutions to the equation $Lu = f$ for compactly supported distributions $f$ on $\RR^n$. To obtain the idea of the proof of the existence of solutions to the equation $Lu = f$, for a distribution $f$ on $U$ (not necessarily compactly supported), imagine that such a solution $u$ existed. For any $\phi \in \DD(U)$ equal to one on some open set $W$, we can find a distribution $u_W$ such that $L(u_W) = \phi f$. Then $L(u - u_W) = 0$ on $W$, which implies that $u - u_W$ is analytic on $W$. If $u_V - u_W = 0$ on $V \cap W$ for any $V,W \subset U$, these solutions would combine to give us a choice of $u$ on the whole domain. Instead, we only have $u_V - u_W$ \emph{analytic} on $V \cap W$. The Runge approximation theorem will enable us to adjust these functions so that $u_V - u_W$ is \emph{almost} equal to zero, and then we can take limits.

\begin{theorem}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\Phi$ is real analytic away from the origin. Then for any open set $U$ in $\RR^n$, and any distribution $f \in \DD(U)^*$, then there exists $u \in \DD(U)^*$ such that $Lu = f$.
\end{theorem}
\begin{proof}
    Let $U_R = \{ x \in U: |x| < R\ \text{and}\ d(x,U^c) > 1/R \}$. Then we can apply Runge's approximation theorem for $U_R \subset U$. We leave this proof of this to the end for it is fairly technical and unenlightening. Now if $\phi_i \in \DD(U)$ equals one on $U_i$, we set $u_i = \Phi * (\phi_i f)$. Then $Lu_i = \phi_i f$, in particular, $Lu_i = f$ on $U_i$. It suffices to modify $u_i$ so that it converges distributionally to some function $u$, since it will then follow that $Lu = f$ on $U$. we note that $L(u_{i+1} - u_i) = 0$ in $U_i$. Thus Runge's theorem implies that there exists an analytic function $w_i$ defined on $U$ such that $\| (u_{i+1} - u_i) - w_i \|_{L^\infty(U_i)} \leq 1/2^i$. But then if we define $v_i = u_i - w_1 - \dots - w_{i-1}$, then $Lv_i = \phi_i f$ on $U$, and
    %
    \[ \| v_{i+1} - v_i \|_{L^\infty(U_i)} = \| (u_{i+1} - u_i) - w_i \|_{L^\infty(U_i)} \leq 1/2^i, \]
    %
    which implies the required convergence property.

    To show that $U - U_R$ has no compact connected components, consider a potential compact connected component $K$ of $U - U_R$. If $B_R$ is the ball of radius $R$ centred at the origin, $K \cap B_R^c$ is compact. It is also open in $B_R^c$, because we can write $K = V \cap U \cap U_R^c$ for some open set $V$, and then $K \cap B_R^c = V \cap U \cap U_R^c \cap B_R^c = V \cap U \cap B_R^c$ since $U_R \subset B_R$, and $U$ and $V$ are both open. But this means that $K \cap B_R^c = \emptyset$, i.e. $K \subset B_R$. Next, we claim $d(x,y) > 1/R$ for any $y \in U^c$. Otherwise, take $y$ with $d(x,y) \leq 1/R$, and consider the line segment $L$ between $x$ and $y$. Since $U^c$ is closed, we may assume without loss of generality (by picking the closest point in $U^c$ to $x$ on the line and replacing $y$ with it), that $L \cap U^c = \{ y \}$. Since $x \not \in U_R$, and $d(x_1,y) < 1/R$ for any other point $x_1$ on the line, $L \cap U_R = \emptyset$. Thus $L - \{ y \} \subset U - U_R$. But $L - \{ y \}$ is connected and contains $x \in K$, so $L - \{ y \} \subset K$. But this is impossible for it implies that $\partial K$ contains $y$, which is not an element of $K$, so $K$ cannot be closed. Put together, this means that for any $x \in K$, $d(x,U^c) = 1/R$. But then it is impossible for $K$ to be an open subset of $U - U_R$, so $K$ cannot exist.
\end{proof}

\begin{example}
    Suppose $L = \sum_{|\alpha|} c_\alpha D^\alpha = P(D)$ is a homogeneous elliptic partial differential equation of degree $m$ on $\RR^n$. Then $1/P(\xi)$ is a homogeneous function defined on $\RR^n - \{ 0 \}$, of degree $-m$, analytic in $\RR^n - \{ 0 \}$. Thus we have a fundamental solution $\Phi$ defined such that $\widehat{\Phi} = 1/P$.
    %
    \begin{itemize}
        \item If $n > m$, then $L$ has a fundamental solution $\Phi = \Phi_0$ is homogeneous of degree $m-n$, and $C^\infty$ in $\RR^n - \{ 0 \}$.

        \item If $n \leq m$, then $L$ has a fundamental solution $\Phi = \Phi_0 - Q(x) \log |x|$, where $\Phi_0$ is homogeneous of degree $m - n$ and
        %
        \[ Q(x) = \frac{1}{(2\pi)^m (m-n)!} \int_{|\xi| = 1} \frac{(2\pi i x \cdot \xi)^{m-n}}{P(\xi)}\; d\xi. \]
        %
        TODO: Technical FT Calculation in H\"{o}rmander Volume 1, Theorem 7.1.20.
    \end{itemize}
    %
    In either case, $\Phi_0$ is analytic in $\RR^n - \{ 0 \}$.
\end{example}








\section{The Cauchy Problem}

Recall the Cauchy problem: Given a linear differential operator $L = \sum c_\alpha D^\alpha$ of order $m$, defined on an open set $\Omega_0 \subset \RR^{n+1}$, with coefficients in $C^\infty(\Omega_0)$. We suppose that $\Omega_0$ is divided into two parts by a smooth hypersurface $S$. Thus $\Omega_0$ is divided into the union of three disjoint set $\Omega_0^- \cup S \cup \Omega_0^+$, where $\Omega_0^-$ and $\Omega_0^+$ are connected, open sets.

Classically, the goal of the Cauchy problem, given some data $f$ on $\Omega_0$, and $\phi_0,\dots,\phi_{m-1}$ on $S$, is to find a solution $Lu = f$, such that the first $m-1$ derivatives of $u$ in the direction tangent to $S$ agrees with the functions $\{ \phi_i \}$. For smooth data this is often a fine way to pose the problem; but for more general data. Instead, we consider $f \in \DD(\Omega_0)$, and 

Consider a linear differential operator $L = \sum c_\alpha D^\alpha$ of order $m$, defined on an open set  Finally, we consider some $f \in \DD(\Omega_0)^*$.

For rough data, the best way to formulate the Cauchy problem is as follows: We consider some initial data $\phi \in \DD$


\emph{Cauchy problem} for this data is, given some set $X \subset \DD(\Omega_0)^*$, to find $u \in X$ such that $Lu = f$.

\subsection{First Order Operators}

TODO

\subsection{Calderon's Uniqueness Theorem}

Let us discuss the phenomenon of \emph{uniqueness} for the Cauchy problem. Thus our goal is to determine, for a given set $X \subset \DD(\Omega_0)^*$, whether $L: X \to \DD(\Omega_0)^*$ is injective. If $X$ is a linear subspace of $\DD(\Omega_0)^*$, it suffices to show that if $u \in X$, and $Lu = 0$, then $u = 0$. This simplifies the notation in the problem. To make the problem possible to study microlocally, we work locally. Thus we focus on the case where $X$ solely contains functions which vanish on $\Omega_0^-$, and will try and find conditions which guarantee that if $Lu = 0$, then $u$ vanishes on a neighborhood of $S$.

Let $P(x,\xi)$ denote the principal symbol of $L$. We begin by assuming that $S$ is \emph{non characteristic} at any of it's points, i.e. that if $x_0 \in S$, and $\eta_0 \in T_{x_0}^* \RR^{n+1} - \{ 0 \}$ has $T_{x_0} S$ as it's kernel (conormal to $S$), then $P(x_0,\eta_0) \neq 0$. We actually assume $S$ is \emph{strongly non characteristic}, i.e. that for any $\eta_0 \in T_{x_0}^* \RR^{n+1}$ conormal to $S$, and any $\eta_1 \in T_{x_0}^* \RR^{n+1}$ not conormal to $S$, the polynomial $P(x_0, \eta_0 + z \eta_1)$ has $m$ simple roots in the $z$-variable. For $m = 1$, this is equivalent to being noncharacteristic. For $m > 1$, the surface $S$ can be noncharacteristic but not satisfy this property, for instance, if $S$ is the $x$-axis, and $L = (D_x + i D_y)^2 = D_x^2 + 2i D_x D_y - D_y^2$.

Being strongly noncharacteristic is a \emph{local} conditions on $L$ and of $S$; if we replace $S$ with any other surface tangent to $S$ at $x_0$, the condition will continue to hold in a neighborhood of $x_0$. Thus, working locally, we may switch to a coordinate system in which it suffices to study a more familiar version of the Cauchy problem, namely, we consider a set $\Omega_0 = (-T,T) \times \Omega$, where $\Omega$ is a connected, open subset of $\RR^n$, $T > 0$, where $S = \{ 0 \} \times \Omega$, and where
%
\[ \Omega^- = \{ (t,x) \in (-T,T) \times \Omega : t < 0 \} \quad\text{and}\quad \Omega^+ = \{ (t,x) \in (-T,T) \times \Omega: t > 0 \}. \]
%
The principal symbol will then be written in the $(t,x)$ variables, and their dual variables $(\tau,\xi)$ variables, i.e. as the polynomial $P(t,x,\tau,\xi)$. The assumption slightly stronger than being noncharacteristic then locally amounts to the fact that for any $\xi \in \RR^n - \{ 0 \}$, and any $z \in \CC$, if $P(t,x,z,\xi) = 0$, then $\partial_z P(t,x,z,\xi) \neq 0$. It follows that locally on $\Omega$ we can write the solutions to $P(t,x,\tau,\xi) = 0$ in the $\tau$ variable for $1 \leq i \leq m$ as the smooth functions $\tau_1,\dots,\tau_m: (-T,T) \times \Omega_x \times (\RR^n_\xi - \{ 0 \}) \to \CC$. Given that $P$ is homogeneous in the $\xi$ variable of degree $m$, $\tau_1,\dots,\tau_m$ will be homogeneous of degree one.

\begin{example}
    Let $L = \partial_t^2 + \Delta_x$. Then $L$ has principal symbol $-4 \pi^2 (\tau^2 + |\xi|^2)$, and has roots $\pm i |\xi|$. The principal symbol factors as $- 4 \pi^2 (\tau - i |\xi|) (\tau + i |\xi|)$.
\end{example}

Since $P$ is a homogeneous polynomial of degree $m$, the coefficient of $\tau^n$ in the expansion of $P$ must be a non-vanishing, $C^\infty$ function of $P$. If it vanished at a point $(t_0,x_0)$, then we would have $P(t_0,x_0,\tau,0) = 0$ for all $\tau \in \RR$, which contradicts the fact that $L$ is strongly noncharacteristic since then $\partial_\tau P(t_0,x_0,\tau,0) = 0$. If $a \in C^\infty((-T,T) \times \Omega)$ is the coefficient of $\tau^n$, it is therefore clear that the solutions of the operator $Lu = 0$ are the same as solutions of the operator $a^{-1} \cdot Lu = 0$. Thus in the sequel, we will assume without loss of generality that $a(t,x) = 1$ for all $t \in (-T,T)$ and all $x \in \Omega$.

\begin{lemma}
    Suppose that $L$ is a differential operator of order $m$ on $(-T,T) \times \Omega$, such that $S = \{ (t,x): t = 0 \}$ is strongly noncharacteristic with respect to $L$. Then there exists $m$ classical pseudodifferential operators $Z_1,\dots,Z_m$, each of order one, with principal symbols $z_1,\dots,z_m$ such that
    %
    \[ L = (D_t - Z_1) \dots (D_t - Z_m) + R, \]
    %
    where $R$ is a smoothing operator.
\end{lemma}
\begin{proof}
    The composition calculus shows that $L - (D_t - z_1(t,x,D_x)) \dots (D_t - z_m(t,x,D_x))$ is a pseudodifferential operator $R_1$ of order $m-1$. As with many regularizing calculi. We proceed asymptotically, like in the construction of parametrices. Given a choice of operators $\{ Z_i^N \}$ such that $R_N = L - (D_t - Z_1^N) \dots (D_t - Z_m^N)$ is order $m-N$, we must consider operators $W_1,\dots,W_m$ of order $1-N$ such that $R_{N+1} = L - (D_t - Z_1^N - W_1) \dots (D_t - Z_m^N - W_m)$ is an operator of order $m - N - 1$. If $w_1,\dots,w_n$ are the symbols of $W_1,\dots,W_m$, then it clearly suffices to choose these symbols such that if $r_N$ is the principal symbol of $R_N$, then
    %
    \begin{align*}
        r_N(t,x,\tau,\xi) &= \sum_{i = 1}^n w_i \left[ \prod_{j \neq i} (\tau - z_j) \right].
    \end{align*}
    %
    If we pick
    %
    \[ w_i = \frac{r_N}{\partial_z P(t,x,z_i,\xi)} = \frac{r_N}{\prod_{j \neq i} (z_i - z_j)}, \]
    %
    then $w_k$ is homogeneous of degree $m-N-(m-1) = 1-N$, and since the rational function
    %
    \[ f(\tau) = \sum_{i = 1}^n \prod_{j \neq i} \frac{\tau - z_j}{z_i - z_j} \]
    %
    is a degree $m-1$ polynomial with $f(z_1) = \dots = f(z_m) = 1$, and so $f(\tau) = 1$ for all $\tau \in \RR$, which implies the required formula for $r_N$. Now we just take $Z_i = \lim Z_i^N$, and we get the required result.
\end{proof}

The next remark shows that we can assume that there exists a compact set $K'$ such that $\text{supp}_x(u) \subset K'$, such that the coefficients of $L$ vanish outside of $K'$, and the $(x,y)$ support of the kernels of $Z_1,\dots,Z_m$, and of $R$ vanish outside of $K'$, uniformly in $t$.

\begin{remark}
    Switch to a coordinate system in which $S = \{ (t,x) \in (-T,T) \times \Omega : t = |x|^2 \}$, after possibly shrinking $\Omega$. In this coordinate system, if $u$ vanishes on $\Omega_0^-$, then $u(t,x)$ vanishes for $t < |x|^2$. Thus, after shrinking $T$, we may assume that $\Omega$ contains a ball of radius $T^2$, and then $\text{supp}_x(u)$ is contained in that ball of radius $T^2$. Switching back to our original coordinate system, we may assume without loss of generality that there exists a compact set $K \subset \Omega$ such that $\text{supp}_x(u) \subset K$. If $g \in C_c^\infty(\Omega)$ is equal to one on a neighborhood of $K$, then $0 = Lu = g \cdot Lu = (D_t - g Z_1) \dots (D_t - g Z_m) + R^\# u$, which is a similar expansion to the original except that we can now assume that the $(x,y)$ supports of the kernels of all operators involved are contained in $K' \times K'$ for some compact set $K'$.
\end{remark}

Define $u_1 = u$, and for $1 \leq i \leq m-1$, iteratively define
%
\[ u_{i+1} = (D_t - Z_i) u_i. \]
%
Then since $L = (D_1 - Z_1) \dots (D_n - Z_m) u + R$, it follows that
%
\[ (D_t - Z_m) u_m = Lu - Ru = -Ru. \]
%
We can then consider the diagonal matrix valued pseudodifferential operator
%
\[ A = i \cdot \text{diag}(Z_1,\dots,Z_m). \]
%
Let $N$ be the standard nilpotent matrix, with ones directly above the diagonal. Let $\tilde{R}(t)$ be the $m \times m$ equal to $R(t)$ in the lower left corner. Then if $U = (u_1,\dots,u_m)$, then
%
\[ \mathcal{L}U = \frac{\partial U}{\partial t} - A(t) U - i [N - \tilde{R}(t)] U = 0. \]
%
Let us now assume that $u \in C^i((-T,T), H^{m-j}_c(\Omega))$. Then $u_k \in C^j((-T,T), H^{m-k+1-j}_c)$. Thus for $j = 0$ and $j = 1$, $U \in C^j((-T,T), H^{1-j}_c(\Omega) \otimes \CC^m)$.

The uniqueness will now follow from an \emph{inequality of Carleman type}. Namely, if $V(t,x) = \chi(t) U(t,x)$, where $\chi(t) = 1$ for $t < 8T/10$, and vanishes for $t > 9T/10$, then for all suitably large positive values $\rho > 0$,
%
\[ \rho \int_0^T \int_\Omega e^{\rho(T-t)^2} |V(t,x)|^2\; dx\; dt \lesssim \int e^{\rho (T - t)^2} |\mathcal{L}V(t,x)|^2\; dx\; dt. \]
%
We then claim that $U$ vanishes for $t < T/2$. Indeed, we can restrict the integration on the right hand side to the region $8T/10 \leq t \leq T$, because $\mathcal{L} U$ because it satisfies the ODE. But if we limit the integration on the left hand side to $0 \leq t \leq t/2$, we get that
%
\[ \rho \cdot e^{\rho (24/25) T^2} \int_0^{t/2} \int_\Omega |V(t,x)|^2\; dx \;dt \lesssim \int_{8T/10}^T \int_\Omega | \mathcal{L} V |^2 \; dx\; dt. \]
%
Unless the right hand side is equal to zero, it will become arbitrarily large as $\rho \to \infty$, which eventually gives a contradiction. Thus $V$ must vanish on $0 \leq t \leq T/2$.

\begin{remark}
    Note that we did not use $\rho$ in the proof. It's utility is that if $\rho$ is suitably large, then we can replace $\mathcal{L}$ by the diagonal part $\mathcal{L}_0 = I_m (\partial / \partial t) - A(t)$, and thus discard the other terms as extraneous.
\end{remark}

Calderon proved this result (Uniqueness in the Cauchy problem of partial differential equations, 1958) under two assumptions:
%
\begin{itemize}
    \item The roots $z_1,\dots,z_m$ are all valued in $\CC - \RR$, i.e. so that $P$ is elliptic.

    \item The roots $z_1,\dots,z_m$ are all valued in $\RR$. Under this condition, we say that $z_1,\dots,z_m$ are \emph{strongly hyperbolic}.
\end{itemize} 
%
TODO: Rest of argument (Treves, Vol 1. Starting on page 112).
















