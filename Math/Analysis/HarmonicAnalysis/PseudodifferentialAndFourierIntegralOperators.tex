%% The following is a directive for TeXShop to indicate the main file
%%!TEX root = HarmonicAnalysis.tex

\part{Pseudodifferential and Fourier Integral Operators}

The theory of the Fourier transform enabled the early harmonic analysts to study various linear partial differential operators, like the heat and wave equations. The theory of pseudodifferential and Fourier integral operators allows us to study \emph{variable coefficient} analogues of these operators on the Fourier side of things, just like in the linear case. In particular, we can appropriately \emph{localize} Euclidean Fourier analysis so that it can used in the study of problems on differentiable manifolds.

Pseudodifferential Operators are very useful for the study of \emph{elliptic differential operators}. But it is difficult to apply the theory of such operators to problems that are genuinely non-elliptic, like the Cauchy problem for a hyperbolic equation. This is because pseudodifferential operators are \emph{microlocal}, i.e. the positions of singularities are preserved, whereas the solution operators to the Cauchy problem for hyperbolic are \emph{not}; solutions propogate through space. The theory of Fourier integral operators extends the class of pseudodifferential operators to model such phenomena.



\chapter{Symbol Classes}

The theory of tempered distributions allows one to build a useful, general theory of expressions of the form
%
\[ \int_{\RR^d} a(x) e^{2 \pi i \xi \cdot x}\; d\xi, \]
%
where $a$ is a tempered locally integrable function on the real line. We will define pseudodifferential operators and Fourier integral operators by very similar expressions, i.e. of the form
%
\[ \int_{\RR^p} a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta. \]
%
However, the useful properties of pseudodifferental and Fourier Integral Operators are more sensitive to the regularity of the input function $a$, i.e. the growth of $a$ and all of it's derivatives. We are thus lead to restrict our analyses where $a$ lies in some given \emph{symbol class}, which quantifies the growth of $a$ and it's derivatives.

Fix $\mu \in \RR$, $0 \leq \rho \leq 1$ and $0 \leq \delta \leq 1$, and an open subset $\Omega \subset \RR^p$, we define the symbol class $\mathcal{S}^\mu_{\rho,\delta}(\Omega \times \RR^p)$ to be the class of all smooth functions $a \in C^\infty(\Omega \times \RR^p)$ such that
%
\[ |D^\alpha_x D^\beta_\theta a(x,\theta)| \lesssim_{\alpha,\beta} \langle \theta \rangle^{\mu - \rho |\beta| + \delta |\alpha|}. \]
%
The optimal choice of constants in these inequalities can be taken as seminorms, which give $\mathcal{S}^\mu_{\rho,\delta}(\Omega \times \RR^p)$ the structure of a Fr\'{e}chet space. The most common spaces that occur in practice are the symbol classes $\mathcal{S}^\mu_{1,0}(\Omega \times \RR^p)$, which we simply denote by $\mathcal{S}^\mu(\Omega \times \RR^p)$. It is also somewhat common to consider classes where $\rho + \delta = 1$, and so we let $\mathcal{S}^\mu_\rho(\Omega \times \RR^p) = \mathcal{S}^\mu_{\rho,1-\rho}(\Omega \times \RR^p)$. It is also natural to consider the classes $\mathcal{S}^\mu_{\rho,\delta,\text{loc}}(\Omega \times \RR^p)$, where the bounds above hold \emph{locally uniformly} in the $x$-variable. We set
%
\[ \mathcal{S}^\infty_{\rho,\delta} = \bigcup_\mu \mathcal{S}^\mu_{\rho,\delta} \quad\text{and}\quad \mathcal{S}^{-\infty}_{\rho,\delta} = \bigcap_\mu \mathcal{S}^\mu_{\rho,\delta}, \]
%
natural because the spaces $\mathcal{S}^\mu_{\rho,\delta}$ are nested, increasing in $\mu$. We can then give this space the topology induced by the direct limit. Elements of $\mathcal{S}^\mu_{\rho,\delta}$ are called \emph{symbols} of order $\mu$, of type $(\rho,\delta)$.

\begin{example}
    Consider a function of the form
    %
    \[ a(x,\xi) = \sum_{|\alpha| \leq n} c_\alpha(x) \cdot \xi^\alpha, \]
    %
    where $\{ c_\alpha \}$ are a family of functions in $C^\infty_{\text{loc}}(\RR^d_x \times \RR^d_\xi)$. Then $a \in S^\mu_{\text{loc}}(\RR^d_x \times \RR^d_\xi)$. If the functions $\{ c_\alpha \}$ and all their derivatives are bounded functions, then $a \in S^\mu(\RR^d_x \times \RR^d_\xi)$. This is true, in particular, if the functions $\{ c_\alpha \}$ all lie in $C_c^\infty(\RR^d_x)$.
\end{example}

It is also natural for harmonic analysis to study the behaviour of homogeneous functions under the Fourier transform. The next example shows such functions are symbols, and thus the study of such functions is encompassed in the more general theory here.

\begin{example}
    Fix a complex number $\mu \in \CC$. If $a \in C^\infty(\Omega \times \RR^p)$, and is homogeneous for large $\theta$, i.e. there exists a constant $R_0 > 0$ such that for $|\theta| \geq R_0$, and $\lambda \geq 1$, $a(x,\lambda \theta) = \lambda^\mu a(x, \theta)$. Then $a$ is a symbol of order $\text{Re}(\mu)$, i.e. $a \in \mathcal{S}^{\text{Re}(\mu)}_{\text{loc}}(\Omega \times \RR^p)$; To see this, assume first that, without loss of generality, $R_0 \geq 1$. For any $\alpha$ and $\beta$, smoothness implies that for $|\theta| \leq 1$, we have
    %
    \[ |D^\alpha_x D^\beta_\theta a(x,\theta)| \lesssim_{\alpha,\beta} 1 \lesssim \langle \theta \rangle^{\text{Re}(\mu)}, \]
    %
    where the implicit constant is locally uniform in the $x$-variable. Differentiating both sides of the equation $a(x,\lambda \theta_0) = \lambda^\mu a(x,\theta_0)$, we conclude that for $|\theta_0| \geq 1$,
    %
    \[ \lambda^{|\beta|} (D^\alpha_x D^\beta_\theta a)(x,\lambda \theta_0) = \lambda^\mu (D^\alpha_x D^\beta_\theta a)(x,\theta_0). \]
    %
    If $|\theta| \geq 1$, then we can write $\theta = \langle \theta \rangle \theta_0$ for $|\theta_0| = 1$, which implies that
    %
    \[ |(D^\alpha_x D^\beta_\theta a)(x, \theta)| = \Big| \langle \theta \rangle^{\mu - |\beta|} (D^\alpha_x D^\beta_\theta a)(x, \theta_0) \Big| \lesssim \langle \theta \rangle^{\text{Re}(\mu) - |\beta|}, \]
    %
    where the implicit constant is locally uniform in $x$.
\end{example}

\begin{example}
    Suppose $a$ is non-isotropically homogeneous, i.e. we can write $\RR^p = \RR^{p_1} \times \dots \times \RR^{p_m}$, such that for $|\theta| \geq 1$, and $\lambda \geq 1$,
    %
    \[ a(x, \lambda^{a_1} \theta_1, \dots, \lambda^{a_m} \theta_m ) = \lambda^a a(x, \theta). \]
    %
    If $\mu = \max_j m / m_j$, and $\rho = \min m_j / m_k$, then $a$ is a symbol of order $\mu$, and type $(\rho,0)$, i.e. $a \in \mathcal{S}^\mu_{\rho,0}(\Omega \times \RR^p)$.
\end{example}

\begin{example}
    Symbols often arise from the asymptotic study of variable-coefficient stationary phase integrals. The classic example is the Fourier transform of the spherical measure. Since $\sigma$ is radially symmetric, so is it's Fourier transform. Thus we can write
    %
    \[ \widehat{\sigma}(\xi) = G(|\xi|), \]
    %
    for some function $G: [0,\infty) \to \CC$. If we set $\lambda = |\xi|$, and $\xi_0 = \xi / |\xi|$, then
    %
    \begin{align*}
        G(\lambda) &= \int_{|x| = 1} e^{-2 \pi i \xi \cdot x}\; dx\\
        &= \int_{|x| = 1} e^{- 2 \pi i \lambda \xi_0 \cdot x}\; dx.
    \end{align*}
    %
    This is an oscillatory integral, with two stationary points, when $x = \xi_0$, and when $x = - \xi_0$. These stationary points are nondegenerate. Thus, for each $\xi_0$, we have an asymptotic expansion of the form
    %
    \[ G(\lambda) \sim \sum_{j = 0}^\infty \left( c_{j,+} e^{2 \pi i \lambda} + c_{j,-} e^{- 2 \pi i \lambda} \right) \lambda^{- \frac{d-1}{2} - j}, \]
    %
    in the sense that for $\lambda \geq 1$,
    %
    \[ \left| \left( \frac{d}{d\lambda} \right)^N \left\{ G - \sum_{j < N} (c_{j,+} e^{2 \pi i \lambda} + c_{j,-} e^{-2 \pi i \lambda} ) \lambda^{- \frac{d-1}{2} - j} \right\} \right| \lesssim_N \lambda^{- \frac{d-1}{2} - j - N}. \]
    %
    Suppose $\chi \in C_c^\infty(\RR^d)$ is radially symmetric, and equal to one in a neighborhood of the origin. Then if we set
    %
    \[ a_{j,+}(\xi) = c_{j,+} (1 - \chi(\xi)) \cdot |\xi|^{- \frac{d-1}{2} - j}, \]
    %
    and
    %
    \[ a_{j,-}(\xi) = c_{j,-} (1 - \chi(\xi)) \cdot |\xi|^{- \frac{d-1}{2} - j}, \]
    %
    then $a_{j,+}$ and $a_{j,-}$ are both radial symbols of order $- (d-1)/2 - j$. The asymptotic formula for $G$ above implies that if we pick radial symbols $a_+$ and $a_-$ of order $-(d-1)/2$ such that
    %
    \[ a_+ \sim \sum_j a_{j,+} \quad\text{and}\quad a_- \sim \sum_j a_{j,-}, \]
    %
    then
    %
    \[ \widehat{\sigma}(\xi) \sim a_+(\xi) e^{2 \pi i |\xi|} + a_-(\xi) e^{- 2 \pi i |\xi|}, \]
    %
    in the sense that the difference between the left and right hand side is a symbol of order $-\infty$.
    % Thus sigma is given by a sum of a smooth function,
    % an oscillatory integral distribution with phase xi * x + |xi|
    % and a distribution with phase xi * x - |xi|
    % The first has stationary points when x + xi / |\xi| = 0
    %      And then the x gradient is -xi
    % The second when x - xi / |xi| = 0
    %       And then the x gradient is xi.
    % Thus the wavefront set is contained in
    %       { (xi_0, xi)  } u { (-xi_0, xi) } = { (x,xi) : |x| = 1, and x is a multiple of xi }.
    %   Since we can project this wavefront set projects onto the spatial variables in a d-1 dimensional set,
    %  we can reduce phase variables so that there is a unique phase variable, i.e.
    % phi(x,tau)
    % s.t. {  ( x, nabla_x phi(x,tau) ) : nabla_tau phi(x,tau) = 0 }
    % is the set above.
    % nabla_tau phi(x,tau) vanishes when |x| = 1 for all tau
    % and then equals tau x
    % so phi(x,tau) = tau |x|^2 - 1
    % so we can write the integral as
    % int a(x,tau) e^{2 pi i tau (|x|^2 - 1)} dtau
    % where a is a symbol of order zero.
\end{example}

It is simple to see that a differential operator $D^\alpha_x D^\beta_\theta$ is a continuous, bounded linear operator from $\mathcal{S}^\mu_{\rho,\delta}$ to $\mathcal{S}^{\mu - \rho |\beta| + \delta |\alpha|}_{\rho,\delta}$.

\begin{example}
    If $\chi \in \mathcal{S}(\RR^d)$, and $a$ is smooth and for $|\theta| \geq 1$,
    %
    \[ a(x,\theta) = \chi \left( |\theta|^\varepsilon x \right). \]
    %
    Then $a$ is a symbol of order zero, and type $(1,\varepsilon)$. Indeed, it can be verified by induction that $D^\beta_\theta a$ is a finite sum of functions of the form
    %
    \[ x^n s(x,\theta) \phi( |\theta|^\varepsilon x ) \]
    %
    where $s$ is a symbol of order at most $-n(1 - \varepsilon) - m$, and $n + m = |\beta|$. It can then be checked that $D^\alpha_x D^\beta_\theta a$ is a finite sum of terms of the form
    %
    \[ P(x) s(x,\theta) \phi( |\theta|^\varepsilon x ) \]
    % k' = n - k
    % k = n - k'
    where $P$ is a polynomial vanishing to order $k$ at the origin, $s$ is a symbol of order at most $-n(1 - \varepsilon) - m + \varepsilon ( |\alpha| - n + k )$, and $\phi$ is Schwartz, where $n + m = |\beta|$ and $n - |\alpha| \leq k \leq n$. We thus have
    %
    \begin{align*}
        |D^\alpha_x D^\beta_\theta a(x,\theta)| &\lesssim_N \max_{n,m,k} |x|^k \langle \theta \rangle^{-n(1 - \varepsilon) - m + \varepsilon (|\alpha| - n + k)} \langle |\theta|^\varepsilon x \rangle^{-N}\\
        &= \max_k \left( |x|^k \langle \theta \rangle^{\varepsilon k} \langle |\theta|^\varepsilon x \rangle^{-N} \right) \langle \theta \rangle^{\varepsilon |\alpha| - |\beta|}.
    \end{align*}
    %
    For $|\theta| \geq 1$, this quantity is
    %
    \[ \lesssim \max_k \langle |\theta|^\varepsilon x \rangle^{k-N} \langle \theta \rangle^{\varepsilon |\alpha| - |\beta|}. \]
    %
    Choosing $N = n$, we conclude that
    %
    \[ |D^\alpha_x D^\beta_\theta a(x,\theta)| \lesssim_{\alpha,\beta} \langle \theta \rangle^{\varepsilon |\alpha| - |\beta|}. \]
    %
    Note that for $|\theta| \geq 1$, the function $a$ concentrates itself in the region $|x| \lesssim |\theta|^{-\varepsilon}$, which, by the mean value theorem, is only possible for a symbol of type $(\rho,\varepsilon)$ if $\delta \geq \varepsilon$.
\end{example}

\begin{example}
    If $a$ and $\phi$ are smooth, and for $|\theta| \geq 1$, the function
    %
    \[ a(x,\theta) = \exp \left( 2 \pi i \phi(x) |\theta|^{1 - t} \right) \]
    %
    is a symbol of order zero, and type $(t,1-t)$. This makes sense since, taking Taylor expansions, near a point $(x_0,\theta_0)$, the function $a$ oscillates in the $x$ variable at a frequency at most $|\theta_0|^{1-t}$, and the function $a$ oscillates in the $\theta$ variable at a frequency $|\theta_0|^{-t}$. This makes us expect the symbol to be of type $(t,1-t)$. We can check this fairly simply; by induction, $D^\alpha_x D^\beta_\theta a(x,\theta)$ is a finite sum of terms of the form
    %
    \[ s(x,\theta) \exp \left( 2 \pi i \phi(x) |\theta|^{1-t} \right), \]
    %
    where $s$ is a symbol of order at most $|\alpha| (1-t) - |\beta| t$.
\end{example}

%In various settings in harmonic analysis, especially in topics related to partial differential equations where \emph{homogeneous functions} are the classical objects of study, it is useful to study various \emph{symbol classes}. For instance, pseudodifferential operators historically dealt with operators $a(x,D)$, where $a: \RR^d_x \times \RR^d_\xi \to \CC$ is a smooth function defined by a finite, or asymptotic sum of homogeneous functions of various orders in the $\xi$ variable. If the highest degree of the terms in the sum was $t$, then for any $n$ and $m$, $\nabla^n_x \nabla^m_\xi a$ is also a sum of homogeneous functions, with highest degree $t - m$. Thus we have bounds of the form
%
%\[ | \nabla^n_x \nabla^m_\theta a(x,\xi) | \lesssim \langle \xi \rangle^{t - m}. \]
%
%Given a quantity $t$, a non-negative integer $p$, and an open subset $\Omega \subset \RR^d$, we define the symbol class $\mathcal{S}^t(\Omega \times \RR^p)$, consisting of \emph{symbols of order $t$}, to be the family of all functions $a \in C^\infty(\Omega_x \times \RR^p_\theta)$ such that
%
%\[ |\nabla^n_x \nabla^m_\theta a(x,\theta)| \lesssim_{n,m} \langle \theta \rangle^{t-m}. \]
%
%where the implicit constant is uniform in $x$. We take the optimal constants in these inequalities as a family of seminorms which gives $\mathcal{S}^t(\Omega \times \RR^p)$ the structure of a Frech\'{e}t space. Similar to other function spaces, we can also consider the local symbol classes $\loc{\mathcal{S}^t}(\Omega \times \RR^p)$.

%The classes $\mathcal{S}^t(\Omega \times \RR^p)$ are decreasing as $t \to -\infty$, and we define $\mathcal{S}^{-\infty}(\Omega \times \RR^p)$ to be the intersection of all these classes of symbols. Operators defined by such functions are often highly regular. For instance, a pseudodifferential operator defined by such a symbol is called a \emph{smoothing operator}, and maps any compactly supported distribution to a smooth function. The class $\mathcal{S}^{-\infty}(\Omega \times \RR^p)$ is dense in any of the classes $\mathcal{S}^t(\Omega \times \RR^p)$, since it contains any symbol compactly supported in $\theta$, and we can take cutoffs as $\theta \to \infty$.

A useful strategy to understand a symbol is to break it down into an asymptotic series of simpler symbols. Suppose $\{ a_n \}$ is a sequence of symbols, then we write
%
\[ a \sim \sum_{n = 0}^\infty a_n \]
%
for some symbol $a$, if for any $t \in \RR$, there exists $N_0$ such that for $N \geq N_0$, $a - \sum_{n = 0}^N a_n$ is a symbol of order $t$. If $a_n$ is a symbol of order $t_n$, and $\lim_{n \to \infty} t_n = -\infty$, then a symbol $a$ always exists satisfying these asymptotics.

\begin{theorem}
    Consider a sequence of symbols $\{ a_n \}$, with $a_n \in \mathcal{S}^{t_n}(\Omega \times \RR^p)$, where $\lim_{n \to \infty} a_n = -\infty$, and let $t = \max t_n$. Then there exists a symbol $a \in \mathcal{S}^t(\Omega \times \RR^p)$ such that $a \sim \sum a_n$.
\end{theorem}
\begin{proof}
    Fix a bump function $\phi \in \DD(\RR^p)$ equal to 0 when $|x| \leq 1/2$, and equal to one when $|x| \geq 1$. Find a rapidly increasing sequence $\{ r_n \}$ such that
    %
    \[ | \nabla_x^j \nabla_\lambda^k \{ \phi( \theta / r_n ) a_n(x,\theta) \} | \leq 2^{-n} \langle \theta \rangle^{t_n + 1 - k} \]
    %
    for $x \in \Omega$, where $i,j \leq n$. We define
    %
    \[ a(x,\theta) = \sum_{n = 0}^\infty \phi(\theta / r_n) \cdot a_n(x,\theta), \]
    %
    which is smooth, since it is a locally finite sum. For any $N$, if we set
    %
    \[ R_N(x,\theta) = \sum_{n = N}^\infty \phi(\theta / r_n) \cdot a_n(x,\theta), \]
    %
    then
    %
    \[ a - \sum_{n = 0}^{N-1} a_n = \sum_{n = 0}^{N-1} (\phi(\theta/r_n) - 1) a_n(x,\theta) + R_N(x,\theta) \]
    %
    If $x \in \Omega$, we find that
    %
    \[ | \nabla_x^j \nabla_\lambda^k R_N(x,\theta) | \lesssim_{N,i,j} \langle \theta \rangle^{\max_{n \geq N} t_n + 1 - k}. \]
    %
    Thus $R_N \in \mathcal{S}^{\beta_N}(\Omega \times \RR^p)$, where $\beta_N = \max_{n \geq N} t_n + 1$. On the other hand,
    %
    \[ E_N(x,\theta) = \sum_{n = 0}^{N-1} (\phi(\theta/r_n) - 1) a_n(x,\theta) \]
    %
    vanishes for $|\theta| \geq r_n$, and is thus compactly supported in $\theta$, which implies that $E_N \in \mathcal{S}^{-\infty}(\Omega \times \RR^p)$.
\end{proof}

\begin{remark}
    A similar result holds for local families of symbols.
\end{remark}

A symbol
%
\[ a \sim \sum_{n = 0}^\infty a_n \]
%
is \emph{not} uniquely defined by it's asymptotic expansion; for any $r \in \mathcal{S}^{-\infty}(\Omega \times \RR^p)$, we have
%
\[ a + \psi \sim \sum_{n = 0}^\infty a_n. \]
%
Nonetheless, this is most general way that uniqueness fails to hold -- any two symbols satisfying the same asymptotic expansion differ by an element of $\mathcal{S}^{-\infty}(\Omega \times \RR^p)$. For this reason, it is often natural in many contexts to work with the space $\dot{\mathcal{S}}^t(\Omega \times \RR^p)$, the quotient space of $\mathcal{S}^t(\Omega \times \RR^p)$ by $\mathcal{S}^{-\infty}(\Omega \times \RR^p)$. In this space of symbols, asymptotic expansions are unique.

To verify asymptotic formulae, the following Lemma is often helpful.

\begin{lemma}
    Suppose $a \in C^\infty(\Omega \times \RR^p)$, and for any $n,m > 0$, there exists $t_{nm}$ such that
    %
    \[ |\nabla^n_x \nabla^m_\theta a(x,\theta)| \lesssim_{n,m} \langle \theta \rangle^{t_{nm}}. \]
    %
    If, for any $t \in \RR$,
    %
    \[ |a(x,\theta)| \lesssim_t \langle \theta \rangle^t, \]
    %
    then $a \in \mathcal{S}^{-\infty}(\Omega \times \RR^p)$.
\end{lemma}
\begin{proof}
    We begin by showing that for $f \in C^2(\RR)$,
    %
    \[ \| f' \|_{L^\infty(\RR)} \leq \sqrt{2 \| f \|_{L^\infty(\RR)} \| f'' \|_{L^\infty(\RR)} }. \]
    %
    This follows because for any $x$, and $\varepsilon > 0$, there exists $\theta_1$ lying between $x$ and $x - \varepsilon$ such that
    %
    \[ f(x) - f(x-\varepsilon) = \varepsilon f'(x) + \varepsilon^2 f''(\theta_1) / 2 \]
    %
    and $\theta_2$ lying between $x$ and $x + \varepsilon$ such that
    %
    \[ f(x + \varepsilon) - f(x) = \varepsilon f'(x) + \varepsilon^2 f''(\theta_2)/2. \]
    %
    Thus
    %
    \[ f(x+\varepsilon) - f(x-\varepsilon) = 2 \varepsilon f'(x) + \varepsilon^2 / 2 (f''(\theta_1) + f''(\theta_2)). \]
    %
    Rearranging gives
    %
    \[ f'(x) = (f(x+\varepsilon) - f(x-\varepsilon))/2 \varepsilon - (\varepsilon / 4)(f''(\theta_1) + f''(\theta_2)), \]
    %
    and thus
    %
    \[ |f'(x)| \leq \varepsilon^{-1} \| f \|_{L^\infty(\RR)} + (\varepsilon^{-1}/2) \| f'' \|_{L^\infty(\RR)}. \]
    %
    Optimizing our choice of $\varepsilon$ completes the proof. It follows from this that if $K$ and $K'$ are compact sets, with $K$ contained in the interior of $K'$, then
    %
    \[ \| \nabla_\theta \phi \|_{L^\infty(K)} \lesssim_K \sqrt{\| \phi \|_{L^\infty(K')} \| \nabla_\theta^2 \phi \|_{L^\infty(K'')} }. \]
    %
    The theorem then follows by successively differentiating in $\theta$.
\end{proof}

\begin{corollary}
    Suppose $\{ a_n \}$ are a family of symbols, with $a_n \in \mathcal{S}^{t_n}(\Omega \times \RR^p)$ for each $n$, and $\lim_{n \to \infty} t_n = -\infty$. Then if $a \in C^\infty(\Omega \times \RR^p)$, and for each $N$ and $M$, there exists $t_{NM}$ such that
    %
    \[ |\nabla^N_x \nabla^M_\theta a(x,\theta)| \lesssim \langle \theta \rangle^{t_{NM}}. \]
    %
    If for each $n$, there exists $\beta_n$ such that
    %
    \[ |a(x,\theta) - \sum_{k = 0}^n a_n(x,\theta)| \lesssim_n \langle \theta \rangle^{\beta_n}, \]
    %
    and $\lim_{n \to \infty} \beta_n = -\infty$, then $a \sim \sum a_n$.
\end{corollary}

Sometimes one has to use more powerful notions of homogeneity than the simple decay estimates above. In this case, it is useful to focus on \emph{classical symbols}, i.e. symbols which satisfy an asymptotic formula of the form
%
\[ a(x,\theta) \sim \sum_{n = 0}^\infty a_{t-n}(x,\theta), \]
%
where $a_{t-n} \in S^{\text{Re}(t) - n}(\Omega \times \RR^p)$ is homogeneous of degree $t-n$ in the $\theta$ variables for suitably large $\theta$ (the symbol must be smooth, and so cannot be homogeneous for small $\theta$ unless it is a polynomial). We denote the class of such symbols of order $t$ by $\mathcal{S}^t_{\text{cl}}(\Omega \times \RR^p)$. Sometimes this class is also called the class of \emph{polyhomogeneous symbols}, and denoted $\mathcal{S}^t_{\text{phg}(\Omega \times \RR^p)}$. We can also consider polyhomogeneous symbols with non integer step sizes, i.e. the class $\mathcal{S}^{t,h}_{\text{phg}}(\Omega \times \RR^p)$, i.e. those symbols that satisfy an asymptotic expansion of the form
%
\[ a(x,\theta) \sim \sum_{n = 0}^\infty a_{t - hn}(x,\theta) \]
%
where $a_{t-hn} \in S^{\text{Re}(t) - hn}(\Omega \times \RR^p)$ is homogeneous of degree $t-hn$. But the case $h = 1$ is often of the most interest.

\begin{remark}
    Let $M$ be a manifold, and let $E$ be a vector bundle over $M$. We can define the space $\loc{\mathcal{S}^t}(E)$ of symbols of order $t$ on $E$ to be the family of all scalar functions $a$ on $E$ which are symbols of order $t$ in local coordinates. These have a very similar theory of the theory we have expounded above. In particular, one can consider asymptotic developments of symbols.
\end{remark}














\chapter{Oscillatory Integral Distributions}

The operators we will discuss in these notes will be Schwartz operators, whose kernels are defined by certain kinds of formal expressions of the form
%
\[ I_{a,\phi}(x) = \int a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta. \]
%
which we will call an oscillatory integral. Here $\Omega$ is some open subset of $\RR^d$, $a$ is a \emph{symbol} lying in some class $\mathcal{S}^\mu_{\text{loc}}(\Omega \times \RR^p)$, and $\phi: \RR^d \times \RR^p - \{ 0 \} \to \RR$ is some smooth function, which we call the \emph{phase}. If $\mu \leq -p$, the integrand is Lebesgue integral, and so we can interpret the definition of $I_{a,\phi}$ pointwise as a Lebesgue integrable function. For $\mu > -p$, one cannot interpret the integral above as a Lebesgue sense, and we must find another way to formally define the integral. In this chapter, we describe the basic theory through which we can rigorously interpret such formulas.

We will make several assumptions on $\phi$ so that as $\theta$ increases in magnitude, the phase behaves in a way to make the integrand more and more oscillatory. By making sense of the cancellation of this oscillation when $\theta$ has large magnitude, we will be able to make sense of the expression $I_{a,\phi}$, as a distribution. In order to guarantee this kind of oscillation, we do need to make some assumptions on $\phi$. The canonical assumptions to make are the following:
%
\begin{itemize}
    \item $\phi$ is \emph{homogeneous} of degree one in the $\theta$ variable.

    \item The functions $\nabla_x \phi$ and $\nabla_\theta \phi$ have no common zeroes on $\msupp(a)$.
\end{itemize}
%
In this chapter, by a \emph{phase function}, we will mean a function with these properties.

These are the easiest phases to handle. In practice, there are other distributions which arise by oscillatory integrals not satisfying these assumptions; for instance, the fundamental solution $\Phi$ of the Schr\"{o}dinger operator
%
\[ \partial_t - (i/2\pi) \Delta \]
%
on $\RR^d$ is naturally expressed by the oscillatory integral
%
\[ \Phi(x,t) = \int e^{2 \pi i ( \xi \cdot x - |\xi|^2 )}\; d\xi, \]
%
which has a phase with a quadratic component. It is possible to extend some of the results here to such other phase, but the degree one case is simplest to analyze, and still features much of the complexity dealt with in the study of other operators.

\begin{theorem}
    Fix $\chi \in C_c^\infty(\RR^p)$, equal to one in a neighborhood of the origin. The distributions
    %
    \[ I_{a,\phi,R} = \int a(x,\theta) \chi(\theta / R) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
    %
    converge in the weak $*$ topology as $R \to \infty$ to a distribution $I_{a,\phi}$ on $\Omega$, independent of the choice of $\chi$. For $\mu \geq -p$, the distribution $I_{a,\phi}$ has order at most the smallest integer larger than $p + \mu$. For a fixed phase function $\phi$, the map $a \mapsto I_{a,\phi}$ is continuous from $\SW^\infty(\Omega \times \RR^p)$ to $\DD(\Omega)^*$, equipped with the weak $*$ topology.
\end{theorem}
\begin{proof}
    If $\mu < -p$, the result follows from the dominated convergence theorem, and moreover, the distribution is continuous the result gives a distribution of order zero. Now fix $f \in \DD(\Omega)$ with support in a compact set $K \subset \Omega$. Our goal is to show that
    %
    \[ \langle I_{a,\theta,R}, f \rangle = \int a(x,\theta) \chi(\theta / R) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
    %
    converges as $R \to \infty$ to a quantity independent of the choice of $\chi$, and that moreover, this quantity is upper bounded by a constant depending on only finitely many derivatives of $f$. Let us write
    %
    \[ a_R(x,\theta) = a(x, \theta) \chi(\theta / R). \]
    %
    We will assume without loss of generality that $a(x,\theta) = 0$ for $|\theta| \leq 1$, since the resulting weak $*$ convergence obtained by taking a cutoff function supported away from the origin is not affected, and the quantity
    %
    \[ \int a(x,\theta) \chi(\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
    %
    defines a function in $C^\infty(\Omega)$. For similar reasons, we will assume without loss of generality that the functions $\nabla_x \phi$ and $\nabla_\theta \phi$ have no common zeroes on the \emph{support} of $a$, rather than just the microsupport. We now apply the principle of nonstationary phase, i.e. integrating by parts. Consider the \emph{homogenized gradient}
    %
    \[ (\nabla^H \phi)(x,\theta) = ( \nabla_x \phi, |\theta| \nabla_\theta \phi(x,\theta) ). \]
    %
    Then $\nabla_{x,\theta}^H \phi$ is also homogeneous of degree one in the $\theta$ variable, and $|\nabla_{x,\theta}^H \phi| > 0$ on the support of $a$. We note that
    %
    \[ (\nabla_{x,\theta}^H e^{2 \pi i \phi} ) = (2 \pi i) e^{2 \pi i \phi} \nabla_{x,\theta}^H \phi. \]
    %
    Note that the formal transpose of $\nabla_{x,\theta}^H$ is the differential operator $L$ given for pairs of functions $F_1: \Omega \times \RR^p \to \RR^d$ and $F_2: \Omega \times \RR^p \to \RR^p$ by the formula
    %
    \begin{align*}
        L(F_1, F_2) &= - ( \nabla_x \cdot F_1 + \nabla_\theta \cdot ( |\theta| F_2 )\\
        &= - \left( \nabla_x \cdot F_1 + |\theta|^{-1} (\theta \cdot F_2) + |\theta| (\nabla_\theta \cdot F_2) \right).
    \end{align*}
    %
    Thus we conclude that
    %
    \begin{align*}
        \langle I_{a,\theta,R}, f \rangle &= \frac{1}{2 \pi i} \int \frac{a \cdot f}{|\nabla_{x,\theta}^H \phi|^2} \left( \nabla_{x,\theta}^H e^{2 \pi i \phi} \right) \cdot (\nabla_{x,\theta}^H \phi)\\
        &= \frac{1}{2 \pi i} \int L \left\{ \frac{a \cdot f}{|\nabla_{x,\theta}^H \phi|^2} \nabla_{x,\theta}^H \phi \right\} e^{2 \pi i \phi}.
    \end{align*}
    %
    Expanding out the differential operator $L$, we see we can write
    %
    \[ \langle I_{a,\theta,R}, f \rangle = \sum_{|\alpha| \leq 1} \langle I_{1,a_{1,\alpha}, \theta, R}, \partial^\alpha f \rangle, \]
    %
    where $a_{1,\alpha}$ is a symbol of order at most $\mu - 1$. Iterating this argument, we find that for any $N > 0$, we can write
    %
    \[ \langle I_{a,\theta,R}, f \rangle = \sum_{|\alpha| \leq N} \langle I_{N,a_{N,\alpha}, \theta, R}, \partial^\alpha f \rangle, \]
    %
    where $a_{N,\alpha}$ is a symbol of order at most $\mu - N$. If $N > \mu + p$, then we conclude the result follows for each term on the right hand side, and these quantities are each distributions of order zero. But this means that the result holds on the left hand side, and the resulting distribution $I_{a,\theta}$ has order at most $N$.
\end{proof}

%and $\phi \in C^\infty(U \times (\RR^p - \{ 0 \}))$ is homogeneous of degree one in $\theta$, and $d\phi$ is nonvanishing on the support of $a$.

%If $t < -d$, then the integrand formally defining $I_{a,\phi}$ is absolutely integrable, and interpreting $I_{a,\phi}$ as a Lebesgue integral gives us a locally integrable function $I_{a,\phi}$. But for $t \geq -d$, the integral defining $I_{a,\phi}$ need not be locally integrable; for instance, our definition will show that the distribution
%
%\[ \int_{\RR^d} \xi^t e^{2 \pi i x \cdot \xi}\; d\xi \]
%
%acts on functions as a constant multiple of the differential operator $D^t$.

%To define the oscillatory integral distribution rigorously, we fix $\psi \in \DD(\RR^d)$, and $\rho \in \DD(\RR^p)$, equal to one in a neighborhood of the origin. The integral
%
%\[ \int a(x,\theta) \psi(x) \rho(\theta / R) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
%
%is then well defined, and we claim that the limit
%
%\[ \lim_{R \to \infty} \int a(x,\theta) \psi(x) \rho(\theta / R) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
%
%exists and is independent of the choice of $\rho$. We can then define this limit to be
%
%\[ \int I_{a,\phi}(x) \psi(x)\; dx \]
%
%and this defines $I_{a,\phi}$ as a distribution. To prove the limit exists, we fix $R_1 \leq R_2$, and let $\tilde{\rho}(\theta) = \rho(\theta/R_2) - \rho(\theta/R_1)$. Then $\tilde{\rho}$ is supported on $R_1 \lesssim |x| \lesssim R_2$. Assume first that $R_2 \leq 2R_1$. Rescaling, we find that if $\eta(x,\theta) = a(x,R_2 \theta) \psi(x) \rho(\theta)$, then
%
%\begin{align*}
%    \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \psi(x) \tilde{\rho}(\theta) &= R_2^m \int_{\RR^n} \int_{\RR^p} e^{2 \pi i R_2 \phi(x,\theta)} a(x,R_2 \theta) \psi(x) \tilde{\rho}(\theta)\\
%    &= R_2^p \int_{\RR^n} \int_{\RR^p} e^{2 \pi i R_2 \phi(x,\theta)} \eta(x,\theta).
%\end{align*}
%
%Then $\eta$ is supported on $1/2 \lesssim |\theta| \lesssim 1$ and $|x| \lesssim 1$. Thus the support of $\eta$ is independant of $R_1$ and $R_2$. It is simple to verify that
%
%\[ |\nabla^n_x \nabla^m_\theta \eta(x,\theta)| \lesssim_{n,m} R_2^t \cdot |\nabla^n_x \psi(x)|, \]
%
%where the bound is independant of $R_1$ and $R_2$. Since $\nabla_x \phi$ and $\nabla_\theta \phi$ have no common zeroes on the support of $a$, we can apply the principle of stationary phase to conclude that
%
%\[ \left| R_2^p \int_{\RR^n} \int_{\RR^p} e^{2 \pi i R_2 \phi(x,\theta)} \eta(x,\theta) \right| \lesssim_N R_2^{p + m - N} \cdot \| \nabla^{\leq N} \psi \|_{L^\infty(\RR^d)}. \]
%
%In general, if $R_2 \geq 2R_1$, we consider the largest $l$ such that $2^l R_1 \leq R_2$. If we set $a_k = 2^k R_1$ for $0 \leq k \leq l$, and $a_{l+1} = R_2$, then we write
%
%\begin{align*}
%    &\left| \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \phi(x) \tilde{\rho}(\theta) \right|\\
%    &\quad\quad= \left| \sum_{k = 0}^l \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \phi(x) (\rho(\theta/a_{k+1}) - \rho(\theta / a_k)) \right|\\
%    &\quad\quad\lesssim \sum_{k = 0}^l a_{k+1}^{p + m - N} \| \nabla^{\leq N} \psi \|_{L^\infty(\RR^d)}. 
%\end{align*}
%
%If we choose $N > p + m$, then we conclude that
%
%\begin{align*}
%    \left| \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \phi(x) \tilde{\rho}(\theta) \right| &\lesssim (R_1^{p + m - N} + R_2^{p + m - N}) \| \nabla^{\leq N}_x \psi \|_{L^\infty(\RR^d)}\\
%    &\lesssim R_1^{p + t - N} \| \nabla^{\leq N} \psi \|_{L^\infty(\RR^d)}.
%\end{align*}
%
%In particular, this quantity tends to zero as $R_1 \to \infty$, which gives convergence of the limit, and also gives boundedness, showing $I_{a,\phi}$ is a distribution of order $\leq N$, where $N$ is the smallest integer bigger than $p + m$. A very similar argument shows that if $\rho \in \DD(\RR^p)$ is equal to zero in a neighborhood of the origin, then
%
%\[ \lim_{R \to \infty} \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \psi(x) \rho(\theta / R)\; dx = 0. \]
%
%It follows from the above observation that the definition is independent of the original choice of $\rho$. It is left as an exercise to show that the map $a \mapsto I_{a,\phi}$ is continuous from $S^t(U \times \RR^p)$ to $\DD^*(U)$.

\begin{remark}
    Suppose $a$ is a symbol of order $\mu$. Using the fact that if $\mu < -p$, then $I_{a,\phi}$ is continuous, and the fact that $\partial^\alpha I_{a,\phi} = I_{b,\phi}$, where $b$ is a symbol of order at most $\mu + |\alpha|$. It thus follows that if $\mu < -p-n$, then $I_{a,\phi} \in C^n(\Omega)$. In particular, if $\mu = -\infty$, then $I_{a,\phi} \in C^\infty(\Omega)$.
\end{remark}

\begin{remark}
    If $M$ is a manifold, and $E$ is a vector bundle over $M$, then for any homogeneous phase $\phi \in C^\infty(E - \{ 0 \})$ and any symbol $a \in \mathcal{S}^t(E^*)$, we can consider the oscillatory integral distribution formally defined by the integral
    %
    \[ I_{a,\phi}(x) = \int_{E_x} a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta, \]
    %
    which is a distribution on $M$. One can develop a theory of such distributions, but we mainly focus on the simpler case defined here.
\end{remark}

The wavefront set of $I_{a,\phi}$ has a simple formula. If $\psi$ is a bump function supported in a neighbourhood of some point $x_0$, then rescaling gives
%
\[ \widehat{I_{a,\phi} \psi}(\lambda \xi_0) = \lambda^d \int \int e^{2 \pi i \lambda (\phi(x,\theta) - x \cdot \xi_0)} a(x,\lambda \theta) \psi(x)\; dx\; d\theta. \]
%
This is an oscillatory integral, and the phase is non-stationary in the $x$ and $\theta$ variables provided that either:%
\begin{itemize}
    \item $\nabla_\theta \phi(x_0,\theta_0) \neq 0$, and the support of $\psi$ is appropriately small.

    \item $\nabla_x \phi(x_0,\theta_0) \neq \xi_0$, and the support of $\psi$ is appropriately small.
\end{itemize}
%
Thus we are lead to conclude that if we define the set
%
\[ \Lambda_\phi = \{ (x_0, \nabla_x \phi(x_0,\theta_0)) : \nabla_\theta \phi(x_0, \theta_0) = 0 \}, \]
%
then $\text{WF}(I_{a,\phi}) \subset \msupp(a) \cap \Lambda_\phi$.

\begin{theorem}
    If $a \in \mathcal{S}^t(U \times \RR^p)$, and $\phi \in C^\infty(U \times \RR^p)$ is a phase satisfying the standard conditions to define the oscillatory integral distribution $I_{a,\phi}$, then
    %
    \[ \text{WF}(I_{a,\phi}) \subset \Lambda_\phi. \]
\end{theorem}
\begin{proof}
    Fix $(x_0,\xi_0) \in T^* U$, and suppose that for all $(x_0,\theta_0) \in U \times \RR^p$, either $\nabla_\theta \phi(x_0,\theta_0) \neq 0$, $\nabla_x \phi(x_0,\theta_0) \neq \xi_0$, or $(x_0,\theta_0) \not \in \msupp(a)$. Without loss of generality, we can assume that this third condition never holds, by decomposing $a$ as the sum of a symbol in $\mathcal{S}^{-\infty}$ and a symbol where $a$ vanishes in a neighborhood of any point $(x_0,\theta_0)$ with $\nabla_\theta \phi(x_0,\theta_0) = 0$ and $\nabla_x \phi(x_0,\theta_0) = \xi_0$, and using the fact that if $a \in \mathcal{S}^{-\infty}$, then $I_{a,\phi} \in C^\infty(U)$. Write
    %
    \[ \widehat{I_{a,\phi} \psi}(\lambda \xi_0) = \lambda^d \int \int e^{2 \pi i \lambda \tilde{\phi}(x,\theta;\xi_0)} \tilde{a}_\lambda(x,\theta)\; dx\; d\theta \]
    %
    where $\tilde{a}_\lambda(x,\theta) = a(x, \lambda \theta) \psi(x)$, and write $\tilde{\phi}(x,\theta;\xi) = \phi(x,\theta) - x \cdot \xi$. If $Z$ is the set of all $\theta \in \RR^p$ with $|\theta| = 1$ such that $\nabla_\theta \phi(x_0,\theta) = 0$, then $Z$ is closed, and thus compact. Since $\nabla_x \phi(x_0,\theta) \neq \xi_0$ for all $\theta \in Z$, it follows by compactness that
    %
    \[ |\nabla_x \phi(x_0,\theta) - t \xi_0| \gtrsim 1 \]
    %
    for all $\theta \in Z$ and all $t > 0$. By homogeneity, for any $\theta \in \RR^p - \{ 0 \}$ such that $\nabla_\theta \phi(x_0,\theta) = 0$,
    %
    \[ |\nabla_x \phi(x_0,\theta) - \xi_0| \gtrsim |\theta|. \]
    %
    By reducing the implicit constant slightly, we may assume that there is $\varepsilon > 0$ such that for any $x \in \RR^d$ and $\xi \in \RR^d$ with $|x - x_0| \leq \varepsilon$ and $|\xi - \xi_0| \leq \varepsilon$, and any $\theta \in \RR^p - \{ 0 \}$ such that $|\nabla_\theta \phi(x_0,\theta)| \leq \varepsilon$, then
    %
    \[ |\nabla_x \phi(x,\theta) - \xi| \gtrsim |\theta|. \]
    %
    Now if $\psi$ has support in a $\varepsilon$ neighborhood of $x_0$, it follows that for all $x \in \text{supp}(\psi)$ and any $\theta \in \RR^p$,
    %
    \[ |\nabla_{x,\theta} \tilde{\phi}(x,\theta,\xi)| \gtrsim 1. \]
    %
    The principle of nonstationary phase thus guarantees that for any $N > 0$,
    %
    \[ |\widehat{I_{a,\phi} \psi}(\lambda \xi_0)| \lesssim_{\phi,N} \lambda^{-N} \sup_{|\alpha| \leq N} \| D^\alpha_{x,\theta} \tilde{a}_\lambda(x,\theta) |\nabla_{x,\theta} \tilde{\phi}(x,\theta;\xi)|^{|\alpha| - 2N} \|_{L^\infty(U \times \RR^p)}. \]
    %
    Now
    %
    \[ |\nabla_{x,\theta} \tilde{\phi}(x,\theta;\xi)| = |\nabla_x \phi(x,\theta) - \xi| \lesssim 1, \]
    %
    and if $D^\alpha_{x,\theta} = D^{\alpha_1}_x D^{\alpha_2}_\theta$, then $D^\alpha_{x,\theta} \tilde{a}_\lambda(x,\theta)$ is a finite sum of $O(\alpha)$ terms, each of the form
    %
    \[ \lambda^{|\alpha_2|} D^{\beta_1}_x D^{\alpha_2}_\theta a(x,\lambda \theta) D^{\beta_2}_x \psi(x), \]
    %
    and
    %
    \[ |\lambda^{|\alpha_2|} D^{\beta_1}_x D^{\alpha_2}_\theta a(x,\lambda \theta) D^{\beta_2}_x \psi(x)| \lesssim_{\beta_1,\beta_2} \lambda^{|\alpha_2|} \langle \lambda \rangle^{t - |\alpha_2|} \lesssim \langle \lambda \rangle^t \]
    Thus we conclude that
    %
    \[ |\widehat{I_{a,\phi} \psi}(\lambda \xi)| \lesssim_{\phi,\psi,N} \langle \lambda \rangle^{t - N}. \]
    %
    Since $N$ was arbitrary, we thus find that $\xi_0 \not \in \text{WF}(I_{a,\phi})$.
\end{proof}

\begin{example}
    If we set $\phi(x,\xi) = - x \cdot \xi$, and $a(x,\xi) = a(\xi)$ is a symbol depending only on the $\xi$ variable, then
    %
    \[ I_{a,\phi}(x) = \int a(\xi) e^{- 2 \pi i x \cdot \xi}\; d\xi \]
    %
    is the Fourier transform of $a$. We calculate that
    %
    \[ \Lambda_\phi = \{ 0 \} \times \RR^d_\xi. \]
    %
    Thus we conclude that
    %
    \[ \text{WF}(I_{a,\phi}) \subset \{ 0 \} \times \RR^n. \]
    %
    Thus the Fourier transform of any symbol is smooth away from the origin. This result should be compared to the standard result that the Fourier transform of a homogeneous distribution which is $C^\infty$ away from the origin is also homogeneous, and $C^\infty$ away from the origin.
\end{example}

As in the theory of pseudodifferential operators, it is often natural to work with oscillatory integral distributions modulo elements of $C^\infty(\Omega)$. Modulo $C^\infty$, the result above implies that we can assume without loss of generality that any symbol $a$ is supported on an arbitrarily small neighborhood of it's microsupport, and an arbitrarily small neighborhood of $\Lambda_\phi$.

Near the wavefront set of an oscillatory integral distribution, we can compute an asymptotic formula which characterizes the behaviour of the distribution near the wavefront set, via integrating against a test function.

\begin{theorem}
    Consider a phase function $\phi: U \times \RR^p \to \RR$. Fix $(x_0,\theta_0) \in U \times \RR^p - \{ 0 \}$, such that
    %
    \[ \nabla_\theta \phi(x_0, \theta_0) = 0. \]
    %
    Let $\xi_0 = \nabla_x \phi(x_0,\theta_0)$. Consider any phase function $\psi: U \times \RR^q \to \RR$, and $\sigma_0 \in \RR^q$ such that
    %
    \[ \nabla_x \phi(x_0,\theta_0) = \nabla_x \psi(x_0,\sigma_0). \]
    %
    Furthermore, assume that the Hessian $H_{x, \theta} (\phi - \psi)$ of the function
    %
    \[ \phi - \psi: U \times \RR^p \times \RR^q \to \RR \]
    %
    is non-degenerate at $(x_0,\theta_0,\sigma_0)$, i.e. if the symmetric $(p + n) \times (p + n)$ matrix
    %
    \[ \begin{pmatrix} H_x \phi & D_x (\nabla_\theta \phi) \\ D_\theta (\nabla_x \phi) & H_\theta \phi \end{pmatrix} - \begin{pmatrix} H_x \psi & 0 \\ 0 & 0 \end{pmatrix} \]
    %
    is invertible. Then there exists a conical neighborhood $\Gamma$ of $(x_0,\theta_0)$, an open neighborhood $V$ of $x_0$, and an open neighborhood $W$ of $\sigma_0$, such that if $f \in \DD(V)$, and $a$ is a symbol on $U \times \RR^p$ with $\msupp(a) \subset \Gamma$, then there exists a sequence of smooth, bounded functions $c_k$ such that as $\lambda \to \infty$, for $\sigma \in W$,
    %
    \begin{align*}
        & \int I_{a,\phi_1}(x) f(x) e^{-2 \pi i \lambda \psi(x,\sigma)}\; dx\\
        &\quad\sim e^{-2 \pi i \lambda \psi(x_\sigma,\sigma)} \frac{e^{(i\pi/4) \text{sgn} \{ Q(\sigma) \} }}{|\det Q(\lambda)|^{1/2}} \lambda^{\frac{p-d}{2}} \sum_{k = 0}^\infty c_k(\sigma,\lambda) \cdot \lambda^{-k},
    \end{align*}
    %
    Here $x_\sigma = x(\sigma)$ and $\theta_\sigma = \theta(\sigma)$ are defined locally in a neighborhood of $\sigma_0$, such that
    %
    \[ \nabla_x \phi(x_\sigma, \theta_\sigma) = \nabla_x \phi(x_\sigma, \sigma) \quad\text{and}\quad \nabla_\theta \phi(x_\sigma, \theta_\sigma) = 0, \]
    %
    and such that $\theta_{\sigma_0} = \theta_0$, and $x_{\sigma_0} = x_0$. These functions exist precisely because the assumptions of the implicit function theorem are given by the Hessian conditions. The functions $\{ c_k \}$ are defined as follows, though explicitly computing them is often more trouble than what it's worth. Consider the matrix
    %
    \begin{align*}
        Q(\sigma) &= H_{x,\theta}(\phi - \psi)(x_\sigma, \theta_\sigma, \sigma),
    \end{align*}
    %
    which we can expand as
    %
    \[ \begin{pmatrix} H_x \phi(x_\sigma, \theta_\sigma) - H_x \psi(x_\sigma, \sigma) & D_x ( \nabla_\theta \phi ) (x_\sigma, \theta_\sigma) \\ D_\theta( \nabla_x \phi)(x_\sigma, \theta_\sigma) & H_\theta \phi(x_\sigma, \theta) \end{pmatrix}. \]
    %
    In a small neighborhood of $\sigma_0$, our assumption guarantees that $Q(\sigma)$ is an invertible matrix. For each $\sigma$, we now choose a diffeomorphism $(x,\theta) \mapsto y(x,\theta,\sigma)$, such that
    %
    \[ y(x_\sigma, \theta_\sigma, \sigma) = 0, \quad\quad (D_{x,\theta} y)(x_\sigma, \theta_\sigma, \sigma) = I, \]
    %
    and,
    %
    \[ (\phi - \psi)(x,\theta,\sigma) = (\phi - \psi)(x_\sigma, \theta_\sigma, \sigma) + y^T Q(\sigma) y / 2. \]
    %
    The function $y$ exists, and is unique in a neighborhood of $(x_0, \theta_0, \sigma_0)$, by a result which is essentially the Morse lemma (see Lemma 1.2.2 of Duistermaat). If we now define
    %
    \[ R(\sigma) = \frac{i}{4 \pi} \nabla_y^T Q(\sigma)^{-1} \nabla_y, \]
    %
    and consider a function $g$ defined for $y = y(x,\theta,\sigma)$ by the relation
    %
    \[ g(y,\sigma,\lambda) = \frac{a(x, \lambda \theta) f(x) }{| \det(D_{x,\theta} y(x,\theta,\sigma)) |}. \]
    %
    We then have $c_k = R(\sigma)^k g(0,\sigma,\lambda) / k!$.

    As special cases, we have
    %
    \[ c_0(\sigma,\lambda) = a(x_\sigma, \lambda \theta_\sigma) f(x_\sigma) \]
    %
    A derivative in $y$ corresponds to a linear combination of derivatives in the $x$ and $\theta$ variables. This shows each function $\{ c_k \}$ is smooth in the $\sigma$ and $\lambda$ variables. Since $\theta_\sigma \neq 0$, we have 
    %
    \[ \left. \nabla_\theta^N \{ a(x, \lambda \theta) \} \right|_{\theta = \theta_\sigma} \lesssim_N 1, \]
    %
    uniformly in the conic set of $\lambda$ under consideration. Thus we have $|c_N| \lesssim_N 1$, and so the asymptotic formula under study does actually decay in $\lambda$ as $\lambda \to \infty$.
\end{theorem}

The phase $\phi$ of an oscillatory integral distribution is called \emph{nondegenerate} if whenever $\nabla_\theta \phi(x,\theta) = 0$, the matrix $D_{x,\theta}(\nabla_\theta \phi)(x,\theta)$ has full rank $p$. It follows that
%
\[ \Sigma_\phi = \{ (x,\theta): \nabla_\theta \phi(x,\theta) = 0 \} \]
%
is a $d$ dimensional submanifold of $U \times \RR^p$. Moreover, the map $f$ from $\Sigma_\phi$ to $U \times \RR^d$ given by $(x,\theta) \mapsto (x,\nabla_x \phi(x,\theta))$ is an immersion, the immersed submanifold in the image being denoted by $\Lambda_\phi \subset T^* U$. To verify the map is an immersion, we note that at a point $(x,\theta) \in U \times \RR^p$, the tangent space of $\Sigma_\phi$ consists of vectors $(v,w) \in \RR^d \times \RR^p$ such that
%
\[ D_x \nabla_\theta \phi(x,\theta) \cdot v + D_\theta \nabla_\theta \phi(x,\theta) \cdot w = 0. \]
%
Now
%
\[ D_{x,\theta}f(x,\theta)(v,w) = (v, D_x \nabla_x \phi(x,\theta) \cdot v + D_\theta \nabla_x \phi(x,\theta) \cdot w ). \]
%
Thus if $(v,w)$ lies in the tangent space and $Df(x,\theta)(v,w) = 0$, then $v = 0$, which implies
%
\[ D_\theta \nabla_\theta \phi(x,\theta) \cdot w = D_\theta \nabla_x \phi(x,\theta) \cdot w = 0. \]
%
Since mixed partials commute, this says exactly that $D(\nabla_\theta \phi)^T \cdot w = 0$. The full rank condition thus implies that $w = 0$. Thus $(v,w) = 0$, completing the argument that $f$ is an immersion.

Many properties about the phase function can be summarized via the set $\Lambda_\phi$. For instance, given a function $\psi(x,\sigma)$, the function $\eta(x,\theta,\sigma) = \phi(x,\theta) - \psi(x,\sigma)$ has a nondegenerate stationary point as a function of $x$ and $\theta$ at a point $(x_0,\theta_0,\sigma_0)$ if and only if $\phi$ is nondegenerate phase function in a neighborhood of $(x_0,\theta_0)$, and the covector field $d_x \psi: U \times \RR^q \to T^* U$ intersects $\Lambda_\phi$ transversally at $(x_0,\xi_0)$, where $\xi_0 = \nabla_x \phi(x_0,\theta_0) = \nabla_x \psi(x_0,\sigma_0)$. In particular, we see that nondegenerate phase functions are `generic' in the class of all phase functions.

The assumptions of the asymptotic theorem above can be specified geometrically in terms of $\Lambda_\phi$. More precisely, the assumptions of the theorem above hold at a point $(x_0,\theta_0,\sigma_0)$ if and only if $\phi$ is a non-degenerate phase function, and \emph{also} that the section $d_x \psi: U \times \RR^q \to T^* U$ intersects $\Lambda_\phi$ transversally at the point $(x_0,\theta_0,\sigma_0)$. In particular, given that $\phi$ is non-degenerate, and stationary at $(x_0,\theta_0)$, a generic $\psi$ satisfying $\nabla_x \phi(x_0, \theta_0) = \nabla_x \psi(x_0,\sigma_0)$ will satisfy the assumptions of the theorem.

The manifold $\Lambda_\phi$ of $U \times \RR^d$ actually has special geometric structure. Consider the two form
%
\[ \sigma = d\xi^1 \wedge dx^1 + \dots + d\xi^d \wedge dx^d. \]
%
The $\sigma = d\omega$, where $\omega = \xi^1 dx^1 + \dots + \xi^d dx^d$. We claim that for any $p =(x,\theta) \in \Sigma_\phi$, and any $v,w \in T_p \Sigma_\phi$, $\sigma(f_* v, f_* w) = 0$. To see this, we calculate that
%
\[ f^*(\sigma) = f^*(d \omega) = d(f^* \omega), \]
%
and
%
\[ f^* \omega = \nabla_x \phi \cdot dx = d \phi - \nabla_\theta \phi \cdot d\theta. \]
%
On $\Sigma_\phi$, $\nabla_\theta \phi = 0$, so $f^* \omega = d \phi$, and so $f^*(\sigma) = d(f^* \omega) = d^2 \phi = 0$. Thus $\Lambda_\phi$ is a \emph{Lagrangian submanifold} of $T^* \RR^d$ with respect to the two form $\sigma$.

For any phase function $\phi$ (possibly degenerate), we can define
%
\[ \Sigma_\phi = \{ (x,\theta): \nabla_\theta \phi(x,\theta) = 0 \} \]
%
\[ \Lambda_\phi = \{ (x,\nabla_x \phi(x,\theta)) : \nabla_\theta \phi(x,\theta) = 0 \}. \]
%
If $\Lambda_\phi$ is an immersed Lagrangian manifold (though not necessarily an immersion through the map $f: \Sigma_\phi \to \Lambda_\phi$), we say $I_{a,\phi}$ is a \emph{Lagrangian distribution}. The phase $\phi$ might be degenerate in this case.

\begin{example}
    A degenerate example of a Lagrangian distribution is given for $p = d + 1$, $\theta = (\theta_0, \theta_1)$ with $\theta_0 \in \RR^d$ and $\theta_1 \in \RR$, and
    %
    \[ \phi(x,\theta) = x \cdot \theta_0, \]
    %
    then $\phi$ defines a Lagrangian distribution $I_{a,\phi}$ for any symbol $a$, provided that $a(x,\theta)$ vanishes for any $\theta$ in a cone containing the $\theta_1$ axis. Now $\Sigma_\phi = \{ 0 \} \times \RR^{d+1}$, and $\Lambda_\phi = \{ 0 \} \times \RR^d$, which is a Lagrangian manifold. Thus the distributions
    %
    \[ I_{a,\phi}(x) = \int a(x,\theta_0,\theta_1) e^{2 \pi i x \cdot \theta_0}\; d\theta_0\; d\theta_1 \]
    %
    are Lagrangian.
\end{example}

If $f: U \to V$ is a diffeomorphism between open subsets of $\RR^d$, and we equip $T^* U$ with coordinates $(x,\xi)$, and $T^* V$ with coordinates $(y,\eta)$, then we obtain an isomorphism $g: T^* U \to T^* V$ mapping $(x,\xi)$ in $T^* V$ to $(x, (Df(x)^T)^{-1} \eta)$ in $T^* U$. Under this correspondence, if we consider the two-form $\omega_V = \sum \eta_i \wedge dy^i$ on $U$, then
%
\[ g^* \omega_V = \sum (\eta^i \circ g) \cdot d(y^i \circ g) = \sum ((Df(x)^T)^{-1} \xi)_i df^i(x) = \sum \xi_i dx^i. \]
%
Thus the Lagrangian form is invariant under coordinate changes, and can thus be well defined on the cotangent bundle of any manifold $M$. Thus we can discuss Lagrangian submanifolds of $T^* M$ for any manifold $M$, and Lagrangian distributions on manifolds.

\begin{example}
    Consider a one-form $\psi$ on $M$, i.e. a smooth function $\psi: M \to T^* M$. Working in coordinates $(x,\xi)$ on $T^* M$, we have
    %
    \[ \psi^* \omega = \sum \psi^i dx^i = d\psi. \]
    %
    Thus we see that $\psi^* \sigma = 0$ if and only if $d\psi = 0$, so $\psi$ defines a Lagrangian submanifold of $T^* M$ if and only if it is closed.
\end{example}




















\chapter{Pseudodifferential Operators}

The goal of this chapter is to define the calculus of pseudodifferential operators, a general family of operators which allows us to manipulate the spatial and frequential properties of functions simultaneously. It is impossible to do this \emph{locally}, because of the uncertainty principle, which prevents us from locally isolating the spatial and frequency support to an arbitrary precision, but one can do things \emph{pseudolocally}, i.e. the position of the support in time and space is approximately preserved, up to a rapidly decaying error. Roughly speaking, we will define a family of operators $a(x,D)$, associated with functions $a(x,\xi)$, such that if the support of a function $f$ is concentrated near a point $x_0$, and the support of $\widehat{f}$ is concentrated near $\xi_0$, then $a(x,D) f \approx a(x_0,\xi_0) f$. Before we begin, let us consider some basic examples that allow us to control space or time exclusively, to get an idea of what we want out of such a theory.

The most basic spatial multipliers in analysis are the \emph{position operators}, which are the family of operators $X^\alpha: \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$, defined by setting
%
\[ X^\alpha f(x) = x^\alpha f(x). \]
%
The \emph{momentum operators} $D^\alpha: \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$ provide the most basic frequency multipliers, given by the relationship
%
\[ \widehat{D^\alpha f}(\xi) = \xi^\alpha \widehat{f}(\xi). \]
%
Note that in this chapter, the operators $\{ D^\alpha \}$ will be normalized as such, and thus differ from the usual differential operators, which we will here denote by $\partial^\alpha$, by the constant $(2 \pi i)^{-|\alpha|}$. For each $m \in C^\infty(\RR^d)$ such that $m$ and all of it's derivatives are slowly increasing, we can define a bounded operator $m(X): \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$ by setting
%
\[ m(X) f(x) = m(x) f(x). \]
%
We can also define an operator $m(D): \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$ by setting
%
\[ \widehat{m(D) f}(\xi) = m(\xi) \widehat{f}(\xi). \]
%
Thus we have found two homomorphisms from a ring of smooth functions on $\RR^d$ to the ring of bounded operators on $\mathcal{S}(\RR^d)$.

The family of such operators is very useful in analysis, since families of functions are more amenable to intuition than families of operators, and so we can try and understand what features of the function $m$ tell us about the resulting operators $m(X)$ and $m(D)$. For instance, an analysis of operators of the form $m(D)$ is very important to the study of \emph{elliptic} differential operators with constant coefficients. Recall that a partial differential operator $L = \sum c_\alpha D^\alpha$ of degree $k$ is \emph{elliptic} if the homogeneous polynomial $\sum_{|\alpha| = k} c_\alpha \xi^\alpha$ is non-vanishing away from the origin. Let us consider an example.

\begin{theorem}
    If $L$ is an elliptic partial differential operator on $\RR^d$, with constant coefficients, then $L$ has a fundamental solution, i.e. there exists a distribution $\Phi \in \DD(\RR^d)^*$ such that $L(\Phi) = \delta$.
\end{theorem}
\begin{proof}
    Suppose $L$ has degree $k$, and write $L = \sum c_\alpha D^\alpha$ for some constants $\{ c_\alpha \}$. Since $L$ is elliptic, there exists $R > 0$ such that the polynomial $P(\xi) = \sum_\alpha c_\alpha \xi^\alpha$ satisfies $|P(\xi)| \sim |\xi|^k$ for $|\xi| \geq R$. If $\chi \in \DD(\RR^d)$ is chosen such that $\chi(\xi) = 1$ for $|\xi| \leq R$, and we define a distribution $\Phi_0$ such that
    %
    \[ \widehat{\Phi_0}(\xi) = \frac{(1 - \chi(\xi))}{P(\xi)}. \]
    %
    Then $\widehat{\Phi_0}$ is a smooth function with $|\widehat{\Phi_0}(\xi)| \lesssim \langle \xi \rangle^{-k}$ for all $\xi \in \RR^d$, which means that $\widehat{\Phi_0}$ is a well defined tempered distribution, and thus $\Phi_0$ is also a well defined tempered distribution. But then
    %
    \[ \widehat{L \Phi_0} = 1 - \chi(\xi). \]
    %
    Since $\chi \in \DD(\RR^d)$, it follows by the Paley-Wiener theorem, taking the inverse Fourier transform that $L \Phi_0 = \delta - w$, where $w$ is an entire analytic function of at most polynomial increase. The Cauchy-Kovalevskaya theorem (i.e. solving the equation by expanding out power series) allows us to find an entire analytic function $u$ of at most exponential increase such that $Lu = w$. Then $\Phi = \Phi_0 + u$ is a fundamental solution for $L$.
\end{proof}

The theory of pseudodifferential operators was introduced primarily to generalize these kinds of constructions to elliptic linear partial differential equations with \emph{non constant} coefficients. A \emph{(left) parametrix} for a linear differential operator $L$ with smooth coefficients on a domain $\Omega$ is an operator $S: \DD(\Omega) \to \DD(\Omega)^*$ such that $1 - S \circ L$ is a \emph{smoothing operator}. We think of $S$ as given an `approximate inverse' for the operator $T$. The existence of a regular parametrix for an elliptic linear differential operator, which will be justified by the theory of pseudodifferential operators, is quite important in the theory of differential equations. In particular, it proves that certain differential operators are \emph{hypoelliptic}, i.e. that if $u \in \DD(\Omega)$, then $\singsupp(Lu) = \singsupp(u)$; it suffices to show $\singsupp(u) \subset \singsupp(Lu)$, since the inclusion $\singsupp(Lu) \subset \singsupp(u)$ is true for any differential operator $L$ with smooth coefficients. We recall that a Schwartz operator $S$ is called \emph{very regular} if it is regular in each variable (a smooth, distribution valued function in each variable) and agrees with integration against a smooth function away from the diagonal.   

\begin{theorem}
    Let $L$ be a differential operator with smooth coefficients. If $L$ has a very regular left parametrix $S$, then $L$ is hypoelliptic.
\end{theorem}
\begin{proof}
    For any very regular operator $S$, $\singsupp(Su) \subset \singsupp(u)$. It suffices to prove that for any \emph{compactly supported} distribution $u$, we have $\singsupp(u) \subset \singsupp(Lu)$, since the general case follows by localization. Since $1 - S \circ L$ is a smoothing operator, we have
    %
    \begin{align*}
        \singsupp(u) &\subset \singsupp((1 - S \circ L) u) \cup \singsupp((S \circ L) u)\\
        &\subset \singsupp((S \circ L) u)\\
        &\subset \singsupp(Lu). \qedhere
    \end{align*}
\end{proof}

The family of pseudodifferential operators we will study are \emph{microlocal}, i.e. not only do they not expand the singular support of distributions, but they also do not expand the wavefront set of distributions. It will therefore follow from the theory that any elliptic differential operator has a pseudodifferential parametrix, and an analogous argument to that given above gives the stronger equation
%
\[ \text{WF}(Lu) = \text{WF}(u) \]
%
for any distribution $u$.

Returning to the general question of constructing a functional calculus which includes both the position and momentum operators, we recall the \emph{spectral calculus}, whose goal, for a suitable algebra of normal operators $A$, is to produce an isomorphism of $A$ with an algebra of functions on some space $X$, called the \emph{spectrum} of $A$. A natural hope would be to find such a calculus for an algebra $A$ of operators which includes the position and momentum operators. This would, in particular, enable us to analyze linear differential operators with non-constant coefficients. However, we quickly see that such a theory would not quite work in as standard a way as the spectral calculus provides, because the families of operators $\{ X^\alpha \}$ and $\{ D^\alpha \}$ do \emph{not} commute with one another, i.e. the chain rule implies that
%
\[ [D^i,X^i] = D^i X^i - X^i D^i = 1. \]
%
The key thing we should notice from this equation, however, is that this equation indicates that position and momentum operators commute `up to lower order terms'. In other words, if we think of $X^\alpha$ and $D^\alpha$ as being operators of \emph{order $|\alpha|$}, then $[D^\alpha,X^\beta]$ is equal to zero, \emph{modulo terms of order $|\alpha| + |\beta| - 1$}. This fact will enable us to obtain an `approximate' functional calculus for the desired algebra of operators. This is precisely the \emph{calculus of pseudodifferential operators}.

We will associate, with each suitably regular function $a(x,\xi)$, an operator $a(x,D)$. The association will then be a homomorphism 'modulo lower order terms'. This association will have the property that if $a(x,\xi) = \sum c_\alpha(x) \xi^\alpha$, then $a(x,D)$ will be the differential operator $\sum c_\alpha(x) D^\alpha$. Indeed, this is where the notation $a(x,D)$ comes from. The association will also generalize the two families of multiplier operators; if $a(x,\xi) = m(x)$, then $a(x,D)$ is equal to $m(X)$, and if $a(x,\xi) = m(\xi)$, then $a(x,D)$ is equal to $m(D)$. To get an idea for what this operator should look like, we calculate that if $a(x,\xi) = \sum_\alpha c_\alpha(x) \xi^\alpha$ is the symbol of a differential operator with nonconstant coefficients, then the corresponding differential operator satisfies
%
\begin{align*}
    a(x,D) f &= \sum c_\alpha(x) D^\alpha f(x)\\
    &= \int_{\RR^d} \sum_\alpha c_\alpha(x) \xi^\alpha \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi\\
    &= \int_{\RR^d} a(x,\xi) e^{2 \pi i \xi \cdot x} \widehat{f}(\xi)\; d\xi.
\end{align*}
%
We use this integral formula to define $a(x,D)$ for a much more general family of functions $a(x,\xi)$.

Fix an open set $\Omega \subset \RR^d$. Given any distribution $a(x,\xi)$ which is tempered in the $\xi$ variable, i.e. any continuous, bilinear map $a: \DD(\Omega_x) \times \mathcal{S}(\RR^d_\xi) \to \CC$, or more technically, any element of the tensor product $\DD(\Omega_x)^* \CT \SW(\RR^d_\xi)^*$, we can associate an operator $a(x,D): \DD(\Omega) \to \DD(\Omega)^*$, such that for any $f,g \in \DD(\Omega)$,
%
\[ \langle a(x,D) f, g \rangle = \int a(x,\xi) \widehat{f}(\xi) e^{2 \pi i \xi \cdot x} g(x)\; dx\; d\xi. \]
%
We call any operator $T$ which can be given in the form $a(x,D)$ a \emph{pseudodifferential operator}. The symbol $a$ is uniquely determined by the operator $T$, since the action of $a(x,D)$ on $\DD(\Omega)$ determines the behaviour of $a$, viewed as a bilinear map, on an arbitrary element of $\DD(\Omega_x) \times \SW(\RR^d_\xi)$. For any set $S \subset \DD(\Omega_x)^* \CT \SW(\RR^d_\xi)^*$, the notation $\text{Op}(S)$ is often used to denote the family of all pseudodifferential operators defined by an element of $S$.

\begin{example}
    Consider the Laplacian $\Delta$ on $\RR^n$. Then $\Delta$ is the pseudodifferential operator on $\RR^n$ of order two, corresponding to the symbol $a(x,\xi) = - 4\pi^2 |\xi|^2$. Since $\Delta$ is a constant coefficient operator, it just acts as a Fourier multiplier. If $\Delta u = f$, then, modulo a harmonic function, which is arbitrarily smooth, $u = \Phi * f$, where $\Phi$ is a fundamental solution to the Laplacian. The operator $f \mapsto \Phi * f$ is a pseudodifferential operator with symbol $b(x,\xi) = \text{f.p}(1/4\pi^2 |\xi|^2)$. 
\end{example}

\begin{example}
    The Cauchy-Riemann operator on $\RR^2$ given by
    %
    \[ \frac{\partial}{\partial \overline{z}} = \frac{1}{2} \left( \frac{\partial}{\partial x} + i \frac{\partial}{\partial y} \right) \]
    %
    is a pseudodifferential operator of order one with symbol $i \pi(\xi + i \eta)$.
\end{example}

Any pseudodifferential operator $T = a(x,D)$ is continuous from $\DD(\Omega)$ to $\DD(\Omega)^*$, and has Schwartz kernel
%
\[ K_a(x,y) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi, \]
%
where in general the oscillatory integral must be interpreted formally, i.e. as an oscillatory integral distribution. It is also useful to write this kernel in the convolution form $k_a(x,z) = K_a(x,x-z)$, because we then have
%
\[ T\phi(x) = \int k_a(x,z) f(x-z)\; dz, \]
%
which reflects the fact that when $a(x,\xi)$ is independant of $x$, $k_a$ is a function of $z$, and then $Tf = k_a * f$ is a convolution operator. In fact, all pseudodifferential operators are infinite sums of convolution operators, in the following sense: if $a \in \DD(\RR^d)^* \CT \SW(\RR^d)^*$, then we can write $a$ as a sum of the form
%
\[ \sum_{i = 1}^\infty u_i \otimes v_i, \]
%
where $\{ u_i \}$ are in $\DD(\RR^d)^*$, and $\{ v_i \} \in \SW(\RR^d)^*$, and the convergence occurs unconditionally, in the distributional topology. It then follows that for $\phi \in \DD(\Omega)$,
%
\[ a(x,D) \phi = \sum_{i = 1}^\infty u_i \cdot (v_i * \phi). \]
%
Thus $a(x,D)$ can be interpreted as a non-constant coefficient sum of convolution operators.

As we increase the regularity of $a$, we no longer need to treat the definition of a pseudodifferential operator quite as formally, and so we can define the operator on a more general family of functions. Here are some non-comprehensive examples of this phenomenon:
%
\begin{itemize}
    \item If $a \in \mathcal{S}(\RR^d \times \RR^d)^*$, then $a(x,D)$ extends to a continuous linear operator from $\mathcal{S}(\RR^d)$ to $\mathcal{S}(\RR^d)^*$. The Schwartz kernel theorem implies that any continuous linear operator from $\mathcal{S}(\RR^d)$ to $\mathcal{S}(\RR^d)^*$ is of this form, which probably indicates that the family of such operators is too general to obtain interesting results.

    \item If $a \in \loc{\mathcal{S}^t}(\Omega \times \RR^d)$, then we will see later on that $a(x,D)$ extends to a continuous operator from $\EC(\Omega)^*$ to $\DD(\Omega)^*$ and from $\DD(\Omega)$ to $\EC(\Omega)$.

    \item If $a \in \mathcal{S}^t(\RR^d \times \RR^d)$, then $a(x,D)$ extends to a continuous operator from $\SW(\RR^d)$ to itself.

    \item If $a \in \loc{\mathcal{S}^{-\infty}}(\Omega \times \RR^d)$, then we will see later in this chapter that $a(x,D)$ has a kernel in $C^\infty(\RR^d \times \RR^d)$, and is therefore a smoothing operator, thus extending to a continuous operator from $\EC(\RR^d)^*$ to $\EC(\RR^d)$.

    Conversely, we will also see that if $T$ is \emph{any} `pseudolocal' smoothing operator, in the sense that it has a kernel $K \in C^\infty(\Omega \times \Omega)$ satisfying bounds of the form
    %
    \[ |\nabla^n_x \nabla^m_y K(x,y)| \lesssim_N \langle x - y \rangle^{-N}, \]
    %
    then $T \in \text{Op}(\loc{\mathcal{S}^{-\infty}}(\Omega \times \RR^d))$. In particular, any proper smoothing operator is of this form.

    \item If $a(x,D)$ is a proper operator, then it maps $\DD(\Omega)$ into $\EC(\Omega)^*$ and from $\EC(\Omega)$ into $\DD(\Omega)^*$. In combination with the previous results, we conclude that if $a \in \loc{\mathcal{S}^t}(\Omega \times \RR^d)$, then $a(x,D)$ is an operator from $\DD(\Omega)^*$ to itself, $\EC(\Omega)^*$ into itself, and from $\DD(\Omega)$ into itself. If $a \in \loc{\mathcal{S}^{-\infty}}(\Omega \times \RR^d)$, then $a(x,D)$ maps $\DD(\Omega)$ to itself and maps $\DD(\Omega)^*$ into $\EC(\Omega)$.

    Conversely, let $T: \DD(\Omega) \to \EC(\Omega)^*$ be \emph{any} proper operator, and let $K$ be it's kernel. Then $K$ lies in $\DD(\Omega_x)^* \CT \EC(\Omega_y)^*$. Thus we can define a symbol $a \in \DD(\Omega_x)^* \CT \SW(\RR^d_\xi)^*$ by setting
    %
    \[ a(x,\xi) = \int K(x,y) e^{2 \pi i \xi \cdot (x - y)}\; dy. \]
    %
    We verify using the Fourier multiplication formula that
    %
    \[ T_a \phi(x) = \int a(x,\xi) \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi = \int K(x,y) f(y)\ dy = T\phi(x). \]
    %
    Thus \emph{any} proper operator is a pseudodifferential operator.
\end{itemize}
%
That every proper operator, and that every operator on Schwartz space, is a pseudodifferential operator, indicates that the theory of pseudodifferential operators is too general to study more detailed in the form above. We will mostly focus on pseudodifferential operators defined by various symbol classes, since most practical operator occuring in PDE and analysis are of this form, and we can build up a sophisticated calculus from tis family.

\section{Basic Definitions}

There are two varieties of the theory of pseudodifferential operators, whose basic results are roughly analogous to one another. The first, which works best when considering pseudodifferential operators on $\RR^d$, works with operators specified by symbols $a: \RR^d \times \RR^d \to \CC$ in $\mathcal{S}^t(\RR^d \times \RR^d)$, i.e. satisfying estimates of the form
%
\[ |\nabla^n_x \nabla^m_\xi a(x,\xi)| \lesssim_{n,m} \langle \xi \rangle^{t-m} \]
%
where the bound holds uniformly in both $x$ and $\xi$, for any integers $n$ and $m$. As mentioned above, $a(x,D)$ then extends to a continuous operator from $\SW(\RR^d)$ to itself, which leads to an elegant theory. However, this theory is less easy to work with locally, e.g. working in various different coordinate systems, or obtaining a definition of pseudodifferential operator that applies to operators on manifolds. The approach here is best taken by describing a theory described by symbols $a \in \loc{\mathcal{S}^t}(\Omega \times \RR^d)$, i.e. satisfying an inequality of the form above uniformly in $\xi$, but only \emph{locally uniformly} in $x$.

Fix an open set $\Omega \subset \RR^d$, and consider a symbol $a \in \loc{\mathcal{S}^t}(\Omega \times \RR^d)$. From this symbol, we can define a continuous operator $T_a: \DD(\Omega) \to \EC(\Omega)$ by setting
%
\[ T_a f(x) = \int a(x,\xi) e^{2 \pi i \xi \cdot x} \widehat{f}(\xi)\; d\xi, \]
%
where the integral can now be interpreted in the usual Riemann / Lebesgue sense. The function $T_a f$ is smooth since $a \in C^\infty(\Omega_x, \SW(\RR^d_\xi)^*)$. We then say $T_a$ is a \emph{pseudodifferential operator of order $t$}. The family of all such operators is denoted $\loc{\Psi^t}(\Omega)$; we reserve the notation $\Psi^t(\Omega)$ to denote those operators defined by elements of $\mathcal{S}^t(\Omega \times \RR^d)$ rather than simply elements of $\loc{\mathcal{S}^t}(\Omega \times \RR^d)$.

The kernel of a pseudodifferential operator given by a symbol $a(x,\xi)$ of the class above is of the form
%
\[ K_a(x,y) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi, \]
%
where the integral is now an oscillatory integral distribution. In particular, we know from our discussion of oscillatory integral distributions that
%
\[ \text{WF}(K_a) \subset \{ (x,x;\xi,\xi) : x, \xi \in \RR^d \}. \]
%
The microlocal analysis of distributions implies the existence of a continuous extension $T_a: \EC(\Omega) \to \DD(\Omega)^*$, and we find that $\text{WF}(T_au) \subset \text{WF}(u)$. Thus the operator $T_a$ preseres the location of singularities of a distribution in both position and frequency. This is the first instance of the \emph{microlocal nature} of pseudodifferential operators; these operators roughly preserve the location of the mass and frequency support of a function, but with some additional `fuzz' that is usually neglible to the problem, but must be managed.

The symbol $a$ is uniquely determined from the operator $T_a$. To actually recover the symbol from an operator, we have several methods. Formally, we can calculate that
%
\[ a(x,\xi) = e^{-2 \pi i \xi \cdot x} T_a(e^{2 \pi i \xi \cdot y}). \]
%
The wavefront calculation above shows that the convolution kernel $k_a(x,z)$ of a pseudodifferential operator agrees with a smooth function away from the line $z = 0$. We will see very shortly that it decays rapidly away from this line, and therefore $k_a$ is tempered in the $z$-variable. The above formal equation then implies the less formal equation
%
\[ a(x,\xi) = \int k_a(x,z) e^{2 \pi i \xi \cdot z}\; dy. \]
%
Thus the symbol $a$ is obtained by taking the inverse Fourier transform of the convolution kernel $k_a$ in the $z$ variable.

Here is a quantitative estimate on the kernel of a pseudodifferential operator, which show another instance of it's pseudolocal nature, i.e. localization on the spatial side of things. In particular, the result implies that if $\Omega = \RR^d$, then $T_a$ extends to a continuous operator from $\SW(\RR^d)$ to itself. As mentioned above, $K_a \in \DD(\Omega \times \Omega)^*$ agrees with a $C^\infty$ function away from the diagonal $\Delta_\Omega$. Thus if $f \in \DD(\RR^d)$, and $x \not \in \text{supp}(f)$, then the multiplication formula for tempered distributions implies that
%
\[ T_af(x) = \int a(x,\xi) \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi = \int K(x,y) f(y)\; dy, \]
%
where, since the integral on the right hand side vanishes in a neighborhood of $x$, we can actually interpret the right hand integral as a Lebesgue integral, rather than a formal integral. Moreover, we have even better estimates for the behaviour of $K_a$ away from the origin, which reflects the pseudolocal behaviour of the operator. To discuss these estimates, we introduce the differential operators $\partial^i_z = \partial^i_x - \partial^i_y$, and the induced operators $\nabla^m_z$, which measures the derivatives measured in the direction normal to the diagonal in $\Omega \times \Omega$.

\begin{theorem}
    Let $a \in \loc{\mathcal{S}^t}(\Omega)$. Then for any pair of integers $n,m \geq 0$, and any $N \geq 0$ such that $t + d + m + N \geq 0$,
    %
    \[ |\nabla^n_x \nabla^m_z K_a(x,y)| \lesssim_{n,m,N} |x - y|^{-t-d-m-N}, \]
    %
    where the implicit constant is locally uniform in $x$. If $a \in \mathcal{S}^t(\Omega)$, then we can choose the implicit constant to be uniform in $x$.
\end{theorem}
\begin{proof}
    If $\text{supp}_\xi(a)$ is compact, then $a \in \loc{\mathcal{S}^{-\infty}}(\Omega)$, and by the compactness, we conclude that for any $N \geq 0$,
    %
    \[ |\nabla^n_x \nabla^m_z K_a(x,y)| = |\mathcal{F}_\xi\{ a \} (x,x-y)| \lesssim_N 1 / |x-y|^N, \]
    %
    where the uniform estimate happens because we $a$ is compactly supported in the $\xi$ variable, uniformly in $x$, and smooth, locally uniformly in $x$. Thus, without loss of generality, in the remainder of the proof we may assume $a(x,\xi) = 0$ for $|\xi| \leq 1$. We can then perform a Littlewood-Paley decomposition, i.e. writing
    %
    \[ a(x,\xi) = \sum_{i = 0}^\infty a_i(x,y,\xi), \]
    %
    where $a_i(x,\xi) = \rho(\xi / 2^i) a(x,\xi)$ is supported on $|\xi| \sim 2^n$. Let $K_i$ be the kernel of the pseudodifferential operator $a_i(x,D)$. Then
    %
    \[ K(x,z) = \sum_{i = 0}^\infty K_i(x,z), \]
    %
    where the convergence is distributional. We claim that for any $i$, and any $n,m,N \geq 0$,
    %
    \[ |\nabla^n_x \nabla^m_z K_i(x,y)| \lesssim_{n,m,N} |x-y|^{-N} 2^{i(t + d + m - N)}, \]
    %
    where the implicit constant is locally uniform in $x$. This follows from a simple integration by parts, applied to the integral
    %
    \[ K_i(x,y) = \int \rho(\xi / 2^i) a(x,\xi) e^{2 \pi i \xi \cdot (x-y)}\; d\xi. \]
    %
    These bounds, if $N$ is taken large enough, imply that the sum $K = \sum K_i$ converges uniformly on any set of the form
    %
    \[ \{ (x,y) \in \Omega \times \Omega: x \in K, |y-x| > \varepsilon \}, \]
    %
    where $K \subset \Omega$ is compact. Summing up these bounds for sufficiently large $N$ gives the required inequality for $|x-y| \geq 1$. For $0 < |x-y| \leq 1$, we break the sum into two parts, i.e. writing
    %
    \[ K(x,y) = \sum_{2^i \leq 1/|x-y|} K_i(x,y) + \sum_{2^i > 1/|x-y|} K_i(x,y). \]
    %
    For the first sum, we take $N = 0$, and for the second sum, we take $N > t + d + m$, which gives the required bounds.
\end{proof}

These singularity conditions characterize those kernels $K_a$ induced by pseudodifferential operators of some order $t < 0$. For $t \geq 0$, we must also assume an additional cancellation condition.

\begin{lemma}
    Let $K \in \DD(\Omega \times \Omega)^*$ be a Schwartz kernel with
    %
    \[ \singsupp(K) \subset \{ (x,x): x \in \Omega \}. \]
    %
    Suppose that for some $t$, and any non-negative integers $n,m$, and $N$, the kernel $K$ satisfies the growth condition
    %
    \[ |\nabla^n_x \nabla^m_z K(x,y)| \lesssim |x-y|^{-t-d-m-N} \]
    %
    locally uniformly in $x$, for all $n$, $m$, and $N$ for which $t + d + m + N \geq 0$. Then:
    %
    \begin{itemize}
        \item If $t < 0$, and if, for each $x \in \Omega$, and any $\phi \in \DD(\Omega)$,
        %
        \[ \int K(x,y) \phi(y)\; dy = \lim_{\varepsilon \to 0} \int_{|x-y| > \varepsilon} K(x,y) \phi(y)\; dy, \]
        %
        where the right hand side exists, and defines a distribution induced by a locally integrable function on $\Omega$ by virtue of the growth condition with $m$ and $N$ equal to zero, then $K$ is the Schwartz kernel of a pseudodifferential operator given by a local symbol of order $t$.

        \item If $t \geq 0$, and any $\phi \in \DD(\Omega)$, the kernel $K$ satisfies the \emph{cancellation conditions}
        %
        \[ \left| \int D^\alpha_x K(x,y) \phi((x-y)/R)\; dy \right| \lesssim_{\phi,\alpha} R^t, \]
        %
        where the implicit constant is independent of $R$, locally uniform in $x$, and a continuous seminorm on $\DD(\Omega)$ for each multi-index $\alpha$, then $K$ is the kernel of some pseudodifferential operator given by a local symbol of order $t$.
    \end{itemize}
    %
    If we replace the inequalities that locally uniformly depend on $x$ with inequalities that are uniform in $x$, then the symbols we find can also be chosen to be uniform.
\end{lemma}
\begin{proof}
    TODO: Brian's Book on Multiparameter Singular Integrals has a good discussion on this.
\begin{comment}
    For $t < 0$, we make the family of all such kernels above into a Fr\'{e}chet space $X_t$ by taking the optimal implicit constants in the growth condition inequalities above as seminorms. For $t \geq 0$, we make $X_t$ into a locally convex space by taking those implicit constants as seminorms, as well as taking, for each bounded set $\mathcal{B}$, the implicit constants in the cancellation condition as a seminorm. For $t < 0$, the growth conditions on elements of $X_t$ imply we have a continuous inclusion $X_t \to L^\infty_x(\RR^d) L^1_z(\RR^d) \to \mathcal{S}(\RR^d \times \RR^d)^*$. For $t \geq 0$,

    Let $k \in X_t$ be a kernel, and let $a(x,\xi)$ be the Fourier transform of the kernel in the $z$-variable. If we split up $k = k_0 + k_\infty$ and thus write $a = a_0 + a_\infty$, where $k_0$ is supported on $|z| \leq 2$, and $k_\infty$ on $|z| \geq 1$, then we see that, because $k_0$ is compactly supported, $a_0$ is smooth, and because $k_\infty$ is rapidly decaying away from the origin, $a_\infty$ is smooth. Thus $a \in C^\infty(\RR^d \times \RR^d)$ for any $k \in X_t$.

    Now set $k_R(x,z) = k(x,z/R)$ for each $R > 0$. The family
    %
    \[ \{ R^{-t-d} k_R : R > 0 \} \]
    %
    is then a bounded set in $X_t$, since, for instance,
    %
    \[ \sup \{ |z|^{t+d+n_2+N} |\nabla_x^{n_1} \nabla_z^{n_2} k_R(x,z)| \} = R^{t + d + N} \sup \{ |z|^{t + d + n_2 + N} |\nabla_x^{n_1} \nabla_z^{n_2} k(x,z)| \} \]


    Suppose we can prove that $|a(x,\xi)| \leq C(a)$ for all $x \in \RR^d$, and $1/2 \leq |\xi| \leq 2$, where $a \mapsto C(a)$ is a continuous seminorm on $X$. If we set
    %
    \[ a_R(x,\xi) = \int k_R(x,z) e^{-2 \pi i \xi \cdot z}, \]
    %
    then we will then have actually proved that $|a_R(x,\xi)| \leq C(a) R^{t+d}$ for all $R > 0$ and $1/2 \leq |\xi| \leq 2$. Since $a_R(x,\xi) = R^d a(x,R \xi)$, this implies that
    %
    \[ |a(x,\xi)| \lesssim_t C(a) |\xi|^t \]
    %
    for all $\xi$. Since $k \mapsto D^\alpha_x D^\beta_z k$ is a continuous operator on $X_t$ to $X_{t - |\beta|}$, this means we will have actually proved that
    %
    \[ |\nabla^{n_1}_x \nabla^{n_2}_z a(x,\xi)| \lesssim_t C_{n_1,n_2}(a) |\xi|^{t-n_2}. \]
    %
    Thus we have proved that $a \in \mathcal{S}^t(\RR^d \times \RR^d)$. For $t < 0$, to show that the bounds on $1/2 \leq |\xi| \leq 2$ hold, we just note that we can take $C(a) = \| k \|_{L^\infty_x L^1_z}$, which is a continuous seminorm on $X_t$ because
    %
    \[ \int |k(x,z)|\; dz \leq \sup_{x \in \RR^d, |z| \leq 1} |k(x,z)| |z|^{t + d} + \sup_{x \in \RR^d, |z| \geq 1} |k(x,z)| |z|^{d+1}. \]
    %

    TODO: Ask Andreas about this.
\end{comment}
\end{proof}

In addition to studying the behaviour of $\Psi$DOs away from the diagonal, which reflects the pseudolocal behaviour of the distribution, it is also of interest to determine the behaviour of the operator under highly oscillatory, but non-stationary, phenomena, which is related to it's microlocal nature. Consider a symbol $a(x,\xi)$, a smooth function $f(y)$, and a smooth phase $\phi(y)$ with $\nabla \phi(y)$ nonvanishing on $\text{supp}_x(a)$. Our goal is to try to determine the asymptotic behaviour of the function $T_a(f e^{2 \pi i \lambda \phi})$ as $\lambda \to \infty$. Since $T_a$ is pseudolocal, the value at a point $x$ should be determined to a large degree by the behaviour of $f e^{2 \pi i \lambda \phi}$ near $x$, which, roughly speaking, oscillates near the frequency $\lambda \nabla \phi(x)$. Thus we might expect that
%
\[ T_a \{ f e^{2 \pi i \lambda \phi} \} (x) \approx a(x,\lambda \nabla \phi(x)) f(x) e^{2 \pi i \lambda \phi(x)}. \]
%
This is correct up to first order in $\lambda$, and in fact, we can obtain a complete asymptotic development as $\lambda \to \infty$. For simplicity, we assume $\text{supp}_x(a)$ is compact.

\begin{theorem}
    Fix a symbol $a \in \mathcal{S}^t(\Omega \times \RR^d)$, compactly supported in the $x$-variable, a smooth function $f \in \DD(\Omega)$, and a smooth, real-valued function $\phi \in C^\infty(\Omega)$ with $\nabla \phi$ nonvanishing on $\text{supp}_x(a)$. Let
    %
    \[ r_x(y) = \nabla \phi(x) \cdot (x - y) - (\phi(x) - \phi(y)). \]
    Then for any $N > 0$ and $\lambda > 0$, we can write $e^{-2 \pi i \lambda \phi(x)} T_a \{ f e^{2 \pi i \lambda \phi} \}(x)$ as
    %
    \begin{align*}
        \sum_{|\beta| < N} \frac{1}{\beta! \cdot (2 \pi i)^{\beta}} \cdot \partial_\xi^\beta a(x,\lambda \nabla \phi(x)) \left. \partial^\beta_y \{ e^{2 \pi i \lambda r_x} f \} \right|_{y = x} + R_N(x,\lambda),
    \end{align*}
    %
    where $\lambda^{t - \lceil N/2 \rceil} R_N \in L^\infty(\RR^d \times (0,\infty))$. In particular, for $N = 3$, we find that $e^{-2 \pi i \lambda \phi(x)} T_a \{ f e^{2 \pi i \lambda \phi} \}(x)$ is equal to
    %
    \begin{align*}
        & a(x, \lambda \nabla \phi(x)) f(x)\\
            &\quad\quad\quad\quad + \frac{1}{2\pi i} \sum_{k = 1}^d (\partial^k_\xi a)(x,\lambda \nabla \phi(x)) \cdot (\partial^k_x f)(x)\\
            &\quad\quad\quad\quad - \frac{i \lambda}{4 \pi} \sum_{|\beta| = 2} (\partial^\beta_\xi a)(x,\lambda \nabla \phi(x)) (\partial^\beta_x \phi)(x) f(x)\\
            &\quad\quad\quad\quad\quad\quad\quad + O(\lambda^{t - 2}).
    \end{align*}
    %
    If $\phi(x) = \xi \cdot x$ for some $\xi$, then we find
    %
    \[ T_a \{ f e^{2 \pi i \lambda \phi} \}(x) \sim \sum_{\beta} \frac{1}{\beta! (2 \pi i )^\beta} \partial_\xi^\beta a(x,\lambda \xi) \cdot \partial^\beta_x f(x). \]
\end{theorem}
\begin{proof}
    We write
    %  xi [x - y] + lambda [phi(y) - phi(x)]
    %  xi [x - y] + lambda [nabla phi(x) (y - x) + r_x(y)]
    % lambda [ (xi - nabla phi(x)) (x - y) + r_x(y)]
    \[ e^{-2 \pi i \lambda \phi(x)} T_a \{ f e^{2 \pi i \lambda \phi} \}(x) = \lambda^d \int a(x, \lambda \xi) f(y) e^{2 \pi i \lambda [ (\xi - \nabla \phi(x)) \cdot (x - y) + r_x(y) ]}\; dy\; d\xi. \]
    %
    This integral is oscillatory, with phase
    %
    \[ \Phi_x(\xi,y) = (\xi - \nabla \phi(x)) \cdot (x - y) + r_x(y). \]
    %
    Now $\nabla_\xi \Phi_x(\xi,y) = 0$ precisely when $y = x$, and $\nabla_y \Phi_x(\xi,x) = 0$ precisely when $\xi = \nabla \phi(x)$. If we consider a smooth cutoff $\psi \in C_c^\infty(\RR^d_\xi)$ supported on
    %
    \[ (1/2) \cdot \inf_{x \in \text{supp}_x(a)} |\nabla \phi(x)| \leq |\xi| \leq 2 \cdot \sup_{x \in \text{supp}_x(a)} |\nabla \phi(x)| \]
    %
    then we can write $e^{-2 \pi i \lambda \phi(x)} T_a \{ f e^{2 \pi i \lambda \phi} \}(x) = I_1 + I_2$, where $I_1$ is obtained by substituting $\psi$ into the integrand, and $I_2$ is obtained by substituting $1 - \psi$ into the integrand. Nonstationary phase tells us that
    %
    \[ |I_2| \lesssim_N \lambda^{-N} \]
    %
    for all $N > 0$, where the implicit constant is independent of $\lambda$. Thus it suffices to concentrate on $I_1$. In the sequel, we will therefore assume without loss of generality that $a(x, \lambda \xi) = a(x, \lambda \xi) \psi(\xi)$, i.e. $a(x, \lambda \xi)$ is supported near $|\xi| \sim 1$. A change of variables $\xi \mapsto \xi + \nabla \phi(x)$ allows us to rewrite $I_1$ as
    %
    \[ \lambda^d \int e^{2 \pi i \lambda ( \xi \cdot (x - y) + r_x(y) )} a(x, \lambda [\nabla \phi(x) + \xi]) f(y)\; d\xi\; dy. \]
    %
    Using Taylor's formula, we write
    %
    \[ a(x, \lambda \nabla \phi(x) + \lambda \xi) = \sum_{|\beta| < N} \frac{\lambda^\beta}{\beta !} \partial_\xi^\beta a(x, \lambda \nabla \phi(x)) \xi^\beta + R_{N,\lambda}(x,\xi), \]
    %
    where
    % f(xi) = a(x, lambda nabla phi(x) + lambda xi)
    \[ R_{N,\lambda}(x,\xi) = \sum_{|\beta| = N} \xi^\beta \frac{N}{\beta!} \int_0^1 (1 - t)^{N-1} \lambda^N \partial^\beta_\xi a(x, \lambda \nabla \phi(x) + t \lambda \xi)\; dt. \]
    %
    We only care about this formula when $|\xi| \sim 1$, and differentiating this formula gives that, for such $\xi$,
    %
    \[ |\partial_\xi^\alpha R_{N,\lambda}(x,\xi)| \lesssim_\alpha \lambda^{t - |\alpha|}, \]
    %
    and $\partial_\xi^\alpha R_{N,\lambda}(x,0) = 0$ for all $|\alpha| < N$. Stationary phase thus implies that
    %
    \[ \left| \lambda^d \int \int e^{2 \pi i \lambda ((x - y) \cdot \xi + r_x(y))} R_{N,\lambda}(x,\xi) f(y)\; d\xi\; dy \right| \lesssim \lambda^{t - \lceil N/2 \rceil}. \]
    %
    Finally, we note that via an integration by parts,
    %
    \begin{align*}
        \int & e^{2 \pi i \lambda (\xi \cdot (x - y) + r_x(y))} \xi^\beta f(y)\; d\xi\; dy\\
        &= \lambda^{-(d + \beta)} (2 \pi i)^{-\beta} \left. \partial_y^\beta \{ e^{2 \pi i \lambda r_x(y)} f(y) \} \right|_{y = x}
    \end{align*}
    % 
    and substituting them into the formula completes the proof.
\end{proof}

\begin{remark}
    One application of this result will occur when we analyze how pseudodifferential operators behave under a change of variables. If $T$ is a pseudodifferential operator on $\Omega \subset \RR^d$ defined by a symbol $a$ with $\text{supp}_x(a)$ compact, and $\kappa: \Psi \to \Omega$ is a diffeomorphism, then we can consider the operator $S: \DD(\Psi) \to \DD(\Psi)^*$ given by `changing the coordinates of $T$', i.e.
    %
    \[ S\phi(x) = T(\phi \circ \kappa^{-1})(\kappa(x)). \]
    %
    We can thus write, after a change of coordinates, with $\tilde{a}(x,\xi) = a(\kappa(x),\xi)$,
    %
    \begin{align*}
        S\phi(x) &= \int \tilde{a}(x,\xi) e^{2 \pi i \xi \cdot (\kappa(x) - \kappa(y))} |\det(\kappa(y))| \phi(y)\; dy\; d\xi.
    \end{align*}
    %
    This leads to an analysis of quantities similar to that obtained in the above proof, which will lead us to conclude that $S$ itself is a pseudodifferential operator. Note, however, that purely from the spectral anlaysis of singularities, we see immediately from the integral kernel that $S$ is a microlocal operator, i.e. it preserves the wavefront set of distributional inputs.

    Another application occurs much later on, when we discuss the composition of a pseudodifferential operator with a \emph{Fourier integral operator}.
\end{remark}

As the order of the symbol $a$ decreases, we expect the behaviour of the corresponding pseudodifferential operator to become more and more regular. In particular, for $t < - d$, the symbol is actually \emph{integrable} in $\xi$. A $\Psi$DO of order $-\infty$ has a kernel $K$ lying in $C^\infty(\Omega \times \Omega)$, and satisfying estimates of the form
%
\[ | \nabla^n_x \nabla^m_z K(x,y)| \lesssim_{n,m,N} \langle x-y \rangle^{-N} \]
%
for any $N \geq 0$. Thus a $\Psi$DO of order $-\infty$ is smoothing. Conversely, if $K \in C^\infty(\Omega \times \Omega)$ satisfies estimates of the form above, then it is the $\Psi$DO corresponding to the symbol
%
\[ a(x,\xi) = \int K(x,y) e^{2 \pi i \xi \cdot (x-y)}\; dy, \]
%
which is a symbol of order $-\infty$. In particular, all properly supported smoothing operators are $\Psi$DOs of order $-\infty$.

Much of the theory of pseudodifferential operators to come is most elegantly explained \emph{modulo smoothing operators}. Working modulo smoothing operators is usually fine in harmonic analysis provided that we are trying to establish localized estimates for certain quantities, since smoothing operators, once localized, satisfy all the inequalities we might be interested in. In particular, working modulo smoothing operators often makes the theory more flexible. For instance, one interesting operator to study is the square root of the Laplacian, which is the pseudodifferential operator with symbol $a(x,\xi) = 2 \pi |\xi|$. The fact that $a$ is not smooth near the origin means that $a(x,D)$ does not quite fit the theory of pseudodifferential operators given above. Nonetheless, for any bump function $\rho \in \DD(\RR^d_\xi)$ equal to one in a neighborhood of the origin, the symbol $\tilde{a}(x,\xi) = 2 \pi |\xi| (1 - \rho(\xi))$ lies in $\mathcal{S}^1(\RR^d \times \RR^d)$. Since $\text{supp}_\xi(a - \tilde{a})$ is compact, it follows that $a(x,D) - \tilde{a}(x,D)$ is a smoothing operator. Thus, modulo smoothing operators, it makes sense to identify $a$ with a symbol of order one. Thus we define the symbol class $\dot{\mathcal{S}}^t(\Omega \times \RR^d)$ to be the space of all distributional symbols which differ from an element of $\loc{S}^t(\Omega \times \RR^d)$ by a distributional symbol which induces a smoothing operator. It then follows that $a \in \dot{\mathcal{S}}^1$, so we can study the theory of the square root of the Laplacian as a pseudodifferential operator, modulo a smoothing operator.

One can already see from this example, that this theory works well with pseudodifferential operators defined in terms of homogeneous functions, of which the square root of the Laplacian is a special example, since homogeneous functions often fail to be smooth at the origin. Another useful idea when working with symbols modulo smoothing operators is that we only need to specify pseudodifferential operators by symbols $a(x,\xi)$ defined for suitably large $\xi$, since any two extensions of these functions to symbols defined near the origin will differ by a symbol compactly supported in the $\xi$ variable, and thus these operators will differ by a smoothing operator.

Another virtue of working modulo smoothing operators is that asymptotics can be used to specify symbols. In other words, for any family of symbols $a_k \in \loc{\mathcal{S}^{t_k}}(\Omega \times \RR^d)$, provided that $t_k \to -\infty$ and with $t = \max(t_k)$, we can define a unique symbol $a \in \dot{\mathcal{S}}^t(\Omega \times \RR^d)$ by an asymptotic formula of the form
%
\[ a(x,\xi) \sim \sum_{k = 0}^\infty a_k(x,\xi), \]
%
since the difference of any two symbols satisfying this asymptotic formula lies in $\loc{\mathcal{S}^{-\infty}}(\Omega \times \RR^d)$, and thus induces a smoothing operator.

\section{Compound Operators and Quantization}

It is natural to wish to study a more general family of operators with a \emph{compound symbol} of the form $a(x,y,\xi)$, i.e. an operator of the form
%
\[ T_a f(x) = \int a(x,y,\xi) e^{2 \pi i \xi \cdot (x - y)} f(y)\; d\xi\; dy. \]
%
However, any such operator is already a pseudodifferential operator, and we can calculate an explicit asymptotic expansion for the symbol of this operator.

\begin{lemma}
    For any $a \in \loc{\mathcal{S}^t}(\Omega_x \times \Omega_y \times \RR^d)$, the operator $T_a$ lies in $\loc{\Psi^t}(\Omega)$, and the symbol of $T_a$ has the asymptotic expansion
    %
    \[ \sum_\beta \frac{1}{\beta!} \frac{1}{(2 \pi i)^{|\beta|}} \partial^\beta_\xi \partial^\beta_y a(x,x,\xi). \]
\end{lemma}
\begin{proof}
    We begin by noting that, by very similar techniques to those above, the kernel $K$ of an operator defined by a compound symbol of order $-\infty$ is smooth, and satisfies estimates of the form
    %
    \[ |\nabla^n_x \nabla^m_z K(x,y)| \lesssim_{n,m,N} \langle x - y \rangle^{-N} \]
    %
    locally uniformly in $x$ and $y$, which means that $K$ is the kernel of an operator in $\loc{\Psi^{-\infty}}(\Omega)$. Thus we obtain the result for $t = -\infty$. In general, we perform a Taylor expansion, writing
    %
    \[ a(x,y,\xi) = \sum_{|\beta| \leq N} \frac{1}{\beta !} \partial^\beta_y a(x,x,\xi) \cdot (y - x)^\beta + R_N(x,y,\xi), \]
    %
    where $\partial^\beta_y R_N(x,x,\xi) = 0$ for all $|\beta| \leq N$. We can find $C^\infty$ functions $b_\beta(x,y,\xi)$, for $|\beta| = N+1$, such that
    %
    \[ R_N(x,y,\xi) = \sum_{|\beta| = N+1} (2\pi i)^{N+1} (y - x)^\beta b_\beta(x,y,\xi). \]
    %
    Now integration by parts shows that
    %
    \begin{align*}
        \int & R_N(x,y,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi\\
        &= (-1)^{N+1} \sum_{|\alpha| = N+1} \int (D_\xi^\alpha b_\alpha)(x,y,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi.
    \end{align*}
    %
    The functions $b_\beta$ are symbols of order $t$, so $D_\xi^\alpha b_\beta$ are symbols of order $t - (N+1)$. Thus the operators specified by the compound symbol $R_N$ have order at most $t - (N+1)$. On the other hand, another integration by parts again shows that
    %
    \begin{align*}
        \int &\partial^\beta_y a(x,x,\xi) \cdot (y - x)^\beta \cdot e^{2 \pi i \xi \cdot (x - y)}\; d\xi\\
        &= \frac{1}{(2 \pi i)^{|\beta|}} \int \partial^\beta_\xi \partial^\beta_y a(x,x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi.
    \end{align*}
    %
    Thus the operator corresponding with symbol $\partial^\beta_y a(x,x,\xi) \cdot (y - x)^\beta$ also corresponds to the symbol $1 / (2 \pi i)^{|\beta|} \cdot \partial^\beta_\xi \partial^\beta_y a(x,x,\xi)$. Thus if we consider a symbol $\tilde{a}(x,\xi)$ satisfying the asymptotic equation defined in the theorem, then we see that $\tilde{a}(x,D)$ differs from $T_a$ by a compound symbol of order $-\infty$, which, as previously discussed, is an element of $\loc{\Psi^{-\infty}}(\Omega)$.
\end{proof}

\begin{remark}
    If $b(x,\xi) = a(x,x,\xi)$, then the formula above can be written more formally as $a(x,y,\xi) \sim e^{2 \pi i D_x \cdot D_\xi} b$. This makes sense, since if $K$ is the kernel of $T_a$, and $T_a$ corresponds to a pseudodifferential operator, then it's symbol would correspond precisely to
    %
    \begin{align*}
        a(x,\xi) &= \int K(x, x - y) e^{-2 \pi i \xi \cdot y}\; dy\\
        &= \int \int a(x,x-y,\xi-\eta) e^{- 2 \pi i \eta \cdot y}\; d\eta\; dy.
    \end{align*}
    %
    If we define $a_x(y,\xi) = a(x,y,\xi)$, and $c(x,\xi) = e^{-2 \pi i \xi \cdot x}$, then $a(x,\xi) = (a_x * c)(x,\xi)$. But $c$ is a Gaussian, and thus if $(\xi', x')$ are the dual variables to $(x,\xi)$, then $\widehat{c}(\xi', x') = e^{2 \pi i \xi' \cdot x'}$. Thus
    %
    \[ a(x,\xi) = e^{2 \pi i D_x \cdot D_\xi} a_x(x,\xi), \]
    %
    where $e^{2 \pi i D_x \cdot D_\xi}$ is the Fourier multiplier operator with symbol $e^{2 \pi i \xi' \cdot x'}$. Taking the power series expansion of the exponential gives the expansion above.
\end{remark}

For any pseudodifferential operator $T$ with kernel $K_a(x,y)$, we can consider it's formal adjoint $T^*$ with kernel $K(x,y) = \overline{K_a(y,x)}$. We now use the calculation above to show the adjoint of a pseudodifferential operator $a(x,\xi)$ is a pseudodifferential operator; it is simple to calculate that the adjoint of any $\Psi DO$ $a(x,D)$ is a pseudodifferential operator with compound symbol $(x,y,\xi) \mapsto \overline{a(y,\xi)}$. Nonetheless, the above theorem implies that the adjoint can be given by a symbol $a^*(x,\xi)$ where $a^*(x,\xi) = e^{2 \pi i D_x \cdot D_\xi} \overline{a}(x,\xi)$, which we can write explicitly as an asymptotic expansion as
%
\[ a^*(x,\xi) \sim \sum_\beta \frac{1}{\beta!} \frac{1}{(2 \pi i)^{|\beta|}} \overline{\partial^\beta_\xi \partial^\beta_x a(x,\xi)}. \]
%
In particular, if $a$ is a symbol of order $t$, then $a^*(x,\xi) - \overline{a(x,\xi)}$ is a symbol of order $t - 1$, which we might write as saying that $a^* \approx \overline{a}$, up to lower order terms. In particular, if $a$ is a symbol such that $a(x,D)$ is a \emph{symmetric} pseudodifferential operator, i.e. such that for all $f,g \in \DD(\Omega)$,
%
\[ \langle a(x,D) f, g \rangle = \langle f, a(x,D) g \rangle, \]
%
then $a \approx \Ree(a)$, in the sense that $a - \Ree(a)$ is a symbol of order $t - 1$.

The choice of $(x,\xi)$ variables for pseudodifferential operators is common, but certainly not standard. The association of the pseudodifferential operator $a(x,D)$ with any symbol $a(x,\xi)$ is called the \emph{Kohn-Nirenberg quantization}. We could also use the \emph{adjoint Kohn-Nirenberg quantization} to associate an operator with every symbol $a$ in two variables, using the $(y,\xi)$ variables instead of the $(x,\xi)$ variables. We find, using the expansion above, that modulo smoothing operators, any symbol in the $(y,\xi)$ variables can be written in the $(x,\xi)$ variables, and moreover,
%
\[ a(y,\xi) \sim \sum_\beta \frac{1}{\beta!} \frac{1}{(2 \pi i)^{|\beta|}} \partial^\beta_\xi \partial^\beta_x a(x,\xi). \]
%
In particular, the symbol $(x,y,\xi) \mapsto a(y,\xi) - a(x,\xi)$ is a pseudodifferential operator of order $t - 1$. Thus the two quantizations describe exactly the same family of operators, and the association of an operator with a symbol only matters up to lower order terms.

The family of operators one can describe via the adjoint Kohn-Nireberg quantization is the same as the Kohn-Niernberg quantization. Thus, in the sequel, there is no harm in sticking with the Kohn-Nirenberg quantization. On the other hand, the symbols representing various operators change. For instance, we previously found that under the Kohn-Nirenberg quantization, the symbol $a(x,\xi) = \sum c_\alpha(x) \xi^\alpha$ corresponded to the differential operator $Lf = \sum c_\alpha D^\alpha f$. Under the adjoint Kohn-Nirenberg quantization, the symbol $a(y,\xi) = \sum c_\alpha(y) \xi^\alpha$ corresponds to the differential operator $Lf = \sum D^\alpha( c_\alpha f)$. If $t$ is the order of these operators, then the difference of these operators is a differential operator of order $t-1$, which reflects the equivalence described above.

We thus see that the differences in quantization arise because differential operators and multiplier operators \emph{do not commute}. The operators above differ in the order in which they apply spatial and frequency modulation. It is sometimes useful to deal with a quantization that does both in a `symmetric' manner. To do this, we introduce the \emph{Weyl quantization}, which associates with each symbol $a(x,\xi)$ gives the Pseudodifferential operator $T$ with compound symbol $(x,y,\xi) \mapsto a((x + y)/2, \xi)$. This approach has the advantage that $T$ will be self-adjoint if and only if $a$ is real-valued, rather than just this only being true up to lower order terms. The Weyl quantization is the approach that works best in a generalization of a functional calculus for any finite family of noncommuting operators (there are notes by Tao which describes this process in detail, but it is beyond the scope of these notes).

\begin{comment}
\begin{remark}
    Here, we have worked with symbols satisfying uniform estimates in $x$. But often one can only work with symbols which \emph{locally} satisfy these estimates in $x$, i.e. working in the symbol classes $\loc{\mathcal{S}^t}(\RR^d \times \RR^d)$. The kernels of operators formed from these symbols satisfy bounds of the form
    %
    \[ | \nabla^{n_1}_x \nabla^{n_2}_z K(x,y)| \lesssim_{n_1,n_2,N} \frac{1}{|x-y|^{t + d + n_2 + N}}, \]
    %
    where the implicit constant is \emph{locally uniform} in $x$, and uniform in $y$. On a related note, such operators can be applied to any compactly supported distribution, and satisfy the microlocalization statement $\text{WF}(Tu) \subset \text{WF}(u)$. On the other hand, unless one has a bound such as
    %
    \[ |\nabla_x^{n_1} \nabla_y^{n_2} \nabla_\xi^m a(x,\xi)| \lesssim_{n,m} (\langle x \rangle^{k_{1n}} + \langle y \rangle^{k_{2n}}) \cdot \langle \xi \rangle^{k_{nm}}, \]
    %
    for all $n$ and $m$, it is not necessarily possible to apply the operator to Schwartz functions, and tempered distributions. One can consider asymptotics, as long as we work modulo a weaker family of smoothing operators, i.e. those whose kernels lie in $\EC(\RR^d \times \RR^d)$.
\end{remark}
\end{comment}

\section{Compositions of $\Psi$DOs}

Let $a(x,D)$ and $b(x,D)$ be pseudodifferential operators defined by local symbols of order $t$ and $s$. It is not always possible to define the composition $a(x,D) \circ b(x,D)$. This is because the image of an element of $\DD(\Omega)$ under the operator $b(x,D)$ in general lies in $\EC(\Omega)$, and one cannot necessarily apply $a(x,D)$ to elements of $\EC(\Omega)$. If we were working on $\RR^d$ and working with uniform symbols this wouldn't be a problem, since if $a \in \mathcal{S}^t(\RR^d \times \RR^d)$ and $b \in \mathcal{S}^t(\RR^d \times \RR^d)$, then $a(x,D)$ and $b(x,D)$ are both continuous operators from $\SW(\RR^d)$ to itself, and so the composition is well defined. In our approach, we must make a slightly technical assumption: we assume that either $a(x,D)$ or $b(x,D)$ maps $\DD(\RR^d)$ to itself, which is true in particular if either $a(x,D)$ or $b(x,D)$ is a \emph{proper} pseudodifferential operator.

Regardless of which method we use, the composition of a $\Psi$DO of order $t$ and a $\Psi$DO of order $s$ will then be a $\Psi$DO of order $t + s$, and we have an asymptotic formula for the symbol of such an expansion, reflecting the lack of commutivity between the spatial and frequential variables. In particular, the symbol of the composition is, to first order, the product of the symbols of the two operators.

\begin{theorem}
    Let $a(x,\xi)$ and $b(x,\xi)$ be symbols of order $t$ and $s$, corresponding to operators $T_a$ and $T_b$. Then $T_a \circ T_b$ is a $\Psi$DO of order $t + s$, and has symbol
    %
    \[ (a \circ b)(x, \xi) = \left. e^{2 \pi i D_\xi \cdot D_y} \{ a(x,\xi) b(y,\eta) \} \right|_{y = x, \eta = \xi}. \]
    %
    In particular, we have the asymptotic expansion
    %
    \[ (a \circ b)(x,\xi) \sim \sum_\alpha \frac{1}{\alpha!} \frac{1}{(2 \pi i)^{|\alpha|}} \partial^\alpha_\xi a(x,\xi) \cdot \partial^\alpha_x b(x,\xi). \]
    %
    Thus $(a \circ b)(x,\xi) - a(x,\xi) b(x,\xi)$ is a symbol of order $t + s - 1$.
\end{theorem}

\begin{remark}
    If we consider the two form
    %
    \[ \omega = dx \wedge d \xi - d\xi \wedge dx \]
    %
    on $T^* \RR^n$, then we can define the \emph{Poisson bracket} of two functions on $T^* \RR^n$ by setting
    %
    \[ \{ a, b \} = \omega ( \nabla a, \nabla b ) = \sum_{i = 1}^d \frac{\partial a}{\partial \xi^i} \frac{\partial b}{\partial x^i} - \frac{\partial a}{\partial x^i} \frac{\partial b}{\partial \xi^i}. \]
    %
    For any two symbols $a$ and $b$, the result above implies that the commutator $[a(x,D), b(x,D)]$ of the two operators is a pseudodifferential operator of order $t + s$ with some symbol $[a,b]$, such that the symbol $[a,b] - (4 \pi i)^{-1} \{ a, b \}$ has order $t + s - 2$.
\end{remark}

\begin{proof}
    We can write
    %
    \begin{align*}
        (T_a \circ T_b) f(x) &= \int a(x,\eta) e^{2 \pi i \eta \cdot (x - z)} T_b f(z)\; dz\; d\eta\\
        &= \int a(x,\eta) b(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)} e^{2 \pi i \xi \cdot (x - y)} f(y)\; dy\; dz\; d\xi\; d\eta.
    \end{align*}
    %
    Thus we see that we can view the composition as a $\Psi$DO with kernel
    %
    \[ c(x,\xi) = \int \int a(x,\eta) b(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz. \]
    %
    This is an oscillatory integral, with stationary point when $z = x$ and $\eta = \xi$. Thus we expand power series near this point, i.e. writing
    %
    \[ a(x,\eta) = \sum_\alpha \frac{1}{\alpha!} \partial^\alpha_\xi a(x,\xi) (\eta - \xi)^\alpha \]
    %
    and
    %
    \[ b(z,\xi) = \sum_\beta \frac{1}{\beta!} \partial^\beta_x b(x,\xi) (z - x)^\beta. \]
    %
    Using the Fourier inversion formula, we calculate that
    %
    \begin{align*}
        \int &(\eta - \xi)^\alpha (z - x)^\beta e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz\\
        &= \int \tau^\alpha y^\beta e^{-2 \pi i \tau \cdot y}\; d\tau\; dy\\
        &= \begin{cases} 0 & \alpha \neq \beta, \\ \alpha! / (2 \pi i)^\alpha & \alpha = \beta. \end{cases}
    \end{align*}
    %
    Working like in our analysis of compound symbols, it suffices to show that if $g_1$ and $g_2$ are symbols of order $t$ and $s$, then
    %
    \[ f(x,\xi) = \int \int (\eta - \xi)^\alpha (z - x)^\beta g_1(x,\eta) g_2(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz \]
    %
    is a symbol of order $t + s - M - 1$. Applying sufficiently many integration by parts, it actually suffices to show integrals of the form
    %
    \[ f(x,\xi) = \int \int g_1(x,\eta) g_2(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz, \]
    %
    have order $t + s$, where $g_1$ has order $t$, and $g_2$ has order $s$. We write $\lambda = |\xi|$, and $\xi = \lambda \tilde{\xi}$, and write
    %
    \[ f(x,\xi) = \lambda^d \int \int g_1(x, \lambda \eta) g_2(z, \xi) e^{2 \pi i \lambda (\eta - \tilde{\xi}) \cdot (x - z)}\; d\eta \]
    %
    We can decompose the domain dyadically. For $|\eta| \leq 1/2$ and $|x - z| \leq 1$, an integration by parts in $z$ gives rapid decay in $t$. Similarily, we can dyadically sum over the regions where $|\eta| \leq 1/2$ and $|x - z| \sim 2^k$ by first integrating in $\eta$ using integration by parts, then integration in parts in $z$. This also gives rapid decay in $t$. Similar arguments give rapid decay in $\xi$ for $|\eta| \sim 2^l$, in fact giving estimates which are summable in $l$. Thus we are left with giving decay for an integral of the form
    %
    \[ t^d \int \int g_1(x, t \eta) g_2(z,\xi) \rho(|x - z|) \rho(|\eta| - 1) e^{2 \pi i t (\eta - \tilde{\xi}) \cdot (x - z)}\; d\eta\; dz. \]
    %
    This domain has a stationary point when $\eta = \xi$ and $z = x$. However, the stationary point is nondegenerate. Thus the integral is $O(\lambda^{t + s} \lambda^{-d})$ and so $|f(x,\xi)| \lesssim \langle \xi \rangle^{t + s}$. Replacing $g_1$ and $g_2$ with appropriate derivatives gives a full argument that $f$ is a symbol of order $t + s$.
\end{proof}

\begin{remark}
    This result shows that $\Phi = \bigcup_t \Phi^t$ and the subfamily $\Phi_{\text{loc},\text{prop}}$ of proper pseudodifferential operators in $\Phi_{\text{loc}} = \bigcup_t \Phi^t_{\text{loc}}$ form graded algebras. We note for any pseudodifferential operator $T \in \Phi^t_{\text{loc}}$, there is a properly supported pseudodifferential operator $\tilde{T} \in \Phi_{\text{loc},\text{prop}}^t$ such that $T - \tilde{T}$ is a smoothing operator. If we define $\dot{\Phi}^t$ to be the space of all operators which differ from an element of $\loc{\Phi^t}$ by a pseudodifferential smoothing operator, then $\dot{\Phi} = \bigcup_t \dot{\Phi}^t$ is a graded algebra under addition and composition, which induces, by bijection, an alternate graded algebra structure on $\dot{\mathcal{S}}$, agreeing up to first order with the standard algebra structure on this space given by multiplication.
\end{remark}

\section{Parametrices for Elliptic Operators}

A \emph{pseudodifferential parametrix} for a pseudodifferential operator $T$ is a pseudodifferential operator $S$ such that $S \circ T$ and $T \circ S$ are the identity operator, modulo smoothing operators. One useful result of our calculations is that we can easily construct \emph{parametrices} for suitable pseudodifferential operators. A symbol $a \in \dot{\mathcal{S}}^t(\Omega \times \RR^d)$ is called \emph{elliptic} if, locally in the $x$ variable, we can find $R > 0$ such that for $|\xi| \geq R$,
%
\[ |a(x,\xi)| \sim \langle \xi \rangle^t, \]
%
where the implicit constant is also locally uniform. In this case, we can interpret $b_0(x,\xi) = 1 / a(x,\xi)$ as an element of $\dot{\mathcal{S}}^{-t}$, since the reciprocal is well defined for large $\xi$, and satisfies the required symbol estimates. By the composition calculus, $1 - (a \circ b_0)(x,\xi)$ is a symbol $r_1 \in \dot{\mathcal{S}}^{-1}$. For $i \geq 1$, given $r_i \in \dot{\mathcal{S}}^{-i}$, if we define $b_i = r_i / a$ in $\dot{\mathcal{S}}^{t-i}$, then the composition calculus tells us that $r_{i+1} = 1 - (a \circ (b_0 + \dots + b_i))$ lies in $\dot{\mathcal{S}}^{-i-1}$, and we can continue the iteration. If we consider $b \in \dot{\mathcal{S}}^{-t}$ defined by the asymptotic development
%
\[ b \sim \sum_{i = 0}^\infty b_i \]
%
then $b(x,D)$ is a right pseudodifferential parametrix for $a(x,D)$. Similarily, we can construct $c \in \dot{\mathcal{S}}^{-t}$ such that $c(x,D)$ is a left pseudodifferential parametrix for $a(x,D)$. But this means that, in $\dot{\mathcal{S}}^{-t}$,
%
\[ b = b \circ (a \circ c) = (b \circ a) \circ c = c \]
%
so $b = c$, modulo smoothing operators. Thus a left parameterix for an elliptic operator is automatically a right parameterix, and we have constructed such a parametrix.

\begin{remark}
    The condition that $|a(x,\xi)| \sim \langle \xi \rangle^t$ for large $\xi$ is necessary in order to construct a parametrix of order $-t$. Without loss of generality, it suffices to analyze the case $t = 0$, since in general we can replace $a(x,\xi)$ with $a(x,\xi) \langle \xi \rangle^{-t}$ and $b(x,\xi)$ with $b(x,\xi) \langle \xi \rangle^t$. If there is $b \in \dot{\mathcal{S}}^0$ such that $b(x,D)$ is a parametrix for $a(x,D)$, then the composition calculus tells us that $1 - a(x,\xi) b(x,\xi)$ is a local symbol of order $-1$. Thus we find that $|a(x,\xi) b(x,\xi) - 1| \lesssim \langle \xi \rangle^{-1}$ locally uniformly in $x$, which implies that, locally in $x$, there exists $R > 0$ such that for $|\xi| \geq R$,
    %
    \[ |a(x,\xi) b(x,\xi) - 1| \leq 1/2. \]
    %
    Thus
    %
    \[ |a(x,\xi)| \geq \frac{0.5}{|b(x,\xi)|}, \]
    %
    and combined with the fact that $|b(x,\xi)| \lesssim 1$, we conclude that $|a(x,\xi)| \gtrsim 1$.
\end{remark}

It follows from our theory that if $T$ is an elliptic pseudodifferential operator on $\Omega$, then for any $u \in \EC(\Omega)^*$, $\singsupp(Tu) = \singsupp(u)$. This is very similar to hypoellipticity, except that for differential operators, this condition can be applied to arbitrary distributions, not just the compactly supported distributions. More generally, we actually find that $\text{WF}(Tu) = \text{WF}(u)$ for $u \in \EC(\Omega)^*$ in virtue of the microlocal nature of pseudodifferential operators.

We can use similar asymptotic tools to construct formal fractional powers of an elliptic pseudodifferential operator. For simplicity, we assume we are constructing the fractional powers of an elliptic symbol $a(x,\xi)$ such that $a(x,\xi)$ is never a negative, real number, so that $a(x,\xi)^{p/q}$ is well defined as a principal branch of $z^{p/q}$. Of course, one can consider a similar development for any other choice of branch, assuming an appropriate constraint on the range of $a$.

\begin{theorem}
    Let $a \in \dot{S}^t$ be an elliptic symbol such that $a(x,\xi)$ is negative a negative, real number, and suppose that
    %
    \[ | \text{arg}(a(x,\xi)) - \pi | \gtrsim 1 \]
    %
    for $\xi \gtrsim 1$, where the implicit constants are locally uniform in $x$. Then for any pair of positive integers $p$ and $q$, there exists a unique $b \in \dot{S}^{t(p/q)}$ with principal symbol $a(x,\xi)^{p/q}$, such that $a(x,D)^p = b(x,D)^q$, modulo smoothing operators.
\end{theorem}
\begin{proof}
    Let $b_0(x,\xi) = a(x,\xi)^{p/q}$. Then $b_0$ is a symbol of order $t(p/q)$, and the composition calculus implies that $a(x,D)^p - b_0(x,D)^q$ is a pseudodifferential operator of order $tp - 1$, say, with symbol $r_1$. Given that we have chosen $b_0,\dots,b_N$ such that $a(x,D)^p - (b_0 + \dots + b_N)(x,D)^q$ is a pseudodifferential operator of order $tp - (N+1)$, say, with symbol $r_N$. The composition calculus means if we choose $b_{N+1} \in \dot{\mathcal{S}}^{t(p/q) - (N+1)}$ by setting
    %
    \[ b_{N+1} = q^{-1} r_N / (b_0 + \dots + b_N)^{q-1}. \]
    %
    Here we rely on the fact that $a$ is elliptic, so that the denominator is non-vanishing for large $\xi$. Then
    %
    \[ a(x,D)^p - (b_0 + \dots + b_N + b_{N+1})^q \]
    %
    is a pseudodifferential operator of order $tp - (N+2)$, allowing us to continue the construction. If we pick $b \sim \sum_{n = 0}^\infty b_n$, then $a(x,D)^p - b(x,D)^q$ will be a smoothing operator. Moreover, it is clear that the choice of such symbols at each step is essentially unique, which shows that $b$ is unique up to a smoothing operator.
\end{proof}

Given the assumptions of the theorem, we denote the unique operator $b$ by $a^{p/q}$. Using $a^{-1}$ instead of $a$, one can also construct negative fractional powers of the symbol $a$. It is simple to see that for $r_1,r_2 \in \QQ$, we have $a^{r_1} \circ a^{r_2} = a^{r_1 + r_2}$.

%\begin{theorem}
%    $T_a$ maps $\mathcal{S}(\RR^d)$ to $\mathcal{S}(\RR^d)$ continuously.
%\end{theorem}
%\begin{proof}
%    Integration by parts shows that 
%    Since $f \mapsto \widehat{f}$ is an isomorphism of $\mathcal{S}(\RR^d)$, it suffices to prove the operator
    %
%    \[ Sg(x) = \int a(x,\xi) g(\xi) e^{2 \pi i \xi \cdot x}\; d\xi. \]
    %
%    is continuous. Fix a multi-index $\alpha$ with $|\alpha| = m$. Now using the fact that $g$ is Schwartz, one finds
    %
%    \[ D^\alpha_x(Sg)(x) = \int D^\alpha_x a(x,\xi) g(\xi) e^{2 \pi i \xi \cdot x}\; d\xi. \]
    %
%    If we write $a_x(\xi) = a(x,\xi)$, then $D^\alpha_x(Sg)(x) = ((D^\alpha_x a_x) g)^\vee(x)$. Now
    %
%    \[ \nabla^n_\xi ( (D^\alpha_x a_x) \cdot g)(\xi) \lesssim_{n,m} \langle x \rangle^{k_m} \langle \xi \rangle^{l_{nm} - k} \| f \|_{\mathcal{S}^{n,k}(\RR^d)}. \]
    %
%    If $k$ is chosen larger than $l_{nm} + d$, then integration by parts implies that
    %
%    \[ |D^\alpha(Sg)(x)| = |((D^\alpha_x a_x) g)^\vee(x)| \lesssim_{n,m} \langle x \rangle^{k_m - n} \| f \|_{\mathcal{S}^{n,k}(\RR^d)}. \]
    %
%    Thus for any fixed $k_1$, there exists $k_2$ such that
    %
%    \[ \| Sg \|_{\mathcal{S}^{m,k_1}(\RR^n)} \lesssim_{m,k_1} \| g \|_{\mathcal{S}^{k_m + k_1, k_2}(\RR^d)}. \]
    %
%    This gives the required continuity of the operator.
%\end{proof}

\section{Regularity Theory}

Let us now discuss the boundedness of certain pseudodifferential operators with respect to various norm spaces. We first note that a differential operator of degree $m$ given by
%
\[ L = \sum c_\alpha(x) D^\alpha, \]
%
where $c_\alpha$ is bounded, maps $H^s(\RR^d)$ to $H^{s-m}(\RR^d)$ for each $s$. This feature remains true for a general pseudodifferential operator.

\begin{theorem}
    For any $a \in \loc{\mathcal{S}^t}(\RR^d)$, $a(x,D)$ extends uniquely to a continuous operator from $H^s_c(\RR^d)$ to $H^{s-t}_{\text{loc}}(\RR^d)$.
\end{theorem}
\begin{proof}
    Let $T$ have symbol $a(x,\xi)$. Without loss of generality, since we need only prove local estimates in the output we may assume that $a$ is compactly supported in the $x$-variable. Then $a$ is uniformly integrable in the $x$-variable, and we let
    %
    \[ A(\lambda,\xi) = \int a(x,\xi) e^{-2 \pi i \lambda \cdot x}\; dx \]
    %
    denote the Fourier transform of $a$ in the $x$-variable. For any input $\phi \in \mathcal{S}(\RR^d)$, $T\phi \in \mathcal{S}(\RR^d)$, and we may calculate that
    %
    \[ \widehat{T\phi}(\lambda) = \int A(\lambda - \xi,\xi) \widehat{\phi}(\xi)\; d\xi. \]
    %
    The assumptions on the symbol $a$ imply that
    %
    \[ |A(\lambda,\xi)| \lesssim_N \langle \xi \rangle^t \langle \lambda \rangle^{-N}. \]
    %
    Without loss of generality, assume that $s = t$. Applying Schur's lemma, the operator
    %
    \[ Sf(\lambda) = \int \langle \lambda - \xi \rangle^{-N} f(\xi)\; d\xi, \]
    %
    somewhat analogous to the Hardy-Littlewood-Sobolev fractional integration operator, is bounded from $L^2(\RR^d)$ to itself provided that $N > d$. But this means that if we pick $N > d$, then
    %
    \begin{align*}
        \| T\phi \|_{L^2(\RR^d)} &\lesssim_N \left\| \int \langle \lambda - \xi \rangle^{-N} \langle \xi \rangle^t \widehat{\phi}(\xi)\; d\xi \right\|_{L^2(\RR^d)}\\
        &\lesssim \| \langle \xi \rangle^t \widehat{\phi} \|_{L^2(\RR^d)}\\
        &\lesssim \| \phi \|_{H^t(\RR^d)}.
    \end{align*}
    %
    Thus $T$ is bounded from $H^t(\RR^d)$ to $L^2(\RR^d)$. But for general $s \in \RR^d$, $T$ will be bounded from $H^s(\RR^d)$ to $H^{s-t}(\RR^d)$ if and only if $(1 - \Delta)^{s-t} T (1 - \Delta)^{t-s}$ is bounded from $H^t(\RR^d)$ to $L^2(\RR^d)$, and this follows because $(1 - \Delta)^{s-t} T (1 - \Delta)^{t-s}$ is also a pseudodifferential operator of order $t$. The bounds we have proven show that there is a unique extension of $T$ to $H^s(\RR^d)$ for all $s \in \RR^d$ such that $\| Tf \|_{H^{s-t}(\RR^d)} \lesssim \| f \|_{H^s(\RR^d)}$ for all $f \in H^s(\RR^d)$. The closed graph theorem shows that this extension agrees with the definition of $Tf$ given for any compactly supported $f$, which we can view as an element of $\mathcal{E}(\RR^d)^*$.
\end{proof}

\begin{remark}
    For symbols of order zero, a simpler proof follows by writing
    %
    \[ T^\lambda \phi(x) = \int A(\lambda, \xi) \widehat{\phi}(\xi) e^{2 \pi i (\lambda + \xi) \cdot x}\; d\xi. \]
    %
    then the Fourier inversion formula shows that
    %
    \[ T \phi(x) = \int T^\lambda \phi(x)\; d\lambda. \]
    %
    Now the operators $\{ T^\lambda \}$ are just Fourier multiplier operators with symbols $\{ m_\lambda \}$, where $m_\lambda(\xi) = A(\lambda, \xi) e^{2 \pi i \lambda \cdot x}$, the bounds on $A$ imply that $\| m_\lambda \|_{L^\infty} \lesssim \langle \lambda \rangle^{-N}$, and this immediately gives boundedness from $L^2(\RR^d)$ to itself. The general result follows from the same trick as in the end of the last proof using the composition calculus.
\end{remark}

\begin{remark}
    If $a$ is \emph{properly supported} pseudodifferential operator of order $t$, then $a(x,D)$ extends to a continuous operator from $\loc{H^s}(\Omega)$ to $\loc{H^{s-t}}(\Omega)$.
\end{remark}

Using Calderon-Zygmund theory, we can obtain better estimates. Let us restrict ourselves at first to pseudodifferential operators of order $0$. The kernel of a $\Psi$DO of order zero satisfies estimates of the form
%
\[ |K(x,y)| \lesssim \frac{1}{|x - y|^d} \quad\text{and}\quad |\nabla_y K(x,y)| \lesssim \frac{1}{|x - y|^{d+1}}. \]
%
Thus $K$ is a singular kernel. We therefore focus on obtaining $L^2 \to L^2$ estimates, so that the standard theory of singular integrals gives $L^p \to L^p$ estimates for all $1 < p < \infty$.

\begin{theorem}
    If $a \in \mathcal{S}^0(\RR^d \times \RR^d)$, then for any $f \in \mathcal{S}$,
    %
    \[ \| T_af \|_{L^2(\RR^d)} \lesssim \| f \|_{L^2(\RR^d)}. \]
    %
    Consequently, for any $1 < p < \infty$,
    %
    \[ \| T_a f \|_{L^p(\RR^d)} \lesssim_p \| f \|_{L^p(\RR^d)}. \]
\end{theorem}
\begin{proof}
    If $\text{supp}_x(a)$ is compact, then we have already proven this result. To prove the result for more general symbols, we work with a kernel representation of $T_a$. Thus we write
    %
    \[ T_af(x) = \int_{\RR^d} K(x,y) f(x)\; dx, \]
    %
    where
    %
    \[ K(x,y) = \int_{\RR^d} a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi. \]
    %
    We have already shown that the kernel $K$ is $C^\infty$ away from the diagonal, and decays rapidly away from that diagonal. This is one instance of the pseudolocal nature of these operators. Another quantitative result reflecting this nature is that for each $N > 0$ and $x_0 \in \RR^d$,
    %
    \[ \int_{|x - x_0| \leq 1} |T_af(x)|^2\; dx \lesssim_N \int_{\RR^d} \frac{|f(x)|^2}{\langle x - x_0 \rangle^N}\; dx. \]
    %
    Thus we can `almost' bound the magnitude of $T_af$ in a neighbourhood of $x_0$ by the magnitude of $f$ in a neighbourhood of $x_0$. We focus on the case $x_0 = 0$, the other cases treated in much the same way. Write $f = f_1 + f_2$, where $f_1$ is supported on $|x| \leq 3$, $f_2$ is supported on $|x| \geq 2$, and $|f_1|, |f_2| \leq |f|$. If $\eta(x)$ is a smooth cuttoff supported on $|x| \leq 3$, then the symbol $\eta(x) a(x,\xi)$ is compactly supported, and so
    %
    \begin{align*}
        \int_{|x| \leq 1} |T_a f_1(x)|^2\; dx &= \int_{|x| \leq 1} |T_{\eta a} f_1(x)|^2 \lesssim \| f_1 \|_{L^2(\RR^d)}^2\\
        &\lesssim_N \int_{\RR^d} \frac{|f_1(x)|^2}{\langle x \rangle^N}\; dx \leq \int_{\RR^d} \frac{|f(x)|^2}{\langle x \rangle^N}\; dx.
    \end{align*}
    %
    On the other hand, since $f_2(x)$ is supported on $|x| \geq 2$, we find that
    %
    \begin{align*}
        \int_{|x| \leq 1} |T_a f_2(x)|^2\; dx &= \int_{|x| \leq 1} \left| \int K(x,y) f_2(y)\; dy \right|^2\; dx\\
        &\leq \int \int_{|x| \leq 1} |K(x,y)|^2 |f_2(y)|^2\; dy\; dx\\
        &\lesssim_N \int \int_{|x| \leq 1} \frac{|f_2(y)|^2}{|x - y|^N}\; dy\; dx\\
        &\lesssim \int \int_{|x| \leq 1} \frac{|f_2(y)|^2}{\langle y \rangle^N}\; dy\\
        &\lesssim \int \frac{|f_2(y)|^2}{\langle y \rangle^N}\; dy.
    \end{align*}
    %
    But we now find that if $N > d$, then
    %
    \begin{align*}
        \int |T_af(x)|^2\; dx &\lesssim \int \int_{|x - y| \leq 1} |T_af(y)|^2\; dy\; dx\\
        &\lesssim_N \int \int \frac{|f(y)|^2}{\langle x - y \rangle^N}\; dy\; dx\\
        &\lesssim \int |f(y)|^2\; dy,
    \end{align*}
    %
    which gives $L^2$ boundedness.
\end{proof}

Sobolev norms follow simply from these bounds. Namely, it follows simply from this that if $a(x,\xi)$ is a symbol of order $t$, then for $1 < p < \infty$, and any $s$, we have bounds of the form
%
\[ \| T_a f \|_{L^p_s(\RR^d)} \lesssim_{p,s} \| f \|_{L^p_{t + s}(\RR^d)}. \]
%
If $T_a$ is an elliptic pseudodifferential operator of order $t$, then it has a parametrix $S$ of order $-t$, and so for any $r > 0$
%
\begin{align*}
    \| f \|_{L^p_{t + s}(\RR^d)} &= \| ST_a f + (I - ST_a) f \|_{L^p_{t+s}(\RR^d)}\\
    &\leq \| ST_a f \|_{L^p_{t+s}(\RR^d)} + \| (I - ST_a) f \|_{L^p_{t+s}(\RR^d)}\\
    &\lesssim_{p,s,r} \| T_a f \|_{L^p_s(\RR^d)} + \| f \|_{L^p_{-r}(\RR^d)} 
\end{align*}
%
Thus $T$ is \emph{almost} invertible as a map from $L^p_{t+s}(\RR^d)$ to $L^p_t(\RR^d)$, except that we cannot quite obtain the bound $\| T f \|_{L^p_s(\RR^d)} \sim_{p,s} \| f \|_{L^p_{t + s}(\RR^d)}$, for instance, by virtue of the fact that $T$ might not even be invertible. But we can obtain a less quantitative result.

\begin{theorem}
    Let $T$ be an elliptic pseudodifferential operator given by a symbol uniformly of order $t$. If $f \in \mathcal{E}(\RR^d)^*$, and $Tf$ lies in $L^p_s(\RR^d)$, then $f$ lies in $L^p_{s + t}(\RR^d)$.
\end{theorem}
\begin{proof}
    Since $T$ is elliptic, we can find a parametrix $S$, which is a pseudodifferential operator of order $-t$. Thus there exists a smoothing operator $U$ such that $1 = ST + U$. Since $Tf \in L^p_s(\RR^d)$, $STf \in L^p_{s + t}(\RR^d)$. Since $f$ is compactly supported, $Uf \in C^\infty(\RR^d)$, and thus in $L^p_{s+t,\text{loc}}(\RR^d)$. This means $f \in L^p_{s+t,\text{loc}}(\RR^d)$, and since $f$ is compactly supported, this means $f \in L^p_{s+t}(\RR^d)$.
\end{proof}















\section{Pseudodifferential Operators on Manifolds}

It is an important fact that the class of pseudodifferential operators whose kernels are compactly supported is invariant under a change of coordinates, modulo smoothing operators. By an analysis of how these pseudodifferential operators change under a change of coordinates, we will be able to obtain a theory of pseudodifferential operators on manifolds.

Let $\kappa: U \to V$ be a diffeomorphism, where $U$ and $V$ are open sets in $\RR^n$, and consider $a \in \loc{S^t}(U)$ which gives a pseudodifferential operator $T: \DD(U) \to \EC(U)$ of order $t$. Define an operator $S: \DD(V) \to \EC(V)$ by setting
%
\[ Sf(\kappa(x)) = T(f \circ \kappa)(x) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)} f(\kappa(y))\; dy\; d\xi, \]
%
i.e. $S$ is defined such that $\kappa_* \circ S = T \circ \kappa_*$. One can verify that $S$ is pseudolocal, i.e. that it does not expand the wavefront sets of inputs, so one might expect $S$ to be a pseudodifferential operator, of order $t$ as well. By localizing, we may assume that $\text{supp}_x(a)$ is compact, so that $T$ extends to a continuous operator from $\mathcal{D}(U)^*$ to $\mathcal{D}(U)^*$, and $S$ to a continuous operator from $\mathcal{D}(V)^*$ to $\mathcal{D}(V)^*$. If a symbol $b \in \loc{S}^t(V)$ existed such that $S = b(y,D)$, then we would find
%
\[ b(\kappa(x_0),\eta) = \left\{ S e^{2 \pi i \eta \cdot z} \right\}(\kappa(x_0)) = \int a(x_0,\xi) e^{2 \pi i [\xi \cdot (x_0 - x) + \eta \cdot \kappa(x)]}\; dx\; d\xi \]
%
Provided we can show that the right hand side defines a symbol $b \in \loc{S}^t(V)$, then $b(y,D)$ will be a continuous operator whose kernel is compactly supported in $V \times V$, and the fact that $S e^{2 \pi i \eta \cdot z} = b(y,D) e^{2 \pi i \eta \cdot z}$ for all $\eta$ implies, by continuity and the fact that linear combinations of exponentials are dense in $\mathcal{D}(V)^*$, that $S = b(y,D)$. Thus, given $a \in \loc{S}^t(U)$, such that $\text{supp}_x(a)$ is compact, our goal is an analysis of the function
%
\[ b(\kappa(x_0),\eta) = \int a(x_0,\xi) e^{2 \pi i [ \xi \cdot (x_0 - x) + \eta \cdot \kappa(x) ]}\; dx\; d\xi. \]
%
If $\phi \in \DD(V)$ is a bump function equal to one in a neighborhood of the projections of the support of the kernel of $S$ onto each coordinate, then
%
\[ b(\kappa(x_0),\eta) = \left\{ \phi S \left\{ \phi \cdot e^{2 \pi i \eta \cdot z} \right\} \right\}(\kappa(x_0)), \]
%
which implies that $b \in C^\infty(T^* V)$. If we set
%
\[ \Phi(\xi,\eta) = \int \phi(x) e^{2 \pi i [ \eta \cdot \kappa(x) - \xi \cdot x ]}\; dx, \]
%
then
%
\[ b(\kappa(x_0), \eta) = \int a(x_0,\xi) \Phi(\xi,\eta) e^{2 \pi i \xi \cdot x_0}\; d\xi. \]
%
Now $\Phi$ is a standard oscillatory integral, whose phase $\phi(x) = \eta \cdot \kappa(x) - \xi \cdot x$ has a stationary point for values of $x$ such that $D\kappa(x)^T \eta = \xi$. Since $D\kappa(x)^T$ is invertible, this can only happen when $|\eta| \sim |\xi|$. More precisely, suppose $|D\kappa(x)|, |D\kappa(x)^{-1}| \leq C$. Then $|D\kappa(x)^T \eta - \xi| \geq |\xi|/2 \gtrsim_C |\xi| + |\eta|$, and $|D\kappa(x)^T \eta - \xi| \geq |\eta|/2 \gtrsim_C |\xi| + |\eta|$ for $|\xi| \leq |\eta|/2C$. Thus unless $2C|\eta| \geq |\xi| \geq |\eta|/2C$, we conclude by the principle of nonstationary phase that for each $N > 0$,
%
\[ |\Phi(\xi,\eta)| \lesssim_N [1 + |\xi| + |\eta|]^{-N}, \]
%
where the implicit constant will be uniformly bounded over a family of diffeomorphisms $\kappa$ and a family of pseudodifferential operators $T$ if the kernels of the resulting operators $S$ are uniformly supported on a common compact subset of $V \times V$, and if we have uniform upper and lower bounds on the derivative of $\kappa$ on the support of these kernels. If we write $1 = \chi_1 + \chi_2$, for $\chi_1,\chi_2 \in C^\infty(\RR^d)$ with $\chi_1(\alpha)$ supported on $1/2C \leq |\alpha| \leq 2C$ and equal to one when $1/C \leq |\alpha| \leq C$, then this induces a decomposition $b(\kappa(x_0),\eta) = b_1(\kappa(x_0),\eta) + b_2(\kappa(x_0),\eta)$, where
%
\[ b_i(\kappa(x_0),\eta) = \int \chi_i(\xi/|\eta|) a(x_0,\xi) \Phi(\xi,\eta) e^{2 \pi i \xi \cdot x_0}\; d\xi. \]
%
The bound on $\Phi(\xi,\eta)$ above implies that $b_1 \in S^{-\infty}$. To analyze $b_2$, we apply the method of stationary phase. To simplify our formulas, let us assume without loss of generality that $x_0 = \kappa(x_0) = 0$ and that $B = D\kappa(x_0)$. If we fix $|\eta| = 1$, consider $\lambda > 1$, and do a change of variables, replacing $\xi$ with $\lambda (\xi + B^T \eta)$, we find that
%
\[ b_2(\kappa(x_0),\lambda \eta) = \lambda^d \int \psi(x,\xi) a(x,\lambda B^T \eta + \xi)) e^{2 \pi i \lambda \phi(x,\xi)}\; d\xi\; dx, \]
%
where $\psi(\xi,x) = \chi_2(\xi + B^T \eta) \phi(x_0 + x)$ and $\phi(x,\xi) = \eta \cdot (\kappa(x) - Bx) - \xi \cdot x$. This is a continuous family of non-degenerate stationary phase integrals, each with a unique stationary point when $(x,\xi) = (0,0)$. Since $\psi$ is equal to one in a neighborhood of this point, it will not show up in the corresponding asymptotics. The Hessian at the origin is precisely $A + B$, where
%
\[ A = \begin{pmatrix} 0 & -I \\ -I & 0 \end{pmatrix} \]
%
and
%
\[ C = \begin{pmatrix} \tilde{C} & 0 \\ 0 & 0 \end{pmatrix} \]
%
where $\tilde{C} = \tilde{C}(\eta)$ is the Hessian of the map $x \mapsto \eta \cdot \kappa(x)$ at the origin. If we set
%
\[ r(x) = \eta \cdot (\kappa(x) - Bx) - (1/2)(x^T A x) \]
% - 0.5 Dkappa(x)^T eta + D kappa(x)^T eta
%
which satisfies $\partial^\alpha r(0) = 0$ for all $|\alpha| \leq 2$, then it follows that if $a_\lambda(x_0,\xi) = a(x_0,\lambda \xi)$, then
% A -I    0  -I
% -I 0    -I -A
% - D_\xi^T D_x
% -D_x^T D_xi - D_xi^T A^T D_xi
\[ b_2(\kappa(x_0),\lambda \eta) \sim \sum_{2 \nu \geq 3 \mu} \frac{1}{(-2)^\nu} \frac{1}{\mu! \nu!} \frac{1}{(2\pi i \lambda)^{\nu - \mu}} \langle (A + B)^{-1} \nabla, \nabla \rangle^\nu \{ r^\mu a_\lambda \}(x, D\kappa(x)^T). \]
%
The next Lemma implies that we can write this asymptotic development as
%
\[ b_2(\kappa(x_0),\lambda \eta) \sim \sum_{\nu = 0}^\infty \langle i \cdot \nabla_x / 2\pi, \nabla_\xi / \lambda \rangle^\nu \left\{ e^{2 \pi i \lambda r(x)} a_\lambda(0,\xi) \right\}_{x = 0, \xi = B^T \eta} \]
%
where if we sum over $\nu \leq N$, then the error term will be $O(\lambda^{(d-N)/2})$.

\begin{lemma}
    Let $A$ be a symmetric, invertible matrix, let $B$ be a symmetric matrix, and suppose $\det(A + tB)$ is independent of $t$. Then there exists $k$ such that $(A^{-1}B)^k = 0$ for some $k$. For this $k$, and for any $N > 0$,
    %
    \begin{align*}
        &\sum_{j < N} \frac{1}{j!} (2 i \lambda)^{-j} \langle (A + B)^{-1} \nabla, \nabla \rangle^j u(0)\\
        &\quad= \sum_{j < N} \frac{1}{j!} (2 i \lambda)^{-j} \langle A^{-1}\nabla, \nabla \rangle^j \left\{ e^{2 \pi i \lambda x^T B x / 2} u \right\}(0) + O(\lambda^{-N/k}).
    \end{align*}
\end{lemma}
\begin{proof}
    See Hormander, Vol 1. Section 7.7.
\end{proof}

Thus we have proved the following representation formula for pseudodifferential operators under changes of coordinates.

\begin{theorem}
    Let $\kappa: U \to V$ be a diffeomorphism, where $U$ and $V$ are open sets in $\RR^n$, and suppose $T = a(x,D)$ is a pseudodifferential operator of order $t$ on $U$. If $S$ is an operator defined on $V$ defined such that $\kappa_* \circ S = T \circ \kappa_*$, then $S$ is a pseudodifferential operator of order $t$, whose symbol $a_\kappa$ has the asymptotic development
    %
    \[ a_\kappa(\kappa(x),\eta) \sim \sum \frac{1}{(2 \pi i)^\alpha} \frac{1}{\alpha!} (\partial^\alpha_\xi a) (x,D\kappa(x)^T \eta) \left. \left\{ \partial^\alpha_y e^{2\pi i \eta \cdot r_x(y)} \right\} \right|_{y = x}, \]
    %
    where $r_x(y) = \kappa(y) - \kappa(x) - D\kappa(x)(y-x)$. The term in the sum corresponding to a multi-index $\alpha$ is a symbol of order $t - \lceil |\alpha| / 2 \rceil$, and thus this really is an asymptotic expansion.
\end{theorem}

Pseudodifferential operators defined by a local symbol of order $t$ are therefore invariant under a change of coordinates, modulo smoothing operators. Moreover, if $\kappa_* \circ S = T \circ \kappa_*$, where $T$ is a $\Psi DO$ with symbol $a \in \loc{S}^t(U)$, and $S$ is a $\Psi DO$ with symbol $b \in \loc{S}^t(V)$, then
%
\[ b(y,\eta) - a(\kappa^{-1}(y), D\kappa(x)^{-T} \cdot \eta) \]
%
is a pseudodifferential operator of order $t - 1$.

%\begin{theorem}
%    Let $U$ and $V$ be open subsets of Euclidean space together with a diffeomorphism $\kappa: U \to V$ be a diffeomorphism. If $a(x,\xi)$ is a symbol of order $m$, and $\text{supp}_x(a)$ forms a compact subset of $U$, then
    %
%    \[ a_\kappa(y,\eta) = e^{-2 \pi i \kappa^{-1}(y) \cdot \eta} a(x,D) e^{2 \pi i y \cdot \eta}. \]
    %
%    TODO (H\"{o}rmander's book seems to have the most readable discussion)
%\end{theorem}

Given a manifold $M$, a continuous operator $T: \DD(M) \to \EC(M)$ is called a \emph{pseudodifferential operator of order $t$} if whenever $(x,U)$ is a coordinate chart on $M$, the operator $T_x: \DD(x(U)) \to \EC(x(U))$ given by applying $T$ in the coordinate chart, is a pseudodifferential operator of order $t$ on $x(U)$. We let $\loc{\Psi^t}(M)$ denote the family of operators of this form. The next Lemma shows that when $M = U$ is an open subset of $\RR^n$, this really is the family of pseudodifferential operators defined by symbols in $\loc{\mathcal{S}^t}(T^* U)$.

\begin{lemma}
    Suppose $T: \DD(U) \to \EC(U)$ is a pseudodifferential operator on $U$ of order $t$, where $U$ is viewed as a manifold as above. Then we can find a symbol $a(x,\xi) \in \loc{\mathcal{S}^t}(U \times \RR^d)$ such that $T - a(x,D)$ is a smoothing operator. The symbol $a$ is uniquely determined up to a symbol in $\mathcal{S}^{-\infty}(\RR^d \times \RR^d)$.
\end{lemma}
\begin{proof}
    The idea is to work on a partition of unity, which we can sum up appropriately to get a sum over local estimates. The complete proof is supplied in Hormander, Proposition 18.1.19.
\end{proof}

\begin{remark}
    Under the assumption that the operator has a kernel which is smooth away from the diagonal, an operator $T: \DD(M) \to \EC(M)$ is a pseudodifferential operator if and only if it is pseudodifferential operator when transferred in coordinates on a family of coordinates charts that form an atlas for $M$. The assumption on the kernel is needed, for instance, since if we take $M = \RR$, we consider an atlas of the form $\{ (n, n+1) \}$, and we consider $Tf(x) = f(x - 2)$, then $T$ vanishes on each of these coordinates charts, and so looks to be a pseudodifferential operator in these charts, whereas $T$ clearly is not a pseudodifferential operator on $\RR$ since it is not pseudolocal.
\end{remark}

It is often simpler to discuss operators that can be asymptotically expanded in terms of homogeneous symbols. That is, we wish to discuss symbols $a \in \dot{\mathcal{S}}^t$ such that there exist a sequence of symbols $\{ a_k \}$, where $a_k(x,\xi)$ is smooth away from $\xi = 0$, homogeneous of order $t - k$, and
%
\[ a \sim \sum_{k = 0}^\infty a_k. \]
%
Such symbols are called \emph{classical}, and denoted $\mathcal{S}^t_{\text{cl}}$, since this, roughly speaking, was the family of pseudodifferential operators initially studied by Kohn and Nirenberg. Given a manifold $M$, we write $\Psi_{\text{cl}}^t(M) = \text{Op}(\mathcal{S}^t_{\text{cl}})(M)$ for the class of all pseudodifferential operators $T$ such that $T_x$ is classical for any coordinate system $(x,U)$ on $M$. It suffices to check this on a cover because of the asymptotic expansion for the change of variables formula. The homogeneous function which agrees with the leading term in the expansion is invariant under coordinate changes if we interpret it as a function on $T^* M - 0_M$, so for a classical pseudodifferential operator $T$ in $\Psi_{\text{cl}}^t(M)$, we can define the \emph{principal symbol} $a \in C^\infty(T^* M - 0_M)$ to be that homogeneous function of order $t$ which agrees with the leading term in the asymptotic expansions above. For nonclassical operators, there is no canonical choice of a principal symbol, though one can consider the principal symbol as an element of $\loc{\mathcal{S}^t}(M) / \mathcal{S}^{t-1}_{\text{loc}}(M)$. A pseudodifferential operator is then called \emph{elliptic} if it's principal symbol is nonvanishing at a suitably distance away from the origin, or equivalently, if it is elliptic in coordinates ranging over the entirety of $M$.

\begin{example}
    Let $\TT = \RR / \ZZ$. For any `symbol of order $t$' on $\TT^d$, i.e. any function $a: \TT^d_x \times \ZZ^d_\xi \to \CC$ with extends to an element of $\mathcal{S}^t(\TT^d_\xi \times \RR^d_\xi)$, we can consider the operator $T: \EC(\TT^d) \to \EC(\TT^d)$ defined by setting
    %
    \[ T\phi(x) = \sum_{\xi \in \ZZ^d} a(x,\xi) \widehat{\phi}(\xi) e^{2 \pi i \xi \cdot x}, \]
    %
    where $\widehat{\phi}: \ZZ^d \to \CC$ is the Fourier transform of $\phi$ on $\TT^d$. We claim that $T$ is a pseudodifferential operator. By translation invariance, it will suffice to find a neighborhood $\Omega$ of the origin upon and a coordinate system on $\Omega$ upon which the transfer of $T$ is a pseudodifferential operator. Write
    %
    \begin{align*}
        T\phi(x) &= \sum_\xi a(x,\xi) \widehat{\phi}(\xi) e^{2 \pi i \xi \cdot x}\\
        &= \int_{\TT^d} \left( \sum_\xi a(x,\xi) e^{2 \pi i \xi \cdot (x - y)} \right) \phi(y)\; dy\\
        &= \int_{\TT^d} K(x,y) \phi(y)\; dz,
    \end{align*}
    %
    where we treat
    %
    \[ K(x,y) = \sum_\xi a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}. \]
    %
    as the distribution on $\DD(\TT^d \times \TT^d)^*$ obtained as the distributional limit of the partial sums. Consider the periodic kernel $\tilde{K} \in \DD(\RR^d \times \RR^d)^*$ induced by $K$. Then the Poisson summation formula implies that
    %
    \[ \tilde{K}(x,y) = \sum_\xi a(x,\xi) e^{2 \pi i \xi \cdot (x - y)} = \sum_n (\mathcal{F}_\xi^{-1} a)(x,(x-y) + n) = \sum_n K_a(x,y+n), \]
    %
    where $K_a$ is the kernel of the psedodifferential operator $a(x,D)$. If $\widetilde{\Omega} = (-1/4,1/4)^d$, then for $x,y \in \widetilde{\Omega}$, and $n \neq 0$,
    %
    \[ |\partial^\alpha_x \partial^\beta_y K_a(x,y+n)| \lesssim_N |n|^{-N}. \]
    %
    This implies that
    %
    \[ (x,y) \mapsto \sum_{n \neq 0} K_a(x,y+n) \]
    %
    lies in $C^\infty(\widetilde{\Omega} \times \widetilde{\Omega})$, and so induces a smoothing operator on $\widetilde{\Omega}$. Thus $\tilde{T}$, restricted to $\tilde{\Omega}$, differs by a smoothing operator from the pseudodifferential operator $a(x,D)$. But this means that $\tilde{T} \in \dot{\Psi}^t(\widetilde{\Omega}$. If $\Omega$ is the subset of $\TT^d$ corresponding to $\widetilde{\Omega}$, then this means $T$ behaves like a pseudodifferential operator on $\widetilde{\Omega}$. Thus $T$ is actually a pseudodifferential operator of order $t$ on $\TT^d$. Modulo smoothing operators, working backwards through this argument also clearly shows that \emph{all pseudodifferential operators} of order $t$ can be written in the form introduced at the beginning of this example.

    As a particular example of this kind of construction, consider the operator $T: \EC(\TT) \to \EC(\TT)$ given by
    %
    \[ P_+ \phi(t) = \sum_{n > 0} \widehat{\phi}(n) e^{2 \pi nit}, \]
    %
    then $P_+$ is a classical pseudodifferential operator on $\TT$ of order zero, and it's principal symbol is $\mathbf{I}(\xi > 0)$. Similarily, if
    %
    \[ P_- \phi(t) = \sum_{n < 0} \widehat{\phi}(n) e^{2 \pi nit}, \]
    %
    then $P_-$ is a classical pseudodifferential operator on $\TT$ of order zero with principal symbol $\mathbf{I}(\xi < 0)$. For any non-zero complex values $a_+,a_- \in \CC - \{ 0 \}$, $a_+ P_+ + a_- P_-$ is an elliptic classical pseudodifferential operator on $\TT$ of order zero.
\end{example}

\begin{example}
    On a Riemannian manifold $M$, the operator $-\Delta$ is a pseudodifferential operator of order two, given in local coordinates as
    %
    \[ a(x,\xi) = \sum g^{ij}(x) \xi_i \xi_j. \]
    %
    If $M$ is geodesically complete, then $-\Delta$ can be interpreted as an essentially self-adjoint operator on $L^2(M)$, and the resulting calculus of unbounded operators allows us to define the operator $\sqrt{-\Delta}$. Regardless, the fact that $-\Delta$ is an elliptic pseudodifferential operator allows us to define a pseudodifferential operator $\sqrt{-\Delta}$ of order one, such that $\sqrt{-\Delta}^2 = - \Delta$. This operator will agree with the definition given by the unbounded calculus, modulo smoothing operators, if $M$ is geodesically complete.
\end{example}











\section{$\Psi$DOs and Microsupport}

Fix an open set $\Omega \subset \RR^d$. The theory of microlocal analysis asks us to think of the singularities of a distribution $u \in \DD(\Omega)^*$ as having both position \emph{and} direction, i.e. existing on the wavefront set $\text{WF}(u) \subset T^* M$, and indicated by the directions that the Fourier transform of $u$ does not decay rapidly, once sufficiently localized. The heuristics of pseudodifferential operators also ask us to view a distribution $u$ as living on $T^*M$, such that a pseudodifferential operator $S$ given by a symbol $a$ acts on $u$ by multiplying that part of $u$ that `lives at' the point $(x,\xi)$ by the quantity $a(x,\xi)$. In particular, if $a$ is made to decay rapidly in the directions that define the wavefront set $u$, then we should expect $Su$ to be smooth, i.e. application of $S$ annihilates the singularities of $a$. In this section, we elaborate on these ideas, as well as introducing further notions of the microlocal properties of pseudodifferential operators.

If $T: \DD(\Omega) \to \EC(\Omega)$ is a pseudodifferential operator with symbol $a$, then we define the microsupport $\msupp(T)$ of $T$ to be equal to the microsupport $\msupp(a)$ of it's symbol, defined in the parts of these notes on oscillatory integral distributions.

\begin{lemma}
    Let $T$ be a pseudodifferential operator on $\Omega$. Then it's canonical relation is equal to
    %
    \[ \mathcal{C}_T = \{ (x,x;\xi,\xi): (x,\xi) \in \msupp(T) \}. \]
    %
    This follows because an open conic set $\Gamma \subset \Omega \times \RR^d$ is disjoint from $\msupp(T)$ if and only if $\Gamma$ is disjoint from $\text{WF}(Tu)$ for any $u \in \EC(\Omega)^*$.
\end{lemma}
\begin{proof}
    Let $T = a(x,D)$ for some symbol $a(x,\xi)$. It follows from the general theory of oscillatory integral distributions that the canonical relation of $T$ is equal to
    %
    \[ \mathcal{C}_T \subset \{ (x,\xi;x,\xi): (x,\xi) \in \msupp(T) \}. \]
    %
    Thus if $\Gamma$ is disjoint from $\msupp(T)$, then it follows from the general theory that $\Gamma$ is disjoint from $\text{WF}(Tu)$ for any $u \in \EC(\Omega)^*$. If we assume the converse, then for any $(x_0,\xi_0) \in \Gamma$, we can find a pseudodifferential operator $S: \DD(\Omega) \to \EC(\Omega)$ with a symbol $b(x,\xi)$ supported on $\Gamma$ and equal to one in a conic neighborhood of $(x_0,\xi_0)$. It follows that $ST$ is a smoothing operator. It follows from the composition calculus that $a \cdot b \in \mathcal{S}^{-\infty}(\Omega \times \RR^d)$. Thus $(x_0,\xi^0) \not \in \msupp(a) = \msupp(T)$.
\end{proof}

Similar to the argument above, the composition calculus implies that for any two properly supported pseudodifferential operators $T$ and $S$,
%
\[ \msupp(TS) \subset \msupp(T) \cap \msupp(S), \]
%
and for any pseudodifferential operator $T$,
%
\[ \msupp(T^t) = \{ (x,-\xi): (x,\xi) \in \msupp(T) \} \quad \msupp(T^*) = \msupp(T). \]
%
One can prove these either using the microsupport of the symbols defining $T$ and $S$, or the properties of the canonical relation of $T$ and $S$.

\begin{theorem}
    Let $\Gamma$ be a closed conic set, and suppose $T$ is a properly pseudodifferential operator with $\msupp(T) \cap \Gamma = \emptyset$, then $T$ maps $\DD^*_\Gamma(\Omega)$ continuously into $\EC(\Omega)$.
\end{theorem}
\begin{proof}
    TODO: For any open set $U \subset \Omega$, control the derivatives of $T \phi$ on $U$ by decomposing $T$ into inputs outside of $U$, a $\Psi$DO with a symbol in $\mathcal{S}^{-\infty}$, and a $\Psi$DO localized near $\msupp(T)$, and so on.
\end{proof}

In fact, a sequence $\{ u_n \}$ converges in $\DD^*_\Gamma(\Omega)$ to some $u \in \DD^*_\Gamma(\Omega)$ if and only if it converges distributionally to $u$, and $Tu_n \to Tu$, where $T$ is an arbitrary properly supported $\Psi DO$ with $\Gamma \cap \msupp(T) = \emptyset$. The proof is left to the reader.

\begin{theorem}
    Fix $u \in \DD(\Omega)^*$. Then $(x_0,\xi^0) \not \in \text{WF}(u)$ if and only if there exists a conic neighborhood $\Gamma$ of $(x_0,\xi^0)$ such that for any properly supported pseudodifferential operator $T$ on $\Omega$ with $(x_0,\xi^0) \in \msupp(T)$, $Tu \in \EC(\Omega)$.
\end{theorem}

\begin{remark}
    It follows from this theorem, and the fact that the class of pseudodifferential operators and the microsupport of such operators are invariant under diffeomorphism, that the wavefront set of a distribution is invariant under diffeomorphisms.
\end{remark}

We have already seen the regularity theory of pseudodifferential operators. Recall that if $T$ is a properly supported pseudodifferential operator of order $t$, then $T$ maps $\loc{H^s}(\Omega) \to \loc{H^{s-t}}(\Omega)$. By virtue of the fact that this is an isomorphism if $T$ is elliptic, one can \emph{define} $\loc{H^s}(\Omega)$ to be the space of all distributions $u \in \DD(\Omega)^*$ such that $Tu \in L^2_{\text{loc}}(\Omega)$, where $T$ can be an arbitrary properly supported $\Psi DO$ of order $m$.



Let us also now look at the \emph{microlocal regularity} of $T$, i.e. the regularity of $T$ where we only care about regularity in certain conical subsets of $T^* \Omega$. For a conic open set $\Gamma \subset \Omega \times \RR^d$, we define $H^s_{\Gamma,\text{loc}}(\Omega)$ to be the family of all distributions $u \in \DD(\Omega)^*$ such that for any properly supported pseudodifferential operator $T$ of order zero with conically compact microsupport $\msupp(T) \subset \Gamma$, $Tu \in \loc{H^s}(\Omega)$. By the results above, and the Sobolev embedding theorem, $\lim_{s \to \infty} H^s_{\Gamma,\text{loc}} (\Omega) = \DD^*_\Gamma(\Omega)$.

\begin{theorem}
    If $T$ is a properly supported pseudodifferential operator of order $t$ on $\Omega$, then $T$ maps $H^s_{\Gamma,\text{loc}}(\Omega)$ into $H^{s-t}_{\Gamma,\text{loc}}(\Omega)$.
\end{theorem}
\begin{proof}
    Fix a conically compact set $\Gamma_1 \subset \Gamma$. If $S$ is a properly supported pseudodifferential operator of order zero with $\msupp(S) \subset \Gamma$, it suffices to show that $ST$ maps $H^s_{\Gamma,\text{loc}}(\Omega)$ into $\loc{H^{s-t}}(\Omega)$. But $ST = STU_1 + STU_2$, where $U_1$ and $U_2$ are properly supported pseudodifferential operators of order zero, such that $\msupp(U_1)$ is conically compact and contained in $\Gamma$, and $\msupp(U_2)$ is disjoint from $\Gamma_1$. But this means that if $v \in H^s_{\Gamma,\text{loc}}(\Omega)$, then $U_1 v \in \loc{H^s}(\Omega)$, and since $ST$ is a properly support pseudodifferential operator of order $t$, $STU_1 v \in \loc{H^{s-t}}(\Omega)$. On the other hand, $\text{WF}(U_2 v)$, and thus $\text{WF}(TU_2 v)$, is disjoint from $\Gamma_1$, which implies that $STU_2$ is smooth, and thus lies in $\loc{H^{s-t}}(\Omega)$ trivially.
\end{proof}

Ellipticity can also be microlocalized. If $T$ was an elliptic pseudodifferential operator, we found a pseudodifferential parametrix $S$ for $T$, i.e. such that $S \circ T$ and $T \circ S$ are smoothing operators. We say a symbol $a \in \dot{S}^t(\Omega)$ is \emph{elliptic} on a conic open set $\Gamma \subset \Omega \times \RR^d$ if for $(x,\xi) \in \Gamma$,
%
\[ |a(x,\xi)| \sim \langle \xi \rangle^t \]
%
with an implicit constant uniform in $\xi$, and locally uniform in $x$. In this case, we can find a `parametrix' on \emph{conically compact} subcones of $\Gamma$.

\begin{theorem}
    If $T$ is a pseudodifferential operator with a symbol $a \in \dot{S}^t(\Omega)$ which is elliptic on a conic set $\Gamma$, then there exists a pseudodifferential operator $S \in \dot{S}^{-t}(\Omega)$ such that $T \circ S$ and $S \circ T$ are regularizing on $\Gamma$.
\end{theorem}
\begin{proof}
    If $\Gamma_1$ is a conic open subset of $\Gamma$, we can find a pseudodifferential operator $S$ with a symbol $b$ by a recursive formula similar to that of the construction of a parametrix of an elliptic symbol, though applying cutoffs outside of $\Gamma_1$ so that the symbol vanishes outside of $\Gamma$ and remains smooth and well defined.
\end{proof}

As a consequence, if a $\Psi$DO $T$ is elliptic on $\Gamma$, then for any compactly supported distribution $u$, it follows that
%
\[ \text{WF}(Tu) \cap \Gamma = \text{WF}(u) \cap \Gamma, \]
%
i.e. the wavefront set is preserved on $\Gamma$.

If $T$ is a properly supported classical pseudodifferential operator of order $t$ with principal symbol $p(x,\xi)$, then the \emph{characteristic set} of $T$ is
%
\[ \Char(T) = \{ (x,\xi): p(x,\xi) = 0 \}. \]
%
The characteristic set is closed and conic, and $T$ is elliptic on the complement of $\Char(T)$. Thus it follows that for $u \in \DD(\Omega)^*$, $\text{WF}(u) \subset \text{WF}(Tu) \cup \Char(T)$. Therefore, if $Tu \in \EC(\Omega)$, then $\text{WF}(u) \subset \Char(T)$.





\section{Vector-Valued Pseudodifferential Operators}

For certain applications of pseudodifferential operators, e.g. to systems of partial differential equations, it is useful to have a theory of vector-valued pseudodifferentail operators acting on systems of distributions. The theory is almost entirely analogous to the scalar-valued theory, except that products of pseudodifferential operators may not commute.

We consider only finite dimensional vector-valued quantities here, though the generalization to Banach spaces is not too difficult to imagine. If $V$ is a finite dimensional vector space, and $\Omega \subset \RR^d$, we can define a family $\DD(\Omega;V)$ of $V$-valued test functions, and thus obtain a family $\DD(\Omega,V)^*$ of $V$-valued distributions on $\Omega$. These spaces are really just $\DD(\Omega) \CT V$ and $\DD(\Omega)^* \widehat{\otimes} V$. Thus if $V$ has a basis $\{ e_1, \dots, e_n \}$, then elements of $\DD(\Omega,V)$ can be uniquely expanded as $\phi_1 e_1 + \dots + \phi_n e_n$ for test functions $\{ \phi_i \}$ in $\DD(\Omega)$, and elements of $\DD(\Omega,V)^*$ can be uniquely expanded as $u_1 e_1 + \dots + u_n e_n$ for distributions $\{ u_i \}$ in $\DD(\Omega)^*$. Similarily, we can define $\EC(\Omega,V)$, $\EC(\Omega,V)^*$, $H^s(\Omega,V)$, and virtually all of the other function spaces of interest to us in analysis, and these also just turn out to be tensor products.

If $V$ and $W$ are both finite dimensional linear spaces, then we have a natural isomorphism
%
\[ L(X \otimes V, Y \otimes W) \cong L(X,Y) \otimes L(V,W). \]
%
In particular, after fixing bases $\{ e_1, \dots, e_n \}$ and $\{ e_1', \dots, e_n' \}$ for $V$ and $W$, an arbitrary operator $T$ in $L(X \otimes V, Y \otimes W)$ can be written uniquely as
%
\[ T \left( \sum_{i = 1}^n x_i \otimes e_i \right) = \sum_{i = 1}^n \sum_{j = 1}^m T_{ij}(x_i) e_j \]
%
where $T_{ij}$ lie in $L(X,Y)$. Thus every vector-valued continuous linear map is given by an $n \times m$ matrix of scalar-valued continuous linear maps.

It is trivial that we have a Schwartz kernel for such operators, i.e. for any $T: \DD(\Omega_1,V) \to \DD(\Omega_2,W)^*$, there exists a matrix-valued distribution $K \in \DD(\Omega_2 \times \Omega_1, V \otimes W)^*$ such that
%
\[ \langle T \phi, \psi \rangle = \int K(x,y) (\phi(x) \otimes \psi(y))\; dx\; dy. \]
%
Let us now specialize to the study of vector valued pseudodifferential operators

We define a pseudodifferential operator $T$ of order $t$ on $\Omega$, \emph{valued in $L(V,W)$}, to be an operator from $\DD(\Omega,V)$ to $\EC(\Omega,W)^*$ induced by an element of $\loc{\Psi^t}(\Omega) \widehat{\otimes} L(V,W)$. With any such operator we can associate $a: \Omega \times \RR^d \to L(V,W)$, a \emph{vector-valued symbol} of order $t$, such that
%
\[ T\phi(x) = \int a(x,\xi) \phi(y) e^{2 \pi i \xi \cdot (x-y)}\; dy. \]
%
The symbolic calculus remains unpeturbed, except for a few modifications:
%
\begin{itemize}
    \item The operators $T^t$ and $T^*$ are $L(W^*,V^*)$-valued.

    \item If $T$ is an $L(V,W)$ valued proper pseudodifferential operator of order $t$, and $S$ an $L(W,U)$ valued operator of order $s$, then the operator $T \circ S$ is an $L(V,U)$ valued pseudodifferential operator of order $t + s$ with an analogous asymptotic expansion to the scalar-valued case, but the non-commutativity implies that the commutator $[T,S] = T \circ S - S \circ T$ is \emph{not necessarily} a pseudodifferential operator of $t + s - 1$.

    \item If $T$ is a classical $L(V,W)$ valued pseudodifferentail operator with principal symbol $p(x,\xi)$, then the characteristic set of $T$ is
    %
    \[ \Char(T) = \{ (x,\xi): p(x,\xi): V \to W\ \text{is not injective} \}. \]
    %
    Then $T$ is elliptic if $\Char(T) = \emptyset$. One can consider the analogous microlocal variants.
\end{itemize}

We can also consider pseudodifferential operators valued in linear maps between two vector bundles $E$ and $F$ on a space $\Omega$, i.e. an operator $T: C^\infty(\Omega;E) \to C^\infty(\Omega;F)$ which, when taken in coordinates given by trivializations of $E$ and $F$, look like matrix valued pseudodifferential operators. We can then associate such an operator $T$ with a symbol, i.e. a family of sections $\RR^n \to \Gamma(\Omega, L(E,F))$ with appropriate smoothness and decay. One can then define $\Char(T)$ as above, and the notion of an elliptic operator.

\begin{example}
    If $M$ is a smooth manifold, then the exterior derivative $\Omega^n(M) \to \Omega^{n+1}(M)$ is a pseudodifferential operator. Let us focus on the case where $M$ is an open submanifold of $\RR^d$ so that it has a natural coordinate system. Since
    %
    \[ d(f dx^S) = \sum_{j \not \in S} \frac{\partial f}{\partial x^j} dx^j \wedge dx^S = \sum_{j \not \in S} (2 \pi i) (D_x^j f) dx^j \wedge dx^S, \]
    %
    it follows that the symbol of the exterior derivative is
    %
    \[ a(\xi) = \sum_{\substack{S \subset \{ 1, \dots, d \}\\\#(S) = n}} \sum_{j \not \in S} \sigma(j,S) \cdot 2 \pi i \xi_j \cdot E_{S,S \cup \{ j \}}, \]
    %
    where $E_{S,T}: L(\Lambda^n, \Lambda^m)$ is simply the bundle map that maps $dx^S$ to $dx^T$, and everything else to zero, and where $\sigma(j,S) \in \{ -1, 1 \}$ is chosen such that $dx^j \wedge dx^S = \sigma(j,S) dx^{S \cup \{ j \}}$. For $n = 0$ in particular, we have
    %
    \[ a(\xi) = \sum_{j = 1}^d 2 \pi i \xi_j E_j, \]
    %
    thus we see that the exterior differential in this case is always injective, and so $d: \Omega^0(M) \to \Omega^1(M)$ is elliptic. For $n > 0$ on the other hand, is \emph{not} elliptic. For instance, in the case $n = 1$, we have
    %
    \[ a(\xi) = \sum_{i < j} 2 \pi i (\xi_j E_{i, \{ i, j \}} - \xi_i E_{j, i \cup \{ i,j \}} ). \]
    %
    But then we notice that for each fixed $\xi^0 \in \RR^d$, $a(\xi^0)$ maps $\sum \xi^0_i dx^i$, and thus $\Char(T) = \Omega \times \RR^d_\xi$.
\end{example}

\begin{example}
    We recall that the principal symbol of a classical pseudodifferential operator on a manifold $M$ is invariantly defined on $T^*M$. Given a manifold $M$, we can consider the line bundle $\text{Vol}^{1/2}(M)$ of half scalar densities. We claim there is a more rich invariant that can be associated with pseudodifferential operators from $\text{Vol}^{1/2}(M)$ to itself, namely, the \emph{subprincipal symbol}, given in coordinates such that if $T$ has symbol $a \sim \sum_{i = 0}^\infty a_{m-i}$, then
    %
    \[ a^{\text{sp}} = a_{m-1} + C \cdot \partial_j^x \partial_j^\xi a_m \]
    %
    TODO: GET COEFFICIENT $C$ CORRECT. is invariantly defined as a $\text{Hom}(\text{Vol}^{1/2}(M))$ valued symbol of order $m-1$ on $T^*M$.
    %Indeed, if we switch to some other coordinates via some diffeomorphism $\kappa$, giving a new classical family of symbols $b \sim \sum_{i = 0}^\infty b_{m-i}$, then
    %
    %\[ b_0(\kappa(x),\eta) = a_0(x, D\kappa(x)^T \eta) \]
    %\[ b_1(\kappa(x),\eta) = \sum_{i = 1}^n \frac{1}{2\pi i} (\partial_\xi^i a_0)(x, D\kappa(x)^T \eta) + \frac{1}{4 \pi i} \sum_{j \leq k} (\partial_\xi^{jk} a_0)(x, D\kappa(x)^T \eta) \{ 2 \pi i \eta \cdot \partial_y^{jk} r_x(y) \}|_{y = x} \]
    In particular, if $a_0$ vanishes up to second order, the $a_{m-1}$ is invariantly defined on $T^*M$.
\end{example}





\section{The Index Theorem}

Let $T \in \loc{\Psi^0}(\Omega)$. Then $T$ is a continuous operator from $L^2_c(\Omega)$ to $L^2_{\text{loc}}(\Omega)$. We begin this section by determining what conditions ensure that this operator is compact, i.e. what conditions ensure that $T$ maps bounded subsets of $L^2_c(\Omega)$ to bounded subsets of $L^2_{\text{loc}}(\Omega)$. This is equivalent to the induced maps $L^2(K) \to L^2_{\text{loc}}(\Omega)$ being compact for any compact set $K \subset \Omega$, and our job is simplified considerably by the following lemma.

\begin{lemma}
    Let $X$ be a Banach space, and let $Y$ be a Fr\'{e}chet space. Then a bounded linear operator $T: X \to Y$ is compact if and only if for any sequence $\{ x_i \}$ converging weakly to zero in $X$, $\{ Tx_i \}$ converges in the standard topology of $Y$.
\end{lemma}
\begin{proof}
    TODO: Maybe move to functional analysis notes?

    Since $Y$ is a Fr\'{e}chet space, $T$ is compact if and only if for any bounded sequence $\{ x_i \}$ in $X$, $\{ Tx_i \}$ has a convergent subsequence in $Y$.

    If $T$ is compact, and a sequence $\{ x_i \}$ converges weakly to zero, then that sequence is bounded, hence $\{ Tx_i \}$ is precompact. But $\{ Tx_i \}$ converges weakly to zero, since $T$ is continuous from the weak topology on $X$ to the weak topology on $Y$. But this means $\{ Tx_i \}$ converges in norm to zero, since any subsequence has a further subsequence converging in norm to zero.

    Conversely, suppose $T$ maps a sequence converging weakly to zero to a sequence converging in norm. If $\{ x_i \}$ is a bounded sequence in $X$, then by Banach-Alaoglu, there exists a subsequence of $\{ x_i \}$ which is Cauchy in the weak topology, which without loss of generality we will assume to be $\{ x_i \}$ itself. To show this implies $\{ Tx_i \}$ converges in $Y$, we note that if $d_Y$ is a translation invariant metric defining $Y$, and $\{ Tx_i \}$ did not converge, then there would be $\varepsilon > 0$ and a strictly increasing pair of sequences $\{ i_j \}$ and $\{ i'_j \}$ such that for all $j$, $d_Y(Tx_{i_j}, Tx_{i'_j}) \geq \varepsilon$. But $x_{i_j} - x_{i'_j}$ converges to zero in the weak topology, which gives a contradiction.
\end{proof}

Thus an operator $T: L^2_c(\Omega) \to L^2_{\text{loc}}(\Omega)$ is compact if and only if, for any compact set $K \subset \Omega$, and any sequence $\{ f_i \}$ in $L^2(K)$ converging weakly to zero, $\{ Tf_i \}$ converges to zero in $L^2_{\text{loc}}(\Omega)$, which means that for any other compact set $K_1 \subset \Omega$,
%
\[ \lim_{i \to \infty} \int_{K_1} |Tf_i(x)|^2\; dx = 0. \]
%
Any operator TODO-

Any smoothing operator $T: L^2_c(\Omega) \to L^2_{\text{loc}}(\Omega)$ is compact, since if $K \in C^\infty(\Omega \times \Omega)$, then it is certainly true that $K \in $

The dual of $L^2_c(\Omega)$ can be identified with $L^2_{\text{loc}}(\Omega)$. Thus a family $\{ f_i \}$ converges to zero weakly in $L^2_c(\Omega)$ if and only if
%
\[ \int f_i(x) g(x)\; dx \to 0 \]

A family $\{ f_i \}$ in $L^2_c(\Omega)$ converges weakly to zero precisely when it converges in $L^2_{\text{loc}}(\Omega)$ to zero.

Thus an operator $T: L^2_c(\Omega) \to L^2_{\text{loc}}(\Omega)$ is compact if and only if 









\chapter{Fourier Integral Operators}

Pseudodifferential Operators formalize a family of operators that can modulate the amplitude of wave packets. The theory of Fourier integral operators extends this theory by introducing operators that can not only modulate the amplitude of wave packets, but also move the position of wave packets in \emph{phase space} (though the uncertainty principle necessitates that we do so in a \emph{symplectic manner}). As a more down to earth description, Fourier integral operators are operators whose kernel is a distribution locally representable by an oscillatory integral, and so we will begin with a general study of such kernels.


\section{Lagrangian Distributions}

Now suppose $a_1$ and $a_2$ are two symbols, and $\phi_1: U \times \RR^{p_1}_{\theta} \to \RR$ and $\phi_2: U \times \RR^{p_2}_{\theta'} \to \RR$ are two non-degenerate phase functions, such that $I_{a_1,\phi_1}$ and $I_{a_2, \phi_2}$ differ by a smooth function. We claim that
%
\[ \msupp(a_1) \cap \Lambda_{\phi_1} = \msupp(a_2) \cap \Lambda_{\phi_2}. \]
%
Indeed, suppose that $(x_0,\xi_0) \in \Lambda_{\phi_1}$. Then there is $(x_0,\theta_0) \in \Sigma_{\phi_1}$, such that $\nabla_x \phi(x_0,\theta_0) = \xi_0$. Consider $\psi$ as above, satisfying the assumptions of the asymptotic theorem above. Then for any compactly supported, smooth function $f$ equal to one in a nieghborhood of $x_0$, the $\lambda^{- \frac{p_1 - d}{2}}$ term in the asymptotic expansion of
%
\[ \int I_{a_1,\phi_1}(x) f(x) e^{-2 \pi i \lambda \psi(x,\sigma)}\; dx \]
%
is equal to $a_1(x_\sigma,\lambda \theta_\sigma)$. Since $(x_0, \theta_0)$ lies in the essential support of $a_1$, we can find some $\theta_{\sigma_1}$ such that it is \emph{not} true that $|a_1(x_{\sigma_1}, \lambda \theta_{\sigma_1})| \lesssim_N \lambda^{-N}$ for all $N > 0$. It then follows that it is not true that for all $N > 0$,
%
\[ \left| \int I_{a_2,\phi_2}(x) f(x) e^{2 \pi i \lambda \psi(x,\sigma_1)} \right| \lesssim_N \lambda^{-N}. \]
%
But this means that
%
\[ (x_0,\xi_0) \in \text{WF}(I_{a_2,\phi_2}) \subset \msupp(a_2) \cap \Lambda_{\phi_2}. \]
%
The converse follows by symmetry.

It turns out that the reverse is true, provided one is willing to change the symbol one is working with. This is precisely the \emph{equivalence of phase theorem}. To prove this, we shall come up with a definition of the family of oscillatory integral distributions $I_{a,\phi}$ such that $\Lambda_\phi$ is an open submanifold of a given Lagrangian submanifold $\Lambda$ of $T^* U$, that is independent of the choice of phase function used.

Let $M$ be a manifold, and let $\Lambda \subset T^* M$ be a Lagrangian submanifold. We then say a distribution $u$ is a \emph{Lagrangian distribution} of order $m$ associated to $\Lambda$, if for all properly supported pseudodifferential operators $P_1,\dots,P_N \in \Psi^1_{\text{cl}}(M)$, with principal symbols vanishing on $\Lambda$,
%
\[ (P_1 \circ \dots \circ P_N) u \in W^{2,\infty}_{-m-d/4, \text{loc}}(M). \]
%
The class of all Lagrangian distributions of order $m$ is denoted by $I^m(M,\Lambda)$. Since there is no occurence of $N$ on the right hand side of the equation, we conclude by a Sobolev embedding argument that $\text{WF}(u) \subset \Lambda$ for any $u \in I^m(M,\Lambda)$. The definition is easily checked to be coordinate independent.

\begin{lemma}
    Suppose $\phi$ is a non-degenerate phase function defined on a conic open subset of $T^* M$, with $\Lambda_\phi \subset \Lambda$. If $a \in S^\mu(M \times \RR^p)$ is a symbol of order $\mu$ supported on this conic neighborhood, and if $m = \mu - d/4 + p/2$, then $I_{a,\phi} \in I^m(M,\Lambda)$.
\end{lemma}
\begin{proof}
    To perform this calculation, we may assume without loss of generality that $\text{supp}_x(a)$ is compact, and that $\text{supp}_\theta(a)$ is supported in a small conic neighborhood $\Gamma$ of $\RR^p - \{ 0 \}$. Then we may choose a coordinate system containing $\text{supp}_x(a)$, and a smooth, homogeneous function $H(\xi)$ in this coordinate system such that
    %
    \[ \Lambda \cap \msupp(a) \subset \{ (\nabla_\xi H(\xi), \xi) : \xi \in \RR^d \}. \]
    %
    Let us calculate
    %
    \[ J(\xi) = e^{2 \pi i H(\xi)} \widehat{I_{a,\phi}}(\xi) = \int a(x,\theta) e^{2 \pi i [ H(\xi) + \phi(x,\theta) - x \cdot \xi ]}\; dx\; d\theta. \]
    %
    If we write $\lambda = |\xi|$, and set $\omega = \xi / |\xi|$, then we can also write this quantity as
    %
    \[ \lambda^p \int a(x, \lambda \theta) e^{2 \pi i \lambda [ H(\omega) + \phi(x,\theta) - x \cdot \omega ]}\; dx\; d\theta. \]
    %
    If there are no stationary points in $\msupp(a)$, then this quantity is $O_N(|\xi|^{-N})$ for all $N > 0$. On the other hand, if there is a stationary point $(x_0,\theta_0,\xi_0)$ in this domain, then
    %
    \[ \nabla_\theta \phi(x,\theta) = 0 \quad\text{and}\quad \nabla_x \phi(x,\theta) = \xi. \]
    %
    For any such triple $(x_0,\theta_0,\xi_0)$, we therefore have $(x_0,\xi_0) \in \Lambda_\phi \subset \Lambda$, so so that $x_0 = \nabla_\xi H(\xi_0)$. The point is non-degenerate, and so for each $\xi$ in a small neighborhood of $\xi_0$, there exists a unique stationary point for the integral above, and this stationary point is precisely given by the function $x = \nabla_\xi H(\xi)$. Moreover, for each such $\xi$ there is a unique $\theta_\xi$ such that $(\nabla_\xi H(\xi), \theta_\xi, \xi)$ is a stationary point of the integral. By homogeneity, the family of all such stationary points $\{ \theta_\xi \}$ is compact, and thus has magnitudes lying in $[C^{-1}, C]$ for some large $C > 0$. If we choose $\chi \in C_c^\infty(\RR^p)$ with $\chi(\theta) = 1$ for $|\theta| \in [C^{-1}, C]$, then the integral
    %
    \[ \lambda^p \int (1 - \chi(\theta)) a(x, \lambda \theta) e^{2 \pi i \lambda [ H(\omega) + \phi(x,\theta) - x \cdot \omega ]}\; dx\; d\theta \]
    %
    has no stationary points on it's support. A simple dyadic analysis for large $\theta$, and for small $\theta$, simply derivative bounds, show this quantity is actually Schwartz in the $\xi$ variable. Thus to understand $J(\xi)$, it suffices to analyze the stationary phase integral
    %
    \[ \lambda^p \int \chi(\theta) a(x, \lambda \theta) e^{2 \pi i \lambda [ H(\omega) + \phi(x,\theta) - x \cdot \omega ]}\; dx\; d\theta. \]
    %
    We can now use the variable-coefficient analysis of stationary phase to bound this integral. Namely, if we set
    %
    \[ \tilde{a}(x,\theta,\lambda) = \lambda^p \chi(\theta) a(x,\lambda \theta), \]
    %
    then
    %
    \[ |\nabla^n_x \nabla^m_\theta \nabla^k_\lambda \tilde{a}(x, \theta, \lambda)| \lesssim_{n,m,k} \lambda^{p + \mu}. \]
    %
    Thus the variable-coefficient version of stationary phase implies that $J$ is a local symbol of order $\mu + p/2 - d/2 = m - d/4$. If $P = P_1 + P_{\leq 0}$ is a properly supported classical pseudodifferential operator of order one with symbol $b \sim \sum b_{1-k}$, where $b_1$ vanishes on $\Lambda$, then
    %
    \begin{align*}
        (P I_{a,\phi})(x) &= \int b(x,\eta) \widehat{I}_{a,\phi}(\eta) e^{2 \pi i \eta \cdot x}\; d\eta\\
        &= \int \{ b(x,\eta)  J(\eta) \} e^{2 \pi i [\eta \cdot x - H(\eta)]}\; d\eta.
    \end{align*}
    %
    In particular,
    %
    \[ e^{2 \pi i H(\xi)} \widehat{P I_{a,\phi}}(\xi) = \int \{ P(x,\eta) J(\eta) \} e^{2 \pi i [ (\eta - \xi) \cdot x - [H(\eta) - H(\xi)] ]}\; d\eta\; dx. \]
    %
    Now since $b_1$ vanishes on $\Lambda$, which is where the integral above is stationary, this quantity differs from
    %
    \[ \int \{ b_{\leq 0}(x,\eta) J(\eta) \} e^{2 \pi i [\eta \cdot x - H(\eta)]}\; d\eta \]
    %
    by a Schwartz function. But now a dyadic decomposition and stationary phase implies that this quantity is a symbol of order $m - d/4$ in the $\xi$ variable. Applying induction, it follows that for any $P_1,\dots,P_N$ of the form above, the function
    %
    \[ (P_1 \circ \dots \circ P_N) I_{a,\phi} \]
    %
    has the property that it's Fourier transform is equal to a symbol $c$ of order $m - d/4$, times $e^{-2 \pi i H(\xi)}$. But then for all $j > 0$,
    %
    \[ \left( \int_{|\xi| \sim 2^j} |c(\xi)|^2\; d\xi \right)^{1/2} \lesssim 2^{j(m + d/4)}, \]
    %
    which is sufficient to conclude that $(P_1 \circ \dots \circ P_N) I_{a,\phi} \in I^m(M,\Lambda)$.
\end{proof}

The \emph{equivalence of phase theorem} now follows from the fact that \emph{any} Lagrangian distribution is given by an oscillatory integral of the form above.

\begin{lemma}
    Suppose that $\Lambda \subset T^* \RR^d$ is a Lagrangian distribution of the form
    %
    \[ \Lambda = \{ (\nabla H(\xi), \xi) : \xi \in \RR^d \} \]
    %
    for some homogeneous, smooth function $H$. Then if $u \in H^m_c(\RR^d, \Lambda)$, then $e^{2 \pi i H(\xi)} \widehat{u}(\xi)$ is a symbol of order $m - d/4$.
\end{lemma}
\begin{proof}
    TODO: See Sogge, ``Fourier Integrals in Classical Analysis'', Proposition 6.1.1.
\end{proof}

\begin{theorem}
    Let $\Lambda \subset T^*M$ be a Lagrangian submanifold, and fix $(x_0,\xi_0) \in \Lambda$. Let $\phi$ be a nondegenerate phase function, such that $\Lambda_\phi$ agrees with $\Lambda$ on a small neighborhood of $(x_0,\xi_0)$. Then for any $u \in I^m(M, \Lambda)$, with $\text{WF}(u)$ contained in a sufficiently small neighborhood of $(x_0,\xi_0)$, can be written, modulo an element of $C^\infty(M)$, can be written as $I_{a,\phi}$ for some symbol $a$ of order $m + d/4 - p/2$.
\end{theorem}
\begin{proof}
    TODO: See Sogge, ``Fourier Integrals in Classical Analysis'', Proposition 6.1.4.
\end{proof}

Let us conclude this section by using the equivalence of phase to discuss the \emph{reduction} of $\theta$ variables. Given any Lagrangian submanifold $\Lambda$, and any $u \in I^m(M, \Lambda)$, it is of interest to determine an oscillatory integral representation of $u$ with as few phase variables as possible. To do this, consider any representation given locally in coordinates in terms of a non-degenerate phase function $\phi: U \times \RR^p_\theta \to \RR$. Consider the projection maps $\Pi_\Lambda: \Lambda_\phi \to U$ and $\Pi_\Sigma: \Sigma_\phi \to U$, then the non-degeneracy of $\phi$ and the fact that $\Sigma_\phi$ is $d$ dimensional implies that
%
\[ \dim ( \text{Ker} (\Pi_\Lambda)_* ) = d - \text{Rank} (\Pi_\Lambda)_*. \]
%
However, if a tangent vector $\nu$ is in the kernel of $(\Pi_\Lambda)_*$, we can write it as $\nu = \sum \nu_i d\theta^i$, where $(H_\theta \phi) \nu = 0$. But the dimension of this space of tangent vectors is precisely $p$ minus the rank of $H_\theta \phi$. Thus we conclude that
%
\[ p - \text{Rank}(H_\theta \phi) = d - \text{Rank} (\Pi_\Lambda)_*. \]
%
This inequality can be used to reduce $\theta$ variables, if the rank of $(\Pi_\Lambda)_*$ is large. Let $r = \text{Rank}(H_\theta \phi)$. TODO: See Sogge, Remark following Proposition 6.1.5. Then we can consider a phase function parameterizing $\Lambda$ locally with only $p - r$ variables. In particular, if the rank of $(\Pi_\Lambda)_*$ is constant, and equal to $r$ everywhere, then $X = \Pi_\Lambda(\Lambda)$ is an $r$ dimensional submanifold of $M$. We then say that $I^m(\Lambda,M)$ is the space of \emph{conormal distributions} to $X$ of order $m$, since one can see that $\Lambda$ is then the conormal bundle of $X$, given the assumption that $\Lambda$ is Lagrangian.

\begin{example}
    We will later see in the theory of Fourier integral operators that on a compact manifold $M$ equipped with a self-adjoint, positive-semidefinite elliptic pseudodifferential operator $P$ of order one, we can approximate the half-wave propogators $e^{itP}$ for small $t$, modulo $C^\infty$ functions, by an operator with kernel $K_t$ in $I^0(M \times M,\Lambda)$, where
    %
    \[ \Lambda = \{ (x,y;\xi,\eta) : (y,-\eta) = \Phi_t(x,\xi) \}, \]
    %
    and where $\{ \Phi_t \}$ is the phase flow for the Hamiltonian vector field associated with the principal symbol $p$ of $P$. Under the assumption that the cospheres
    %
    \[ \{ \xi: p(x,\xi) = 1 \} \]
    %
    have non-vanishing Gaussian curvature, $H_\xi \phi$ has rank $d-1$. But this means that we should be able to locally find a one-dimensional non-degnerate phase function $\psi$, such that $\Lambda_\psi$ agrees with $\Lambda$ locally, and so there exists a symbol $b(t,x,y,s)$ of order $\mu = (d-1)/2$ in the $s$ variable, such that $K_t(x,y)$ is a finite sum of oscillatory integrals of the form
    % d/4 - 1/2
    \[ K_t(x,y) = \int b(t,x,y,s) e^{2 \pi i \psi(t,x,y,s)}\; ds. \]
    %
    In the special case where $M$ is Riemannian, and $P = \sqrt{-\Delta}$, one can use the fact that $\Phi_t$ is the geodesic flow to show $\psi(t,x,y,s) = s \cdot a(t,x,y) \cdot ( |t| - d_g(x,y) )$ for some non-vanishing function $a$.
    % |t| = d_g(x,y)
    % xi = - s a(t,x,y) nabla_x d_g(x,y)
    % eta = - s a(t,x,y) nabla_y d_g(x,y)
    % (y, a(t,x,y) nabla_y d_g(x,y) ) = Phi_t ( x, a(t,x,y) [ -nabla_x d_g(x,y)] ) 
    % 
\end{example}

\section{Local Symplectic Geometry}

Before we get into the general theory of Fourier integral operators, let's recall some results in the theory of symplectic geometry. We recall that a \emph{symplectic vector space} $V$ is a finite dimensional vector space equipped with a non-degenerate, skew-symmetric bilinear form $\omega$. A fundamental example is that for any vector space $W$, $V = W^* \oplus W$ is naturally a symplectic vector space with the symplectic form $\omega((x^*_1,x_1),(x^*_2,x_2)) = x^*_2(x_1) - x^*_1(x_2)$. Spectral theory can be used to show that for any symplectic vector space $V$, $V$ is even dimensional, and that we can find a pair of independent sets $\{ e_i \}$ and $\{ f^i \}$, forming a basis of $V$, such that $\omega(e_i,e_j) = \omega(f^i,f^j) = 0$, and $\omega(e_i,f^i) = 1$. Such a basis is called a \emph{Darboux basis}, and we conclude from it's existence that all symplectic vector spaces of the same dimension are isomorphic.

A \emph{Lagrangian subspace} of a symplectic vector space $V$ is a subspace $W$ of $V$ such that $W^\perp = W$, where
%
\[ W^\perp = \{ x \in V : \omega(x,x') = 0\ \text{for all}\ x' \in W \}. \]
%
A subspace $W$ is Lagrangian if and only if $\dim(W) = \dim(V) / 2$, and for any $w_1,w_2 \in W$, $\omega(w_1,w_2) = 0$. As an example, if we write $V = V_e \oplus V_f$, where $V_e$ and $V_f$ are the spans of the separate parts of a Darboux basis, then $V_e$ and $V_f$ are Lagrangian subspaces. If $A: W \to W^*$ is a linear map, then the graph $\Gamma_A = \{ (x,Ax) : x \in W \}$ is a Lagrangian submanifold of $W \oplus W^*$ if and only if $A$ is self-adjoint, where we identify $W^{**}$ with $W$, i.e. if $\langle Ax_1, x_2 \rangle = \langle x_1, Ax_2 \rangle$ for all $x_1,x_2 \in W$.

\begin{lemma}
    Let $V$ be a symplectic vector space, and let
    %
    \[ \{ e_1, \dots, e_{n_1} \} \cup \{ f^1, \dots, f^{n_2} \} \]
    %
    be linearly independent vectors such that $\omega(e_i,e_j) = \omega(f^i,f^j) = 0$, and $\omega(e_i,f^j) = \delta(i,j)$. Then we can extend these sets to a full Darboux basis for $V$.
\end{lemma}
\begin{proof}
    Suppose first that $n_1 < n_2$. Since $\omega$ is non-degenerate, we can find a vector $e$ such that $\omega(e,e_i) = 0$ for $1 \leq i \leq n_1$, and $\omega(e,f^i) = \delta(i,n_1 + 1)$. It follows that $e$ is linearly independent from the previously selected elements of the basis and we can set $e_{n_1 + 1} = e$. Thus we can increase $n_1$ by one. A similar argument works for choosing $f_{n_2 + 1}$ if $n_2 < n_1$. If $n_1 = n_2$, and we don't yet have a basis, then we choose $e = e_{n_1 + 1}$ linearly independent to the previous set such that $\omega(e,e_i) = \omega(e,f^i) = 0$. Iterating this selection procedure yields the required Darboux basis.
\end{proof}

\begin{lemma}
    If $V_0$ and $V_1$ are Lagrangian subspaces of a symplectic vector space $V$, then we can find a third Lagrangian subspace $V_2$ which is transverse to both $V_0$ and $V_1$.
\end{lemma}
\begin{proof}
    Let $V$ have dimension $2n$. It suffices to find a Darboux basis in which
    %
    \[ V_0 = \text{span}(e_1,\dots,e_n) \quad\text{and}\quad V_1 = \text{span}(e_1,\dots,e_k,f^{k+1},\dots,f^n), \]
    %
    since we can then set $V_2$ to be the space spanned by $\{ e_i + f^i : k+1 \leq i \leq n \} \cup \{ f^1, \dots, f^k \}$. To do this, we pick $\{  e_1, \dots, e_n \}$ such that $\{ e_1, \dots, e_k \}$ spans $V_0 \cap V_1$, and $\{ e_1,\dots, e_n \}$ spans $V_1$. Next, we note that the map $T: V_0 \to \RR^{n-k}$ given by
    %
    \[ Tv = (\omega(e_{k+1},v), \dots, \omega(e_n,v)) \]
    %
    has kernel equal to $V_0 \cap V_1$. This is because $V_0^\perp = V_0$, so if $v \in V_1$, then we automatically obtain that $\omega(e_1,v) = \dots = \omega(e_k,v) = 0$, so that if $Tv = 0$, then $v \in V_0^\perp = V_0$. But this means that $T$ is surjective, so we can find $\{ f^{k+1},\dots,f^n \} \subset V_1$ such that $\omega(e_i,f_j) = \delta(i,j)$. It follows that $\{ e_1,\dots,e_k \} \cup \{ f^{k+1},\dots,f^n \}$ are linearly independent, and thus form a basis for $V_1$. And we can now use the previous Lemma to extend these vectors to a Darboux basis.
\end{proof}

If $V_X$ and $V_Y$ are symplectic vector spaces, then $V_X \oplus V_Y$ can be made into a symplectic vector space, if we equip it either with with the symplectic form $\omega_X - \omega_Y$, or with $\omega_Y - \omega_X$. In either case, we call a Lagrangian subspace $C$ of $V_X \oplus V_Y$ a \emph{linear canonical relation}. We recall that a \emph{symplectic linear map} $A: V_1 \to V_2$ between symplectic vector spaces is a map preserving the symplectic form.

\begin{lemma}
    Let $C \subset V_X \oplus V_Y$ be a linear canonical relation. Then we can find orthogonal decompositions $V_X = V_{X,1} \oplus V_{X,2}$ and $V_Y = V_{Y,1} \oplus V_{Y,2}$ such that
    %
    \[ C = C_X \oplus \Gamma \oplus C_Y, \]
    %
    where $C_X$ is a Lagrangian submanifold of $V_{X,1}$, $C_Y$ is a Lagrangian submanifold of $V_{Y,1}$, and $\Gamma$ is the graph of a symplectic isomorphism $A: V_{X,2} \to V_{Y,2}$.
\end{lemma}
\begin{proof}
    Let
    %
    \[ C_X = \{ x \in V_X : (x,0) \in C \} \quad\text{and}\quad C_Y = \{ y \in V_Y : (0,y) \in C \}. \]
    %
    Because $C$ is Lagrangian, $C$ is contained in $C_X^\perp \oplus C_Y^\perp$. In other words, if $x_1 \in C_X$, $y_1 \in C_Y$, and $(x_2,y_2) \in C$, then
    %
    \[ \omega(x_1,x_2) = \omega(y_1,y_2) = 0. \]
    %
    In particular, $C_X \subset C_X^\perp$ and $C_Y \subset C_Y^\perp$. Find orthogonal $V_{X,2}$ and $V_{Y,2}$ such that
    %
    \[ C_X^\perp = C_X \oplus V_{X,2} \quad\text{and}\quad C_Y^\perp = C_Y \oplus V_{Y,2}. \]
    %
    Then $C \subset C_X \oplus C_Y \oplus (V_{X,2} \oplus V_{Y,2})$. We can thus find $\Gamma \subset V_{X,2} \oplus V_{Y,2}$ such that $C = C_X \oplus C_Y \oplus \Gamma$. We claim $\Gamma$ projects bijectively onto $V_{X,2}$ and $V_{Y,2}$. For instance, suppose $x \in V_{X,2}$ and $y_1,y_2 \in V_{Y,2}$ are such that $(x,y_1)$ and $(x,y_2)$ lie in $\Gamma$. Then $(0,y_1 - y_2)$ lies on $\Gamma$ and on $C_Y$, so by orthogonality, $y_1 = y_2$. Thus $\Gamma$ is the graph of a symplectic isomorphism $A:V_{X,2} \to V_{Y,2}$. To define $V_{X,1}$ and $V_{Y,1}$, let
    %
    \[ \dim(V_X) = 2n \quad \dim(V_Y) = 2m \quad \dim(C_X) = a \quad \dim(C_Y) = b. \]
    %
    We can then consider Darboux bases
    %
    \[ \{ e_{X,1}, \dots, e_{X,n} \} \cup \{ f_{X,1}, \dots, f_{X,m} \} \]
    %
    and
    %
    \[ \{ e_{Y,1}, \dots, e_{Y,m} \} \cup \{ f_{Y,1}, \dots, f_{Y,m} \} \]
    %
    for $V_X$ and $V_Y$, such that
    %
    \[ C_X = \text{span} ( \{ e_{X,1}, \dots, e_{X,a} \} ) \]
    %
    and
    %
    \[ C_Y = \text{span} ( \{ e_{Y,1}, \dots, e_{Y,b} \} ). \]
    %
    But then we immediately see that
    %
    \[ V_{X,2} = \text{span}( \{ e_{X,a+1}, \dots, e_{X,n} \} \cup \{ f_{X,a+1}, \dots, f_{X,n} \} ) \]
    %
    and
    %
    \[ V_{Y,2} = \text{span}( \{ e_{Y,b+1}, \dots, e_{Y,m} \} \cup \{ f_{Y,a+1}, \dots, f_{Y,m} \} ). \]
    %
    We then simply define
    %
    \[ V_{X,1} = \text{span}( \{ f_{X,1}, \dots, f_{X,a} \}  ) \]
    %
    and
    %
    \[ V_{Y,1} = \text{span}( \{ f_{Y,1}, \dots, f_{Y,b} \} ), \]
    %
    and the remaining parts of the proof follow immediately.
\end{proof}

A \emph{symplectic manifold} $M$ is a manifold equipped with a symplectic two form $\omega$, i.e. a two form which gives each of the tangent spaces of $M$ a symplectic structure. The basic example here is $M = T^* X$, where $X$ is any smooth manifold; the natural two form here is
%
\[ \omega = dx \wedge d\xi = d \theta, \]
%
where $\theta = \sum \xi_i dx^i$ is the \emph{tautological one form} on $T^* M$. It has the property that for any section $s: M \to T^* M$, we have $s^* \theta = s$.

Like with the Riemannian form on a Riemannian manifold, the symplectic form on a symplectic manifold gives us a natural bundle isomorphism $J: T^*M \to TM$. In particular, given a function $f : M \to \RR$, we can define the \emph{symplectic gradient} $\nabla_{\Xi} f$ as the vector field which is identified under the bundle isomorphism with the covector field $df$. As an example, if $M = T^* X$, then in local coordinates $(x,\xi)$ on $T^* X$, the identification is given by
%
\[ J(d\xi^i) = \frac{\partial}{\partial x^i} \quad\text{and}\quad J \left( dx^i \right) = - \frac{\partial}{\partial \xi^i}. \]
%
Thus for a function $f: T^* X \to \RR$, we have
%
\[ \nabla_{\Xi} f = \sum \frac{\partial f}{\partial \xi^i} \frac{\partial}{\partial x^i} - \frac{\partial f}{\partial x^i} \frac{\partial}{\partial \xi^i}. \]
%
This gradient is closely related to the theory of Hamiltonian vector fields, i.e. since, given a Hamiltonian $H$ on some phase space representing a physical system, $\nabla_{\Xi} H$ gives the Hamiltonian flow of that physical system. We can define the \emph{Poisson bracket} of two functions $f,g: M \to \RR$ by setting $\{ f, g \} = \nabla_\Xi f (g) = dg ( \nabla_\xi f)$. For $M = T^* X$, we can write this in coordinates as
%
\[ \{ f, g \} = \sum \frac{\partial f}{\partial \xi_i} \frac{\partial g}{\partial x_i} - \frac{\partial f}{\partial x_i} \frac{\partial g}{\partial \xi_i}, \]
%
which agrees with the classical Poisson bracket.

A (immersed) \emph{Lagrangian submanifold} of a symplectic manifold $M$ is a submanifold $N$ such that it's tangent space is a Lagrangian subspace of the tangent space of $M$ at each point. To check that an immersion $i: X \to M$ gives a Lagrangian submanifold, it suffices to show that $i^* \omega = 0$, and that $\dim(X) = \dim(M)/2$. We have already seen these kinds of subspaces in our discussion of oscillatory integral distributions, since the wavefront sets of these distributions form Lagrangian submanifolds of the cotangent space of the space the distributions live on. Another example includes particular kinds of sections $X \to T^* X$.

\begin{lemma}
    The image of a section $s: X \to T^* X$ is an immersed Lagrangian submanifold if and only if locally we can write
    %
    \[ s = d f \]
    %
    for some function $f: X \to \RR$.
\end{lemma}
\begin{proof}
    If $\theta = \sum \xi^i dx^i$, then $d\theta$ is the symplectic form $\omega$, and $s^* \theta = s$. Thus $s$ gives a Lagrangian manifold if and only if $s^* \omega = s^*(d \theta) = d(s^* \theta) = ds = 0$. The result above now follows by Poincar\'{e}'s Lemma.
\end{proof}

A similar result holds if $\Lambda$ is a conic Lagrangian submanifold of $T^* X$.

\begin{lemma}
    Suppose that $\Lambda \subset T^* X - \{ 0_X \}$ is a conic Lagrangian manifold containing some covector $(x_0,\nu) \in T^* X$. Then local coordinates $(x,U)$ can be chosen, centered at $x_0$, inducing coordinates $(x,\xi)$ on $T^* U$, such that the map $(x,\xi) \mapsto \xi$ is a diffeomorphism in an open neighborhood of $(x_0,\xi_0)$ in $\Lambda$, and there exists a smooth, homogeneous function $H$ such that, in a small neighborhood of $(x_0,\xi_0)$ in $T^* X$, $\Lambda$ is equal to the set of all pair $(\nabla H(\xi), \xi)$.
\end{lemma}
\begin{proof}
    We first choose coordinates $(x,U)$ such that $(x,\xi) \mapsto \xi$ is a diffeomorphism. Begin by choosing coordinates $(y,V)$ centered at $x_0$ such that $\nu = dy_1$. The tangent plane $V_0$ to $\Lambda$ at $\nu$ must be Lagrangian. If $V_0$ is transverse to the Lagrangian plane given in $(y,\eta)$ coordinates by
    %
    \[ V_1 = \{ (0,a) : a \in \RR^d \}, \]
    %
    then we can set $x$ to be $y$. Otherwise, we find $V_2$ Lagrangian and transverse to both $V_0$ and $V_1$. Since $V_2$ is transverse to $V_1$, it can be identified with a linear section, and the last result thus implies that we can find a quadratic form $Q: \RR^d \to \RR^d$ such that 
    %
    \[ V_2 = \{ (a,dQ(a)) : a \in \RR^d \}. \]
    %
    If we set $x_1 = y_1 + Q(y)$, and $x_i = y_i$ for $2 \leq i \leq n$, then these are the required coordinates.

    We claim now that if $(x,U)$ gives a diffeomorphism, then we can find $H$. Shrinking $U$ if necessary, there exists a radial $\phi: \RR^d \to U$ such that
    %
    \[ \Lambda \cap U = \{ (\phi(\xi), \xi) : \xi \in \RR^d \}. \]
    %
    Since $\Lambda$ is Lagrangian, if $\psi(\xi) = (\phi(\xi),\xi)$, then
    %
    \[ \psi^* \theta = \sum \xi_i d\phi_i = 0. \]
    %
    If we set $H(\xi) = \sum \xi_i \phi_i(\xi)$, then $\nabla H = \phi$, giving the required result.
\end{proof}

The structure of linear canonical relations can give us results about `nonlinear' canonical relations, i.e. a conic Lagrangian submanifold of $T^* X \times T^* Y$ for two manifolds $X$ and $Y$.

\begin{lemma}
    Let $X$ and $Y$ be smooth manifolds, and let $\mathcal{C}$ be a conic Lagrangian submanifold of $T^* X \times T^* Y$. Fix $(x_0,y_0;\xi_0,\eta_0) \in \mathcal{C}$, and assume that the vector
    %
    \[ \xi_0 \frac{\partial}{\partial \xi} + \eta_0 \frac{\partial}{\partial \eta} \]
    %
    is not tangent to $\mathcal{C}$. Then $X$ and $Y$ have coordinate systems $x = (x',x'')$ and $y = (y',y'')$ centered at $x_0$ and $y_0$, such that $\xi_0 = (1,\dots,0)$, $\eta_0 = (1,\dots,0)$, and the tangent plane to $\mathcal{C}$ is given by
    %
    \[ dx' = dy' \quad\text{and}\quad d\xi' = d\eta' \quad\text{and}\quad d\xi'' = 0 \quad\text{and}\quad d \eta'' = 0. \]
    %
    Then $(x',x'',\eta',y'')$ can be used as local coordinates for $\mathcal{C}$, and we can find a phase function $\phi(x',x'',y'',\eta')$ such that $C$ is parameterized by $\phi$, in the sense that $\mathcal{C}$ locally agrees with $\Lambda_\phi$ on the coordinate system.
\end{lemma}

\section{Local Theory}

Let us recall the theory of oscillatory integral distributions. Let $U \subset \RR^n$ be open. Consider a real-valued phase function $\phi \in C^\infty(U_x \times \RR^p_\theta)$, homogeneous in the $\theta$ variable, and such that $\nabla_{x,\theta} \phi$ is non-vanishing on the support of a symbol $a \in S^m(U \times \RR^p)$. Then we can define a distribution $u$, formally speaking, by the equation
%
\[ u(x) = \int_{\RR^p} a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta. \]
%
If we consider the conic set
%
\[ \Sigma_\theta = \{ (x,\theta) \in U \times \RR^p : \nabla_\theta \phi(x,\theta) = 0 \}, \]
%
then $\text{WF}(u) \subset \Sigma_\theta$. Let us now assume the phase is \emph{nondegenerate}, in the sense that whenever $\nabla_\theta \phi = 0$, $D_{x,\theta} (\nabla_\theta \phi)$ is an invertible matrix. Then $\Sigma_\theta$ will be an $n$ dimensional manifold in $U \times \RR^p$, and the map $\Sigma_\theta \to T^* U$ given by $(x,\theta) \mapsto \nabla_x \phi(x,\theta)$ will be an immersion, which we will denote by $\Lambda_\theta$. This immersed manifold will be a \emph{Lagrangian submanifold} of $T^* U$, in the sense that the Tangent spaces $W$ at each point of $\Lambda_\theta$ will satisfy $W^\perp = W$ with respect to the symplectic form $d\xi \wedge dx$.

A \emph{Fourier integral operator} is a continuous operator $T: C_c^\infty(Y) \to \mathcal{D}^*(X)$ whose Schwartz kernel $K$ is given, modulo a smoothing kernel, by a sum of oscillatory integral distributions of the form
%
\[ K(x,y) = \int_{\RR^p} a(x,y,\theta) e^{2 \pi i \phi(x,y,\theta)}\; d\theta, \]
%
for some symbol $a \in S^\mu(X \times Y \times \RR^N)$. It's \emph{canonical relation} is
%
\[ C_\phi = \{ (x,y; \nabla_x \phi(x,y,\theta), - \nabla_y \phi(x,y,\theta) ) : \nabla_\theta \phi(x,y,\theta) = 0 \}, \]
%
which roughly speaking, tells us how $T$ moves wave packets around in phase space. The \emph{order} of the operator is $\mu - n/4 + p/2$; this strange choice might be better understood if $\phi(x,y,\xi) = (x - y) \cdot \xi$, in which case the Fourier integral operator is actually a pseudodifferential operator, and then the two orders agree with one another. TODO: More intuitive explanation, maybe using stationary phase?

\begin{example}
    The solution to the half-wave equation $\partial_t f = \sqrt{-\Delta} f$ on $\RR^d$ is given by the equation
    %
    \[ e^{i t \sqrt{-\Delta}} f = \int e^{2 \pi i (\xi \cdot x + t |\xi|)} \widehat{f}(\xi) = \int e^{2 \pi i (\xi \cdot (x - y) + t |\xi|)} f(y)\; d\xi\; dy, \]
    %
    which is a Fourier integral operator which phase $\phi_t(x,y,\xi) = \xi \cdot (x - y) + t |\xi|$ and symbol $a_t(x,y,\xi) = 1$. Given two input functions $f_0$ and $f_1$, if we write
    %
    \[ f_+ = \frac{f_0 - i \sqrt{-\Delta}^{-1} f_1}{2}  \quad\text{and}\quad   f_- = \frac{f_0 + i \sqrt{-\Delta}^{-1} f_1}{2}, \]
    %
    then the function
    %
    \[ u(x,t) = e^{it \sqrt{-\Delta}} f_+ + e^{-i t \sqrt{-\Delta}} f_- \]
    %
    solves the wave equation $\partial_t^2 u = \Delta u$, with initial conditions
    %
    \[ u(x,0) = f_+ + f_- = f_0 \]
    %
    and
    %
    \[ \partial_t u(x,0) = i \sqrt{-\Delta} f_+ - i \sqrt{-\Delta} f_- = f_1. \]
    %
    Expanding out the definition of $u$, we obtain a sum of operators applied to $f_0$ an $f_1$, of the form
    %
    \[ Tf(x,t) \mapsto \int e^{2 \pi i (\xi \cdot x \pm t |\xi|)} |\xi|^{-j} \widehat{f}(\xi). \]
    %
    Each of these operators is a Fourier integral operator with canonical relation
    % 
    \[ C_\phi = \{ y \mp t \xi / |\xi|, y; \xi, \xi \}. \]
    %
    Similarily, one may define wave propogators on a compact Riemannian manifold $M$. Locally in coordinates, these propogators can be expressed as Fourier integral operators, with a very similar canonical relation, i.e.
    %
    \[ C_\phi = \{ \exp_y(t \xi / |\xi|), y; \xi, \xi \}, \]
    %
    so that singularities travel along geodesics.
\end{example}

\begin{example}
    Let $A_t$ be the spherical averaging operator, i.e. $A_t f(x)$ is the average of $f$ on a sphere of radius $t$ centered at $x$. We can write $A_t = f * \sigma_t$, where $\sigma_t$ is the surface measure of the sphere of radius $t$. Recall that stationary phase tells us that
    %
    \[ \widehat{\sigma}(\xi) = \sum_{\pm} e^{\pm 2 \pi i |\xi|} a_{\pm}(\xi) \]
    %
    for symbols $a_{\pm}$ of order $-(n-1)/2$. Thus we can write
    %
    \[ A_t f(x) = \sum_{\pm} \int e^{2 \pi i(\xi \cdot x \pm t |\xi|)} a_{\pm}(t \xi) \widehat{f}(\xi), \]
    %
    which relates the study of averaging operators to the theory of Fourier integral operators. Alternatively, if $\Phi(x,y,t) = |x - y|^2 / t^2 - 1$, then
    %
    \begin{align*}
        A_t f(x) &= \int \delta(\Phi(x,y,t)) f(y)\; dy\\
        &= \int e^{2 \pi i \lambda \Phi(x,y,t)} f(y)\; d\lambda\; dy.
    \end{align*}
    %
    Thus we can express $A_t$ in many different ways as Fourier integral operators.
\end{example}

The last example indicates an important problem with the theory of Fourier integral operators; there is a lack of uniqueness in the choice of phase defining the operator. Nonetheless, we have seen that the \emph{wavefront set} is essentially uniquely verified, because it is connected to the relation between $\text{WF}(Tu)$ and $\text{WF}(u)$, which do not need a phase representation to be defined. The \emph{equivalence of phase theorem} says that the canonical relation is essentially the only invariant of the representation of the operator as a Fourier integral; if two phases have the same canonical relations, then Fourier integral operators defined in terms of one phase can be converted into an operator defined in terms of the other operator, and one has an asymptotic formula relating the two symbols of the associated representations.

TODO: Merge these notes with later notes.

For some purposes, it has become convenient to determine the class of Lagrangian distributions in a representation independent way. A \emph{Lagrangian distribution} of order $m$ on a manifold $M$, associated with a Lagrangian submanifold $\Lambda$ of $T^*M$, is a distribution $u$ on $M$, such that for any $N > 0$, and any properly supported pseudodifferential operators $P_1,\dots,P_N$ of order one, with principal symbols vanishing on $\Lambda$, we have
%
\[ (P_1 \circ \dots \circ P_N) u \in H^\infty_{-m-n/4, \text{loc}}(M). \]
%
The set of all Lagrangian distributions of order $m$ is denoted $I^m(M,\Lambda)$. The condition above means, roughly, that one can differentiate $u$ in directions away from $\Lambda$ while maintaining the regularity of $u$. In particular, applying some kind of Sobolev embedding gives that if $u \in I^m(M,\Lambda)$, then $\text{WF}(u) \subset \Lambda$. It will be easy to see what kinds of distributions are Lagrangian once we prove the equivalence of phase theorem, which allows one to reduce the study of Lagrangian distributions to oscillatory integrals like the ones above.

%\begin{example}
%    Let $P$ be a pseudodifferential operator of order $m$ on a manifold $M$ with symbol $a$, and let
    %
%    TODO: Prove that $P$ is a Lagrangian distribution.
    %
%    \[ K(x,y) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi \]
    %
%    be it's kernel. Then $\text{WF}(K)$ is contained in $\Lambda = \{ (x,x;\xi,-\xi) \}$. If $Q$ is a properly supported pseudodifferential operator on $M \times M$ with principal symbol vanishing on $\Lambda$, and we let $b$ be it's symbol in some local coordinates, then
%    %
%    \begin{align*}
%        Q \{ K \}(x,y) &= \int b(x,\xi) e^{2 \pi i [\xi \cdot (x - x') + \eta \cdot (y - y')]} K(x',y')\; d\xi\; dx'\; dy'\\
%        &= \int b(x,\xi) a(x',\xi') e^{2 \pi i [ \xi \cdot (x - x') + \eta \cdot (y - y') + \xi' \cdot (x' - y')]}\; d\xi'\; d\xi\; dx'\; dy'\\
%        &= \int b(x,\xi) a(x',\xi') e^{2 \pi i [ (\xi \cdot x + \eta \cdot y) - ((\xi - \xi') \cdot x' + (\eta + \xi') \cdot y')]}
%    \end{align*}
%\end{example}

The next lemma is useful for the proof of the equivalence of phase theorem, and is, in fact, a special case.

\begin{lemma}
    Suppose that $u$ is a compactly supported Lagrangian distribution in $I^m(\RR^n, \Lambda)$, where
    %
    \[ \Lambda = \{ (\nabla H(\xi), \xi) : \xi \in \RR^n \} \]
    %
    for some smooth, homogeneous function $H$. Then for $|\xi| \geq 1$, there exists a symbol $\nu \in S^{m-n/4}(\RR^n)$ such that
    %
    \[ \widehat{u}(\xi) = e^{- 2 \pi i H(\xi)} \nu(\xi), \]
    %
    i.e. so that formally speaking, $u$ is given by the oscillatory integral distribution.
    %
    \[ u(x) = \int \nu(\xi) e^{2 \pi i (\xi \cdot x - H(\xi))}\; d\xi \]
\end{lemma}
\begin{proof}
    TODO: 6.1.1 of Sogge.
\end{proof}

\begin{theorem}
    Let $\phi$ be a non-degenerate phase function defined on an open conic neighborhood of a point $(x_0,\xi_0) \in T^* \RR^n$, and consider the conic Lagrangian manifold $\Lambda_\phi$. If $a \in S^\mu(\RR^n \times \RR^p)$ is supported on a sufficiently small conic neighborhood of $(x_0,\xi_0)$, then the oscillatory integral distribution
    %
    \[ u(x) = \int a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
    %
    lies in $I^m(\RR^n, \Lambda)$, where $m = \mu - n/4 + p/2$. Moreover, there exists $\nu \in S^{m-n/4-1}$ such that
    %
    \[ \widehat{u}(\xi) = (2 \pi)^{n/2 - p/2} e^{-2 \pi i H(\xi)} \left( a(x,\theta) |\text{Det}(H \phi)|^{-1/2} e^{(i\pi/4) \text{sgn}(H\phi)} + \nu(\xi) \right), \]
    %
    where $(x,\theta)$ is the unique solution to the differential equation $\nabla_\theta \phi(x,\theta) = 0$ and $\nabla_x(x,\theta) = \xi$. Conversely, every Lagrangian distribution $u \in I^m(\RR^n, \Lambda)$ with $\text{WF}(u)$ contained in a small enough neighborhood of $(x_0,\xi_0)$ can be written in this form.
\end{theorem}

\begin{example}
    Let $\phi(x,y,\xi)$ be smooth away from $\xi = 0$, homogeneous of degree one, and satisfy
    %
    \[ \partial^\beta_\xi \{ \phi (x,y,\xi) - (x - y) \cdot \xi \} \lesssim_\beta |x - y|^2 |\xi|^{1-\beta}. \]
    %
    For any symbol $a \in S^m(\RR^n \times \RR^n)$ supported on $|x - y| \lesssim 1$ and $|\xi| \gtrsim 1$ in such a way that $|\nabla_\xi \phi| \gtrsim |x - y|$ and $|\nabla_x \phi | \gtrsim |\xi|$ on the support of $a$, define
    %
    \[ K(x,y) = \int a(x,y,\xi) e^[2 \pi i \phi(x,y,\xi)]\; d\theta \]
    %
    We have seen one proof that $K$ is a pseudodifferential operator. Let's give another proof using the equivalence of phase theorem. The distribution $K$ is defined by an oscillatory integral distribution with $\Sigma_\phi$ contained in $\{ (x,x;\xi) : x \in \RR^n, \xi \in \RR^n \}$. The fact that $\phi(x,y,\xi) \approx (x - y) \cdot \xi$ means that the resulting Lagrangian manifold is then
    %
    \[ \Lambda_\phi = \{ (x,x; \xi, - \xi ) \}, \]
    %
    which is the same Lagrangian manifold associated pseudodifferential operators. To determine the Fourier transform of $K$ using equivalence of phase, fix $(x_0,\xi_0)$. Then at $p = (x_0,x_0;\xi_0,-\xi_0)$, the tangent space to $\Lambda_\phi$ is the span of
    %
    \[ \{ \partial_{x_i} + \partial_{y_i} \} \cup \{ \partial_{\xi_i} - \partial_{\eta_i} \}. \]
    %
    Let $V$ be the Lagrangian subspace of $T_p(T^* M)$ spanned by
    %
    \[ \{ (a,0,c,a + c) \} \]

    \[ \{ \partial_{\eta_i} \} \cup \{ \partial_{x_i} + \partial_{\xi_i} - \partial_{\eta_i} \} \]

    \[ e_1,\dots,e_n = \partial_{x_i} + \partial_{y_i} \]
    \[ e'_1,\dots,e_n' = \partial_{x_i} \]
    \[ f_i' = \partial_{\xi_i} - \partial_{\eta_i} \]
    \[ f_i = \partial_{\eta_i} \]


    $z^1 = \xi_0 dx - \xi_0 dy$

    Choose coordinates $\xi_0 dx - \xi_0 dy = dz^1$


    Now $u \in I^m(\RR^n, \Lambda_\phi)$. The result above says that
    %
    \[ \widehat{K}(\xi,\eta) = (2 \pi)^{n/2} e^{-2 \pi i H(\xi)} \]
\end{example}


\section{Fourier Integral Operators}

Pseudodifferential operators formalize the family of all operators that modulate the amplitude of wave packets. The theory of Fourier integral operators extends this theory by not only modulating the amplitude of wave packets, but also moving them around in phase space in a \emph{symplectic manner}, i.e. in a way which, roughly speaking, obeys the uncertainty principle. Basic examples of Fourier integral operators include the translation operators
%
\[ \text{Trans}_{x_0} f(x) = f(x - x_0), \]
%
modulation operators
%
\[ \text{Mod}_{\xi_0} f(x) = e^{2 \pi i \xi_0 \cdot x} f(x), \]
%
the change of variables operator $T_A$ associated with an invertible linear transformation $A: \RR^n \to \RR^n$, i.e. such that
%
\[ T_A f(x) =  |\det(A)|^{-1/2} f(A^{-1} x), \]
%
and the Fourier transform
%
\[ \mathcal{F}f(\xi) = \widehat{f}(\xi). \]
%
These four operators are all unitary, so might be thought of as preserving the amplitude of wave packets, but they move wave packets around in phase space in different ways:
%
\begin{itemize}
    \item The translation operators move wave packets in phase space according to the diffeomorphism
    %
    \[ \Phi(x,\xi) = (x + x_0, \xi). \]

    \item The modulation operators move packets in phase space according to the diffeomorphism
    %
    \[ \Phi(x,\xi) = (x,\xi + \xi_0). \]

    \item The change of variables operator moves packets in space according to the diffeomorphism
    %
    \[ \Phi(x,\xi) = (Ax, (A^T)^{-1} \xi). \]

    \item The Fourier transform move packets according to the diffeomorphism
    %
    \[ \Phi(x,\xi) = (\xi,-x). \]
\end{itemize}
%
All four of the diffeomorphisms $\Phi: T^* \RR^d \to T^* \RR^d$ are \emph{symplectomorphisms}, i.e. they preserve the symplectic form $\omega = \sum dx^i \wedge d\xi_i$, i.e. the bilinear form
%
\[ \omega((x_1,\xi_1), (x_2,\xi_2)) = \xi_2(x_1) - \xi_1(x_2), \]
%
which is the derivative of the \emph{tautological one form} $\theta = \sum \xi_i dx^i$, a fact very important to the tractability of the study of the associated operators, because of the uncertainty principle.

Let us see why this is essential. With any diffeomorphism $\Phi: T^* \RR^n \to T^* \RR^n$, we can try and construct a unitary operator $T_\Phi$ from $L^2(\RR^n)$ to itself, which roughly speaking, has the property that it maps a wave packet localized at a point $(x_0,\xi_0)$ to a wave packet localized near $\Phi(x_0,\xi_0)$. If we consider an pseudodifferential operator $S_a = a(x,D)$ with symbol $a$, then $S$ amplifies wave packets localized at $(x_0,\xi_0)$ by a quantity $a(x_0,\xi_0)$. Thus, morally speaking, we should expect the operator $T_\Phi^{-1} \circ S_a \circ T_\Phi$ to fix the location of wave packets, and amplify wave packets localized at $(x_0,\xi_0)$ by the quantity $a \circ \Phi$, i.e. so that
%
\[ T_\Phi^{-1} \circ S_a \circ T_\Phi \approx (a \circ \Phi)(x,D). \]
%
We should at least expect this to hold up to first order. If we have another operator $S_b$, then we should expect that, using the formula above, up to first order we should have
%
\begin{align*}
    [(a \circ \Phi)(x,D), (b \circ \Phi)(x,D)] &\approx [T_\Phi^{-1} \circ S_a \circ T_\Phi, T_\Phi^{-1} \circ S_b \circ T_\Phi]\\
    &\approx T_\Phi^{-1} \circ [S_a,S_b] \circ T_\Phi\\
    &\approx ([a,b] \circ \Phi)(x,D).
\end{align*}
%
Taking principal symbols of either side of the equation yields to the exact equation
%
\[ \{ a \circ \Phi, b \circ \Phi \} = \{ a, b \} \circ \Phi, \]
%
where $\{ f,g \} = \omega( \nabla f, \nabla g )$ is the Poisson bracket. But this means that the equation above can only be true if $\Phi^* \omega = \omega$, i.e. $\Phi$ is a symplectomorphism. In this case, the graph of $\Phi$, namely the set
%
\[ \Lambda_\Phi = \{ (x,y;\xi,\eta) : (x,\xi) = \Phi(y,\eta) \} \subset T^*(\RR^n \times \RR^n) \]
%
will be a Lagrangian submanifold of $T^* \RR^n_X \times T^* \RR^n_Y$ with respect to the symplectic form
%
\[ \omega_X - \omega_Y = \sum dx^i \wedge d\xi_i - dy^i \wedge d\eta_i. \]
%
The set $\Lambda_\Phi$ is called the \emph{canonical relation} of $\Phi$. To see that the canonical relation is Lagrangian, note that $T_{(x,y;\xi,\eta)} \Lambda_\Phi$ can be identified with pairs of tangent vectors
%
\[ v \in T_{(x,\xi)} (T^* \RR^n_X) \quad\text{and}\quad w \in T_{(y,\eta)} (T^* \RR^n_Y) \]
%
such that $v = \Phi_*(w)$, and $\omega_X(\Phi_*(w_1),\Phi_*(w_2)) = \omega_Y(w_1,w_2)$.
%since, once we identify each of the tangent spaces $T_p(T^* \RR^n \times T^* \RR^n)$ with $\RR^n \times \RR^n \times \RR^n \times \RR^n$ via the coordinate system $(dx, d\xi, dy, d\eta)$, then the tangent space to $\Lambda_\Phi$ at each point $(p,q) \in T^* \RR^n \times T^* \RR^n$ is the set of all pairs $(v_x, v_\xi, w_y, w_\eta)$ such that $(w_y, w_\eta) = D\Phi(q) (v_x,v_\xi)$, and then
%
%\[ \omega(v_x,v_\xi) - \omega(w_y,w_\eta) = \omega(v_x, v_\xi) - \omega(D\Phi(q)(v_x, v_\xi)) \]
%since the tangent space at each point is $(dx, d\xi) = D \Phi \cdot (dy, d\eta)$
% Phi^* omega (v,w) = omega( DPhi(v), DPhi(w)  ) = v^T DPhi^T M DPhi w = v^T M w
% so omega oplus -omega

The fact that we are reducing ourselves to the study of symplectomorphisms $\Phi$ gives us a hint as to how to define the resulting operator $T_\Phi$, at least microlocally. Intuitively speaking, our discussion above shows that the wave front set of the kernel of $\Phi$ must be contained in $\Lambda_\Phi$, because spectral singularities at a point $(y,\eta)$ will be moved to singularities at a point $(x,\xi)$, so we should expect that $\text{WF}(T_\Phi f) = \Lambda_\Phi \circ \text{WF}(f)$. We will see in the next section on \emph{oscillatory integral distribution} (one can also see the idea immediately from stationary phase heuristics) that an operator of the form
%
\[ T_\Phi f(x) = \int a(x,y,\theta) e^{2 \pi i \phi(x,y, \theta)} f(y)\; d\theta\; dy \]
%
would have this property, provided that we choose the \emph{phase function} $\phi: \RR^n_x \times \RR^n_y \times \RR^N_\theta \to \RR$ such that
%
\[ \Lambda_\Phi = \{ (x,y; - \nabla_x \phi(x,\theta), \nabla_y \phi(x,\theta) ) : \nabla_\theta \phi(x,y,\theta) = 0 \} \]

$\Lambda_\Phi$

%
\[ \int a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
%
have a wave-front set contained in $\Lambda_\phi = \{ (x,\nabla_x \phi(x,\theta)) : \nabla_\xi \phi(x) = 0 \}$, and, provided $\phi$ is non-degenerate, $\Lambda_\phi$ is a Lagrangian manifold. Thus, given a symplectomorphism $\Phi: T^* \RR^n \to T^* \RR^n$, if we can find a phase $\phi: \RR^n \times \RR^n \to \RR^n$ such that $\Lambda_\Phi = \Lambda_\phi$, then, modulo $C^\infty$ kernels, we might expect to find a symbol $a$ such that
%
\[ T_\Phi f(x) = \int a(x,y,\theta) e^{2 \pi i \phi(x,\theta)} f(y)\; d\theta\; dy. \]
%
More generally, we might not be able to find a phase $\phi$ that works globally for $\Phi$, but we can localize, and once localized, the symplectic structure of $\Lambda_\Phi$ will actually guarantee the existence of $\phi$. But this means that our operators might be given by finite sums of integral operators of the form above. We are now naturally reaching the study of general Fourier integral operators.

\section{Hyperbolic Equations}

Fourier integral operators were initially introduced to obtain parametrices for hyperbolic equations. To see how these arise, let us begin with a constant coefficient linear differential operator on $\RR_t \times \RR^n_x$, given by $P(\partial_t, D_x)$, where $P(\tau, \xi)$ is a polynomial, which we will assume can be written in the form $\tau^m + \tau^{m-1} Q_1(\xi) + \dots + Q_m(\xi)$, where $Q_i(\xi)$ is a polynomial of degree at most $i$. Then the hyperbolic equation is
%
\[ L = \partial_t^m + \partial_t^{m-1} Q_1(D_x) + \dots + \partial_t Q_{m-1}(D_x) + Q_m(D_x). \]
%
We note that here $\partial_t$ is the standard derivative operator, whereas $D_x^\alpha$ is the derivative operator, normalized by dividing by an appropriate power of $2 \pi i$ so that it is the Fourier multiplier of $\xi^\alpha$. We recall the Cauchy-Kovalevskaya theorem, which gives unique analytic solutions to the Cauchy problem $Lu = f$ given initial conditions $u_0,\partial_t u_0, \dots, \partial_t^{m-1} u_0$, given that $f$, and the initial conditions are analytic functions on $\RR^n$. But we are interested in more general existence results.

% partial_t (f1,...,fm-1) = ( f2,...,fm-1, - sum_{k = 1}^{m-1} Q_k(D_x) f_k )
% partial_t f = sum M_alpha D^alpha f
% partial_t g = sum M_alpha xi^alpha g
%             = N(xi) g

% g(xi,t) = e^{t N(xi)} g0(xi)
% Suppose that N(xi) always has n distinct eigenvalues
%     N(xi) has eigenvalues lambda_1(xi), ..., lambda_n(xi)
%           and eigenvectors v_1(xi), ..., v_n(xi)
% g_j(xi,t) = e^{t lambda_j(xi)} v_j(xi)
% g_j(xi,t) = e^{t lambda_j(xi)} Sum_i v_j(xi)_i E_i(xi,t)
% 


% partial_t f = sum M_alpha D^alpha_x f
% M_alpha is a d x d matrix for each alpha.
%
% partial_t f^ = (sum xi^alpha M_alpha) f^
% partial_t f^ = N(xi) f^
% f^ = e^{t N(xi)} f_0^ 
% 
% g = f^
% g = e^{t N(xi)} g_0
%
% Eigenfunction analysis of N(xi)?
% (Unique roots - strictly hyperbolic?)
% Then if g_lambda(xi) is an eigenvector of N(xi) with eigenvalue lambda(xi), then
% g(xi,t) = e^{t lambda(xi)} g_lambda(xi)
% 
% Then by linearity e^{t lambda(xi)} (g_lambda)_i = sum_j (E_j)_i (g_lambda)_j
% Then can invert the matrix of g_lambdas to get the E_i
% 

% Then by linearity, e^{t lambda(xi)} g_0(xi) = sum g_{0,i}(xi) E_i(xi,t) = sum g_{0,i} E_i
% Can be inverted to write E_i in terms of eigenvectors of N(xi) and the lambda(xi)
% To be tempered, e^{t lambda(xi)} g_0(xi) << |xi|^{O(1)}
% Re(lambda(xi)) << O(1)
%
% partial_t f = Delta f
% N(xi) = -|xi|^2
% lambda(xi) = -|xi|^2
% g(xi,t) = e^{- t |xi|^2} is good and tempered * in the future * .

The surprising feature of this problem is that these operators need not even have solutions if we switch from studying analytical initial conditions to say, compactly supported smooth initial conditions. For instance, suppose there exists a distribution $u$ on $\RR_t \times \RR_x$, tempered in the $x$-variable, such that $Lu = 0$, where $L = \partial_t - D_x$, and we let $u_0 \in \SW(\RR_x)^*$ be the initial value of the distribution. Then, taking Fourier transforms in the $x$ variable, we conclude that $\partial_t \widehat{u}(t,\xi) = \xi \widehat{u}(t,\xi)$, which implies that $\widehat{u}(t,\xi) = \widehat{u_0}(\xi) e^{\xi t}$. But this distribution is \emph{never} tempered in the $\xi$ variable; if it was tempered for one positive value of $t$, and one negative value of $t$, then we could conclude that
%
\[ |\widehat{u_0}(\xi)| \lesssim e^{- \varepsilon |\xi|} \]
%
for some $\varepsilon > 0$. But the Paley-Wiener theorem and it's variants therefore imply that $u_0$ is analytic, and actually extends to a holomorphic function on a small strip containing the real line. Thus the existence of solutions to the Cauchy problem $\partial_t u - Du = 0$ is very delicate; in particular, there are no solutions with initial conditions in $\DD(\RR_x)$. This hints at the fact that to make the solution to the Cauchy problem tractable, we must ensure that the polynomial $P(\tau,\xi) = 0$ have \emph{imaginary roots}. A desire to find a more powerful existence statement for solutions to such equations, tempered in the $x$-variable, will force us to choose polynomials $P(\tau,\xi)$ whose principal part has purely imaginary roots in the $\tau$ variable.

%Another kind of problem occurs if the polynomial $P(\tau,\xi) = 0$ has \emph{repeated roots}. For instance, if we consider the operator $L = (\partial_t - 2 \pi i D)^2$. If $u$ is tempered in the $x$-variable and solves the equation $Lu$ with initial conditions $u_0 \in \SW(\RR_x)^*$, then taking the Fourier transform leads to an expression of $u$ in the form
%
%\[ \widehat{u}(\xi,t) = \widehat{u_0}(\xi) e^{i \xi t} + \left( \partial_t \widehat{u}_0(\xi) - i \xi \widehat{u}_0(\xi) \right) t e^{i \xi t}. \]
%
%Taking inverse Fourier transforms implies that
%
%\[ u(x,t) = u_0(x + t/2\pi) + t \cdot \partial_t u_0(x + t/2\pi) - i t \cdot Du_0(x + t/2\pi). \]
%
%TODO

Let us discuss this situation more precisely. Let $\tilde{E}_0, \dots, \tilde{E}_{m-1}: \RR^n_\xi \times \RR_t \to \CC$ be the analytic solutions to the Cauchy problem $P(\partial_t,\xi) = 0$ with initial conditions
%
\[ \partial_t^i \tilde{E}_j(0,\xi) = \delta_{ij} \]
%
for $0 \leq i \leq m-1$. If we are to expect $P(\partial_t, D_x) = 0$ to be a well posed differential equation, then we should expect each solution $\tilde{E}_i$ to be tempered in the $\xi$ variable. We can calculate the functions $\{ \tilde{E}_i \}$ explicitly. If we fix $\xi_0$, and assume first that the roots of $P(\tau,\xi_0)$ in the $\tau$ variable are distinct, then the roots are distinct locally around $\xi_0$. If we let $\tau_1(\xi),\dots,\tau_m(\xi)$ be the roots of the equation, then these are analytic functions in the $\xi$ variable locally around $\xi_0$. The functions $h_i(t,\xi) = e^{i \tau_i(\xi) t}$ then satisfy the Cauchy problem $P(\partial_t,\xi) = 0$ with initial conditions
%
\[ \partial_t^i h_j(0,\xi) = \tau_j(\xi)^i \]
%
for $0 \leq i \leq m-1$. The uniqueness of analytic solutions guaranteed by the Cauchy-Kovalevsky theorem imply that
%
\[ h_i(t,\xi) = \tilde{E}_0(t,\xi) + \tilde{E}_1(t,\xi) \tau_i(\xi) + \dots + \tilde{E}_{m-1}(t,\xi) \tau_i^{m-1}(\xi). \]
%
If $\tilde{E} = (\tilde{E}_0,\dots,\tilde{E}_{m-1})$ and $h = (h_0,\dots,h_{m-1})$, then we can summarize this in the matrix equation
%
\[ h = \begin{pmatrix} 1 & \tau_1 & \dots & \tau_1^{m-1} \\ 1 & \tau_2 & \dots & \tau_2^{m-1} \\ \vdots & \ddots & \dots & \vdots \\ 1 & \tau_m & \dots & \tau_m^{m-1} \end{pmatrix} \tilde{E}. \]
%
Provided that the roots $\{ \tau_i \}$ are distinct, we can solve this equation to find the functions $\{ \tilde{E}_i \}$ in terms of the functions $\{ h_i \}$ using Cramer's rule. Namely, if $V(\tau_1,\dots,\tau_m)$ is the Vandermonde determinant, i.e. the determinant of the matrix $\{ \tau_i^j \}$, and if $V_i(\tau_1,\dots,\tau_m;t)$ is the determinant of the matrix obtained by replacing the $i$th column with the vector $\{ e^{t \tau_j(\xi)} \}$, then
%
\[ \tilde{E}_i(t,\xi) = \frac{V_i(\tau_1(\xi),\dots,\tau_m(\xi);t)}{V(\tau_1(\xi),\dots,\tau_m(\xi))}. \]
%
For instance, if $m = 2$, then
%
\[ \tilde{E}_1(t,\xi) = \frac{e^{t \tau_1(\xi)} \tau_2(\xi) - e^{t \tau_2(\xi)} \tau_1(\xi)}{\tau_2(\xi) - \tau_1(\xi)} \quad\text{and}\quad \tilde{E}_2(t,\xi) = \frac{e^{t \tau_2(\xi)} - e^{t \tau_1(\xi)}}{\tau_2(\xi) - \tau_1(\xi)} \]
%
Note that the function
%
\[ (\tau_1,\dots,\tau_m,t) \mapsto \frac{V_i(\tau_1,\dots,\tau_m;t)}{V(\tau_1,\dots,\tau_m)} \]
%
are analytic in $t$, symmetric in the variables $\{ \tau_i \}$, and \emph{entire} in the variables $(\tau_1,\dots,\tau_m) \in \CC^n$. For instance, in the case $m = 2$, when $\tau_1(\xi_0) = \tau_2(\xi_0) = \tau$ we have
%
\[ \tilde{E}_1(t,\xi_0) = e^{t \tau} (1 - t \tau) \quad\text{and}\quad \tilde{E}_2(t,\xi_0) = t e^{t \tau}. \]
%
Thus the equation we have constructed continues to specify the functions $\{ \tilde{E}_i \}$ even when the roots of $P$ in the $\xi$ variable are not distinct.

By virtue of the roots switching around, one cannot necessarily define the functions $h_1,\dots,h_n$ globally for all $\xi \in \RR^n$ if roots coincide. But quantities symmetric in the variables $\{ h_i \}$ are well defined, for instance, the function
%
\[ S(t,\xi) = |\text{Re}(h_1(t,\xi))| + \dots + |\text{Re}(h_n(t,\xi))|. \]
%
is globally defined. If $\tilde{E}_0,\dots,\tilde{E}_{m-1}$ are tempered in the $\xi$ variable, then it follows that the function $s$ is tempered in the $\xi$ variable, and thus satisfies some equation of the form
%
\[ |S(t,\xi)| \lesssim_t \langle \xi \rangle^{N_t} \]
%
for some $N_t > 0$. But this means that
%
\[ |\text{Re}(\tau_1(\xi))| + \dots + |\text{Re}(\tau_m(\xi))| \lesssim 1 + \log \langle \xi \rangle. \]
%
The theory of semialgebraic sets (which applies because $(\tau_1,\dots,\tau_m)$ are the projections onto the $\tau$ variable of solutions to the polynomial equation $P(\tau,\xi) = 0$) implies that this can only be possible if
%
\[ |\text{Re}(\tau_1(\xi))| + \dots + |\text{Re}(\tau_m(\xi))| \lesssim 1, \]
%
i.e. because we can only have polynomial growth on semialgebraic sets. This is actually a necessary and sufficient condition for the Cauchy problem to be solvable (a result of Garding). An operator with this property will be called \emph{hyperbolic}.

There is an equivalent specification of being hyperbolic which is very useful to the study of such equations. If $L = P(\partial_t, D_x)$ is a hyperbolic constant-coefficient partial differential equation of order $m$, then we can consider the degree $m$ polynomial $P_m(\tau,\xi)$. We claim the roots of $P_m$ in the $\tau$ variable differ from the roots of $P$ by at most $O(1)$ for $|\xi| \gg 1$. Note that this is the only part of the discussion where we have used the fact that the polynomials $Q_i$ have degree at most $i$. This means that the condition
%
\[ |\text{Re}(\tau_1(\xi))| + \dots + |\text{Re}(\tau_m(\xi))| \lesssim 1 \]
%
holds if and only if the roots of $P_m$ are all purely imaginary. Thus $P(\partial_t, D_x)$ is hyperbolic if and only if the roots of $P_m$ in the $\tau$ variable are all purely imaginary.

In addition, we say a differential operator $P(\partial_t, D_x)$ is \emph{strongly}, or \emph{strictly hyperbolic} if in addition to being hyperbolic, the imaginary roots of $P_m$ are all distinct from one another for all $\xi \in \RR^d$, which implies the roots of $P$ are distinct for large $\xi$. If we label the roots of $P_m$ as $i \lambda_1(\xi), \dots, i \lambda_m(\xi)$, then the functions $\{ \lambda_i \}$ are real-valued analytic functions in $\RR^n - \{ 0 \}$, which are homogeneous of degree one. Thus $|\lambda_i(\xi) - \lambda_j(\xi)| \gtrsim |\xi|$ for $i \neq j$.

TODO: Construct Parametrix.

\begin{remark}
    A similar phenomenon to the study of parametrices for hyperbolic equations arises in the study of the half-wave equation associated with positive semidefinite pseudodifferential operators. More precisely, if $P$ is a positive-semidefinite pseudodifferential operator of order one on a compact manifold $M$, then one can construct a parametrix to the half-wave equation
    %
    \[ \partial_t = 2 \pi i P \]
    %
    which also has an expression as a Fourier integral. This is done in more detail in the later parts of these notes on the geometry of eigenfunctions.
\end{remark}

\section{Propogation of Singularities}

One important relation between $u$ and $\text{WF}(u)$ is the \emph{propogation of singularities theorem}. If $u$ is a solution to a linear partial differential equation
%
\[ \sum_{|\alpha| \leq K} a_\alpha(x) (\partial_\alpha u)(x) = v \]
%
where $v$ is a distribution, then for any $(x,\xi) \in \text{WF}(u) - \text{WF}(v)$,
%
\[ q(x,\xi) = \sum_{|\alpha| \leq K} a_\alpha(x) \xi^\alpha = 0, \]
%
and $\text{WF}(u) - \text{WF}(v)$ is invariant under the flow generated by the Hamiltonian vector field
%
\[ H_{x,\xi} = \sum_{i = 1}^d \frac{\partial q}{\partial x^j} \frac{\partial}{\partial \xi^j} - \frac{\partial q}{\partial \xi_j} \frac{\partial}{\partial x^j}. \]
%
As a particular example, if $u(t,x,y)$ is a distributional solution to the wave equation $u_{tt} = \Delta u$ and we let $v_t(x,y) = u(t,x,y)$, then $\Delta v_t = u_{tt}$, and so by the propogation of singularities theorem $\text{WF}(v_t) \subset \text{WF}(u_{tt})$.

Then the Paley-Wiener theorem implies that $\widehat{u}$ is an analytic function on $\RR^d$. If $\widehat{u}$ decays rapidly, then $u$ is also a smooth function. However, even if $u$ is not smooth, $\widehat{u}$ may still decrease rapidly in certain directions, which implies that the singularities of $u$ `propogate' in certain directions and understanding these directions is often useful to understanding the distribution $u$. We can also get even more information about the distribution $u$ by looking at the singular frequencies.

To begin with, let 

To begin with, a distribution $u$ is \emph{nonsingular} at a point $x \in \RR^d$ if $u$ is locally a $C^\infty$ function in a neighbourhood of $x$, i.e. there exists a bump function $\phi \in C^\infty(\RR^d)$ with $\phi(x) \neq 0$ such that $\phi u \in C^\infty(\RR^d)$. The  \emph{singular support} of a compactly supported distribution $u$ to be the set of all points $x \in \RR^d$ upon which $u$ is not nonsingular.

\newpage

A degree $m$ constant coefficient linear differential operator $P(D)$ on $\RR^n$ is said to be of \emph{real principal type} if the principal symbol $P_m$ is a real-coefficient polynomial, and $\nabla P_m$ is non-vanishing on $\RR^n - \{ 0 \}$.

\begin{lemma}
    If $P(D)$ is a differential operator of real principal type, then there exists distributions $E_+$ and $E_-$ which are parametrices for $P$,
    %
    \[ \text{WF}(E_+) \subset (\{ 0 \} \times \RR^n) \cup \{ (t \cdot \nabla P_m(\xi), \xi) : t > 0, \xi \in \text{Char}(P), P_m(\xi) = 0 \}, \]
    %
    and
    %
    \[ \text{WF}(E_+) \subset (\{ 0 \} \times \RR^n) \cup \{ (t \cdot \nabla P_m(\xi), \xi) : t < 0, \xi \in \text{Char}(P), P_m(\xi) = 0 \}. \]
\end{lemma}



















\section{Littlewood Paley Theory}



% theta * nabla_x f = d * f

% Suppose nabla_theta f = 0
% We have phi = sum theta_i phi_{theta_i}
% So phi_x = sum theta_i phi_{x theta_i}
%   If phi_x != 0, then phi_{x,theta} != 0
%   If phi_x = 0 and phi_theta = 0, then
%       phi = 0
%       phi_x = sum theta_i phi_{x,theta_i}
%       So phi_{x,theta} * theta = 0
%       phi = |theta| r(x, omega)
%       So r = 0, r_x = 0, and r_omega = 0
% Let r(x,omega) = x (omega_1 - 1)
% Then when x = 0 and omega = e_1, r = 0 and r_x = omega - 1 = 0 and r_omega = 0, whereas r_{x,omega} != 0

%       - phi(x,theta) = theta phi(x, omega)
%           - phi vanishes, and radial derivatives of phi in the omega variable vanish.
%           - and first derivatives in x vanish.
%           - phi_x = sum theta_i phi_{x, theta_i}
%           So phi_{x,theta} vanishes in the radial direction
%               phi_x is homogeneous of degree one so

%       so phi = O(delta_x^2 + delta_theta^2 + delta_x delta_theta)
%       Homogeneity in theta implies that the delta_theta^2 term vanishes,
%       i.e. phi = O( delta_x^2 + delta_x delta_theta )

% If nabla_{x,theta} f = 0, does nabla_x f = 0?
% phi = sum theta_i d phi/d theta^i
% So phi vanishes whenever it is stationary, which makes sense.
% phi_x = sum theta_i nabla_{x,theta} phi
% So if nabla_x

% If nabla_{x,theta} f is nonvan

Let $T$ be a Fourier integral operator from an open set $U \subset \RR^n$ to $V \subset \RR^m$ associated with a Lagrangian distribution
%
\[ \Lambda \subset (T^* X - 0_X) \times (T^* Y - 0_Y). \]
%
Qualitatively speaking, wavefront set analysis tells us the following:
%
\begin{itemize}
	\item $T$ maps $\DD(X)$ into $\EC(Y)$.

	\item $T$ extends to a map from $\EC(X)^*$ into $\DD(Y)^*$.
\end{itemize}
%
Let's see some more quantitative consequences, namely, that we can apply \emph{Littlewood-Paley theory} to these operators.

It will be easiest to work locally in coordinates. We can therefore assume that $U$ and $V$ are open subsets of $\RR^n$ and $\RR^m$, and that $T$ has an integral expression of the form
%
\[ Tf(x) = \int \int_{\RR^p} a(x,y,\theta) e^{2 \pi i \phi(x,y,\theta)} f(y)\; dy\; d\theta, \]
%
where $\phi$ has the property that for any $(x,y,\theta) \in \msupp(a)$ with $\nabla_\theta \phi(x,y,\theta) = 0$, we have \emph{both} $\nabla_x \phi(x,y,\theta) \neq 0$ and $\nabla_y \phi(x,y,\theta) \neq 0$, and $a$ is a symbol of order $\mu$ in the $\theta$ variable, which (working modulo the family of smoothing operators), we may assume to be supported on a $\delta$ neighborhood of $\Lambda$. We fix a smooth, compactly supported function $\eta \in C_c^\infty(\RR^d)$ supported on $\{ 1/2 \leq |\xi| \leq 2 \}$, and consider the Littlewood-Paley cuttoff operator $L_k = \eta(D / 2^k)$. We now compute the operator
%
\[ L_{k_1} \circ T \circ L_{k_2}. \]
%
Firstly, we calculate that $L_{k_1} \circ T$ can be expressed as on oscillatory integral of the form
%
\[ \int a_{k_1}(x,y,\theta) e^{2 \pi i \phi(x,y,\theta)}\; d\theta, \]
%
where if $\phi_1(x,y,z,\theta) = \phi(z,y,\theta) - \phi(x,y,\theta) + (x - z) \cdot \nabla_x \phi(x,y,\theta)$, then
%
\begin{align*}
    a_{k_1}(x,y,\theta) &= e^{- 2 \pi i \phi(x,y,\theta)} \eta ( D / 2^{k_1} ) \{ e^{2 \pi i \phi(x,y,\theta)} a(x,y,\theta) \}\\
    &\sim \sum_\alpha \frac{1}{2^{|\alpha| k_1} \cdot \alpha!} (\partial^\alpha \eta) \left( \frac{\nabla_x \phi(x,y,\theta)}{2^{k_1}} \right) \left. D^\alpha_z \left\{ e^{2 \pi i \phi_1(x,y,z,\theta)} a(z,y,\theta) \right\} \right|_{z = x}.
\end{align*}
%
We therefore calculate that $L_{k_1} \circ T \circ L_{k_2}$ can be expressed as
%
\[ \int a_{k_1,k_2}(x,y,\theta) e^{2 \pi i \phi(x,y,\theta)}\; d\theta, \]
%
where, if $\phi_2(x,y,w,\theta) = \phi(x,w,\theta) - \phi(x,y,\theta) + (y - w) \cdot \nabla_y \phi(x,y,\theta)$, then
%
\begin{align*}
    a_{k_1,k_2}(x,y,\theta) &\sim \sum_\beta \frac{1}{2^{|\beta| k_2} \cdot \beta!} (\partial_\xi^\beta \eta) \left( - \frac{\nabla_y \phi(x,y,\theta)}{2^{k_2}} \right) \left. D^\beta_w \{ e^{2 \pi i \phi_2(x,y,w,\theta)} a_{k_1}(x,w,\theta) \} \right|_{w = y}\\
    &\sim \sum_{\alpha,\beta} \frac{1}{\alpha! \beta!} \frac{1}{2^{|\alpha| k_1 + |\beta| k_2}} (\partial_\xi^\beta \eta) \left( - \frac{\nabla_y \phi(x,y,\theta)}{2^{k_2}} \right)\\
    &\quad\quad\quad \left. D^\alpha_{z} D^\beta_w \left\{ e^{2 \pi i [ \phi_1(x,z,w,\theta) + \phi_2(x,y,w,\theta) ]} (\partial^\alpha \eta) \left( \frac{\nabla_x \phi(x,w,\theta)}{2^{k_1}} \right) a(z,w,\theta) \right\} \right|_{\substack{z = x \\ w = y}}.
\end{align*}
%
% phi_1(x,z',z,theta) + phi_2(x,y,z,theta)
% phi(z,z',theta) - phi(x,z',theta) + (x - z) nabla_x phi(x,z',theta)
%       + 
%    phi(x,z,theta) - phi(x,y,theta) + (z - y) nabla_y phi(x,y,theta)
% DOESN'T LOOK LIKE ANY IMMEDIATE CANCELLATION OCCURS
Now we apply our assumption. The set
%
\[ \{ (x,y,\theta) : |\theta| = 1, \nabla_\theta \phi(x,y,\theta) = 0 \} \] 
%
is compact. Applying this compactness, together with homogeneity, we can find $C > 0$ such that if $\nabla_\theta \phi(x,y,\theta) = 0$, then
%
\[ (C/2)^{-1} |\theta| \leq |\nabla_x \phi(x,y,\theta)| + |\nabla_y \phi(x,y,\theta)| \leq (C/2) |\theta|. \]
%
Modulo smoothing operators, we have $\text{supp}(a_{k_1,k_2}) \subset \text{supp}(a)$. Moreover, for $(x,y,\theta) \in \text{supp}(a)$, we can find $(x',y',\theta')$ such that $|\theta| = |\theta'|$,
%
\[ |x - x'| + |y - y'| + \frac{|\theta - \theta'|}{|\theta|} \leq \delta, \]
%
and $\nabla_\theta \phi(x',y',\theta) = 0$. If $\delta$ is chosen appropriately, depending only on $\phi$, we conclude that
%
\[ C^{-1} |\theta| \leq |\nabla_x \phi(x,y,\theta)| + |\nabla_y \phi(x,y,\theta)| \leq C |\theta|. \]
%
In order for $a_{k_1,k_2}$ to not be smoothing on a neighborhood of $(x,y,\theta)$, we therefore must have
%
\[ C^{-1} 2^{k_2 - 1} \leq |\theta| \leq C 2^{k_2 + 1}. \]
%
and
%
\[ C^{-1} 2^{k_1 - 1} \leq |\theta| \leq C 2^{k_1 + 1}, \]
%
i.e. so that the gradients $\nabla_x \phi$ and $\nabla_y \phi$ are contained in the support of $\eta(\cdot / 2^{k_1})$ and $\eta( \cdot / 2^{k_2} )$ respectively. But this is impossible if $|k_2 - k_1| \geq \log_2(4C^2)$. Thus we should expect in this circumstance that the operator $L_{k_1} \circ T \circ L_{k_2}$ is arbitrarily well behaved. Moreover, under this assumption we should expect that the kernel of $L_{k_1} \circ T \circ L_{k_2}$ is infinitely differentiable, and each derivative is $O_N( 2^{-N (k_1 + k_2)} )$ for all $N > 0$. This means that in regularity problems involving these operators, if we perform a decomposition
%
\[ T = \sum_{k_1,k_2} = L_{k_1} \circ T \circ L_{k_2}, \]
%
then we should only have to worry about the analysis of the components $L_{k_1} \circ T \circ L_{k_2}$ with $|k_1 - k_2| \lesssim 1$. By applying the triangle inequality (so that you can assume that non-zero Littlewood-Paley parts of the operator are sparse), or widening the support of the function $\eta$, we can actually assume that we have an equality of the form
%
\[ T \approx \sum_k L_k \circ T \circ L_k, \]
%
where the difference between the two sides is a smoothing operator.

A similar phenomenon happens in the study of spectral multipliers on a Riemannian manifold $M$.  It is then natural to simultaneously apply the Littlewood-Paley theory in coordinates, i.e. the operators $\{ L_k \}$, but in addition, Littlewood-Paley theory on the manifold, i.e. considering the operators $\{ L_k' \}$ given by the equation
%
\[ L_k' = \eta( P / 2^k ), \]
%
where $P$ is a classical self-adjoint positive-semidefinite elliptic pseudodifferential operator of order one, on $M$, with symbol compactly localized in space to the coordinate system $U$, such that in this coordinate system, $P$ has symbol $p$, and principal symbol $p_1$, and $\psi$ is another compactly supported smooth function on $M$ localizing the multiplier to a coordinate system. It is then natural to consider expressions of the form
%
\[ L_{k_1} \circ T \circ L_{k_2}'. \]
%
For two symbols $a$ and $b$, let
%
\[ a \circ b \sim \sum_\alpha \frac{1}{\alpha!} D_\xi^\alpha a \cdot \partial_x^\alpha b \]
%
be the composition operator obtained via the calculus of pseudodifferential operators. In Strichartz (1972), it is shown that $\eta( P / 2^k )$ is a pseudodifferential operator, and has a symbol $\tilde{\eta}_k$ which can be asymptotically expanded as
%
\[ \tilde{\eta}_k(x,\xi) \sim \sum_{m \leq n} \frac{(-1)^{m}}{m! (n-m)!} \frac{1}{2^{kn}} \{ (\partial_x^n \eta)( p_1 / 2^k ) p_1^m \} \circ \overbrace{(p \circ \dots \circ p)}^{n - m\ \text{times}}. \]
%
Thus, in particular, we have that
%
\[ |D^\alpha_x D^\beta_\xi \{ \tilde{\eta}_k(x, 2^k \xi) \}| \lesssim_{\alpha,\beta,N} \langle\xi \rangle^{-N}, \]
%
uniformly in $k$. Applying the composition calculus for FIOs, as above, shows that for $|k_1 - k_2| \gtrsim 1$, we also have that $L_{k_1} \circ T \circ L_{k_2}'$ is infinitely differentiable, and each derivative is $O_N( 2^{-N(k_1 + k_2)} )$.




\begin{comment}

alculate that the operator $L_{k_1} \circ T \circ L_{k_2}$ has a kernel $K_{k_1,k_2}$ of the form
	%
	\begin{align*}
		K_{k_1,k_2}(x,y) &= \int \left\{ \eta(\xi_1 / 2^{k_1}) e^{2 \pi i \xi_1 \cdot (x - w)} \right\}\\
		&\quad\quad\quad \left\{ a(w,z,\theta) e^{2 \pi i \phi(w,z,\theta)} \right\}\\
		&\quad\quad\quad\quad \left\{ \eta(\xi_2 / 2^{k_2}) e^{2 \pi i \xi_2 \cdot (z - y)} \right\}\\
		&\quad\quad\quad\quad\quad \; d\xi_1\; dw\; dz\; d\xi_2\; d\theta\\
		&= 2^{k_1 + k_2} \int a_{k_1,k_2}(w,z,\theta,\xi_1,\xi_2) e^{2 \pi i \Phi_{k_1,k_2}(x,w,z,y,\xi_1,\xi_2,\theta)}\; dw\; dz\; d\xi_1\; d\xi_2\; d\theta,
	\end{align*}
	%
	where
	%
	\[ a_{k_1,k_2}(w,z,\theta,\xi_1,\xi_2) = a(w,z,\theta) \eta(\xi_1) \eta(\xi_2) \]
	%
	and
	%
	\[ \Phi_{k_1,k_2}(x,w,z,y,\xi_1,\xi_2,\theta) = 2^{k_1} \xi_1 \cdot (x - w) + 2^{k_2} \xi_2 \cdot (z - y) + \phi(w,z,\theta). \]
	%
	Let us also localizaze in the $\theta$ variable, multiplying the integrand by $\chi( \theta / \lambda )$ defining
	%
	\[ K_{k_1,k_2,\lambda}(x,y) = 2^{k_1 + k_2} \lambda^p \int a_{k_1,k_2,\lambda}(w,z,\theta,\xi_1,\xi_2) e^{2 \pi i \Phi_{k_1,k_2,\lambda}(x,w,z,y,\xi_1,\xi_2,\theta)}\; dw\; dz\; d\xi_1\; d\xi_2\; d\theta. \]
	%
	This integral is now over the same domain, regardless of $k_1$, $k_2$, and $\lambda$. We have
	%
	\[ \nabla_w \Phi_{k_1,k_2,\lambda} = - 2^{k_1} \xi_1 + \lambda \nabla_w \phi(w,z,\theta) \quad \nabla_z \Phi_{k_1,k_2,\lambda} = 2^{k_2} \xi_2 + \lambda \nabla_z \phi(w,z,\theta) \]
	%
	\[ \nabla_\theta \Phi_{k_1,k_2,\lambda} = \lambda \nabla_\theta \phi(w,z,\theta) \]
	%
	\[ \nabla_{\xi_1} \Phi_{k_1,k_2,\lambda} = 2^{k_1} (x - w) \quad \nabla_{\xi_2} \Phi_{k_1,k_2,\lambda} = 2^{k_2} (z - y). \]
	%
	We have $|\nabla_\theta \Phi_{k_1,k_2,\lambda}| \gtrsim (2^{k_1} \lambda )^\varepsilon$ unless
	%
	\[ |\nabla_\theta \phi(w,z,\theta)| \lesssim 2^{\varepsilon k_1} / \lambda^{1 - \varepsilon}. \]
	%
	For $\lambda \gtrsim 2^{2 \varepsilon k_1}$, this implies that $(w,z,\theta)$ lies within a distance $O(2^{2 \varepsilon k_1} / \lambda^{1 - \varepsilon})$ of a point $(w_0,z_0,\theta_0)$ with $\nabla_\theta \phi(w_0,z_0,\theta_0) = 0$. Applying continuity and compactness, we conclude that for such $\lambda$, we have
	%
	\[ |\nabla_w \phi(w,z,\theta)| \sim 1 \quad\text{and}\quad |\nabla_z \phi(w,z,\theta| \sim 1. \]
	%
	But this implies for $k_1 - k_2 \gtrsim 1$, that we always have
	%
	\[ |\nabla_w \Phi| + |\nabla_z \Phi| \gtrsim (\lambda 2^{k_1})^\varepsilon. \]
	%
	On the other hand, if $\lambda \lesssim 2^{2 \varepsilon k_1}$, then simply because $\nabla_w \phi$ is bounded from above, we get that
	%
	\[ |\nabla_w \Phi| \sim 2^{k_1} \gtrsim 2^{\varepsilon k_1} \lambda^\varepsilon. \]
	%
	Thus across the support of the phase, we have
	%
	\[ |\nabla \Phi| \gtrsim 2^{\varepsilon k_1} \lambda^\varepsilon. \]
	%
	We also have $|D^N a_{k_1,k_2,\lambda}(w,z,\theta)| \lesssim_N \lambda^\mu$ for all $N > 0$, and so for all $N > 0$, we have
	%
	\[ |K_{k_1,k_2,\lambda}(x,y)| \lesssim_N \lambda^{\mu + p} 2^{k_1 + k_2} ( \lambda 2^{k_1} )^{-N \varepsilon}. \]
	%
	Taking $N$ in large gives a bound summable for dyadic $\lambda$, which yields that for $k_1 - k_2 \gtrsim 1$,
	%
	\[ |K_{k_1,k_2}(x,y)| \lesssim_N 2^{-N k_1}. \]
	%
	This completes the proof of the theorem. We remark that if the assumptions of the theorem held, then we could, for example, find $z_0$, $w_0$, and $\theta_0$ on the common support such that $\nabla_\theta \phi(z_0,w_0,\theta_0) = 0$, and $\nabla_z \phi(z_0,w_0,\theta_0) = 0$. If $\xi_1$

\end{comment}
