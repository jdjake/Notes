%% The following is a directive for TeXShop to indicate the main file
%%!TEX root = HarmonicAnalysis.tex

\part{Geometry of Eigenfunctions}



In these parts of the notes, we study \emph{eigenfunctions} for the Laplacian on compact manifolds and bounded domains. This is a very classical problem, and it is where many of the classical techniques of harmonic analysis began. For instance, let us consider the study of the wave and heat equations
%
\[ \left( \frac{\partial^2}{\partial t^2} - \Delta \right) u = 0 \quad\text{and}\quad \left( \frac{\partial}{\partial t} - \Delta \right) u = 0 \]
%
on a vibrating membrane $\Omega$ fixed at the boundary, i.e. with $u(x,t) = 0$ for $x \in \partial \Omega$. If $\varphi_\lambda$ solves the \emph{Helmholtz equation} $\Delta \varphi_\lambda = - \lambda^2 \varphi_\lambda$, vanishing on $\partial \Omega$, then a family of solutions to the wave equation and heat equations are given by
%
\[ u_\lambda(t,x) = \cos(\lambda t + \phi) \varphi_\lambda(x) \quad\text{and}\quad u_\lambda(t,x) = e^{-t \lambda} \varphi_\lambda(x). \]
%
In this setting, the functions $\varphi_\lambda$ are referred to as the \emph{modes} of the wave equation, giving the wave profiles under which the resulting functions $u_\lambda$ oscillate. Studying how these eigenfunctions interact with one another allows us to understand more general solutions to the wave equation.

Another application of eigenfunction problems occurs in the study of the Schr\"{o}dinger equation
%
\[ \left( - \frac{\hbar^2}{2} \Delta + V \right) \psi = E \psi, \]
%
which describes the evolution of a wave function $\psi$ under a potential $V$. The case $V = 0$ and $E = E_0$ a constant value (the free Schr\"{o}dinger equation) is equivalent to the Helmholtz equation, i.e. with $\lambda$ proportional to $E_0 / \hbar$. The values $E_0$ for which a solution exists are the \emph{energy states} of the system. A useful physical intuition is that high energy states behave `approximately classically', i.e. behaving like the classical dynamics of the Hamiltonian system given by the equation $H(x,\xi) = V(x) + |\xi|^2 / 2$. Thus the study of eigenfunctions is closely related to \emph{semiclassical analysis}, i.e. understanding the relation between classical and quantum mechanics as the scale under which a problem is being studied changes.

There are various properties one can study of the eigenfunctions $\{ \varphi_\lambda \}$. For instance, one could study their $L^p$ norms, or other norms. One could also study the geometric properties of TODO







\chapter{The Laplace Beltrami Operator}

Let








\chapter{Self-Adjoint, Elliptic Operators on a Compact Manifold}

Let $M^d$ be a compact manifold. Given a scalar density $d\omega$ on a manifold $M$, we can consider $L^2(M)$ as a Hilbert space induced by the inner product
%
\[ \langle u, v \rangle = \int u(x) \overline{v(x)}\; d\omega. \]
%
Thus given a scalar density we can consider the adjoint of a pseudodifferential operator on $M$ by considering the operator as an unbounded operator on $L^2(M)$ with domain $H^k_c(M)$, and in particular, we can consider \emph{self-adjoint unbounded} operators on $M$; we are being somewhat lax with an overloaded set of terminology here, by a \emph{self-adjoint operator} we mean an operator from $\DD(M)$ to $\DD(M)^*$, which is formally self adjoint on $\DD(M)$, i.e. such that for all $f,g\ in \DD(M)$,
%
\[ \int_M Tf \cdot \overline{g}\; d\omega = \int_M f \cdot \overline{Tg}\; d\omega. \]
%
By a \emph{self-adjoint unbounded operator}, we mean an operator from $\DD(M)$ to $\DD(M)^*$ which is essentially self-adjoint as an unbounded operator on $L^2(M)$, in the sense of the theory of self-adjointness. This is slightly stronger than being a self-adjoint operator, though we will soon see these properties are equivalent for an elliptic pseudodifferential operator. We now analyze the theory of self-adjoint, elliptic pseudodifferential operators on a compact manifold, in particular, proving the existence of the eigenfunction expansions of such operators. We begin by showing that such operators are automatically self-adjoint in the sense of an unbounded operator.

\begin{theorem}
    Suppose $T$ is a self-adjoint, elliptic pseudodifferential operator of order $t$ on a compact manifold $M$. Then $T$ is a closed, self-adjoint unbounded operator.
\end{theorem}
\begin{proof}
    Let us begin by showing $T$ is closed. We begin by noting that $T$ is a continuous operator from $\DD(M)^*$ to itself. We desire to show
    %
    \[ \{ (u,v) \in H^t(M) \times L^2(M) : Tu = v \} \]
    %
    is closed in $L^2(M) \times L^2(M)$, and so $T$ is a closed operator on $L^2(M)$ when viewed with domain $H^t(M)$. If $\{ u_i \}$ is a sequence in $H^t(M)$ converging in the $L^2(M)$ norm to some $u \in L^2(M)$, and $\{ Tu_i \}$ converges in the $L^2(M)$ norm to some $v \in L^2(M)$, then $\{ u_i \}$ converges distributionally to $u$, and so $Tu = v$ by the distributional continuity of $T$. Applying elliptic regularity, since $v \in L^2(M)$, we conclude that $u \in H^t(M)$. Thus we have shown the set above is closed.

    Next, we show that $T$ is a self-adjoint unbounded operator. Because $T$ is continuous from $H^t(M)$ to $L^2(M)$, it is simple to see via a density argument that on $L^2(M)$, we have
    %
    \[ \langle Tu, v \rangle = \langle u, Tv \rangle. \]
    %
    Thus to show $T$ is self-adjoint as an unbounded operator, it suffices to show that if $v \in L^2(M)$ induces an inequality of the form
    %
    \[ |\langle Tu, v \rangle| \lesssim \| u \|_{L^2(M)} \]
    %
    for all $u \in H^t(M)$, then $v \in H^t(M)$. But this again follows by elliptic regularity. Indeed, the inequality then holds for $u \in C^\infty(M)$, and the distributional theory thus implies that for such $u$,
    %
    \[ \langle Tu, v \rangle = \langle u, Tv \rangle. \]
    %
    Thus we have an inequality of the form
    %
    \[ |\langle u, Tv \rangle| \lesssim \| u \|_{L^2(M)} \]
    %
    for all $u \in C^\infty(M)$, and a density argument thus shows that $Tv \in L^2(M)$, so that $v \in H^t(M)$.
\end{proof}

Now let $T$ be a classical, self-adjoint pseudodifferential operator of order $t$. It follows from the calculus of pseudodifferential operators that it's principal symbol is real-valued. If $T$ is self-adjoint and also \emph{elliptic}, and $M$ is connected and has dimension bigger than one, it follows that the principal symbol is either positive or negative. By swapping $T$ out with it's negation, we might as well assume that the principal symbol is positive. We will begin by consider the case $t = 1$, though the general case will reduce to this question. Given that the principal symbol is positive, we might imagine that $T$ is `positive-definite' up to first order, an intuition which leads to the following lemma.

\begin{lemma}
    Let $T$ be a classical self-adjoint elliptic pseudodifferential operator of order $1$ on a manifold $M$. Then there exists a classical self-adjoint elliptic pseudodifferential operator $S$ of order $1/2$ such that $T - S^* S$ is a smoothing operator.
\end{lemma}
\begin{proof}
    We proceed as in the proof that $\sqrt{-\Delta}$ is a classical pseudodifferential operator. Let $S_0$ be a classical self-adjoint pseudodifferential operator of order $1/2$ with principal symbol $b_0(x,\xi) = a(x,\xi)^{1/2}$, then $S_0^* S_0$ is positive-semidefinite, and $T - S_0^* S_0$ is a classical pseudodifferential operator of order zero. Let $r_1$ denote the principal symbol of this operator. More generally, let us suppose that $T - (S_0 + \dots + S_n)^* (S_0 + \dots + S_n)$ is a classical pseudodifferential operator of order $-n$, with principal symbol $r_n$. If we consider a classical psuedodifferential operator $S_{n+1}$ of order $1/2 - (n+1)$ with principal symbol $b_{n+1}(x,\xi) = r_n(x,\xi) / 2 b_0(x,\xi)$, then $T - (S_0 + \dots + S_{n+1})^* (S_0 + \dots + S_{n+1})$ is a classical pseudodifferential operator of order $-(n+1)$. Thus if we choose a self-adjoint operator $S$ of order $1/2$ such that $S \sim \sum_{i = 0}^\infty S_i$, then $T - S^* S$ is smoothing. 
\end{proof}

\begin{lemma}
    Suppose $T$ is a classical self-adjoint elliptic pseudodifferential operator of order $1$ with a non-negative principal symbol on a manifold $M$. For any compact subset $K$ of $M$, there exists $\lambda_0 > 0$ such that for $\lambda \geq \lambda$, and $u \in H^1(M)$ supported on $K$,
    %
    \[ \langle (T + \lambda_0) u, u \rangle \sim \| u \|_{H^{1/2}(M)}^2. \]
    %
    In particular, if $M$ is compact, one can do this anlaysis globally.
\end{lemma}

\begin{proof}
    Without loss of generality, we may assume that the support of the kernel of $T$ is compact. Choose a classical, self-adjoint, elliptic pseudodifferential operator $S$ of order $1/2$ such that $T - S^* S$ is smoothing. Then for $u \in H^1_c(M)$, there exists $\gamma_0 > 0$ such that
    %
    \begin{align*}
        \left| \langle Tu, u \rangle - \| Su \|_{L^2(M)}^2 \right| &= \left| \int_M (T - S^* S) u(x) \overline{u}(x)\; dx \right| \leq \gamma_0 \| u \|_{L^2(M)}^2.
    \end{align*}
    %
    Thus if $\gamma > \gamma_0$,
    %
    \[ \langle (T + \gamma) u, u \rangle = \langle Tu, u \rangle + \gamma \| u \|_{L^2(M)} \geq \| Su \|_{L^2(M)}^2 + (\gamma - \gamma_0) \| u \|_{L^2(M)}. \]
    %
    Thus we conclude that $T + \gamma$ is positive definite. Since $S$ has principal symbol $a(x,\xi)^{1/2}$, it is elliptic, and so for $u \in H^{1/2}(M)$, if $\gamma > \gamma_0$.
    %
    \begin{align*}
        \| u \|_{H^{1/2}(M)}^2 &\lesssim \| Su \|_{L^2(M)}^2 + \| u \|_{L^2(M)}^2\\
        &\lesssim \left| \langle Tu, u \rangle \right| + \| u \|_{L^2(M)}^2\\
        &= |\langle (T + \gamma) u, u \rangle - \langle \gamma u, u \rangle | + \| u \|_{L^2(M)}^2\\
        &\leq \langle (T + \gamma) u, u \rangle + \langle \gamma u, u \rangle + \| u \|_{L^2(M)}^2\\
        &\leq \langle (T + 2\gamma + 1) u , u \rangle.
    \end{align*}
    %
    Thus if $\lambda_0 > 2 \gamma_0 + 1$, then
    %
    \[ \langle (T + \lambda_0) u, u \rangle \lesssim \| Su \|_{L^2(M)} + \| u \|_{L^2(M)} \lesssim \| u \|_{H^{1/2}(M)}. \qedhere \]
\end{proof}

\begin{theorem}
    Suppose $T$ is a classical, self-adjoint pseudodifferential operator of order one on a compact manifold $M$, with a non-negative principal symbol. Then for suitably large $\lambda_0 > 0$,
    %
    \begin{itemize}
        \item For all $k > 0$, $(T + \lambda_0)^k$ is an isomorphism from $H^k(M)$ to $L^2(M)$.

        \item There exists an increasing family of real numbers $\{ \lambda_i \}$ with $\lambda_i \to \infty$, and an orthogonal basis $\{ e_i \}$ for $L^2(M)$ consisting solely of elements of $C^\infty(M)$, such that $Te_i = \lambda_i e_i$ for each $i > 0$. The functions $\{ e_i \}$ satisfy
        %
        \[ \| e_i \|_{H^k(M)} \sim_k (\lambda_0 + \lambda_i)^k. \]

        \item If $u \in H^k(M)$, then $\langle u, e_i \rangle \lesssim_k \| u \|_{H^k(M)} (\lambda_0 + \lambda_i)^{-k}$.
    \end{itemize}
\end{theorem}
\begin{proof}
    The last result implies that $T + \lambda_0$ is an injective operator from $H^1(M)$ to $L^2(M)$ for sufficiently large $\lambda_0 > 0$. We have already seen that, since $M$ is compact, $T + \lambda_0$ is a closed, self-adjoint unbounded operator on $L^2(M)$. But the theory of unbounded operators thus implies that because $T + \lambda_0$ is injective, it has dense image in $L^2(M)$. Thus we can define it's inverse $R = (T + \lambda_0)^{-1}$, which is a densely defined continuous operator in $L^2(M)$, and thus extends to a continuous operator on all of $L^2(M)$. Because $T + \lambda_0$ is positive-definite, i.e. $\langle (T + \lambda_0) u, u \rangle > 0$ for all non-zero $u \in H^1(M)$, density implies that $\langle Rv, v \rangle > 0$ for all $v \neq 0$. Thus $R$ is positive definite. If $u \in H^1(M)$, and $(T + \lambda_0) u = v$, i.e. $u = Rv$, then ellipticity implies that
    %
    \[ \| Rv \|_{H^1(M)} \lesssim \| v \|_{L^2(M)} + \| Rv \|_{L^2(M)} \lesssim \| v \|_{L^2(M)}. \]
    %
    Conversely, continuity of pseudodifferential operators implies that
    %
    \[ \| v \|_{L^2(M)} = \| (T + \lambda_0) u \|_{L^2(M)} \lesssim \| u \|_{H^1(M)}. \]
    %
    Thus density implies that $R$ is an \emph{isomorphism} from $L^2(M)$ to $H^1(M)$. In particular we note that that $T + \lambda_0$ is an isomorphism from $H^1(M)$ to $L^2(M)$, i.e. it was surjective in the first place rather than merely having dense image. Moving on, The Rellich-Kondrachov theorem thus implies that $R$ is a \emph{compact}, positive definite operator on $L^2(M)$. Thus the spectral analysis of such operators implies that there exists an orthogonal basis $\{ e_i \}$ and a family of positive, decreasing eigenvalues $\{ \gamma_i \}$ such that if $E_i$ is orthogonal projection onto the span of $e_i$, then $(T + \lambda_0)^{-1} = \sum_i \gamma_i^{-1} E_i$. If $\lambda_i = \gamma_i - \lambda_0$, then this means that $T = \sum_i \lambda_i E_i$. 

    Applying elliptic regularity, since $(T + \lambda_0) e_i = \gamma_i e_i$ lies in $L^2(M)$, we conclude that $e_i \in H^1(M)$. But iterating this argument gives that $e_i \in H^N(M)$ for any $N > 0$. Applying the Sobolev embedding theorem thus shows that $e_i \in C^\infty(M)$ for each $i$.

    A simple generalization of the argument above (the spectral theory, ellipticity, and so on) shows that $(T + \lambda_0)^k$ is actually an isomorphism from $H^k(M)$ to $L^2(M)$ for each $k > 0$. We thus find that for any $u \in H^k(M)$,
    %
    \[ \| u \|_{H^k(M)}^2 \sim_k \| (T + \lambda_0)^k u \|_{L^2(M)}^2 = \sum (\lambda_i + \lambda_0)^{2k} |\langle f, e_i \rangle|^2. \]
    %
    Thus we find that
    %
    \[ |\langle u, e_i \rangle| \lesssim_k \| u \|_{H^k(M)} |\lambda_i + \lambda_0|^{-k} \lesssim_k \| u \|_{H^k(M)} |1 + \lambda_0|^{-k}. \qedhere \] 
    %which we briefly describe the details to. It is verified to be an injective, closed, self-adjoint map from $H^k(M)$ to $L^2(M)$, and thus has dense image, and a unique continuous left inverse $R_k: L^2(M) \to L^2(M)$. Ellipticity implies that if $u \in H^k(M)$, and $(T + \lambda_0)^k u = v$, with $v \in L^2(M)$, then $u = R_k v$, and
    %
    %\[ \| R_k v \|_{H^k(M)} \lesssim \| v \|_{L^2(M)} + \| R_k v \|_{L^2(M)} \lesssim \| v \|_{L^2(M)} \]
    %
    %and the continuity of pseudodifferential operators imples
    %
    %\[ \| v \|_{L^2(M)} \lesssim \| u \|_{H^k(M)}. \]
    %
    %Thus we conclude that
\end{proof}

The following, known as \emph{H\"{o}rmander's square root trick}, allows us to extend the theory above to elliptic, self-adjoint operators of arbitrary order.

\begin{theorem}
    Fix integers $p$ and $q$ with $q \neq 0$, and set $t = p/q$. Suppose $T$ is a classical, positive-definite, elliptic pseudodifferential operator of order $t$ on a compact manifold $M$. Then the operator $T^{q/p}$, defined using the spectral functional calculus, is a classical, positive-definite, elliptic pseudodifferential operator of order $1$, with principal symbol $a(x,\xi)^{q/p}$.
\end{theorem}
\begin{proof}
    The case $t = -1$ is easily seen to be true, since the assumptions imply $T$ is invertible, and it's inverse is a pseudodifferential operator modulo smoothing. Thus, without loss of generality, we may assume that $q = 1$, and that $p > 0$. We can certainly \emph{construct} an operator $S \in \Psi^1_{\text{cl}}(M)$ which is self-adjoint, with principal symbol $a(x,\xi)^{1/p}$, such that $S^p - T$ is a smoothing operator. Applying the theory above, we see that $S$ has an eigenvalue decomposition, with eigenvectors lying in $C^\infty(M)$, and only finitely many eigenvalues being negative. Thus, modulo a smoothing operator, i.e. a finite sum of the projection operators $\{ E_i \}$, we may actually replace $S$ with a positive-definite operator. We claim that $S - T^{1/p}$ is also a smoothing operator, which would complete the proof since the principal symbol of $S$ is equal to $a(x,\xi)^{q/p}$. Since $S$ and $T$ are both positive-definite, they are injective, and so by the spectral calculus of unbounded operators, $T^{-1}$ and $S^{-1}$ is a well-defined bounded, positive-definite operator on $L^2(M)$. If $\gamma$ is a contour in the complex plane which winds around each element of $\sigma(T^{-1})$ exactly once, then we find using the holomorphic functional calculus that
    %
    \[ T^{1/p} = \frac{1}{2\pi i} \int_\gamma z^{-1/p} (z - T^{-1})^{-1}\; dz \]
    %
    and
    %
    \[ S = \frac{1}{2 \pi i} \int_\gamma z^{-1/p} (z - S^{-p})^{-1}\; dz \]
    %
    Now $S^{-p}$ is a pseudodifferential operator of order $-p$. Since $S^p - T$ is a smoothing operator, the composition calculus tells us that so is $T^{-1} (S^p - T) S^{-p} = T^{-1} - S^{-p}$. Write $S^{-p} = T^{-1} - R$. Then
    %
    \begin{align*}
        S - T^{1/p} &= \frac{1}{2 \pi i} \int_\gamma z^{-1/p} \left( (z - T^{-1} + R)^{-1} - (z - T^{-1})^{-1} \right)\\
        &= \frac{1}{2 \pi i} \int_\gamma z^{-1/p} \left( (z - T^{-1} + R)^{-1} R (z - T^{-1})^{-1} \right).
    \end{align*}
    %
    This is a integral over a compact curve over a continuous family of smoothing operators, which is therefore a smoothing operator.
\end{proof}

\begin{remark}
    As above, finding an operator $S$ of order $t/2$ such that $T - S^*S$ is smoothing allows one to show that if $T$ is a classical, elliptic, self-adjoint pseudodifferential operator of order $t$, then $T + \lambda_0$ is positive definite for suitably large $\lambda_0 > 0$, so that we may apply the theorem above to a wider situation.
\end{remark}

Using the trick, we quickly extend the theory above to general operators of this form.

\begin{theorem}
    Suppose $T$ is a classical, self-adjoint, elliptic pseudodifferential operator of order $t = p/q$ on a compact manifold $M$. Then for sufficiently large $\lambda_0 > 0$,
    %
    \begin{itemize}
        \item $(T + \lambda_0)^k$ is an isomorphism from $H^{tk}(M)$ to $L^2(M)$ for all $k > 0$.
        \item There is a basis $\{ e_i \}$ for $L^2(M)$ consisting of elements of $C^\infty(M)$ and an increasing sequence of positive real numbers $\{ \lambda_i \}$ with $\lambda_i \to \infty$, such that $Te_i = (\lambda_0 + \lambda_i)^t e_i$. The functions $\{ e_i \}$ satisfy
        %
        \[ \| e_i \|_{H^k(M)} \sim_k (\lambda_0 + |\lambda_i|)^k \]
        \item If $u \in H^k(M)$, then $|\langle u, e_i \rangle| \lesssim_k \| u \|_{H^k(M)} (\lambda_0 + |\lambda_i|)^{-k}$.
    \end{itemize}
\end{theorem}

The special case of this result, where $\Delta$ is the Laplace-Beltrami operator on a compact Riemannian manifold, was first conjectured by Ohm and Raleigh, and proved by Hilbert in 1904.

\begin{example}
    Let $M$ be a compact Riemannian manifold. Then the Laplace-Beltrami operator $\Delta$ is a classical pseudodifferential operator of order two on $M$, and $-\Delta$ is formally positive-semidefinite. Thus we can see $\lambda_0$ above to be any positive number, which gives that there exists a discrete subset $\Lambda(M)$ of $[0,\infty)$, and a family of finite dimensional subspaces $E_\lambda$ of $C^\infty(M)$ for each $\lambda \in \Lambda(M)$, such that $\Delta e_\lambda = - \lambda^2 e_\lambda$ for each $e_\lambda \in E_\lambda$. If $u \in H^k(\TT^n)$ and $e_\lambda \in E_\lambda$, then
    %
    \[ |\langle u, e_\lambda \rangle| \lesssim_{\varepsilon,k} \| e_\lambda \|_{L^2(M)} \| u \|_{H^k(M)} (\varepsilon + \lambda_i)^{-k} \]
    %
    On $\TT^n = \RR^n / \ZZ^n$, we can compute this expansion explicitly. The space $E_\lambda$ consists of the span of any functions of the form $e_\xi(x) = e^{2 \pi i \xi \cdot x}$, where $\xi \in \ZZ^n$, and $\lambda = 2 \pi |\xi|$. In this case the Fourier transform explicitly tells us the slightly stronger identity
    %
    \[ |\langle u, e_\xi \rangle| = |\widehat{u}(\xi)| \lesssim_k \min \left( \| u \|_{L^1(\TT^n)}, \| D^k u \|_{L^1(\TT^n)} |\xi|^{-k} \right). \]
\end{example}







\chapter{Distribution of Eigenvalues and the Half Wave Operator}

Consider the setup we began our study of in the last section. We have a classical, self-adjoint, elliptic pseudodifferential operator $T$ of order one on a compact manifold $M$ with principal symbol $p(x,\xi) \geq 0$, and we have associated with $T$ a sequence of orthonormal smooth functions $\{ e_i \}$ in $C^\infty(M)$ which form a basis for $L^2(M)$, and an increasing sequence $\{ \lambda_i \}$ tending to $\infty$, such that $Te_i = \lambda_i e_i$. Our goal now is to further the study of the behaviour of the eigenfunctions $\{ e_i \}$, and the distributions of the eigenvalues $\{ \lambda_i \}$. A key object in the study of the distribution of the eigenvalues is the function $N(\lambda)$, which gives the number of eigenvalues of $T$ less than or equal to $\lambda$. Our results already give a very basic estimate for $N$, which we will considerably sharpen over the course of this chapter.

\begin{theorem}
    The function $N$ is tempered in $\lambda$. More precisely, for $\lambda > 0$,
    %
    \[ N(\lambda) \lesssim_\varepsilon \lambda^{n + \varepsilon}. \]
\end{theorem}
\begin{proof}
    Define the operators $S_\lambda$, which are the projections in $L^2(M)$ onto the eigenspaces corresponding to eigenvalues with value $\leq \lambda$. Then $S_\lambda$ clearly has kernel
    %
    \[ K_\lambda(x,y) = \sum_{\lambda_i \leq \lambda} e_i(x) \overline{e_i(y)}. \]
    %
    This function is smooth, and
    %
    \[ \int K_\lambda(x,x)\; dx = \sum_{\lambda_i \leq \lambda} |e_i(x)|^2 = N(\lambda). \]    
    %
    Thus $N(\lambda)$ is the trace of the operator $S_\lambda$. Because $\| e_i \|_{H^k(M)} \lesssim_k (1 + |\lambda|)^k$ if $\lambda_i \leq \lambda$, we have the elementary estimate
    %
    \[ \| S_\lambda f \|_{H^k(M)} \lesssim_k \lambda^k \| f \|_{L^2(M)}. \]
    %
    The Sobolev embedding theorem thus implies that if $\dim(M) = d$, and if $\varepsilon > 0$, then
    %
    \[ \| S_\lambda f \|_{L^\infty(M)} \lesssim_\varepsilon \| S_\lambda f \|_{H^{d/2 + \varepsilon}(M)} \lesssim \lambda^{d/2 + \varepsilon} \| f \|_{L^2(M)}. \]
    %
    Thus we conclude that, for any $f \in C^\infty(M)$, and any $x \in M$,
    %
    \[ \left| \int K_\lambda(x,y) f(y)\; dy \right| \lesssim_\varepsilon \lambda^{d/2 + \varepsilon} \| f \|_{L^2(M)}. \]
    %
    By density, this implies that if $g_{\lambda,x}(y) = K_\lambda(x,y)$, then
    %
    \[ \| g_{\lambda,x} \|_{L^2(M)} \lesssim_\varepsilon \lambda^{d/2 + \varepsilon}. \]
    %
    But $g_{\lambda,x} \in \text{span} \{ e_i: \lambda_i \leq \lambda \}$, so this means that
    %
    \[ \| g_{\lambda,x} \|_{L^\infty(M)} = \| S_\lambda g_{\lambda,x} \|_{L^\infty(M)} \lesssim_\varepsilon \lambda^{d/2 + \varepsilon} \| g_{\lambda,x} \|_{L^2(M)} \lesssim_\varepsilon \lambda^{d + 2 \varepsilon}. \]
    %
    But this means we conclude that $\| K_\lambda \|_{L^\infty(M \times M)} \lesssim_\varepsilon \lambda^{d + \varepsilon}$, and thus that
    %
    \[ N(\lambda) = \int K_\lambda(x,x)\; dx \lesssim_\varepsilon \lambda^{d + \varepsilon}. \qedhere \]
\end{proof}

Our next goal is now to establish the \emph{Sharp Weyl formula}. If
%
\[ c = \int_{\{ (x,\xi) \in T^*M : a(x,\xi) \leq 1 \}} d\xi\; dx, \]
%
then the result states that
%
\[ N(\lambda) = c \dot \lambda^n + O(\lambda^{n-1}). \]
%
We will continue to use the representation $N(\lambda) = \text{Tr}(S_\lambda)$. However, a key step here is to recognize that $S_\lambda$ is a \emph{function} of $T$, namely $S_\lambda = \chi_\lambda(T)$, where $\chi_\lambda(\xi) = \mathbf{I}(\xi \leq \lambda)$. The next trick is to use the Fourier multiplication formula to obtain a useful representation of the structure of $S_\lambda$. For $f \in C^\infty(M)$, we can write
%
\begin{align*}
    S_\lambda f &= \int_{-\infty}^\infty \chi_\lambda(\tau) \left( \sum_i \delta_{\lambda_i}(\tau) E_i f \right)\; d\tau\\
    &= \int_{-\infty}^\infty \widehat{\chi}_\lambda(t) \left( \sum_i e^{2 \pi i t \lambda_i} E_i f \right)\; dt\\
    &= \int_{-\infty}^\infty \widehat{\chi}_\lambda(t) e^{2 \pi i t T}\; dt\\
    &= \frac{1}{2 \pi i} \int_{-\infty}^\infty \frac{e^{2 \pi i t (T - \lambda)} f}{t + i0}\; dt.
\end{align*}
%
Thus we are lead to study the \emph{half wave operator} $\partial_t - 2 \pi i T$, since one sees that $(\partial_t - 2 \pi i T) \{ e^{2 \pi i t T} f \} = 0$ for all $f \in L^2(M)$; it is easily verified for the eigenfunctions of $T$, and then the result follows by the distributional continuity of all operations involved.





\section{Construction of the Lax Parametrix}



We will understand the operators $e^{2 \pi i t T}$ by constructing a \emph{parametrix} for the equation $\partial_t - 2 \pi i T$ over small times, i.e. for $|t| \lesssim 1$. The equation $\partial_t = 2 \pi i T$ is a pseudodifferential variant of a basic hyperbolic partial differential equation, so based on the type of parametrices one can construct in the hyperbolic setting, one might hope to find a parametrix defined by an oscillatory integral of the form
%
\[ Sf(x,t) = S(t)f(x) = \int s(t,x,y,\xi) e^{2 \pi i \Phi(t,x,y,\xi)} f(y)\; dy\; d\xi, \]
%
such that:
%
\begin{itemize}
    \item $\Phi(t,x,y,\xi) = \phi(x,y,\xi) + t p(y,\xi)$, where $\phi$ is smooth away from $\xi = 0$, homogeneous of degree one, and $\phi(x,y,\xi) \approx (x - y) \cdot \xi$ in the sense that on the support of $s$,
    %
    \[ \partial^\beta_\xi \{ \phi(x,y,\xi) - (x - y) \cdot \xi \} \lesssim_\beta |x - y|^2 |\xi|^{1 - \beta}. \]
    %
    In particular, this implies that $\phi(x,y,\xi) = 0$ when $(x - y) \cdot \xi = 0$.

    \item $s$ is a symbol of order zero, supported on $|x - y| \lesssim 1$ and on $|\xi| \geq 1$, in such a way that
    %
    \[ |\nabla_\xi \phi(x,y,\xi)| \gtrsim |x - y| \quad\text{and}\quad |\nabla_x \phi(x,y,\xi)| \gtrsim |\xi| \]
    %
    for $(x,y) \in \text{supp}_x(s) \times \text{supp}_y(s)$.
\end{itemize}
%
If $(\partial_t - 2 \pi i T) \circ S = 0$ is a smoothing operator on $(-\varepsilon,\varepsilon) \times M$ and $S(0)$ differs from the identity operator by a smoothing operator, then $S - e^{2 \pi i t T}$ is smoothing for $|t| \leq \varepsilon$. The construction of the parametrix $S$ will therefore give us much more information about the behaviour of the propogators $e^{2 \pi i t T}$ over small times.

To find a choice of $\phi$ and $s$ which gives us this parametrix, let us start by determining what properties these functions should satisfy. Let us fix a coordinate system $(x,U)$, where $x(U)$ is a precompact subset of $\RR^n$. Let us assume that in these coordinates, $T$ has symbol $a(x,\xi)$. Then the kernel of $(\partial_t - 2 \pi i T) \circ S$ in this coordinate system is
%
\[ \int (\partial_t + 2 \pi i T(x,D)) \left\{ s(t,\cdot,y,\xi) e^{2 \pi i \Phi(t,\cdot,y,\xi)} \right\}\; d\xi. \]
%
If we set
%
\[ s'(t,x,y,\xi) = e^{- 2 \pi i \Phi(t,x,y,\xi)} (\partial_t - 2 \pi i T(x,D)) \left\{ s(t,\cdot,y,\xi) e^{2 \pi i \Phi(t,\cdot,y,\xi)} \right\} \]
%
then the kernel is
%
\[ \int s'(t,x,y,\xi) e^{2 \pi i \Phi(t,x,y,\xi)}\; d\xi. \]
%
Provided that $s'$ is a symbol of order $-\infty$ for $0 < |t| \leq \varepsilon$, integration by parts shows that $(\partial_t + 2 \pi i T) \circ S$ is smoothing, and so we will try to choose $\phi$ and $s$ so as to obtain such a result.

In our discussion of pseudodifferential operators, we have already discussed an asymptotic formula for $s'$, namely, if
% Phi(t,x,y,xi) = phi(x,y,xi) - t p(y,xi)
% phi(x,y,xi) = (x - y) * xi + O(|x-y|^2 |xi|)
% nabla_x phi = xi + nabla_x O( |x - y|^2 |xi| )
%
\begin{align*}
    r_{x,y}(z) &= \nabla_x \phi(x,z,\xi) \cdot (x - z) - \{ \phi(x,y,\xi) - \phi(z,y,\xi) \}.
\end{align*}
%
then for any $N > 0$, if $a \sim \sum_{k = -\infty}^1 a_k$, where $a_k$ is homogeneous of degree $k$, and if $\xi_\phi = \nabla_x \Phi(t,x,y,\xi) = \nabla_x \phi(x,y,\xi)$,
% Symbol of (partial_t + 2 pi i T) is
% 2 pi i (tau + a(x,xi))
\begin{align*}
    s' & (t,x,y,\xi)\\
    &= \underbrace{ \left( p(y,\xi) - a(x, \xi_\phi) \right) \cdot s(t,x,y,\xi) }_{\text{symbols of order 1}}\\
    &\quad + \underbrace{\partial_t s(t,x,y,\xi)}_{\text{symbol of order $0$}}  \\
    &\quad - \sum_{1 \leq |\beta| < N} \underbrace{\frac{2 \pi i}{\beta! \cdot (2 \pi i)^\beta} \cdot \partial_\xi^\beta a(x, \xi_\phi) \partial_z^\beta \{ e^{2 \pi i r_{x,y}(z)} s(t,z,y,\xi) \} |_{z = y}}_{\text{symbols of order $1 - \lceil |\beta| / 2 \rceil$}}\\
    &\quad + R_N(t,x,y,\xi).
\end{align*}
%
where, because $|\nabla_x \Phi(t,x,y,\xi)| \gtrsim |\xi|$ on the support of $s$,
%
\[ \langle \xi \rangle^{t - \lceil N/2 \rceil} R_N \in L^\infty((-\varepsilon,\varepsilon) \times U \times U \times \RR^d). \]
%
It is simple to  establish estimates of the form
%
\[ |\partial_x^\alpha \partial_y^\beta \partial_\xi^\lambda s'(t,x,y,\xi)| \lesssim \langle \xi \rangle^{N_{\alpha \beta \lambda}}. \]
%
Thus if we can justify that $|s'(t,x,y,\xi)| \lesssim_N \langle \xi \rangle^{-N}$ for all $N > 0$, then it will follow that $s'$ is a symbol of order $-\infty$. We now determine the propoerties of the symbol $s$ and the symbol $\phi$ which will give us these estimates.

To begin with, let us specify the function $\phi$. In order to guarantee that $s'$ is a symbol of order zero, the expansion above shows that $(p(y,\xi) - p(x,\xi_\phi)) \cdot s(t,x,y,\xi)$ must be a symbol of order zero. This will be true if we can pick $\phi$ such that, on the support of $s$, and for $|\xi| \gtrsim 1$,
%
\[ p(x, \nabla_x \phi(x,y,\xi)) = p(y,\xi). \]
%
This is an example of an \emph{Eikonal equation}, e.g. an equation of the form
%
\[ q(z,\nabla_z \psi(z)) = 0 \]
%
for some function $q(z,\zeta)$. In our case, $z = (x,y,\xi)$, so $\zeta = (\zeta_x, \zeta_y,\zeta_\xi)$, and so
%
\[ q(z,\zeta) = p(x,\zeta_x) - p(y,\xi). \]
%
Let us make some further remarks we desire about our choice of function $\phi$:
%
\begin{itemize}
    \item We want $\phi$ to be homogeneous and smooth away from the origin. If we solve the equation for all $|\xi| = 1$, and then extend $\phi$ such that for $\lambda > 0$ and $|\xi| = 1$,
    %
    \[ \phi(x,y,\lambda \xi) = \lambda \phi(x,y,\xi) \psi(\lambda), \]
    %
    where $\psi$ is smooth, equal to one for $|\lambda| \geq 3/4$, and vanishing for $|\lambda| \leq 1/2$, then $\phi$ will satisfy the equation for all $|\xi| \gtrsim 1$. This means that
    %
    \[ p(x,\nabla_x \phi(x,y,\xi)) - p(y,\xi) \]
    %
    is smooth and supported on $|\xi| \lesssim 1$, which implies it is a symbol of order $-\infty$, which suffices for our construction. Thus it suffices to solve the equation for $|\xi| = 1$.

    \item Since $\phi$ is smooth away from the origin and homogeneous, the equation
    %
    \[ |\partial_\xi^\beta \left\{ \phi(x,y,\xi) - (x - y) \cdot \xi \right\}| \lesssim_\beta |x - y|^2 \langle \xi \rangle^{1 - \beta} \]
    %
    holds if, for $|\xi| = 1$, we have $\phi(x,y,\xi) = 0$ whenever $(x - y) \cdot \xi = 0$, and $\nabla_x \phi(x,y,\xi) = \xi$ whenever $x = y$. Thus we have some \emph{initial conditions} for our Eikonal equation.
\end{itemize}
%
The second condition constitutes a type of initial condition for $\phi$, since it specifies it's behaviour on a hypersurface, a kind of Cauchy condition, and thus we should expect these are close to the conditions that give unique solutions to the equation. And the following Lemma indeed shows that there is a unique function $\phi$, defined for $|x - y| \lesssim 1$ and $|\xi| = 1$ with these properties.

\begin{lemma}
    Let $Z$ be a smooth manifold, and let $q(z,\zeta)$ be a real-valued, smooth function defined locally around a point $(z_0,\zeta_0) \in T^*Z$. Let $S$ be a smooth hypersurface in $Z$ passing through $z_0$ with conormal vector $\zeta_S$ at $z_0$, such that
    %
    \[ \frac{\partial q}{\partial \zeta_S}(z_0,\zeta_0) = \lim_{t \to 0} \frac{q(z_0,\zeta_0 + t \zeta_S) - q(z_0,\zeta_0)}{t} \]
    %
    is nonzero. Suppose that $\psi$ is any smooth function defined on $S$ locally about $z_0$, such that $d \psi(z_0)$ agrees with the action of $\zeta_0$ on $T_{x_0} S$. Then there exists a unique smooth function $\phi$ defined in a neighborhood of $z_0$, which agrees with $\psi$ on $S$, satisfies the Eikonal equation $q(z,\nabla_z \phi(z)) = 0$, and has $\nabla_z \phi(z_0) = \zeta_0$.
\end{lemma}
\begin{proof}
    TODO: See Sogge, Theorem 4.1.1.
\end{proof}

In our case,
%
\[ Z = \{ (x,y,\xi) : |\xi| = 1 \}. \]
%
We have $z_0 = (x_0,x_0,\xi_0)$, $\zeta_0 = (\xi,\xi,0)$, and
%
\[ S = \{ (x,y,\xi): |\xi| = 1 \quad\text{and}\quad (x - y) \cdot \xi = 0 \}. \]
%
The conormal vector $\xi_S$ of $S$ at $z_0$ is a multiple of $(\xi_0,-\xi_0,0)$, and so by homogeneity,
%
\[ \frac{\partial q}{\partial \xi_S} = \lim_{t \to 0} \frac{p(x_0,(1 + t)\xi_0) - p(x_0,\xi_0)}{t} = p(x_0,\xi_0), \]
%
which is nonvanishing because $T$ is elliptic. If we define $\psi$ equal to zero on $S$, then $d \psi = 0$, which agrees with the action of $\zeta_0$ on $S$. Thus the theorem applies local uniqueness and existence to solutions to the Eikonal equation, and by compactness of $Z$ we can patch such solutions together to find a solution defined for all $|x - y| \lesssim 1$.

We therefore conclude that there exists a unique choice of $\phi$ such that, if $s$ has small enough support, $s'(t,x,y,\xi)$ is a symbol of order zero. Next, let us see what constraints are forced on us in order to ensure that $S(0)$ differs from the identity by a smoothing operator. The kernel of $U$ is precisely
%
\[ \int s(0,x,y,\xi) e^{2 \pi i \phi(x,y,\xi)}\; d\xi. \]
%
We now show that this operator is actually a \emph{pseudodifferential operator} of order zero, and determine it's symbol up to first order.

To do this, we write $\phi_\alpha(x,y,\xi) = (1 - \alpha) \phi(x,y,\xi) + \alpha (x - y) \cdot \xi$. Let $U_\alpha$ be the operator with kernel
%
\[ \int s(0,x,y,\xi) e^{2 \pi i \phi_\alpha(x,y,\xi)}\; d\xi. \]
%
Assume the support of $s$ is close enough to the diagonal such that
%
\[ |\nabla_\xi \phi_\alpha(x,y,\xi)| \gtrsim |x - y| \]
%
on the support of $s$. Then $\partial_\alpha^n U_t$ has kernel
%
\[ \int (2 \pi i)^n ( \phi_1 - \phi_0 )^n s(0,x,y,\xi) e^{2 \pi i \phi_\alpha(x,y,\xi)}\; d\xi. \]
%
This is an oscillatory integral defined by a symbol of order $n$. However, when $t = 1$, the fact that $\phi(x,y,\xi) \approx (x - y) \cdot \xi$, together with the formula for converting pseudodifferential operators with compound symbols into standard Kohn-Nirenberg type symbols shows that $\partial_\alpha^n U_1$ is actually a pseudodifferential operator of order $-n$. Integration by parts, similarily, shows that $\partial_\alpha^n U_t$ is defined by an oscillator integral against a symbol of order $-n$. But this means that if we define a pseudodifferential operator by the asymptotic formula
%
\[ V \sim \sum \frac{(-1)^n}{n!} \partial_\alpha^n U_1, \]
%
then $U - V$ is smoothing. Indeed, for any $n$, by Taylor's formula we have
%
\[ U = \sum_{k = 0}^{n-1} \frac{(-1)^n}{n!} \partial_\alpha^n U_1 + \frac{(-1)^n}{n!} \int_0^1 \alpha^{n-1} \partial_\alpha^n U_\alpha\; d\alpha \]
%
The integral here is an oscillatory integral defined against a symbol of order $-n$, and thus taking $n \to \infty$ verifies the claim.

It is an important remark that reversing this argument shows that \emph{any} pseudodifferential operator can be written in the form above for the particular choice of $\phi$ we have given. This is a special case of the \emph{equivalence of phase functions} theorem. This in particular guarantees that we can choose a symbol $I(x,y,\xi)$ of order zero such that $U - 1$ is smoothing if and only if $s(0,x,y,\xi) - I(x,y,\xi)$ is a symbol of order $-\infty$. The symbol $I$ can be chosen to be vanishing for $|x - y| \gtrsim 1$, since the difference will be a smoothing pseudodifferential operator.

Next, the quantity
%
\begin{align*}
    &\partial_t s(t,x,y,\xi)\\
    &\quad\quad + \sum_{k = 1}^d \partial_\xi^k a(x,\xi_\phi) \partial_x^k s(t,x,y,\xi)\\
    &\quad\quad + \left( a_0(x,\xi_\phi) + \frac{1}{2 \pi} \sum_{|\beta| = 2} \partial_\xi^\beta p(x,\xi_\phi) \partial_x^\beta \phi(x,y,\xi) \right) s(t,x,y,\xi).
\end{align*}
%
must be a symbol of order $-1$. But because the coefficients of this equation are smooth, and all derivatives are bounded, it follows from the general theory of transport equations that there exists a unique smooth, function $s_0$ defined for $|t| \leq \varepsilon$, which is a symbol of order zero, such that $s_0(0,x,y,\xi) = I(x,y,\xi)$, $s_0$ vanishes for $|x - y| \gtrsim 1$, and satisfies the transport equation
%
\begin{align*}
    &\partial_t s_0(t,x,y,\xi)\\
    &\quad\quad + \sum_{k = 1}^d \partial_\xi^k a(x,\xi_\phi) \partial_x^k s_0(t,x,y,\xi)\\
    &\quad\quad + \left( a_0(x,\xi_\phi) + \frac{1}{2 \pi} \sum_{|\beta| = 2} \partial_\xi^\beta p(x,\xi_\phi) \partial_x^\beta \phi(x,y,\xi) \right) s_0(t,x,y,\xi) = 0.
\end{align*}
%
We have thus justified that the quantity
%
\[ R_0(t,x,y,\xi) = e^{-2 \pi i \Phi(t,x,y,\xi)} (\partial_t - 2 \pi i T)(s_0(t,\cdot,y,\xi) e^{2 \pi i \Phi(t,x,y,\xi)}) \]
%
is a symbol of order $-1$. Now we come to a quirk of this parametrix, which does not occur in the study of hyperbolic partial differential equations. Since the operator $P(x,D)$ is only \emph{pseudolocal} rather than completely local, the remainder term $R_0$ is \emph{not} necessarily supported on a neighborhood of the origin. To fix this, we now successively define the terms $\{ s_k \}$ for $k < 0$, which are symbols of order $-k$, such that $s_k(0,x,y,\xi) = 0$, and
%
\[ TODO: SPECIFY REQUIRED EQUATION. \]
%
Again, solutions exist for small time periods. And this implies that $e^{-2 \pi i \Phi(t,x,y,\xi)} (\partial_t + 2 \pi i T)((s_0 + \dots + s_{-k}) e^{2 \pi i \Phi(t,x,y,\xi)})$ is a symbol of order $-k$ (TODO: Is It), and we can continue the calculation to complete the argument.

% PROBLEMS WITH EXTENDING TO ALL TIMES
%       CANNOT ASSUME |x - y| << 1
%           - SO this means that oscillatory integrals become bad.

\begin{comment}
\begin{lemma}
    Consider an operator of the form
    %
    \[ Sf(x) = \int a(x,y,\xi) e^{2 \pi i \phi(x,y,\xi)} f(y)\; dy\; d\xi, \]
    %
    where $a \in S^r$ and vanishes for $|x - y| \gtrsim 1$, $\phi \in S^1$, and is homogeneous of degree one in $\xi$, $|\nabla_\xi \phi(x,y,\xi)| \gtrsim |x - y|$ on the support of $a$, and for all $r > 0$,
    %
    \[ \partial^\beta_\xi \{ \phi(x,y,\xi) - (x - y) \cdot \xi \} \lesssim_\beta |x - y|^2 |\xi|^{1-|\beta|}. \]
    %
    Then $S$ is well defined, and is actually a pseudodifferential operator of order $r$. If $T$ is the pseudodifferential operator with symbol $(x,\xi) \mapsto a(x,x,\xi)$, then $T - S$ is a pseudodifferential operator of order $r-1$.

    Conversely, for \emph{any} $\Psi DO$ $T$ of order $r$, there exists a symbol $a$ of order $r$ such that for the resulting operator $S$ of order $r$, $S - T$ is a smoothing operator.
\end{lemma}
\begin{proof}
    Let us first define the operator $S$. Let $\phi_0(x,y,\xi) = (x - y) \cdot \xi$, $\phi_1(x,y,\xi) = \phi(x,y,\xi)$, $\phi_t = t \phi_1 + (1 - t) \phi_0$, and define $S_t$ with the phase function $\phi_t$ and symbol $a$. Note that $|\nabla_\xi \phi_t| \gtrsim |x - y|$, uniformly in $t$. This enables us to compute the kernel $K_t(x,y)$ for $0 \leq t \leq 1$. For $t = 0$ we have a pseudodifferential operator, and for $t = 1$, we get the kernel $K(x,y)$ we get to compute. It is also simple to see that, since $|\nabla_\xi \phi_t| \gtrsim |x - y|$, that for large $N$,
    %
    \[ K(x,y)| \lesssim_N \frac{1}{|x - y|^N}, \]
    %
    so we already see that $S$ is somewhat pseudolocal.

    We have
    %
    \[ \frac{\partial^N K_t(x,y)}{\partial t^N} = (2 \pi i)^N \int (\phi_1(x,y,\xi) - \phi_0(x,y,\xi))^N a(x,y,\xi) e^{2 \pi i \phi_t(x,y,\xi)}\; d\xi. \]
    %
    Now $(\phi_1 - \phi_0)^N \cdot a$ is a symbol of order $r + N$. But on the other hand, using the fact that $(\phi_1 - \phi_0)^N \lesssim |x - y|^{2N} |\xi|^N$, and thus vanishes to order $2N$ on the diagonal, then combined with the fact that $|\nabla_\xi \phi(x,y,\xi)| \gtrsim |x - y|$, we actually see via an integration by parts $2N$ times in $\xi$ that we can rewrite the integral in terms of a symbol of order $r - N$ and the same phase $\phi_t$. Applying Taylor's theorem, we write
    %
    \[ K(x,y) = K_1(x,y) = \sum_{k = 0}^{N-1} \frac{1}{k!} \left. \frac{\partial^k K_t(x,y)}{\partial t^k} \right|_{t = 1} + \frac{1}{N!} \int_0^1 t^{N-1} \frac{d^NK_t(x,y)}{dt^N}\; dt. \]
    %
    This integral gives an arbitrarily smooth kernel as $N \to \infty$. Thus if we let $T$ be a pseudodifferential operator of order $r$ such that
    %
    \[ T \sim \sum_{k = 0}^\infty \frac{1}{k!} \left. \frac{\partial^k K_t(x,y)}{\partial t^k} \right|_{t = 1}, \]
    %
    then $T - S$ is a smoothing operator. Now if $\tilde{T}$ is the pseudodifferential operator corresponding to the symbol $a(x,x,\xi)$, then $T - \tilde{T}$, and thus $S - \tilde{T}$, is a pseudodifferential operator of order $r-1$. The converse is similar, working in the opposite direction, i.e. from $t = 1$ to $t = 0$, and is left as an exercise.
\end{proof}
\end{comment}

%Since $I$ is a $\Psi DO$ of order zero, we can find a symbol $a$ of order zero such that if $T$ is the operator with kernel
%
%\[ \int a(x,y,\xi) e^{2 \pi i \phi(x,y,\xi)}\; d\xi, \]
%
%then $T - I$ is a smoothing operator. To ensure that $S(0) - I$ is a smoothing operator, it is natural to insist that $s(0,x,y,\xi) = a(x,y,\xi)$. We note in particular that since $I$ is a $\Psi DO$ with $1$ as a symbol, this implies $s(0,x,x,\xi) - 1$ is a symbol of order $-1$.

\section{The Sharp Weyl Formula}

Let us now use the Lax parametrix to prove the sharp Weyl formula, which immediately is given by the following, more precise estimate.

\begin{theorem}
    Let $M$ be a compact manifold, and let $T$ be a classical, self-adjoint, elliptic pseudodifferential operator of order one on $M$, with principal symbol $p(x,\xi)$. If $S_\lambda$ is the projection operator onto the span of eigenfunctions with eigenvalue $\leq \lambda$, and $K_\lambda$ is the kernel of the operator $S_\lambda$, then
    %
    \[ K_\lambda(x,x) = c(x) \lambda^n + O(\lambda^{n-1}), \]
    %
    where
    %
    \[  c(x) = \int_{p(x,\xi) \leq 1}\; d\xi. \]
\end{theorem}
\begin{proof}
    Recall that we have
    %
    \[ S_\lambda f(x) = \frac{1}{2 \pi i} \int_{-\infty}^\infty \frac{e^{2 \pi i t (T - \lambda)} f}{t + i 0}\; dt. \]
    %
    This integral only has a singularity when $t = 0$, so it makes sense to decompose the integral into two parts using an even function $\rho \in C_c^\infty(\RR)$ supported on $|t| \leq \varepsilon / 2$ and equal to one for $|t| \leq \varepsilon / 4$, i.e. writing
    %
    \[ S_\lambda f = S_{\lambda, \text{low}} f + S_{\lambda,\text{high}} f, \]
    %
    where
    %
    \[ S_{\lambda, \text{low}} f = \frac{1}{2 \pi i} \int_{-\infty}^\infty \frac{\rho(t)}{t + i0} e^{2 \pi i t (T - \lambda)} f\; dt \]
    %
    and
    %
    \[ S_{\lambda,\text{high}} f = \frac{1}{2 \pi i} \int_{-\infty}^\infty \frac{1 - \rho(t)}{t} e^{2 \pi i t (T - \lambda)} f\; dt. \]
    %
    To understand $S_{\lambda, \text{low}} f$, we use the parametrix for the wave equation. If we switch to coordinates around a particular point, then we find that the kernel of $S_{\lambda, \text{low}}$ is equal to $\tilde{K}_\lambda + R_\lambda$, where $\tilde{K}_\lambda$ is supported on a neighborhood of the diagonal, and locally in coordinates we can write
    %
    \[ \tilde{K}_\lambda(x,y) = \frac{1}{2 \pi i} \int_{-\infty}^\infty \int_{\RR^n} \frac{\rho(t)}{t + i0} s(t,x,y,\xi) e^{2 \pi i (\phi(x,y,\xi) + t(p(y,\xi) - \lambda))}\; d\xi\; dt. \]
    %
    and where
    %
    \[ R_\lambda(x,y) = \frac{1}{2 \pi i} \int_{-\infty}^\infty \frac{\rho(t)}{t + i 0} A(t,x,y) e^{2 \pi i t \lambda}\; dt, \]
    %
    where $A$ is smooth for $|t| \leq \varepsilon$ and for $x,y \in M$. But since $\rho \cdot A$ is smooth, with compact support in the $t$ variable taking inverse Fourier transforms in the $t$ variable shows that
    %
    \[ |R_\lambda(x,y)| = \left| \int_{-\infty}^\lambda \mathcal{F}_t^{-1}\{\rho A\}(\lambda - \tau,x,y)\; d\tau \right| \lesssim 1, \]
    %
    By Taylor's formula, we can write $s(t,x,x,\xi) = s(0,x,x,\xi) + t \cdot r(t,x,\xi)$, where $r$ is a symbol of order zero. But if $N$ is sufficiently large, we have
    %
    \begin{align*}
        \frac{1}{2 \pi i} &\int_{-\infty}^\infty \int_{\RR^n} \frac{\rho(t)}{t + i0} (t \cdot r(t,x,\xi)) e^{2 \pi i t(p(x,\xi) - \lambda)}\; d\xi\; dt\\
        &= \frac{1}{2 \pi} \int_{-\infty}^\infty \int_{\RR^n} \rho(t) r(t,x,\xi) e^{2 \pi i t(p(x,\xi) - \lambda)}\; d\xi\; dt\\
        &= \frac{1}{2 \pi} \int_{\RR^n} \mathcal{F}^{-1}_t \{ \rho \cdot r \}( p(x,\xi) - \lambda ,x,\xi)\; d\xi\\
        &= \int O_N \left( 1 + |p(x,\xi) - \lambda| \right)^{-N}\; d\xi = O(\lambda^{n-1}).
    \end{align*}
    %
    We also have $s(0,x,x,\xi) = 1 + s_{-1}(x,\xi)$, where $s_{-1}$ is a symbol of order $-1$. Now if $\tilde{\chi}_\lambda = \chi_\lambda * \mathcal{F}_t^{-1} \{ \rho \}$, then
    %
    \[ \frac{1}{2 \pi i} \int_{-\infty}^\infty \int_{\RR^n} \frac{\rho(t)}{t + i0} s_{-1}(x,\xi) e^{2 \pi i t (p(x,\xi) - \lambda)}\; d\xi\; dt = \int_{\RR^n} \tilde{\chi}_\lambda(p(x,\xi)) s_{-1}(x,\xi)\; d\xi. \]
    %
    Then $\tilde{\chi}_\lambda(p(x,\xi)) \sim 1$ for $|\xi| \lesssim \lambda$, and for $|\xi| \gtrsim \lambda$,
    %
    \[ \tilde{\chi}_\lambda(p(x,\xi)) \lesssim_N \langle |\xi| - \lambda \rangle^{-N} \]
    %
    This implies that
    %
    \[ \left| \int_{\RR^n} \tilde{\chi}_\lambda(p(x,\xi)) s_{-1}(x,\xi)\; d\xi \right| \lesssim \int_0^{\lambda + O(1)} r^{n-2} + \int_{\lambda + O(1)}^\infty r^{n-1} (r - \lambda)^{-N} \lesssim \lambda^{n-1}. \]
    %
    Thus we have
    %
    \begin{align*}
        \tilde{K}_\lambda(x,x) &= \frac{1}{2 \pi i} \int_{-\infty}^\infty \int_{\RR^n} \frac{\rho(t)}{t + i0} e^{2 \pi i t (p(x,\xi) - \lambda)} + O(\lambda^{n-1})\\
        &= \int_{\RR^n} \tilde{\chi}_\lambda(p(x,\xi))\; d\xi + O(\lambda^{n-1})\\
        &= \int_{\RR^n} \tilde{\chi}(p(x,\xi) - \lambda)\; d\xi + O(\lambda^{n-1})\\
        &= c(x) \lambda^n + \int_{\RR^n} (\tilde{\chi} - \chi)(p(x,\xi) - \lambda)\; d\xi + O(\lambda^{n-1}).
    \end{align*}
    %
    Now $\tilde{\chi} - \chi = \chi * u$, where $u$ is the inverse Fourier transform of $\rho(t) - 1$. But then
    %
    \[ (\chi * u)(\tau) = \int_{-\infty}^0 \widehat{\rho}(\tau - \omega)\; d\omega - \mathbf{I}(\tau \geq 0), \]
    %
    from which we verify that
    %
    \[ |(\chi * u)(\tau)| \lesssim_N (1 + |\tau|)^{-N}. \]
    %
    But we can use this to again show that
    %
    \begin{align*}
        \left| \int_{\RR^n} (\tilde{\chi} - \chi)(p(x,\xi) - \lambda)\; d\xi \right| &\lesssim \int_0^{\lambda - O(1)} r^{n-1} |\xi|^{-N}\; dr\\
        &\quad + \int_{\lambda - O(1)}^{\lambda + O(1)} (\lambda - r)^{-N} r^{n-1}\; dr\\
        &\quad + \int_{\lambda + O(1)}^\infty r^{n-1} (r - \lambda)^{-N}\\
        &\lesssim \lambda^{n-1}.
    \end{align*}
    %
    Thus we have established the result for the kernel $K_{\lambda,\text{low}}$ of the operator $S_{\lambda,\text{low}}$. The proof of this theorem would be finished if we were able to justify that
    %
    \[ |K_\lambda(x,x) - K_{\lambda,\text{low}}(x,x)| \lesssim \lambda^{n-1}. \]
    %
    Define the function
    %
    \begin{align*}
        g(\lambda,x) &= K_\lambda(x,x) - K_{\lambda,\text{low}}(x,x)\\
        &= \frac{1}{2\pi i} \int_{-\infty}^\infty (1 - \rho(t)) \{ e^{-2 \pi i t (T - \lambda)}(x,x) \}\; dt.
    \end{align*}
    %
    Then the Fourier transform in the $\lambda$ variable is
    %
    \[ \widehat{g}(t,x) = \frac{1}{2 \pi i} (1 - \rho(t)) e^{-2 \pi i t T}. \]
    %
    Thus the support of $\widehat{g}$ is supported away from $|t| \leq \varepsilon / 2$. A Lemma of Tauberian type following this proof shows that it suffices to show that for $\lambda > 0$, and $0 < \tau \leq 1$,
    %
    \[ |g(\lambda + \tau,x) - g(\lambda + \tau,x)| \lesssim (1 + \lambda)^{n-1} \]
    %
    But this follows if we can show that
    %
    \[ |K_{\lambda + \tau}(x,x) - K_\lambda(x,x)| \lesssim (1 + \lambda)^{n-1} \]
    %
    and that
    %
    \[ |K_{\lambda + \tau, \text{low}}(x,x) - K_{\lambda, \text{low}}(x,x)| \lesssim (1 + \lambda)^{n-1}. \]
    %
    These inequalities are equivalent to the $(L^1,L^2)$ \emph{discrete restriction theorem} for eigenfunctions of the Laplacian, which we will analyze in the next section. Indeed, if we let $\chi_{\lambda,\tau}$ be the operator with kernel $K_{\lambda + \tau} - K_\lambda$, then the discrete restriction theorem tells us that
    %
    \[ \| \chi_{\lambda,\tau} f \|_{L^2(M)} \lesssim (1 + \lambda)^{(n-1)/2} \| f \|_{L^1(M)} \]
    %
    which by Schur's test, is equivalent to us having
    %
    \[ \sup_{x \in M} \int_M |K_{\lambda + \tau}(x,y) - K_\lambda(x,y)|^2\; dy \lesssim (1 + \lambda)^{n-1} \]
    %
    But the left hand side, by orthgonality, is equal to
    %
    \[ \sup_{x \in M} \sum_j \mathbf{I}(\lambda \leq \lambda_j \leq \lambda + \tau) |e_j(x)|^2 = \sup_{x \in M} |K_{\lambda + \tau}(x,x) - K_{\lambda}(x,x)|, \]
    %
    which gives the required inequality. The analysis of $K_{\lambda, \text{low}}$ follows because we can write
    %
    \[ K_{\lambda + \tau, \text{low}}(x,y) - K_{\lambda, \text{low}}(x,y) = \frac{1}{2 \pi i} \int \frac{\rho(t)}{t + i0} (e^{-2 \pi i \tau t} - 1) e^{2 \pi i (T - \lambda)}\; dt. \]
    %
    The $e^{-2 \pi i t \tau t} - 1$ term annihilates the singularity at the origin, and one can now argue as above to show this quantity is $O(\lambda^{n-1})$.
\end{proof}

\begin{lemma}
    Let $g(\lambda)$ be a piecewise continuous function on $\RR$, such that for $\lambda > 0$, and $0 < \tau \leq 1$,
    %
    \[ |g(\lambda + \tau) - g(\lambda)| \lesssim (1 + \lambda)^a. \]
    %
    If $\widehat{g}(t)$ vanishes for $|t| \leq 1$, then
    %
    \[ |g(\lambda)| \lesssim (1 + \lambda)^a. \]
\end{lemma}
\begin{proof}
    If
    %
    \[ G(\lambda) = \int_\lambda^{\lambda + 1} g(\tau)\; d\tau, \]
    %
    then $G$ is absolutely continuous, and for almost all $\lambda$, $G$ is differentiable with
    %
    \[ |G'(\lambda)| = |g(\lambda + 1) - g(\lambda)| \lesssim (1 + \lambda)^a. \]
    %
    The Fourier transform of $G$ also vanishes for $|t| \leq 1$. But
    %
    \[ |g(\lambda)| \leq |G(\lambda)| + O((1 + \lambda)^a) \]
    %
    so it suffices to prove the estimates for $G$. If $\eta(t) = 1$ for $|t| > 1$, and $\eta(t) = 0$ for $|t| \leq 1/2$, and if $\psi$ has Fourier transform $\eta(t) / 2 \pi i t$, then $\psi$ is bounded and rapidly decreasing at infinity. But $G' * \psi = G$, which gives
    %
    \[ |G(\lambda)| \lesssim (1 + \lambda)^a \int |\psi(s)| (1 + |s|)^a\; ds \lesssim (1 + \lambda)^a. \qedhere \]
\end{proof}

TODO: Compare to the proof of the lattice bounds $N(\lambda) = \text{Vol}(B) \cdot \lambda^n + O( \lambda^{n-2 + 2/(n+1)} )$ that one can obtain in the setting $M = \TT^d$, where $B$ is the unit ball in $\RR^d$.






\chapter{Nodal Sets}

Let $M^d$ be a compact manifold, and consider a classical, self-adjoint, elliptic pseudodifferential operator $P$ with positive principal symbol. Then we have seen that one can decompose $L^2(M)$ into orthogonal eigenspaces $\oplus_\lambda E_\lambda$ of the Laplace-Beltrami operator on $M$, where $\lambda$ ranges over a discrete subset of real numbers bounded from below, and $E_\lambda$ is a finite dimensional subspace of $C^\infty(M)$ such that $P E_\lambda = \lambda E_\lambda$. The \emph{node} of a real-valued eigenfunction $e_\lambda$ is the zero set of $e_\lambda$, denoted $N_\lambda$ or $N(e_\lambda)$. We are interested in the asymptotic behaviour of $N_\lambda$ as $\lambda \to \infty$. In particular, one might ask questions such as:
%
\begin{itemize}
    \item How does the number of connected components of $M - N_\lambda$, the \emph{nodal count} of the eigenfunction, grow as $\lambda \to \infty$.

    \item What is the volume of $N_\lambda$. S.T. Yau's nodal size conjecture is that if $P = \sqrt{-\Delta}$, where $\Delta$ is the Laplace Beltrami operator, then
    %
    \[ H^{n-1}(N_\lambda) \sim_M \lambda, \]
    %
    where the implicit constant depends solely on the manifold $M$.

    \item One cannot `hear the shape of a drum', i.e. there exists non-isomorphic compact Riemannian manifolds which are \emph{isospectral}, i.e. whose Laplace-Beltrami operators have the same spectrum. However Smilansky has posed the question of whether one can 'count the shape of a drum', i.e. does the nodal count of $N_\lambda$ for all $\lambda$ determine the Riemannian manifold.
\end{itemize}
%
The analysis often breaks up into complex-variable techniques, which assume $M$ is an analytic Riemannian manifold, and real-variable techniques, which depend only on the fact that $M$ is a smooth manifold. For concreteness, we will focus on the case where $P = \sqrt{-\Delta}$, which has been the scenario with the most focused study.

\begin{example}
    The only compact Riemannian manifold of dimension one, up to scaling, is $\TT = \RR / \ZZ$. In this case, $\lambda$ ranges over the non-negative integers, $E_0$ is one dimensional, the span of the constant function, and more generally, $E_n$ is two dimensional, spanned by $e^{2 \pi n i x}$ and $e^{-2 \pi n i x}$. A general element of $E_n$ can be written as
    %
    \[ e_n = A \cos( 2 \pi n x + \phi ) \]
    %
    for some constants $A$ and $\phi$, and we see the nodal set $N(e_n)$ consists of $2n$ equidistributed points on the torus, and thus the nodal count is $\text{NC}(e_n) = 2n$.

    More generally, we can consider a flat torus $T = \RR^d / \Gamma$, where $\Gamma$ is a lattice with some basis $\{ z_1,\dots,z_d \}$. We define the dual lattice $\Gamma^*$ to be the space of all vectors $w$ such that $w \cdot z \in \ZZ$ for any $z \in \Gamma$. If $w \in \Gamma^*$, then
    %
    \[ e_w(x) = e^{2 \pi i w \cdot x} \]
    %
    is seen to be an eigenfunction of the Laplacian on $T$ with eigenvalue $2 \pi |w|$. These form an orthogonal basis for $L^2(T)$, and therefore span the space of all eigenvalues. Due to the multiplicity of the eigenspaces, it seems very difficult to picture a general nodal set. But if we consider an eigenfunction of the form
    %
    \[ e(x) = A e^{2 \pi i w \cdot x} + B e^{-2 \pi i w \cdot x} = C \cos(2 \pi w \cdot x + \phi) \]
    %
    then we see that the nodal set here is a union of $2 v(w)$ hyperplanes, where $v(w)$ is the minimum positive value of $w \cdot \gamma$, where $\gamma$ ranges over elements of $\Gamma$. If we consider the basis of $\Gamma^*$ given by $\{ w_1,\dots,w_d \}$, where $w_i \cdot z_j = \delta_{i,j}$, and $w = \sum m_i w_i$, then $v(w)$ is the greatest common divisor of the integers $\{ m_1,\dots,m_n \}$.
\end{example}

\begin{example}
    The eigenfunctions of the sphere $S^d$ consists of the spherical harmonics. The eigenvalues $\lambda$ range over numbers of the form $n^{1/2} (n + d - 1)^{1/2}$ for some $n \geq 0$, and for such $\lambda$, the eigenspace $E_\lambda$ can be identified with the space of all harmonic polynomials in $d+1$ variables, homogeneous of degree $n$. The nodal sets of a general harmonic polynomial, however, is much more difficult to analyze than the torus, since the eigenspaces $E_\lambda$ have high multiplicity for large $\lambda$.
\end{example}

Knowledge of general nodal sets is very restricted. We know that the $d-1$ dimensional Hausdorff measure of a nodal set is finite, as well as the $d-2$ dimensional Hausdorff measure of the singularities of the nodal set, i.e. where $e_\lambda$ and $\nabla e_\lambda$ vanishes.

\section{Nodal Sets for Open Subsets of $\RR^d$}

Before we discuss the general setting, let us gain some intuition by studying the basic properties of the nodal sets of eigenfunctions of the Laplacian on bounded, open subsets of $\RR^d$. We fix some open, bounded subset $\Omega$ of $\RR^d$, and consider $C^2(\Omega)$, real-valued functions $e_\lambda: \Omega \to \RR^d$ such that $\Delta e_\lambda = - \lambda^2 \phi$. In this case, we can reduce the study of $e_\lambda$ to a harmonic function on $\Omega \times \RR$, by setting $\phi(x,t) = e_\lambda(x) e^{\lambda t}$. Then
%
\[ \Delta_{x,t} \phi = \Delta_x \phi + \Delta_t \phi = - \lambda^2 \phi + \lambda^2 \phi = 0. \]
%
Since $e^{\lambda t}$ never vanishes, we have $N(u) = N(\phi) \times \RR$. Thus in this situation we can shift our analysis from the understanding of general eigenfunctions to the understanding of harmonic functions. In particular, we see that any eigenfunction lies in $C^\infty(\Omega)$.

\begin{theorem}
    Let $B$ be the unit ball in $\RR^d$. If $e_\lambda \in C^\infty(B)$, and $\Delta e_\lambda = - \lambda^2 e_\lambda$, then $B/2$ is contained in a $c \lambda^{-1}$ neighborhood of $N_\lambda$.
\end{theorem}
\begin{proof}
    We prove the result by contradiction. Suppose that $B/2$ was not contained in an $r < 1/4$ neighborhood of $N_\lambda$. Then $e_\lambda$ does not change sign in some other ball $B'$ with center lying in $B/2$ and with radius $r$, and we may assume without loss of generality that $e_\lambda$ is positive here. Consider the harmonic function
    %
    \[ \phi: B \times \RR \to \RR. \]
    %
    associated with $e_\lambda$ by setting $\phi(x,t) = e_\lambda(x) e^{\lambda t}$. Harnack's inequality tells us that there exists a constant $C$ such that
    %
    \[ e^{\lambda r/2} \sup_{x \in B'} e_\lambda(x) = \sup_{|t| \leq r/2} \sup_{x \in B'} \phi(x,t) \leq C \inf_{|t| \leq r/2} \inf_{x \in B'} \phi(x,t) = C e^{-\lambda r/2} \inf_{x \in B'} e_\lambda(x). \]
    %
    Thus
    %
    \[ e^{\lambda r} \sup_{x \in B'} e_\lambda(x) \leq C \inf_{x \in B'} e_\lambda(x) \leq C \sup_{x \in B'} e_\lambda(x). \]
    %
    Thus, dividing out, we conclude that $e^{\lambda r} \leq C$, which implies that if $c = 2\log(C)$, then $r < c/\lambda$.
\end{proof}

The solution to the Cauchy uniqueness problem for harmonic functions tells us that non-zero harmonic functions can only vanish of order up to one on hyperplanes. This also remains true for eigenfunctions of the Laplacian by this extension trick.

\section{Nodal Sets on the Sphere}

To gain some intuition, let us restrict our analysis even further, to the study of \emph{homogeneous harmonic polynomials} of degree $k$ $\mathbf{H}_k$ on $\RR^{d+1}$, which is equivalent to study eigenfunctions of the Laplacian on the sphere $S^d$. The space $\mathbf{H}_k$ then has dimension
%
\[ { {d + k} \choose {d} } - { {d + k - 2} \choose {d} } \]
%
General nodal sets are impossible to calculate, but the concreteness here should make a stronger analysis more possible.

\begin{example}
    The space $\mathbf{H}_k$ on $\RR^2$ has dimension $2$ for all $k$. The space therefore consists of functions expressible in polar coordinates in the form
    %
    \[ (r,\theta) \mapsto r^k \sin(k \theta + \phi). \]
    %
    Alternatively, we can get these results from the real and imaginary parts of the complex homogeneous polynomial $(x,y) \mapsto (x + iy)^k$. The nodal sets of these polynomials in $\RR^2$ are precisely $k$ lines through the origin, spaced out by a fixed angle. The nodal set on $S^1$ therefore has zero dimensional Hausdorff measure equal to $k$.
\end{example}

\begin{example}
    The space $\mathbf{H}_k$ on $\RR^3$ has dimension $2k+1$. One can find a basis of $\mathbf{H}_k$ using Legendre functions, but the nodal sets become hard to picture. But there are analogues here to the case of $\RR^2$, e.g. the real and imaginary parts of the functions $(x + i y)^k$, $(x + iz)^k$, and $(y + iz)^k$, whose nodal sets are $k$ planes with a common intersection line, and are space out at equal angles radially outward from this perpendicular line. Thus the one dimensional Hausdorff measure of this nodal set on $S^2$ is equal to $2k \pi$. One can perform a similar analysis in $\RR^n$, with the functions $(x + i y)^k$ being formed from $k$ hyperplanes in $\RR^{d+1}$ with a common $d$ dimensional plane lying at their intersection, and thus the nodal set on $S^d$ has measure $k c_d$ where $c_d$ is the volume of an $d-1$ dimensional great circle on $S^d$.
\end{example}

To estimate the size of a general nodal set on a sphere, we utilize an integral geometric formula. Namely, if $E$ is a smooth, $n$ dimensional hypersurface in $\RR^{n+1}$, and we define
%
\[ A_i = \int_{\RR^n} H^0(E \cap H_{i,y})\; dy, \]
%
where $H_{i,y}$ is the hyperplane given by $\{ x \in \RR^{n+1}: (x_1,\dots,\widehat{x_j},\dots,x_{n+1}) = y \}$ for $y \in \RR^n$, then
%
\[ \left( \sum_{i = 1}^{n+1} A_i^2 \right)^{1/2} \leq H^{n-1}(E) \leq \sum_{i = 1}^{n+1} A_i. \]
%
This leads to a general bound.

\begin{theorem}
    If $f \in \mathbf{H}^k$, then $N(f) \subset S^d$ satisfies
    %
    \[ H^{d-1}(N(f)) \lesssim_d k. \]
\end{theorem}
\begin{proof}
    Observe that the number of points in $N(f) = E \cap H_{i,y}$ is equal to the number of zeroes of the degree $\leq k$ polynomial $f(y_1,\dots,t,\dots,y_n)$. Since $f$ is harmonic, and thus does not vanish to order greater than one on any hperplane, for almost every $y$, we conclude that $H^0(N(f) \cap H_{i,y}) \leq k$, and applying the formula above immediately yields the result.
\end{proof}

\begin{remark}
    A lower bound here is immediately seen more difficult, since a general single variable degree $\leq k$ polynomial can have any number of zeroes on the real line, so this technique cannot work so well to get lower bounds unless we use analyticity in some way, and this probably depends on the underlying manifold we are working with to have some analytic structure. But one can obtain this result for the sphere, precisely because it has this analytic structure. TODO: See Han's notes on Nodal Sets.
\end{remark}

\section{Brownian Motion and Nodal Sets}

Eigenfunctions $e_\lambda$ to the Laplace-Beltrami operator on a compact manifold $M^d$ behave well under the heat equation, i.e. if $e^{\Delta t}$ are the propogators for the heat equation $\partial_t = \Delta$ on $M$, and $e_\lambda u = - \lambda^2 u$, then
%
\[ (e^{t \Delta} e_\lambda)(x) = e^{- \lambda^2 t} e_\lambda(x). \]
%
The heat equation is mathematically describing the distribution of a large number of particles, each diffusing through a medium in which they are subject to random molecular bombardments. The theory of \emph{diffusions} in probability give us an alternate viewpoint through which to model this situation, so it makes sense this theory will bring light upon the theory of eigenfunctions.

\subsection{Probabilistic Tools}

To define diffusions, let us introduce the required machinery. We work over a fixed probability space $\Omega$. A \emph{continous stochastic process} valued in some space $M$ is then a Borel-measurable function $X: \Omega \to C([0,\infty),M)$, which we also view as a family of $M$ valued random variables $\{ X_t: t \in [0,\infty) \}$. Intuitively, a stochastic process $X$ is a random path formed by a particle travelling through space. Given a fixed process on $M$ and $x \in M$, we let $\EE^x[\cdot] = \EE[ \cdot | X_0 = x ]$ denote the conditional expectation given that the process starts at the position $x$.

The most basic diffusion process is \emph{Brownian motion}, and is used to generate the more general family. A one dimensional Brownian motion $B$ is a continuous stochastic process such that for any interval $I = [t,s]$, the random variables $\Delta_I B = B_s - B_t$ are mean zero, variance $s - t$ Gaussians, and for any disjoint family of closed intervals $\{ I_1,\dots, I_n \}$ in $[0,\infty)$, the random variables $\{ \Delta_{I_1} B, \dots, \Delta_{I_n} B \}$ are independent of another. An $n$ dimensional Brownian motion on $\RR^d$ is precisely a stochastic process whose coordinates are independent Brownian motions. An \emph{It\^{o} diffusion} with \emph{drift coefficient} $b(x)$ (valued in $\RR^d$) and \emph{diffusion coefficient} $A(x)$ (a $d \times d$ matrix) is a continuous random process $X$ satisfying a \emph{stochastic differential equation} of the form $dX = b(X) dt + A(X) dB$. The formal definition of this stochastic differential equation is quite difficult, but intuitvely, there exists a Brownian motion $B$ such that
%
\[ X_{t + \delta} \approx X_t + b(X_t) \delta + A(X_t) [B_{t + \delta} - B_t] \]
%
which the approximation becomes equality in a technical sense as $\delta \to 0$, i.e. the error $E_{t,\delta}$ between the two random variables is a random variable with mean $o(\delta)$ and third moment $O(\delta^3)$. As one might expect, one can define It\^{o} diffusions on a compact Riemannian manifold $M$, given a vector field $b$ on $M$ operating as the drift coefficient, and a section of linear transformations on $TM$.

An important fact about the diffusions above is that they are \emph{Markov}, i.e. if one observes the values of the Brownian motion $\{ X_t \}$, up to a certain time $T$, the only information one observes which tells us about the evolution of the process past the time $T$ is the position the diffusion arrives to at time $T$, i.e. the random variable $X_T$. More formally, a probabilist would write this by stating that for $S > T$, and for a function $f$ on $M$,
%
\[ \EE[ f(X_S) | \Sigma_T ] = \EE[ f(X_S) | X_T ], \]
%
where the conditional expectation is taken with respect to a $\sigma$ algebra $\Sigma_T$, which models the information one sees when observing the process up to time $T$. One can also let the times $T$ and $S$ be random \emph{stopping times}, so a diffusion satisfies the \emph{strong Markov property}.

Now we connect diffusions to the study of second order partial differential equations. For any $f \in C^2(M)$, if we define a differential operator $L$ on $M$, the \emph{generator of the diffusion}, by setting
%
\[ Lf(x) = b(x) \cdot \nabla f(x) + \frac{A(x)A(x)^T \cdot Hf(x)}{2}, \]
%
Then the derivative of the function $t \mapsto \EE^x[f(X_t)]$ at $t = 0$ is precisely $Lf(x)$. Dynkin's formula follows by formally applying the fundamental theorem of calculus to this derivative, i.e. that
%
\[ \EE^x[f(X_T)] = \EE^x[f(X_0)] + \EE^x \left[ \int_0^T Lf(X_s)\; ds \right] = f(x) + \EE^x \left[ \int_0^T Lf(X_s)\; ds \right], \]
%
and we can allow $T$ to be a stopping time as well, provided that $\EE^x[T] < \infty$. The \emph{Feynman-Kac formula} reverses this process; if we define
%
\[ u(x,t) = \EE^x[f(X_t)] \]
%
then $u$ is the solution to the partial differential equation $\partial_t u = Lu$, with initial conditions $f$. Thus one can convert problems about second order parabolic PDEs to problems about diffusions, and vice versa. In particular, we see that we can obtain a natural definition of Brownian motion on a manifold by letting $B$ be a diffusion with generator given by the Laplace Beltrami operator.

TODO: Showing that it takes $R^2/n$ time on average to leave a ball of radius $R$.

Next, we move onto the study of boundary value problems for semielliptic PDEs $L$ via diffusions. Let us start with a bounded region $D$ of $\RR^d$. Consider a diffusion process $X$ with generator $L$, and let $T_D = \inf \{ t > 0 : X_t \not \in D \}$. Then for sufficiently regular inputs, the Dynkin formula tells us that the unique solution to the problem $Lv = -h$ on $D$ with boundary conditions $\phi$ on $\partial D$ is given by
%
\[ v(x) = \EE^x[\phi(X_{T_D})] + \EE^x \left[ \int_0^{T_D} h(X_t)\; dt \right]. \]
%
We can also solve the heat equation $\partial_t u = Lu$ with absorbing boundary conditions $u(x,t) = 0$ for $x \in \partial D$, and initial condition $u(x,0) = f(x)$ by setting
%
\[ u(x,t) = \EE^x[f(X_t) \chi_t ], \]
%
where $\chi_t = 1$ if $t < T_D$, and $\chi_t = 0$ otherwise (we kill paths that reach the boundary). Using linearity, we can now solve the problem $\partial_t u - Lu = h$ with a general boundary condition $u(x,t) = \phi(x)$ on $\partial D$ and with initial conditions $u(x,0) = f(x)$, namely, we have
%
\[ u(x,t) = \EE^x[\phi(X_{T_D})] + \EE^x \left[ \int_0^{T_D} h(X_t)\; dt \right] + \EE^x[f(X_t) \chi_t]. \]
%
Note that if $D$ is bounded, and $f \in L^\infty(D)$, then dominated convergence implies that for each $x \in D$, $u(x,t) \to v(x)$ as $t \to \infty$, i.e. so the solution to Dirichlet's problem is really the long term distribution of the process.



\begin{comment}
As an example, consider the equation $\Delta u = \delta_x$ defined on a bounded open subset $\Omega$ of $\RR^d$, with $x \in \Omega$, and subject to the condition that $u$ vanishes on the boundary of $\Omega$. One can view this as the steady state distribution of heat obtained by placing a candle underneath the surface at the point $x$, while fixing the temperature of the boundary. In this situation heat is constantly emitted from the point $x$ at all times, allowed to travel around $\Omega$ at random, but is eradicated if it ever touches the boundary $\partial \Omega$ by virtue of the boundary condition. The probabilistic model of this equation is to consider a Brownian motion $\{ B^{x,t_0} \}$ starting at a point $x \in \Omega$ and released at time $t_0$. The density function of these particles at time $T$, viewed as a random measure $\mu^T$ on $\Omega$, is given by
%
\[ \int \phi(x) d\mu^T(x) = \int_0^T \phi(B^{x,t}_T) \chi^{x,t}_T\; dt, \]
%
where $\chi^{x,t_0}_t$ is the indicator function, equal to one if $B^{x,t_0}$ has remained in $\Omega$ up to time $T$, and equal to zero if $B^{x,t_0}$ has ever exited $\Omega$. We then expect that the solution $u$ above is given by
%
\[ \int \phi(x) u(x)\; dx = \lim_{T \to \infty} \EE \left[ \int_0^T \phi(B^{x,t}_T) \chi^{x,t}_T\; dt \right] = \lim_{T \to \infty} \int_0^T \EE[ \phi(B^x_t) \chi^x_t ]\; dt, \]
%
and indeed, this gives a solution to the problem.

We have therefore found a Green's function for the Dirichlet problem. Namely, if we define a distribution $g$ on $\Omega \times \Omega$ such that
%
\[ \int \phi(y) g(x,y)\; dy = \lim_{T \to \infty} \int_0^T \EE[ \phi(B^x_t) \chi^x_t ]\; dt, \]
%
then for a harmonic function $u$ on $\Omega$, we should have
%
\[ u(x) = \int_{\partial \Omega} \frac{\partial g}{\partial \eta} u(y)\; dy. \]
%
This leads to the \emph{harmonic measure}, i.e. we have
%
\[ \frac{\partial g}{\partial \eta} = d\mu^x, \]
%
where
%
\[ \int_{\partial \Omega} \phi(y) d\mu^x(y) = \EE \left[ \phi( V^x ) \right], \]
%
where $V^x$ is a random variable valued on the boundary, equal to $B^x_T$, where $T$ is the \emph{hitting time} of $\partial \Omega$, i.e. the first time $t$ that $B^x_t$ touches $\partial \Omega$. And it makes sense that the function $u(x) = \EE[\phi(V^x)]$ solves the Dirichlet problem on $\Omega$; if we consider a small ball $B \subset \Omega$ of radius $r$ around a point $x$, then Brownian motion starting at $x$ is equally likely to exit $B$ at each point uniformly on the boundary, and so by the Markov property, we find that
%
\[ \EE[\phi(V^x)] = \fint_{|y - x| = r} \EE[\phi(V^y)]\; dy, \]
%
which is equivalent to being harmonic if $u$ is sufficiently regular.

The \emph{Feynman-Kac formula} extends this kind of analysis from the Dirichlet problem to the study of more general solutions to the heat equation $\partial_t u = \Delta u$.

 is a version of this result

For our purposes, we are interested in the \emph{Feynman-Kac} formula. For an open set $\Omega \subset \RR^d$, $f \in L^2(\Omega)$, $x \in \Omega$, and $t > 0$, we find that
%
\[ e^{t \Delta} f(x) = \frac{\EE[ f(B^x_t) | H_\Omega > t ]}{\PP(H^x_\Omega > t)}, \]
%
where
%
\begin{itemize}
    \item $B^x$ is a standard Brownian motion beginning at $x$.
    \item $H^x_\Omega$ is the time that $B^x$ hits $\partial \Omega$.
\end{itemize}
%
Thus, in particular,
%
\[ e^{-\lambda^2 t} e_\lambda(x) = \frac{\EE[ e_\lambda(B^x_t) | H^x_\Omega ]}{\PP(H^\Omega_x > t)} \]
%
One can again understand $H_{\Omega,x}$ by `reversing time' in a certain sense. The probability that Brownian motion will have left $\Omega$ at a certain time is equal to the probability that a Brownian motion starting uniformly on the boundary will reach $x$. Thus
%
\[ u(x,t) = \PP(H_{\Omega,x} > t) \]
%
is a solution to the heat equation, such that $u(x,t) = 1$ on $\partial \Omega$, and starts equal to zero on $\Omega$.
\end{comment}

\section{Nodal Sets Via Brownian Motion}

To exploit this relation to control nodal sets, we let $\Omega$ be a nodal domain of $e_\lambda$, i.e. a connected component of $M$. The Feynman-Kac formula tells us that solutions to the equation $\partial_t = \Delta$ on an open set $\Omega \subset M$, which are held equal to one on $\partial \Omega$ and vanish initially on the interior can be understood in terms of the probability that Brownian motion will hit $\partial \Omega$ in a given number of units of time.



We will get information about the nodal set by constructing diffusion processes which behave different near the boundary via the Feynman-Kac formula,

TODO: WHY IS NEUMANN VS DIRICHLET CONNECTED TO THE NODAL SET OF AN EIGENFUNCTION? NEUMANN CONDITIONS DON'T WORK, BECAUSE THE ASSOCIATED BROWNIAN MOTION MUST BE REFLECTED ABOUT THE SINGULAR SET OF $e_\lambda$, WHICH CAUSES PROBLEMS.

Instead of imposing boundary conditions, we instead construct a stochastic process which looks like a diffusion for small times, but converges back to initial data at large times. This leads to a bound of the form
%
\[ H^{d-1}(N_\lambda) \gtrsim_M \lambda^{- \frac{n-3}{4}} \]
%
A related problem is to show that nodal domains can be `concentrated' near flat surfaces. Call a smooth, embedded $d-1$ dimensional hypersurface $\Sigma$ in $M$ \emph{admissable up to distance $r$} if the geodesic flow outward from $\Sigma$ is injective up to a distance $r$, i.e. any point in the $r$-thickening of $\Sigma$ has a unique closest point on $\Sigma$. Roughly speaking, this implies that $\Sigma$ is `locally flat at a scale $r$'.

\begin{theorem}
    For any manifold $M$, there exists a constant $c > 0$ such that if $\Sigma$ is admissable up to a distance $\lambda^{-1/2}$, then no nodal domain $N_\lambda$ can be a contained in a $c \lambda^{-1/2}$ neighborhood of $\Sigma$.
\end{theorem}

The proof will show one can generalize this result to $\Sigma$ formed from a finite union of embedded manifolds admissable up to a distance $\lambda^{-1/2}$, provided these manifolds are sufficiently transversal to one another. This leads to a new proof of a class result due to Hayman.

\begin{corollary}
    There exists $c \geq 1/900$ such that if $\Omega \subset \RR^2$ is simply connected with \emph{inradius} $\rho$ ($\rho$ is the largest radius of a ball contained in $\Omega$), $\lambda_1(\Omega) \geq c/\rho^2$.
\end{corollary}

TODO: DO WE EXPECT DENSITY OF THE NODAL SET FOR LARGE $\lambda$, i.e. $\lambda^{-1/2}$ density.

(Citation: Green, Brown, and Probability)
(Citation: Stochastic Differential Equations)
(Citation: Tao Brownian Motion)

















\section{Discrete Restriction Theory}

Let $T$ be a classical, self-adjoint, elliptic pseudodifferential operator of order one on a compact manifold $M$, and consider an eigenfunction decomposition $\{ e_j \}$ for $T$, corresponding to an increasing set of eigenvalues $\{ \lambda_i \}$. We are concerned with the $(L^p,L^q)$ bounds for the \emph{spectral band projection operators}
%
\[ \chi_{\lambda,\varepsilon} = \sum_{\lambda \leq \lambda_j \leq \lambda + \varepsilon} E_j. \]
%
These operators are closely related to restriction theory. The Stein-Tomas theorem studies the spherical projection operator, defined for functions on $\RR^n$ by setting
%
\[ \chi f(x) = \int_{|\xi| = 1} \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi. \]
%
We can also consider the \emph{spherical projection operators}
%
\[ \chi_\lambda f(x) = \int_{|\xi| = \lambda} \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi = \lambda^{-1} \text{Dil}_{1/\lambda} \chi \{ \text{Dil}_\lambda f \}. \]
%
The Stein-Tomas theorem characterizes the mapping properties of the operator $\chi$, showing that the only inequality the operator has are of the form
%
\[ \| \chi f \|_{L^{p^*}(\RR^n)} \lesssim \| f \|_{L^p(\RR^n)} \]
%
for $1 \leq p \leq 2(n+1)/(n+3)$. Rescaled, one concludes that we have
%
\[ \| \chi_\lambda f \|_{L^{p^*}(\RR^n)} \lesssim \lambda^{n(1/p - 1/p^*)-1} \| f \|_{L^p(\RR^n)}. \]
%
This inequality implies that if we define the spectral band projection operators
%
\[ \chi_{\lambda,\varepsilon} f(x) = \int_{\lambda \leq |\xi| \leq \lambda + \varepsilon} \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi = \int_\lambda^{\lambda + \varepsilon} S_\tau f(x)\; d\tau, \]
%
then,
%
\begin{align*}
    \| \chi_{\lambda,\varepsilon} f \|_{L^{p^*}(\RR^n)} &\lesssim \int_\lambda^{\lambda + \varepsilon} \tau^{n(1/p - 1/p^*) - 1} \| f \|_{L^p(\RR^n)}\; d\tau\\
    &\lesssim \varepsilon (1 + \lambda)^{n(1/p - 1/p^*) - 1} \| f \|_{L^p(\RR^n)}.
\end{align*}
%
It is also clear that a proof of this inequality would prove that $\chi_\lambda$ was bounded, since $\chi_\lambda = \lim_{\varepsilon \to 0} \varepsilon^{-1} \chi_{\lambda, \varepsilon}$. Thus the theory of boundedness of spherical projections is closely related to the theory of boundedness for spectral band projections.

The original context for the spherical projection operators is to apply a $TT^*$ argument, i.e. proving the $(L^p,L^2)$ and $(L^2,L^{p^*})$ boundedness of the \emph{restriction} and \emph{extension} operators, which map functions on $\RR^n$ to functions on $\lambda S^{n-1}$, and vice-versa, by setting
%
\[ R_\lambda f(\xi) = \widehat{f}(\xi) \quad\text{and}\quad E_\lambda f(x) = \int_{|\xi| = \lambda} f(\xi) e^{2 \pi i \xi \cdot x}\; d\xi. \]
%
These operators are adjoints of one another, and $S_\lambda = E_\lambda \circ R_\lambda$. Thus a $T^*T$ argument justifies that for $1 \leq p \leq 2(n+1)/(n+3)$,
%
\[ \| R_\lambda f \|_{L^2(\lambda S^{n-1})} \lesssim \lambda^{n(1/p - 1/2) - 1/2} \| f \|_{L^p(\RR^n)} \]
%
and
%
\[ \| E_\lambda f \|_{L^{p^*}(\RR^n)} \lesssim \lambda^{n(1/p - 1/2) - 1/2} \| f \|_{L^2(\lambda S^{n-1})}. \]
%
It is difficult to find direct analogues of the operators $R_\lambda$ and $E_\lambda$ on a manifold, just as we cannot directly find a direct analogue of $\chi_\lambda$, because our eigenfunction is discrete. But we \emph{can} consider analogues obtained by thickening the restriction set, i.e. considering the operators $R_{\lambda,\varepsilon}$ and $E_{\lambda,\varepsilon}$, mapping functions on $\RR^n$ to functions on the annulus $A_{\lambda,\varepsilon} = \{ \xi \in \RR^n: \lambda \leq |\xi| \leq \lambda + \varepsilon \}$ and vice versa by setting
%
\[ R_{\lambda,\varepsilon} f(\xi) = \widehat{f}(\xi) \quad\text{and}\quad E_{\lambda,\varepsilon} f(x) = \int_{\lambda \leq |\xi| \leq \lambda + \varepsilon} f(\xi) e^{2 \pi i \xi \cdot x}\; d\xi. \]
%
We have $\chi_{\lambda,\varepsilon} = E_{\lambda,\varepsilon} \circ R_{\lambda,\varepsilon}$, and the Stein-Tomas theorem is then verified to be equivalent to bounds of the form
%
\[ \| R_{\lambda,\varepsilon} f \|_{L^2(A_{\lambda,\varepsilon})} \lesssim \varepsilon \lambda^{n(1/p - 1/2) - 1/2} \| f \|_{L^p(\RR^n)} \]
%
and
%
\[ \| E_{\lambda,\varepsilon} f \|_{L^{p^*}(\RR^n)} \lesssim \varepsilon \lambda^{n(1/p - 1/2) - 1/2} \| f \|_{L^2(A_{\lambda,\varepsilon})}. \]
%
But the orthogonality of the Fourier transform, shows that the restriction bound is equivalent to the fact that
%
\[ \| \chi_{\lambda,\varepsilon} f \|_{L^2(\RR^n)} \lesssim \varepsilon \lambda^{n|1/p - 1/2| - 1/2} \| f \|_{L^p(\RR^n)} \]
%
and
%
\[ \| \chi_{\lambda,\varepsilon} f \|_{L^{p^*}(\RR^n)} \lesssim \varepsilon \lambda^{n|1/p - 1/2| - 1/2} \| f \|_{L^2(\RR^n)}. \]
%
This bound is the one we will begin by focus on generalizing to arbitrary manifolds, and we will start with case $p = 1$. Since there is no ambiguity, in the sequel, we let $\chi_\lambda = \chi_{\lambda,1}$.

We note that in $\RR^n$, one can prove the same result for any positive homogeneous function $p(\xi)$ of degree one such that the \emph{cosphere} $\Sigma = \{ \xi : p(\xi) = 1 \}$ has non-vanishing curvature, Stein-Tomas gives results about
%
\[ \chi_\lambda f(x) = \int_\Sigma \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d \xi. \]
%
Returning to the analysis of the operator $T$ with principal symbol $p(x,\xi)$. We will obtain good results about the operator $\chi_\lambda$ provided that the cospheres $\Sigma(x) = \{ \xi : p(x,\xi) = 1 \}$ has non-vanishing curvature for all $x \in M$.

The easiest bound in the Stein-Tomas theorem are the equivalent bounds
%
\[ \| \chi_\lambda f \|_{L^2(\RR^n)} \lesssim \lambda^{(n-1)/2} \| f \|_{L^1(\RR^n)} \]
%
and
%
\[ \| \chi_\lambda f \|_{L^\infty(\RR^n)} \lesssim \lambda)^{(n-1)/2} \| f \|_{L^2(\RR^n)}, \]
%
which does not even utilize the curvature of the domain of projection whatsoever, solely using the fact that the sphere of radius $\lambda$ has surface measure $O(\lambda^{n-1})$. Let us see if we can justify the analogous result on a compact manifold. We will find we do not need to assume curvature here either.

\begin{lemma}
    Let $T$ be a classical, elliptic, self-adjoint pseudodifferential operator of order one on a compact manifold $M$ of dimension $n$, and consider the association spectral band projection operators $\{ \chi_\lambda \}$. Then
    %
    \[ \| \chi_\lambda f \|_{L^2(M)} \lesssim \lambda^{(n-1)/2} \| f \|_{L^1(M)}, \]
    %
    and thus by self-adjointness, that
    %
    \[ \| \chi_\lambda f \|_{L^\infty(M)} \lesssim \lambda^{(n-1)/2} \| f \|_{L^2(M)}. \]
\end{lemma}
\begin{proof}
    We want to exploit the parametrix for the wave equation. Thus we start by replacing $\chi_\lambda$ with an operator $\tilde{\chi}_\lambda$ given by
    %
    \[ \tilde{\chi}_\lambda f(x) = \sum_j \chi(\lambda_j - \lambda) E_j, \]
    %
    where $\chi$ is a non-negative Schwartz function with $\chi(0) > 0$, and such that $\widehat{\chi}(t)$ has support on $|t| \leq \varepsilon/2$. Because $\mathbf{I}(\lambda \leq \lambda_j \leq \lambda + \varepsilon) \lesssim \chi(\lambda_j - \lambda)$, orthogonality shows that
    %
    \[ \| \chi_\lambda f \|_{L^2(M)} \lesssim \| \tilde{\chi}_\lambda f \|_{L^2(M)} \]
    %
    and so it suffices to prove the result for $\tilde{\chi}_\lambda$. But if $\tilde{\chi}_\lambda$ has kernel
    %
    \[ \tilde{K}_\lambda(x,y) = \sum_j \chi(\lambda_j - \lambda) e_j(x) \overline{e_j(y)}. \]
    %
    This is equivalent to showing that
    %
    \[ \| \tilde{K}_\lambda \|_{L^\infty_y L^2_x} \lesssim \lambda^{(n-1)/2}. \]
    %
    But orthogonality shows that
    %
    \begin{align*}
        \| \tilde{K}_\lambda \|_{L^\infty_y L^2_x} &= \left( \sup_{y \in M} \sum_j \chi(\lambda_j - \lambda)^2 |e_j(y)|^2 \right)^{1/2}\\
        &\leq \| \chi \|_{L^\infty}^{1/2} \left( \sup_{y \in M} \sum_j \chi(\lambda_j - \lambda) |e_j(y)|^2 \right)^{1/2}\\
        &\leq \| \chi \|_{L^\infty}^{1/2} \left( \sup_{y \in M} \tilde{\chi}_\lambda(y,y) \right)^{1/2}.
    \end{align*}
    %
    Thus we need to show that for all $y \in M$,
    %
    \[ \tilde{\chi}_\lambda(y,y) \lesssim \lambda^{n-1}. \]
    %
    This follows by an argument similar to the proof of the Weyl law, e.g. applying the parametrix for the wave equation.
\end{proof}

Now we move onto results that require a curvature assumption.

\begin{theorem}
    Let $T$ be a classical, elliptic, self-adjoint pseudodifferential operator of order one on a compact manifold $M$ of dimension $n$ and with principal symbol $p(x,\xi)$, such that the cospheres
    %
    \[ \Sigma(x) = \{ \xi \in T^*M : p(x,\xi) = 1 \} \]
    %
    have non-vanishing curvature for each $x \in M$. If we consider the association spectral band projection operators $\{ \chi_\lambda \}$, then for $p_c = 2(n+1)/(n+3)$, we have
    %
    \[ \| \chi_\lambda f \|_{L^2(M)} \lesssim (1 + \lambda)^{(n - 1)/2(n+1)} \| f \|_{L^{p_c}(M)}. \]
\end{theorem}

\begin{remark}
    Combined with the $(L^1,L^2)$ boundedness of the equation, and the fact that
    %
    \[ \| \chi_\lambda f \|_{L^2(M)} \lesssim \| f \|_{L^2(M)} \]
    %
    we conclude using interpolation that for $1 \leq p \leq 2(n+1)/(n+3)$,
    %
    \[ \| \chi_\lambda f \|_{L^2(M)} \lesssim (1 + \lambda)^{n|1/p - 1/2| - 1/2} \| f \|_{L^p(M)} \]
    %
    and for $2(n+1)/(n+3) \leq p \leq 2$,
    %
    \[ \| \chi_\lambda f \|_{L^2(M)} \lesssim (1 + \lambda)^{(\frac{n-1}{2})(1/p-1/2)} \| f \|_{L^p(M)}. \]
    %
    All these inequalities are sharp, as we will discuss after the proof.
\end{remark}

\begin{proof}
    We start by using a strategy we began the $(L^1,L^2)$ boundedness result with, namely, to swap $\chi_\lambda$ out with a more well behaved operator. The operators $\tilde{\chi}_\lambda$ used in that proof become singular near the diagonal as $\lambda \to \infty$, i.e. the kernel is $\Theta(\lambda^n)$. Thus we modify their definition slightly. We fix a small quantity $\varepsilon_0 \leq \varepsilon/2$, and define a Schwartz function $\chi$ (not necessarily positive this time), with $\chi(0) = 1$ and with Fourier support on $\varepsilon_0 / 2 \leq t \leq \varepsilon_0$. Nonetheless, it remains true that $\chi(x) \gtrsim 1$ for $|x| \leq \varepsilon$, so that
    %
    \[ \| \chi_\lambda f \|_{L^2(M)} \lesssim \| \tilde{\chi}_\lambda f \|_{L^2(M)}. \]
    %
    It thus suffices to obtain a bound for $\tilde{\chi}_\lambda$ at the critical exponent. Applying the parametrix, and seeing that the remainder term has operator norm $O_N((1 + \lambda)^{-N})$ for all $N > 0$, it suffices to show that the operator $\tilde{\chi}_\lambda$ wih kernel
    %
    \[ \int \int \widehat{\chi}(t) s(t,x,y,\xi) e^{2 \pi i [\phi(x,y,\xi) + t(p(y,\xi) - \lambda)]}\; dt\; d\xi \]
    %
    is well behaved. The kernel of this operator is an oscillatory integral, and on the support of the amplitude $s$, and if we set $\Phi(t,x,y,\xi) = \phi(x,y,\xi) + t p(y,\xi)$ has
    %
    \[ |\nabla_\xi \Phi(t,x,y,\xi)| \gtrsim 1 \]
    %
    on the support of the amplitude $\widehat{\chi} s$ for $\xi \neq 0$ except if $|x - y| \sim \varepsilon_0$. Thus, applying stationary phase, if $\eta \in C^\infty(M \times M)$ is a function which equals one for $|x - y| \sim \varepsilon_0$, and vanishes everywhere else, the difference between $\tilde{\chi}_\lambda$ and the operator $\chi'_\lambda$ with kernel
    %
    \[ \int \int \widehat{\chi}(t) s(t,x,y,\xi) \eta(x,y) e^{2 \pi i [\Phi(t,x,y,\xi) - \lambda t]}\; d\xi\; dt \]
    %
    is an operator of the form
    %
    \[ \int \widehat{\chi}(t) A(t,x,y) e^{- 2 \pi i \lambda t}, \]
    %
    where $A$ is smooth, and it therefore follows this kernel is $O_N((1 + \lambda)^{-N})$. Let us set $a(t,x,y,\xi) = \widehat{\chi}(t) s(t,x,y,\xi) \eta(x,y)$. Our proof is now completed by applying some results about non-homogeneous oscillatory integral operators, once we show that 
    %
    \[ \int \int a(t,x,y,\xi) e^{2 \pi i [\Phi(t,x,y,\xi) - \lambda t]}\; d\xi\; dt = \lambda^{(n-1)/2} a_\lambda(x,y) e^{2 \pi i \lambda \psi(x,y)}, \]
    %
    where $\psi$ is non-homogeneous, and satisfies the $n \times n$ Carleson-Sj\"{o}lin conditions on the support of $a_\lambda$, which is smooth, and satisfies $|\partial_x^\alpha \partial_y^\beta a_\lambda| \lesssim_{\alpha,\beta} 1$, uniformly in $\lambda$.
\end{proof}


